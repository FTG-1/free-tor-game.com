<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Unit-testing &#8211; TDD a card game &#8211; where to start &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1083760 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1083760" class="post-1083760 software type-software status-publish hentry category-software tag-tdd tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Unit-testing &#8211; TDD a card game &#8211; where to start</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">tdd</span><span class="mr-2 badge badge-info">unit testing</span></p><div class="entry-content"><p>One of the most important rule in TDD is to write the simplest test to implement the simplest code in order to get closer to the end of a project.</p><p>I&#39;d like to implement the game of <a href="https://en.wikipedia.org/wiki/Briscola" rel="nofollow noreferrer">Briscola</a>.<br /> It&#39;s a simple card game, with 40 cards, 2-5 players, and simple rules.</p><p>To start, I thought the best thing to implement was the core of the game, playing a hand.</p><p>To play a hand I need at least 2 players in a game, both will have 3 cards in hand, both have to be able to play one card each, and the game has to be able to decide the winner, and count points.</p><p>That looks like a lot of things to implement before passing that first test.</p><p>Should I still write that test down, and use it to implement everything needed ?<br /> Or should I write tests for everything before trying to make that test pass ?</p><p>One thing that makes me reluctant to write a test as simple as &#34;an_ace_is_worth_11_points&#34; is that I&#39;m afraid the design I&#39;d start implementing would absolutely not fit the design to make a more concrete and complete test pass.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Because you&#39;re <em>running too fast</em>. When reading <em>specifications</em> you should stop as soon as you can write some code (after you understood the domain). I usually read the domain model specifications few times until I think I understood them and then I read them again using an highlighter to mark important bits to start coding.</p><blockquote><p>To start, I thought the best thing to implement was the core of the game, playing a hand.
 To play a hand I need at least 2 players in a game, both will have 3 cards in hand, both have to be able to play one card each, and the game has to be able to decide the winner, and count points.</p></blockquote><p>First of all write down the complete specifications for this game. Everything, even if you think you have it clear in your mind. It doesn&#39;t even need to be strictly formal.</p><p>Let&#39;s go through this word by word, the first keyword to highlight is <strong>game</strong>. You will, probably, then need a <code>Game</code> class you want to create. Let&#39;s write a test method (syntax is for C# but the important part is the concept):</p><pre><code>[TestMethod]
void CanCreateNewGame()
{
    var game = new Game();
}
</code></pre><p>So far so good, we just want to be sure we can create a <code>Game</code> object and it doesn&#39;t throw any exception. If we will introduce a factory (for example to join an on-line pending game) then this is the test we need to rewrite. Let&#39;s write code to make it pass:</p><pre><code>public sealed class Game { }
</code></pre><p>Now continue scanning your specifications, you have <strong>players</strong>. You will then need to create them, same as above. You see then <strong>...in a game...</strong>. It means they must be stored in the <code>Game</code> class and they can be from 2 to 5, you need also a collection.</p><pre><code>[TestMethod]
public void CanCreatePlayer()
{
    var game = new Game();
    game.Players.Add(new Player());
}
</code></pre><p>Let&#39;s declare the class and its collection <code>PlayerCollection</code> then add it to the game class:</p><pre><code>public sealed class Player { }
public sealed class PlayerCollection : Collection&lt;Player&gt; { }

public sealed class Game
{
    public PlayerCollection Players { get; } = new PlayerCollection();
}
</code></pre><p>Our tests are green, we can now move to the next important part (the number of players). When we need at least two players and no more than 5? When we <strong>start</strong> a game:</p><pre><code>[TestMethod]
[ExpectedException(typeof(InvalidOperationException))]
public void CannotStartGameWithLessThan2Players()
{
    var game = new Game();
    game.Start();
}
</code></pre><p>Make it compile, add <code>Start()</code> to <code>Game</code>:</p><pre><code>public void Start()
{
    if (Players.Count &lt; MinimumNumberOfPlayers || Players.Count &gt; MaximumNumberOfPlayers)
        throw new InvalidOperationException(&#34;...&#34;);
}
</code></pre><p>Just continue like this until your application is completed. Now you can move that check into a separate function <code>EnsureThereIsRightNumberOfPlayers()</code> and you already have all the tests to do it safely. I&#39;d suggest to also add assertions to help you with tests (countless times an assertion failed when running my tests and I found I had to add more tests...) but it&#39;s probably outside the scope of your question.</p><p>Writing tests before code will also help to have a better code coverage and to keep your code testable even when you just started using unit testing.</p><hr/><p>What I shown above is a <em>literal</em> TDD approach, I am often little bit more pragmatic and I write bigger code blocks and/or multiple tests in one shot. For example I will NEVER write <code>int Sum(int a, int b) =&gt; 2;</code> because I need to pass the test <code>Assert.AreEqual(2, Sum(1, 1,))</code> (to fix it in the next test when I need to verify <code>Sum(-1, -1)</code>). I&#39;d write, whenever possible, enough code to pass the test but using what may be a <em>true</em> implementation (which I may refine and refactor later because I already have tests in-place).</p><p>With some experience with TDD you will find what&#39;s the best compromise for you.</p><hr/><h1>TDD as a tool to study the domain</h1><p><strong>Note</strong>: <a href="https://softwareengineering.stackexchange.com/a/231418/49723">TDD won&#39;t replace design phase</a>, it&#39;s not its role. It will, however, help you to refine your design from an abstract domain point of view to a <em>practical</em> implementation. Also note that the <em>type</em> of tests you write in this case is pretty different from the type of tests you write on a <em>normal</em> TDD approach.</p><p>Sometimes the <em>domain</em> isn&#39;t perfectly clear and you need to write some code to outline overall architecture. This case, IMO, is when you have <strong>greater benefits with TDD</strong>. Didn&#39;t ever happen to write a <em>great</em> model which is a pain to consume? If you start <em>consuming</em> your model first then this won&#39;t ever happen.</p><p>In this case I find convenient to write a slightly complex test method to understand who the <em>actors</em> are, for example a very naive first approach to the problem may be:</p><pre><code>[TestMethod]
public void CanSetupGame()
{
    // I have a game
    var game = new Game();

    // With at least two named players
    game.Players.Add(new Player(&#34;Adam&#34;));
    game.Players.Add(new Player(&#34;Jon&#34;));

    // I can start the game
    game.Start();

    // And I keep playing until there are cards in the table...
    while (game.Cards.Count &gt; 0)
    {
        // Print current cards to...console?
        var availableCards = game.CurrentPlayer.Cards;

        // Read user input from?
        var selectedCard = availableCards.First();

        game.CurrentPlayer.Play(selectedCard);
    }
}
</code></pre><p>As you can see you immediately see what your objects have to do, you need to keep track of the current player, its cards and stop playing when...cards are finished. You also immediately see that more users may share the same screen and so on...</p><p>Of course you will need to write a lot of code before this test can pass (you may temporarily <code>[Ignore]</code> it) and it MUST change/evolve over time but it will be your <em>GPS</em> to write all the other smaller tests you need. You may even find that some of these &#34;high level abstraction&#34; tests should be moved to integration tests, for example. Even better. Note that you should not throw away these tests, they&#39;re great self-documenting examples and the <strong>first thing that someone else should see when studying your code</strong>.</p><p>Writing this kind of rough code will greatly help you to better understand the Big Picture before writing one single line in your model (and some IDEs let you generate stubs from this code...). After you wrote above code you may then think <em>&#34;Shouldn&#39;t everything be inside <code>Start()</code>?&#34;</em>. You will then drop that <code>while</code> and you will next think <em>&#34;How should I get inputs?&#34;</em> and add, for example, an <code>Input</code> property of type <code>Stream</code> to the <code>Game</code> class. You will do the same for <code>Output</code> and you will then ask yourself <em>&#34;What if I want to make it graphical?&#34;</em> and replace it with with a <code>UserInteraction</code> class. Keep changing, refining and increasing your understanding. You won&#39;t write a model (and its tests) you need to throw away because it&#39;s a pain to use (which may also cause the calling code to be a mess because you don&#39;t want to throw away such <em>beautiful</em> already written model...)</p><p>Note that this <em>consumer to implementation</em> approach will also help you to refine some of your architectural decisions, for example:</p><ul><li>Is the language a <em>good fit</em> to express the model? Should I move to another language? To a DSL?</li><li>Do I need any framework? Are frameworks I supposed to use good for this job? Did they drive in the choice of the language?</li><li>Are performance good enough? Should I review my algorithms?</li><li>This package/module/class depend on the other one to perform its task. Is it a <em>good enough</em> decision or should I move responsibilities?</li><li>Did I practically put too many responsibilities on this class and I&#39;d better move them out? Is there a chance to reuse this code somewhere else?</li></ul><p>You probably have already noted that DDD, TDD and - when dealing with UI - lean UX design aren&#39;t separate steps or different approaches (!!!) but they go pretty well all together.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/unit-testing-how-should-you-tdd-a-yahtzee-game/'>Unit-testing &#8211; How should you TDD a Yahtzee game</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/unit-testing-in-tdd-if-i-write-a-test-case-that-passes-without-modifying-production-code-what-does-that-mean/'>Unit-testing &#8211; In TDD, if I write a test case that passes without modifying production code, what does that mean</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/tdd-and-version-control/'>TDD and Version Control</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/when-do-you-write-the-real-code-in-tdd/'>When do you write the &#8220;real&#8221; code in TDD</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/unit-testing-tdd-create-a-game-logic-using-test-first-programming/'>Unit-testing &#8211; TDD: Create a Game logic using Test-First Programming</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>