<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Legitimate &#8220;real work&#8221; in a constructor &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069639 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069639" class="post-1069639 software type-software status-publish hentry category-software tag-constructors tag-dependency-injection tag-design tag-design-patterns tag-java"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Legitimate &#8220;real work&#8221; in a constructor</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">constructors</span><span class="mr-2 badge badge-info">dependency-injection</span><span class="mr-2 badge badge-warning">design</span><span class="mr-2 badge badge-primary">design-patterns</span><span class="mr-2 badge badge-danger">java</span></p><div class="entry-content"><p>I am working on a design, but keep hitting a roadblock. I have a particular class (ModelDef) that is essentially the owner of a complex node tree built by parsing an XML schema (think DOM). I want to follow good design principles (SOLID), and ensure that the resulting system is easily testable. I have every intention of using DI to pass dependencies into the constructor of ModelDef  (so that these can easily be swapped out, if need be, during testing).</p><p>What I&#39;m struggling with, though, is the creation of the node tree. This tree is going to be made up entirely of simple &#34;value&#34; objects which will not need to be independently tested. (However, I may still pass an Abstract Factory into ModelDef to assist with the creation of these objects.)</p><p>But I keep reading that a constructor <strong>should not do any real work</strong> (e.g. <a href="http://misko.hevery.com/code-reviewers-guide/flaw-constructor-does-real-work/">Flaw: Constructor does Real Work</a>). This makes perfect sense to me if &#34;real work&#34; means constructing heavy-weigh dependent objects that one might later want to stub out for testing. (Those should be passed in via DI.)</p><p>But what about light-weight value objects such as this node tree? The tree has to be created somewhere, right? Why not via the constructor of ModelDef (using, say, a buildNodeTree() method)?</p><p>I don&#39;t really want to create the node tree outside of ModelDef and then pass it in (via constructor DI), because creating the node tree by parsing the schema requires a significant amount of complex code &#8212; code that needs to be thoroughly tested. I don&#39;t want to relegate it to &#34;glue&#34; code (which should be relatively trivial, and will likely not be directly tested).</p><p>I have thought of putting the code to create the node tree in a separate &#34;builder&#34; object, but hesitate to call it a &#34;builder&#34;, because it doesn&#39;t really match the Builder Pattern (which seem to be more concerned with eliminating telescoping constructors). But even if I called it something different (e.g. NodeTreeConstructor), it still feels like a bit of a hack just to avoid having the ModelDef constructor build the node tree. It has to be built somewhere; why not in the object that&#39;s going to own it?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>And, besides what Ross Patterson suggested, consider this position which is the exact opposite:</p><ol><li><p>Take maxims such as &#34;Thou Shalt Not Do Any Real Work In Thy Constructors&#34; with a grain of salt.</p></li><li><p>A constructor is, really, nothing but a static method.  So, structurally, there is really not much difference between:</p><p>a) a simple constructor and a bunch of complex static factory methods, and</p><p>b) a simple constructor and a bunch of more complex constructors.</p></li></ol><p>A considerable part of the negative sentiment towards doing any real work in constructors comes from a certain period of the history of C++ when there was debate as to precisely what state the object will be left in if an exception is thrown within the constructor, and whether the destructor should be invoked in such an event.  That part of the history of C++ is over, and the issue has been settled, while in languages like Java there never was any issue of this kind to begin with.</p><p>My opinion is that if you simply avoid using <code>new</code> in the constructor, (as your intention to employ Dependency Injection indicates,) you should be fine.  I laugh at statements like &#34;conditional or looping logic in a constructor is a warning sign of a flaw&#34;.</p><p>Besides all that, personally, I would take the XML parsing logic out of the constructor, not because it is evil to have complex logic in a constructor, but because it is good to follow the &#34;separation of concerns&#34; principle.  So, I would move the XML parsing logic into some separate class altogether, not into some static methods that belong to your <code>ModelDef</code> class.</p><p><strong>Amendment</strong></p><p>I suppose that if you have a method outside of <code>ModelDef</code> which creates a <code>ModelDef</code> from XML, you will need to instantiate some dynamic temporary tree data structure, populate it by parsing your XML, and then create your new <code>ModelDef</code> passing that structure as a constructor parameter.  So, that could perhaps be thought of as an application of the &#34;Builder&#34; pattern. There is a very close analogy between what you want to do and the <code>String</code> &amp; <code>StringBuilder</code> pair. However, I have found this Q&amp;A which seems to disagree, for reasons which are not clear to me: <a href="https://stackoverflow.com/q/5238007/773113">Stackoverflow - StringBuilder and Builder Pattern</a>.  So, to avoid a lengthy debate over here as to whether the <code>StringBuilder</code> does or does not implement the &#34;builder&#34; pattern, I would say feel free to be inspired by how <code>StrungBuilder</code> works in coming up with a solution that suits your needs, and postpone calling it an application of the &#34;Builder&#34; pattern until that little detail has been settled.</p><p>See this brand new question: <a href="https://softwareengineering.stackexchange.com/q/305504/41811">Programmers SE: Is “StringBuilder” an application of the Builder Design Pattern?</a></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../python-representing-complex-object-dependencies/'>Python &#8211; Representing complex object dependencies</a></li><li class="list-group-item"><a href='../design-is-stringbuilder-an-application-of-the-builder-design-pattern/'>Design &#8211; Is &#8220;StringBuilder&#8221; an application of the Builder Design Pattern</a></li><li class="list-group-item"><a href='../java-is-it-strange-for-a-builder-object-to-have-getter-methods/'>Java &#8211; Is it strange for a Builder object to have getter methods</a></li><li class="list-group-item"><a href='../java-should-constructors-ever-be-used-only-for-side-effects/'>Java &#8211; Should constructors ever be used only for side-effects</a></li><li class="list-group-item"><a href='../dependency-injection-via-constructor-vs-setter/'>Dependency Injection via Constructor vs Setter</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>