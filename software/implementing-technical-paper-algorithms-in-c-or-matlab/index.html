<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Implementing technical paper algorithms in C++ or MATLAB &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1077993 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1077993" class="post-1077993 software type-software status-publish hentry category-software tag-algorithms tag-c tag-matlab"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Implementing technical paper algorithms in C++ or MATLAB</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">MATLAB</span></p><div class="entry-content"><p>I am an Electrical Engineering undergrad. I&#39;ve reading many technical papers about Signal and Image processing algorithms (reconstruction, segmentation, filtering, etc). Most of the algorithms shown in these papers are defined over continuous time and continuous frequency, and often give the solutions in terms of complicated equations. How would you implement a technical paper from scratch in C++ or MATLAB in order to replicate the results obtained in said paper?</p><p>More specifically, I was looking at the paper &#34;A general cone-beam reconstruction algorithm&#34; by Wang et al (<a href="http://www.imaging.sbes.vt.edu/BIDLib/CT/C003-scb-algo.pdf">IEEE Trans Med Imaging. 1993;12(3):486-96</a>), and I was wondering, how do I even start implementing their algorithm?<br /> Equation 10 gives you the formula of the reconstructed image at . How would you code that up? Would you have a for-loop going through each voxel and computing the corresponding formula? How would you code functions of functions in that formula? How would you evaluate functions at arbitrary points?</p><p>I&#39;ve read the book &#34;Digital Image Processing&#34; by Gonzalez and Woods but I&#39;m still at a loss. I have also read about the Numerical Recipes book series. Would that be the correct way?</p><p>What are your experiences programming algorithms from research papers? Any tips or suggestions?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Signal processing algorithms defined in continuous time/space/frequency are typically implemented by sampling the signal on a discrete grid and converting integrals into sums (and derivatives into differences).  Spatial filters are implemented through convolution with a convolution kernel (i.e. weighted sum of neighbors).</p><p>There is a huge body of knowledge concerning filtering sampled time-domain signals; time-domain filters are implemented as either <a href="http://en.wikipedia.org/wiki/FIR_filter" rel="nofollow">finite impulse response filters</a>, where the current output sample is computed as a weighted sum of the previous N input samples; or infinite impulse response filters, where the current output is a weighted sum of the previous inputs and previous <em>outputs</em>.  Formally, the discrete time filters are described using the <a href="http://en.wikipedia.org/wiki/Z_transform" rel="nofollow">z-transform</a>, which is the discrete-time analog to the <a href="http://en.wikipedia.org/wiki/Laplace_transform" rel="nofollow">Laplace transform</a>.  The <a href="http://en.wikipedia.org/wiki/Bilinear_transform" rel="nofollow">bilinear transform</a> maps one to the other (<code>c2d</code> and <code>d2c</code> in Matlab).</p><blockquote><p>How would you evaluate functions at arbitrary points?</p></blockquote><p>When you need the value of a signal at a point that does not lie directly on your sampling grid, you <a href="http://en.wikipedia.org/wiki/Interpolation" rel="nofollow">interpolate</a> its value from nearby points.  Interpolation can be as simple as choosing the nearest sample, computing a weighted average of the nearest samples, or fitting an arbitrarily complicated analytic function to the sampled data and evaluating this function at the needed coordinates.  Interpolating onto a uniform finer grid is <a href="http://en.wikipedia.org/wiki/Upsampling" rel="nofollow">upsampling</a>.  If your original (continuous) signal does not contain details (i.e. frequencies) finer than half the sampling grid, then the continuous function can be perfectly reconstructed from the sampled version (the <a href="http://en.wikipedia.org/wiki/Nyquistâ€“Shannon_sampling_theorem" rel="nofollow">Nyquist-Shannon sampling theorem</a>).  For an example of how you can interpolate in 2D, see <a href="http://en.wikipedia.org/wiki/Bilinear_interpolation" rel="nofollow">bilinear interpolation</a>.</p><p>In Matlab you can use <code>interp1</code> or <code>interp2</code> to interpolate 1D or regularly sampled 2D data (respectively), or <code>griddata</code> to interpolate from irregularly sampled 2D data.</p><blockquote><p>Would you have a for-loop going through each voxel and computing the corresponding formula?</p></blockquote><p>Yes, exactly.</p><p>Matlab saves you from having to do this via explicit for-loops because it is designed to operate on matrices and vectors (i.e. multidimensional arrays).  In Matlab this is called &#34;vectorization&#34;.  Definite integrals can be approximated with <code>sum</code>, <code>cumsum</code>, <code>trapz</code>, <code>cumtrapz</code>, etc.</p><blockquote><p>I&#39;ve read the book &#34;Digital Image Processing&#34; by Gonzalez and Woods but I&#39;m still at a loss. I have also read about the Numerical Recipes book series. Would that be the correct way?</p></blockquote><p>Yes, <em>Numerical Recipes</em> would be a great start.  It is very practical and covers most of the numerical methods you&#39;ll end up needing.  (You will find that Matlab already implements everything you need, but <em>Numerical Recipes</em> will provide excellent background.)</p><blockquote><p>I have taken an &#34;algorithms and data structures&#34; class, but I don&#39;t see the relation between the material presented there and implementing scientific algorithms.</p></blockquote><p>The material treated in &#34;Algorithms and data structures&#34; courses tends to concentrate on structures like lists, arrays, trees, and graphs containing integers or strings and operations like sorting and selecting: problems for which there is typically a single correct result.  When it comes to scientific algorithms, this is only half of the story.  The other half concerns methods to estimate real numbers and analytic functions.  You&#39;ll find this in a course on &#34;Numerical Methods&#34; (or &#34;Numerical Analysis&#34;; like <a href="http://persson.berkeley.edu/128A/" rel="nofollow">this one</a> - scroll down for the slides): how to estimate special functions, how to estimate integrals and derivatives, etc.  Here one of the main tasks is to estimate the accuracy of your result, and one common pattern is to iterate a routine that improves an estimate until it is sufficiently accurate.  (You might ask yourself how Matlab knows how to do something as simple as estimate a value of <code>sin(x)</code> for some <code>x</code>.)</p><hr/><p>As a simple example, here is a short script that computes a radon transform of an image in Matlab.  The radon transform takes projections of an image over a set of projection angles.  Instead of trying to compute the projection along an arbitrary angle, I instead rotate the entire image using <code>imrotate</code>, so that the projection take is always vertical.  Then we can take the projection simply using <code>sum</code>, since the <code>sum</code> of a matrix returns a vector containing the sum over each column.</p><p>You could write your own <code>imrotate</code> if you prefer, using <code>interp2</code>.</p><pre><code>%%# Home-made Radon Tranform

%# load a density map (image).  
A = phantom;

n_pixels = size(A, 1);  %# image width (assume square)

%# At what rotation angles do we want to take projections?
n_thetas = 101;
thetas = linspace(0, 180, n_thetas);

result = zeros(n_thetas, n_pixels);

%# Loop over angles
for ii=1:length(thetas)
    theta = thetas(ii);
    rotated_image = imrotate(A, theta, &#39;crop&#39;);
    result(ii, :) = sum(rotated_image);
end

%# display the result
imagesc(thetas, 1:n_pixels, result.&#39;);
xlabel(&#39;projection angle [degrees]&#39;);
</code></pre><p>What was once an integral of the density along a ray is now a sum over a column of a discretely sampled image, which was in turn found by interpolating the original image over a transformed coordinate system.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../in-matlab-how-can-preallocating-cell-arrays-improve-performance/'>In MATLAB, how can &#8216;preallocating&#8217; cell arrays improve performance</a></li><li class="list-group-item"><a href='../unit-testing-unit-regression-testing-scientific-algorithms-given-floating-point-behavior/'>Unit-testing &#8211; Unit (regression) testing scientific algorithms given floating point behavior</a></li><li class="list-group-item"><a href='../traverse-a-matrix-using-a-linear-index-to-get-an-evenly-distributed-values-sample/'>Traverse a matrix using a linear index to get an evenly distributed values sample</a></li><li class="list-group-item"><a href='../gpling-an-implementation-of-a-patented-algorithm/'>GPLing an implementation of a patented algorithm</a></li><li class="list-group-item"><a href='../parallel-processing-a-tree-on-gpu/'>Parallel processing a Tree on GPU</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>