<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Entity Framework Code First, C# class separation and EAV &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073671 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073671" class="post-1073671 software type-software status-publish hentry category-software tag-codefirst tag-database-design tag-entity-framework tag-poco"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Entity Framework Code First, C# class separation and EAV</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">codefirst</span><span class="mr-2 badge badge-info">database-design</span><span class="mr-2 badge badge-warning">entity-framework</span><span class="mr-2 badge badge-primary">poco</span></p><div class="entry-content"><p>I&#39;m in the process of redesigning a portion of my ASP.NET MVC application. I&#39;m currently using Entity Framework 6.1 code first approach.</p><p>I&#39;ve been reading as of late that (Correct me if I&#39;m wrong, I don&#39;t know much about DBs): Joins are expensive; we should keep our database normalized and with the least queries executed as possible. Entity Framework does a join each time we &#34;virtual&#34; a property and try to retrieve it (Eager/Lazy Loading). We should avoid an Entity-Attribute-Value approach (EAV), unless denormalization becomes desirable (Correct me).</p><p>Code First approach allows us to write the DB schema using C# OOP code (POCO). Which means that we should adhere to OOP&#39;s SOLID Principles (Correct me). The first one is Single Responsibility, which means a class should do only one thing (again, correct me if I&#39;m wrong).</p><p>Now here comes the problem (this is the first time it happens to me). I have a class with around 30 properties. Before thinking in anti-EAV, I went and separated the model accordingly:</p><p><a href="../../../i.stack.imgur.com/Mq3st.png" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/Mq3st.png" alt="enter image description here"/></a></p><p>As you can see I have many virtual properties without the List&lt;&gt; type, this means that it is a one-to-one relationship. I have read in a previous stack-overflow post that a good rule of thumb is that one-to-one relationships should be avoided in favor of having them in a same table. That is, of course, if that one-to-one is not called from other tables. We prevent EAV and therefore, Joins.</p><p>Following SOLID principles, I have extracted some properties to external classes. They will get their own table.</p><p>So, the question will be, should I favor a fully normalized design over a OOP Approach when modeling in Entity Framework?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>(Late to the party, but I couldn&#39;t resist)</p><p>Let&#39;s straighten out some misconceptions.</p><blockquote><p>Joins are expensive</p></blockquote><p>As compared to what? Of course, reading one flat table is &#34;cheaper&#34; than joining tables, but any mature RDBMS is highly optimized for executing joins because they are inevitably part of sound database designs. Joins over foreign key constraints (the most common ones) are especially optimized. And of course, proper indexing is indispensable.</p><blockquote><p>we should keep our database normalized and with the least queries executed as possible</p></blockquote><p>The way you pose this, it seems to be a consequence of preventing these &#34;expensive&#34; joins. The reverse is true. Normalization will always result in more tables and, hence, more joins to query the same data as from a denormalized data schema. (Well, to be fair to you, later on you say &#34;We prevent EAV and therefore, Joins.&#34;).</p><blockquote><p>We should avoid an Entity-Attribute-Value approach (EAV), unless denormalization becomes desirable</p></blockquote><p>EAV is all but denormalization. I&#39;m under the impression that you don&#39;t fully understand what EAV is.</p><p>In an EAV design, <strong>attributes</strong> of a relation (aka <em>fields</em>, or <em>columns</em>, of a database <em>table</em>) are taken out of a relation and stored as records in an Attributes tables. The <strong>values</strong> are stored in yet another table that has foreign keys to the Attributes table and an <strong>Entity</strong> table. A record in the Attributes tables expresses one fact: this is value X of attribute Y in entity Z.</p><p>So with EAV, when applied rigorously, if you want to know the start date, end date, and cost of a tournament, you&#39;ll have to query the PGTournament table and join to Attribute and Value (with a <code>WHERE</code> condition for the attributes). That&#39;s two joins instead of zero without EAV!</p><p>Nearly always, EAV is bad design. It&#39;s to be used when there&#39;s no alternative (for instance in lab applications where new analyses for samples can be invented every day -- a fixed set of fields in a Sample table won&#39;t suffice).</p><p>In your case, I don&#39;t see any reason to introduce EAV -- I don&#39;t even understand why you bring it up. I think it is because you confuse EAV with 1:1 associations. Read on.</p><blockquote><p>Which means that we should adhere to OOP&#39;s SOLID Principles</p></blockquote><p>The EF class model is part of a <em>data access layer</em>. It&#39;s not a domain model! At least, it&#39;s not its first responsibility to be that. The class properties should facilitate data access. That means that there will be bidirectional relationships and Id properties, to mention two OOP anti-patterns. And the real OOP bummer: the classes tend to be highly anemic. Whenever the EF classes <em>can</em> be used as domain classes, this is a mere <a href="https://stackoverflow.com/a/18113611/861716">bonus</a>.</p><blockquote><p>virtual properties without the <code>List&lt;&gt;</code> type</p></blockquote><p>Such properties are known as <em>navigation properties</em> because the &#34;navigate&#34; to other entities. Lists are <em>collection navigation properties</em> and entity-type properties (without the <code>List&lt;&gt;</code> type) are <em>reference navigation properties</em>. They don&#39;t have to be virtual. When they&#39;re virtual, EF may be able to lazily load the properties.</p><blockquote><p>this means that it is a one-to-one relationship</p></blockquote><p>Why? Reference navigation properties are often the &#34;1&#34; part of a 1:n association. I think most of your reference properties are like that. For example, <code>GameGenre</code>. I think there are <em>many</em> tournaments having the same <code>GameGenre</code>. It&#39;s a <code>1</code> (genre) to <code>n</code> (tournament) association, even if <code>GameGenre</code> doesn&#39;t have a <code>Tournaments</code> collection. Maybe only <code>TournamentSettings</code> and <code>MainImage</code> are actual 1:1 associations.</p><p>1:1 Associations distribute data belonging to one entity over multiple tables. There can be very good reasons to do that. One of them is to facilitate querying light-weight data without the heavy payload of some blob, like <code>MainImage</code>. Another one is separating sensitive data from public data. Or common data (often queried) from specialized data (queried sometimes), maybe your <code>TournamentSettings</code>.</p><p>Now, finally, your question:</p><blockquote><p>should I favor a fully normalized design over a OOP Approach when modeling in Entity Framework?</p></blockquote><p>You&#39;re comparing apples and oranges. Normalized design is database, OOP is class model. But if there is anything to favor, it&#39;s normalized design. A well-wrought database design is pivotal to any data-based application. Everything else follows. The EF class model will necessarily closely reflect the database structure. As I said above: it must be seen as a data access layer.</p><p>But whenever you model business logic, of course, try to do it as SOLID as possible. That means that sometimes you&#39;ll have to populate a specialized domain model out of the entities queried by EF, and sometimes the EF classes can be extended to encapsulate behavior and data (which is what OOP is all about).</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../eav-is-it-really-bad-in-all-scenarios/'>EAV &#8211; is it really bad in all scenarios</a></li><li class="list-group-item"><a href='../c-entity-framework-and-distributed-systems/'>C# &#8211; Entity Framework and distributed Systems</a></li><li class="list-group-item"><a href='../c-entity-framework-and-eager-loading-and-enterprise-application-with-ddd-aproach/'>C# &#8211; Entity framework and Eager loading and enterprise application with DDD aproach</a></li><li class="list-group-item"><a href='../design-how-to-model-users-accounts-in-asp-mvc-framework-with-entity-framework-using-code-first-approach/'>Design &#8211; How to model users accounts in ASP MVC Framework with Entity Framework using code-first approach</a></li><li class="list-group-item"><a href='../c-should-you-reuse-an-entity-framework-edmx-between-multiple-solutions/'>C# &#8211; Should you reuse an Entity Framework EDMX between multiple solutions</a></li><li class="list-group-item"><a href='../c-entity-framework-domain-object-as-business-object/'>C# &#8211; Entity Framework Domain Object as Business Object</a></li><li class="list-group-item"><a href='../serialize-entity-framework-objects-without-lazy-loading/'>Serialize Entity Framework Objects Without Lazy Loading</a></li><li class="list-group-item"><a href='../table-per-concrete-type-in-entity-framework-core/'>Table Per Concrete Type in Entity Framework Core</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>