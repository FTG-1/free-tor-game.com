<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; How to unit-test the presence of specific file contents, through an interface &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087044 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087044" class="post-1087044 software type-software status-publish hentry category-software tag-c tag-interfaces tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; How to unit-test the presence of specific file contents, through an interface</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">interfaces</span><span class="mr-2 badge badge-warning">unit testing</span></p><div class="entry-content"><p>I am currently trying to test a file manager class. This class is responsible for keeping track of how long the file is good for. The file will have a date written into it that denotes when it was generated as well as the duration of how long the file is good for. Consumers of my interface will be agnostic to these details. The interface looks like:</p><pre><code>public interface IFileManager
{
    bool GenerateFile(string location);
    bool DeleteFile(string location);
    bool IsFileValid(string location);
    bool Update(string customerID, string location);
}
</code></pre><p>I am concerned with how to test one of these methods, specifically <code>IsValid(string location)</code>. Part of the implementation I am planning on for <code>IsValid</code> will be to check whether the file has expired, as well as the file not just containing garbage.</p><p>Okay, so here is my conundrum. I always write my unit tests in a separate project, where they only have a reference to an interface library. That is, I test everything through an interface so my unit tests will only know about <code>IFileManager</code>. So from a high-level interface, how do I test a specific implementation of an &#34;expired&#34; or &#34;garbage&#34; file?</p><p>My interface does not allow for a client of said interface to create a file that&#39;s already expired. And that makes sense to me! On top of that, I don&#39;t want to add in functionality to my interface just to be able to test! My thoughts about how can I test this, give me a code smell.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>My thoughts about how can I test this, give me a code smell.</p></blockquote><p>This API is encapsulating a side effect.  And that&#39;s fine -- most of your code doesn&#39;t need to know the details.  But for unit testing, you probably need a way to replace the side effect with a test double.</p><p>You&#39;re implementation is probably using a small number of calls to some File library to do the actual work.  So the idea is to have an interface that wraps those calls, and pass an instance of that interface in to get the <code>IFileManager</code> you want.</p><pre><code>interface FilePrimitives { ... }

IFileManager fileManager(FilePrimitives filePrimitives) { ... }
</code></pre><p>The is basically the &#34;Strategy&#34; pattern at work.</p><p>In your production code, you initialize the FileManager using an implementation of FilePrimitives that makes actual library calls. The primitives are effectively part of the &#34;imperative shell&#34;, where your code interacts with the outside world.</p><p>Key point: one of your constraints in implementing the primitives is that they should be too simple to break.</p><p>When you are testing, instead of using the &#34;real&#34; primitives, you use a test double, and control the responses from the test.</p><p>So if you want to test a garbage file, you set up your test double so that it reacts <em>as if</em> there really is a garbage file, and then use that to initialize the rest of your system.</p><p>Your test is really two pieces -- it is both a use case (exercising the API) validator, but it is also a <a href="http://blog.ploeh.dk/2011/07/28/CompositionRoot/" rel="noreferrer">composition root</a>.</p><blockquote><p>So you are saying to abstract the file library and then inject a mock version of it that always reports that a file is expired?</p></blockquote><p>Yes, although I would spell it somewhat differently: we&#39;re taking the <a href="https://blog.acolyer.org/2016/09/05/on-the-criteria-to-be-used-in-decomposing-systems-into-modules/" rel="noreferrer">decision</a> to use this file library, and placing a module boundary around that decision, so that we can change that decision in the test harness.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-how-should-i-unit-test-a-class-that-relies-on-having-realistic-data/'>Unit-testing &#8211; How should I unit-test a class that relies on having realistic data</a></li><li class="list-group-item"><a href='../unit-testing-how-to-unit-test-that-the-correct-implementation-of-an-interface-is-used/'>Unit-testing &#8211; How to unit test that the correct implementation of an interface is used</a></li><li class="list-group-item"><a href='../c-how-to-make-one-test-depend-on-the-results-of-another-test/'>C# &#8211; How to make one test depend on the results of another test</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>