<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Mvc &#8211; Decoupling UI code &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073168 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073168" class="post-1073168 software type-software status-publish hentry category-software tag-coupling tag-design tag-mvc tag-ui"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Mvc &#8211; Decoupling UI code</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">coupling</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">mvc</span><span class="mr-2 badge badge-primary">ui</span></p><div class="entry-content"><p>In my application I have several event handlers that perform some action in response to user interface events such as a button click or menu selection.  The code in these event handlers looks like this for example:</p><pre><code>void MyDialog::OnCommandLoadFile()
{
    char strFilter[] = { &#34;Text Files (*.txt)|*.txt|All Files (*.*)|*.*||&#34; };

    CFileDialog fileDlg(TRUE, &#34;.txt&#34;, NULL, 0, strFilter);

    if( fileDlg.DoModal() == IDOK )
    {
        const std::string path = fileDlg.GetPathName();

        std::vector&lt;std::string&gt; urls;
        int maxNumberOfUrls = settings_-&gt;Get&lt;int&gt;(Settings::MaxNumberOfUrls);
        UrlProvider *urlProvider = new FileUrlProvider(path);
        urlProvider-&gt;GetUrls(urls, maxNumberOfUrls);

        webMonitoringService_-&gt;MonitorUrls(urls);

        DisplayMessage(&#34;URLs loaded.&#34;);
    }

}
</code></pre><p>This is typical of my event handlers. I don&#39;t code monolithic event handlers but they do &#34;glue&#34; various pieces together.  I usually have some business-logic/service classes which the UI has a reference to and in the event handlers I make calls to one or more of these to perform the desired task.</p><p>What I&#39;m wondering is is this still too coupled?  If I wanted to turn this into a command line app I&#39;d have to extract bits and pieces from the UI code.  In the above example, there is a compound action going on so should I&#39;m thinking it should look more like:</p><pre><code>void MyDialog::OnCommandLoadFile()
{
    char strFilter[] = { &#34;Text Files (*.txt)|*.txt|All Files (*.*)|*.*||&#34; };

    CFileDialog fileDlg(TRUE, &#34;.txt&#34;, NULL, 0, strFilter);

    if( fileDlg.DoModal() == IDOK )
    {
        const std::string path = fileDlg.GetPathName();

        application-&gt;MonitorUrlsFromFile(path);

        DisplayMessage(&#34;URLs loaded.&#34;);
    }

}
</code></pre><p>Is that right? In the above code what would &#34;application&#34; be?  A controller?  Is that the right abstraction for this?  Whenever I need to perform some task in a UI handler, should it always be a one-liner (aside from getting data in or out of text boxes etc.)  Anyone have a pointer to a tutorial that really covers this (in any programming language)?</p><p>Furthermore, if in fact you should abstract compound actions, how to you propagate error messages from within the compound abstraction back out to the UI?  An exception hierarchy? Single exception with error code?</p><p><strong>UPDATE</strong></p><p>I&#39;m looking at the Command Pattern which looks promising.</p><p><strong>UPDATE 2</strong></p><p>In the end I decided on refactoring my code as described in the Humble Dialog Box paper in the accepted answer.  My understanding is that this is a Model View Presenter (MVP) type pattern and more specifically a Passive View.  The refactoring is going smoothly.  There are some rough edges in my understanding of the full application of the pattern when it comes to things like displaying message boxes and file open dialogs or dealing with event timers but overall I&#39;m happier with my code; the tight coupling was bothering me.</p><p>I also found this &#34;bundle&#34;: <a href="http://webclientguidance.codeplex.com/wikipage?title=MVP_landing_page" rel="noreferrer">patterns &amp; practices Web Client Developer Guidance: Model View Presenter (MVP) Bundle</a> which has sample MVP code.  It&#39;s a web project whereas my current implementation is desktop but I guess that&#39;s the beauty of MVP is that it partly doesn&#39;t matter.  One thing I got from that was to dependency inject my service layer objects into the presenter rather than new&#39;ing them inside my presenter class.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>If you want to learn how to better decouple your GUI from your business logic, I suggest you read Michael Feathers` article <a href="https://web.archive.org/web/20151130093108/http://www.objectmentor.com/resources/articles/TheHumbleDialogBox.pdf" rel="nofollow noreferrer">&#34;The humble dialog box&#34;</a></p><p>If you got yourself familiar with that, and you want some more of that stuff, here is a Blog series &#34;Build Your Own CAB&#34; which explains all important variants of &#34;MVC&#34;:</p><p><a href="http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/" rel="nofollow noreferrer">http://codebetter.com/jeremymiller/2007/07/26/the-build-your-own-cab-series-table-of-contents/</a></p><p>EDIT: according your example code: when you are going to use &#34;MVP&#34;, that will mean not to have a &#34;god object&#34; <code>application</code> where you place <code>MonitorUrlsFromFile</code>, but a controller (or &#34;presenter&#34;) class <code>MyDialogController</code> at first hand. Think of it when your program get 20 dialogs and all of them would place their handler logic in a class <code>application</code> - that will easily end up with a class having 5000 lines of code or more, which is definitely too big.</p><p>By MVP approach, you will only refactor <code>MonitorUrlsFromFile</code> to another more general place, when you need this function from more than one dialog and want to reuse it. Even then I would not make this an <code>application</code> class, better group functions for urls or url monitoring into one utility class.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-how-to-set-up-mvp-for-a-winforms-solution/'>C# &#8211; How to set up MVP for a Winforms solution</a></li><li class="list-group-item"><a href='../c-thread-class-design/'>C++ &#8211; Thread class design</a></li><li class="list-group-item"><a href='../java-how-to-design-an-application-that-read-files-using-mvc-pattern/'>Java &#8211; How to design an application that read files using MVC pattern</a></li><li class="list-group-item"><a href='../design-loose-coupling-presenter-to-view-in-mvp/'>Design &#8211; Loose Coupling Presenter to View in MVP</a></li><li class="list-group-item"><a href='../mvc-why-is-it-the-callers-responsibility-to-ensure-thread-safety-in-gui-programming/'>Mvc &#8211; Why is it the caller&#8217;s responsibility to ensure thread safety in GUI programming</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>