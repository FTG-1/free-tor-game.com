<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>RESTful API/Data Modeling &#8211; How to model an subordinate resource that will only ever have one element &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1080189 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1080189" class="post-1080189 software type-software status-publish hentry category-software tag-api-design tag-data-modeling tag-rest"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">RESTful API/Data Modeling &#8211; How to model an subordinate resource that will only ever have one element</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api-design</span><span class="mr-2 badge badge-info">data modeling</span><span class="mr-2 badge badge-warning">rest</span></p><div class="entry-content"><p>I&#39;m creating an API and data model for a multi-user document-creation application and I&#39;m having trouble with a particular part of the data model/API design. Below is my current line of thinking:</p><p>There are two similar actions that can happen while a user is writing a document:</p><ol><li>A user can manually save a document. This creates a revision and there can be many revisions for a single document.</li><li>An autosave is triggered periodically while a user is editing the document. Because autosaves can happen fairly frequently and have redundant data, there can only be one autosave for a single document.</li></ol><p>These actions are used to create a couple of features:</p><ol><li>Users can revert to an old revision of the document.</li><li>Autosaves prevent the user from losing their work.</li><li>Basic document locking &#8211; if a user creates an autosave for a document, then another user cannot begin editing that document. When a user triggers a manual save, creating a revision, the autosave associated with the document will be deleted, and therefore another user could start working on the document then.</li></ol><p>Here&#39;s an outline of the data model I have:</p><pre><code> _________           ______________________
|Documents|         |DocumentRevisions     |
|---------| ------&lt; |----------------------|    
|id: int  |         |id: int               |
|_________|         |documentBody: string  |
     |              |createdAt: datetime   |
     |              |______________________|
 ____|________________
|DocumentDrafts       |
|---------------------|
|id: int              |
|documentBody: string |
|_____________________|
</code></pre><p>And here are some of the endpoints I have:</p><ul><li>GET  /documents/</li><li>POST /documents//revisions<ul><li>This is called on a manual save</li></ul></li><li>PUT  /documents//draft<ul><li>This is called on autosave</li></ul></li></ul><p>These are the things I don&#39;t like about this current model:</p><ul><li>The <code>POST /documents/&lt;documentId&gt;/revisions</code> endpoint has to also modify the DocumentDrafts table to reflect the fact that the document is now in a &#34;clean&#34; state and can be modified by another user</li><li>The <code>PUT /documents/&lt;documentId&gt;/draft</code> endpoint breaks a few rules of REST including the use of the singular word &#34;draft&#34; (because there can only be one draft of a document)</li></ul><p>I think the requirement that only one autosave can exist for a document at any point is really tripping me up and I&#39;m not sure how to model it correctly. Is there a better way? Do I need to lift the requirement of a single autosave per document?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>The <code>POST /documents/&lt;documentId&gt;/revisions</code> endpoint has to also modify the <code>DocumentDrafts</code> table to reflect the fact that the document is now in a &#34;clean&#34; state and can be modified by another user</p></blockquote><p>Different layer. It is important to understand that it is usually not desirable to tightly couple the API layer to the service and/or data layers.</p><blockquote><p>The <code>PUT /documents/&lt;documentId&gt;/draft</code> endpoint breaks a few rules of REST including the use of the singular word &#34;draft&#34; (because there can only be one draft of a document)</p></blockquote><p>There is no such rule. For starters, REST says exactly nothing about what URIs should look like. Beyond that, it is generally accepted in web API design that singular words are reasonable when only a single instance of the resource exists.</p><p>In your shoes, I&#39;d use these endpoints:</p><pre><code>/documents
/documents/{id}
/documents/{id}/draft
/revisions
/revisions/{id}
</code></pre><p>A user can GET a document. This will contain a link or a subresource with the most recent revision. To start editing, they POST to draft. This will either return <code>201 Created</code> (they are now editing) or <code>409 Conflict</code> (somebody else is already editing). The user who is editing will PUT to draft. To cancel editing without saving, the user can DELETE draft. To commit the draft, they POST to /revisions. A side effect of this will be to DELETE the draft. Alternately, you can require a manual DELETE of draft by the client to terminate the edit.</p><p>Now the only problem you have is what happens when the user starts an edit and goes on vacation without cancelling or committing it. :-)</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-what-api-design-makes-the-most-sense-for-changing-a-users-password/'>Rest &#8211; What API design makes the most sense for changing a user&#8217;s password</a></li><li class="list-group-item"><a href='../rest-with-a-rest-api-is-there-a-convention-for-clients-validate-a-request-without-committing-any-changes/'>Rest &#8211; With a REST API, is there a convention for clients validate a request without committing any changes</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>