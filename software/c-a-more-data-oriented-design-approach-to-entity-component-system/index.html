<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; A more data oriented design approach to Entity Component System &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1084651 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1084651" class="post-1084651 software type-software status-publish hentry category-software tag-architecture tag-c tag-data tag-entity tag-entity-component-system"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; A more data oriented design approach to Entity Component System</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">data</span><span class="mr-2 badge badge-primary">entity</span><span class="mr-2 badge badge-danger">entity-component-system</span></p><div class="entry-content"><p>I&#39;m creating my first c++ game engine project (for learning purposes) and in it I&#39;ve attempted to implement an entity/component system utilizing some data oriented design principles while also not fully giving up my object oriented way of thinking. I have data only component structs:</p><p>(Example)</p><p>Position.h</p><pre><code>struct Position
{
    Vector3D position{ 0.0f, 0.0f, 0.0f };
};
</code></pre><p>which are stored in arrays within my SceneManager class:</p><p>SceneManager.h</p><pre><code>class SceneManager
{
    //Some other code....

private:
    //So only systems have access to component arrays
    friend class BGraphics::RenderSystem;
    friend class BInput::InputSystem;
    friend class BPhysics::MovementSystem;
    friend class BPhysics::CollisionSystem;
    friend class BAudio::AudioSystem;

    //Component arrays. Each index of the arrays represents an entity.
    //So positionComponents.at(1) represents entity 1&#39;s position. 
    Array&lt;Position, 10&gt; positionComponents;
    Array&lt;Velocity, 10&gt; velocityComponents;
};
</code></pre><p>As you can see, my engine&#39;s system classes are the only ones who have access to the component arrays and so every system can process components. There are some other things involved in this setup that I don&#39;t want to get too deep into for simplicity&#39;s sake. My issues are as follows:</p><p>Each system accepts a SceneManager reference in an Update function like so:</p><pre><code>RenderSystem::Update(SceneManager&amp; scene)
{ 
   //Use scene component arrays necessary for processing...
}
</code></pre><p>What I&#39;m struggling with is right now my components seem like global variables in that every system has access to them and can change their state. Though it seems like a lot of data oriented design involves structs like these with public data for which other functions can operate on, changing their state. With that being said, is there something I&#39;m missing with my implementation that would make my component data more encapsulated and safer? How am I suppose to think about handling data in a safe way when utilizing data oriented design? Any clarification is appreciated.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Indeed, in your design, the <code>SceneManager</code> acts as a container for global data. This is the inconvenience of a data centric design that sees data as a flat passive structure, and which leave to subsystems&#39; functions the responsibility to manage the data.</p><p>A first remark is that each of the subsystems has to know that your data is in an array of fixed size, and needs to know the number of active elements therein. This is a fatal dependency. If later you&#39;d choose to use a dynamic vector, or a searchable unordered multimap (e.g. for targeting group of components corresponding to a <a href="https://docs.unity3d.com/Manual/Tags.html" rel="nofollow noreferrer">game tag</a>), you&#39;d need to rewrite everything.</p><p>You therefore need a minimum of encapsulation for accessing to elements in the container (e.g. With an <a href="http://www.oodesign.com/iterator-pattern.html" rel="nofollow noreferrer">iterator</a> like interface such as <code>first()</code>, <code>next()</code>, <code>previous()</code>, <code>last()</code> ). The containers would then remain private, and the access to the components would be controlled.</p><p>Nevertheless this kind of architecture will be difficult to maintain. If you <a href="https://en.m.wikipedia.org/wiki/Information_hiding" rel="nofollow noreferrer">encapsulate</a> data and the interface for accessing it, you are in an <a href="https://en.m.wikipedia.org/wiki/Object-oriented_programming" rel="nofollow noreferrer">object oriented</a> paradigm. So why not go for it ? Your <code>SceneManager</code> would the maintain a a container of <code>Components</code>. The components would become more comprehensive entities, which know their own position and velocity, the other subsystems will then not know these internals, but use the object&#39;s interface in a well behaved fashion.</p><p>If you want to know more about such approach, I&#39;d recommend you <a href="https://en.m.wikipedia.org/wiki/Mike_McShaffry" rel="nofollow noreferrer">Mike McShaffry</a>&#39;s &#34;<a href="http://www.goodreads.com/book/show/18953515-game-coding-complete-fourth-edition" rel="nofollow noreferrer">Game Coding Complete</a>&#34;. This book gives full insight about a game architecture, including hints about when to use object oriented features such as inheritance, and when rather avoid it.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-entity-component-system-architecture-interaction-between-systems/'>Architecture &#8211; Entity-Component-System architecture: interaction between systems</a></li><li class="list-group-item"><a href='../c-how-to-avoid-managers-in-the-code/'>C++ &#8211; How to avoid &#8220;managers&#8221; in the code</a></li><li class="list-group-item"><a href='../design-how-to-allow-for-custom-rules-in-a-entity-component-system-designed-game-engine/'>Design &#8211; How to allow for custom Rules in a Entity Component System designed game engine</a></li><li class="list-group-item"><a href='../object-oriented-oop-ecs-vs-pure-ecs/'>Object-oriented &#8211; OOP ECS vs Pure ECS</a></li><li class="list-group-item"><a href='../isnt-an-entity-component-system-terrible-for-decoupling-information-hiding/'>Isn&#8217;t an Entity-Component System terrible for decoupling/information hiding</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>