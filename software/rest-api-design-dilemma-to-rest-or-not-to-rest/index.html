<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; API design dilemma: to REST or not to REST &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075000 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075000" class="post-1075000 software type-software status-publish hentry category-software tag-api-design tag-rest tag-state tag-time-management"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; API design dilemma: to REST or not to REST</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api-design</span><span class="mr-2 badge badge-info">rest</span><span class="mr-2 badge badge-warning">state</span><span class="mr-2 badge badge-primary">time-management</span></p><div class="entry-content"><p>I&#39;d like to design a REST API supporting:</p><ul><li>Login</li><li>Temporary token generation</li></ul><p>The reason being there are a number of client-side REST libraries that would speed up development if used, as they take care of serialization, connection, etc. If not used, we would have to code these parts separately. I don&#39;t need REST for performance, there will be no load balancing or caching involved in the server side.</p><p>Login and token generation are quite common. And yet I&#39;m having a hard time trying to figure how to do them in REST. For instance:</p><h2>Login</h2><p>I&#39;ve read a lot about login in REST, and apparently there&#39;s no right answer here. In the end many people end up using OAuth just because it is mainstream. Actually I just need to check if the user exists and the password is correct. Any other operation in the API will be passed the user name and password for authorization purposes, so for now we are still in the stateless side.</p><p>The problem here is that I&#39;ve envisioned login as a query against the users collection:</p><pre><code>GET https://api.example.com/users?usr=username&amp;psw=1234
</code></pre><p>The server will respond with a filtered list of a single user.</p><p>But I don&#39;t like passing the password in the query string. It does not look OK to me. <strong>The connection will be made using HTTPS</strong>, but there&#39;s an additional step of having to URL-encode all odd characters, and decode them in the server, which we wont have in a POST. And also URLs are more frequently logged than payloads.</p><p>I could also get the password in the server response:</p><pre><code>GET https://api.example.com/users?usr=username
</code></pre><p>The returned JSON object would contain all the fields for the user (id, password, etc), so I could check the password in the client.</p><p>Which one is better? Any alternative?</p><h2>Token generation</h2><p>A registered user is able to generate temporary tokens. I&#39;m struggling trying to force tokens into being a resource. They are generated on the fly, and the operation is not idempotent, as each subsequent token request will return a different token. To make things worse, this operation is stateful: there will be a temporary table in the backend where tokens will be stored for a period of time. So what would be the REST version? It could be a PUT if the client were the one generating it, but it is the server.</p><p><strong>TL;DR</strong><br /> This is so difficult. If I succeed in creating a REST version of this API, the client code will be shorter and clearer, as we will be using well-known libraries that have been extensively tested. But honestly it looks almost impossible to force the stateful into stateless. Maybe I should just give up and provide a straightforward stateful API? How could I explain the extra time it would take to management? They will probably argue that nowadays everything is REST.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>First of all, let me say that I agree 100% with <a href="https://softwareengineering.stackexchange.com/users/76757/mvdd">@MvdD</a>, that a REST API should <em>not</em> include login/logout semantics.  However, as I&#39;m sure you&#39;ve heard/read OAuth is a headache you really don&#39;t want if you aren&#39;t &#34;required&#34; to have federated auth!</p><p>As other answers have pointed out, there is no one pattern to accomplish this, with several being accepted as answers in previous similar questions (mostly from SO).  I&#39;m also assuming you&#39;ve looked at <a href="https://stackoverflow.com/questions/13916620/rest-api-login-pattern">previous related questions</a> and such.  There is also <a href="https://stackoverflow.com/questions/319530/restful-authentication#7158864">this question (RESTful Authentication) on <em>SO</em></a>, which details 4 techniques (some more RESTful than others).  If you&#39;re (seemingly?) happy to transmit the password as cleartext in HTTPS then option #1 of that answer (HTTP basic auth) would work with pretty much any HTTP library your REST tools are wrapping.</p><hr/><h2>If you must...</h2><p>Since there&#39;s a bounty and all (and because it&#39;s an interesting challenge), I thought about it, and (after about 1.5 cups of coffee) have had the following idea: <code>POST</code> to a &#34;challenge&#34; resource, which then redirects to a <em>resource identifier</em> for <em>that</em> challenge, (and no this is not idempotent).</p><p><strong>What am I talking about?</strong></p><p>Well, as pointed out <a href="http://www.ics.uci.edu/~fielding/pubs/webarch_icse2000.pdf" rel="nofollow noreferrer">here</a> (Table 1, page 3), resource <em>identifiers</em> are different to <em>resources</em> themselves.  Ergo, you can RESTful-ly <code>POST</code> to one URI but be causing a change (<em>i.e.</em> RESTful change, such as CREATE, UPDATE) in a <strong>resource</strong> not necessarily located there.  Let me explain in action...</p><p><strong>Authentication Process</strong>:</p><ol><li>Client sends <code>POST /challenges</code> with payload of <code>username</code>.  This triggers the server to create necessary backend entry in DB table, allocate resources, etc.</li><li>Server responds with a <a href="https://en.wikipedia.org/wiki/HTTP_303" rel="nofollow noreferrer"><code>303 See Other</code></a> (which is just a <a href="https://www.rfc-editor.org/rfc/rfc2616" rel="nofollow noreferrer">newer</a> version of <a href="https://en.wikipedia.org/wiki/HTTP_302" rel="nofollow noreferrer"><code>302 Moved temporarily</code></a>), directing client to <code>/challenges/&lt;some random request code&gt;</code>.</li><li>Client <code>GET</code>&#39;s <code>/challenges/&lt;some random request code&gt;</code> (Note, <strong>will</strong> be GET, as <code>303</code> is used instead of <code>302</code>).  Which returns (with a <code>200 OK</code>) a JSON-encoded <em>challenge</em> (more on this later).</li><li>Client responds to challenge, this time with <code>POST</code> to <code>/challenges/&lt;some random request code&gt;</code> with a hash meeting the challenge as payload.</li><li>Server responds with either <code>403 Forbidden</code> (if challenge <em>failed</em>, ergo, wrong password, etc) or a <code>200 OK</code> (optionally with a JSON payload containing your session info or user profile or what-have-you).</li></ol><p><strong>A word on Challenges</strong>: (As promised in step #3)</p><p>The <em>challenge</em> given by the server is basically just some task (usually hashing, but possibly a two-way encryption/decryption, etc) given by the server to the client.  The server knows (computes) the result (hence why hashes are good, since they&#39;re cheap) ahead of time, and compares that with the challenge-responce given by the client.</p><p>This can be as simple as some random text (or even static text, like your application name, etc) sent to the client in plaintext (or hash, not important) with the server having worked out the <em>hash</em> of that text (essentially a <em>salt</em>) concatenated with the (hashed, since it&#39;s in the DB - and we don&#39;t store plaintext passwords in databases) password.
If the client can concatenate this salt with the password (after hashing the password locally) and then hash that concatenation, it can <em>answer</em> the challenge.</p><p>Example:</p><ul><li>server: salt = md5(&#34;MaryHadALittleLamb&#34;) -&gt; <code>8c20828418ca489f5b949f25f35abaa0</code> (sends to client in step #3).</li><li>client: hashes the password &#34;<code>password</code>&#34; (<em>&#39;username&#39; is a notoriously insecure password selector</em>) to produce <code>5f4dcc3b5aa765d61d8327deb882cf99</code>, this is then concatenated with <code>8c20828418ca489f5b949f25f35abaa0</code> to produce &#34;<code>5f4dcc3b5aa765d61d8327deb882cf998c20828418ca489f5b949f25f35abaa0</code>&#34;.</li><li>client: hashes this <code>md5(&#34;5f4dcc3b5aa765d61d8327deb882cf998c20828418ca489f5b949f25f35abaa0&#34;)</code> -&gt; <code>09f3bb66a44153c4053857d4b57fdf3b</code> and sends to server (step #4).</li><li>server: (having already done the above itself) compares <code>09f3bb66a44153c4053857d4b57fdf3b</code> with it&#39;s own result, and (if they match) allows username to login (or begin a session, etc).</li></ul><p><em>Note</em>: This is a fairly naive way to implement challenges, as there&#39;s no temporal component of the salt it&#39;s vulnerable to replay attacks, etc.  But you can ask more about that on Security.SO if need be.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-designing-authentication-for-rest-api/'>Rest &#8211; Designing authentication for REST API</a></li><li class="list-group-item"><a href='../rest-how-should-an-api-use-http-basic-authentication/'>Rest &#8211; How should an API use http basic authentication</a></li><li class="list-group-item"><a href='../rest-is-it-an-implementation-of-a-stateful-mechanism-for-rest-api-authentication/'>Rest &#8211; Is it an implementation of a stateful mechanism for Rest API authentication</a></li><li class="list-group-item"><a href='../rest-decoupling-server-and-client-using-rest-api/'>Rest &#8211; Decoupling Server and Client using REST API</a></li><li class="list-group-item"><a href='../rest-api-security-stored-token-vs-jwt-vs-oauth/'>REST API security Stored token vs JWT vs OAuth</a></li><li class="list-group-item"><a href='../rest-api-oauth-2-which-grant-type-to-use/'>REST API Oauth 2 &#8211; Which grant type to use</a></li><li class="list-group-item"><a href='../rest-token-based-authentication-using-access-and-refresh-tokens/'>Rest &#8211; Token-based authentication using access and refresh tokens</a></li><li class="list-group-item"><a href='../rest-stateful-authentication-in-rest-api-using-tokens/'>Rest &#8211; Stateful authentication in REST API using tokens</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>