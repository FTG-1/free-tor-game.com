<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; Best Creational Pattern for loggers in a multi-threaded system &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076778 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076778" class="post-1076778 software type-software status-publish hentry category-software tag-c tag-design-patterns tag-logging tag-multithreading"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; Best Creational Pattern for loggers in a multi-threaded system</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">logging</span><span class="mr-2 badge badge-primary">multithreading</span></p><div class="entry-content"><p>This is a follow up question on my past questions :<br /> <a href="https://softwareengineering.stackexchange.com/q/168486/39294">Concurrency pattern of logger in multithreaded application</a></p><p>As suggested by others, I am putting this question separately.</p><p>As the learning from the last question. In a multi-threaded environment, the logger should be made thread safe and probably asynchronous (where in messages are queued while a background thread does writing releasing the requesting object thread). The logger could be signleton or it can be a per-group logger which is a generalization of the above.</p><p>Now, the question that arise is how does logger should be assigned to the object? There are two options I can think of:</p><p><strong>1. Object requesting for the logger:</strong></p><p>Should each of the object call some global API such as <code>get_logger()</code>? Such an API returns &#34;the&#34; singleton or the group logger. However, I feel this involves assumption about the Application environment to implement the logger -which I think is some kind of coupling. If the same object needs to be used by other application &#8211; this new application also need to implement such a method.</p><p><strong>2. Assign logger through some known API</strong><br /> The other alternative approach is to create a kind of virtual class which is implemented by application based on App&#39;s own structure and assign the object sometime in the constructor.</p><p>This is more generalized method. Unfortunately, when there are so many objects &#8211; and rather a tree of objects passing on the logger objects to each level is quite messy.</p><blockquote><p>My question is there a better way to do this? If you need to pick any<br /> one of the above, which approach is would you pick and why?</p></blockquote><p>Other questions remain open about how to configure them:</p><ol><li><p>How do objects&#39; names or ID are assigned so that will be used for printing on the log messages (as the module names)</p></li><li><p>How do these objects find the appropriate properties (such as log levels, and other such parameters)</p></li></ol><p>In the first approach, the central API needs to deal with all this varieties.<br /> In the second approach &#8211; there needs to be additional work.</p><p>Hence, I want to understand from the real experience of people, as to how to write logger effectively in such an environment.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This is not an easy question to answer succinctly.</p><p>First, the approach you choose depends on your very specific goals and constraints.  To what degree will you log object messages or activities?  And is logging an intrinsic activity (something that is a key, integral responsibility of the objects, or is it a secondary, really nice to have, book-keeping activity)?</p><p>There are situations where logging is intrinsic, and pervasive, but often it is a secondary concern (a book-keeping activity).  This suggests that you do not want to strongly couple the logger to each object that you are tracking.</p><p>One approach to consider is something along the lines of an application global message queue, or enterprise service bus.  Something that is closer to the first alternative rather than the second alternative you suggested.</p><p>Each object that you are interested in tracking with a logger would produce object or activity specific messages that each implement a common message interface that supports the common properties you are interested in each object recording in the log for identification.  In each object or activity specific message, define and add the specific details to that message structure.  Finally, send the message to the application&#39;s message listener queue.  If acknowledgement of receipt is required, give it to the sender, so it may continue.  Generally in a closed, single-host system, explicit acknowledgement of message receipt is not required.</p><p>In the application scoped message processor (globally available within your application), you would &#39;register&#39; message handlers.  This could be done &#39;lazily&#39;, as needed, or pre-emptively at start up, as part of &#39;bootstrapping&#39;.  Perhaps it would include a generic handler that works on any message that it receives.  It may have a handler for that common logger message.  It may also have a handler for several or all specific logger messages, if other activities need to occur in conjunction with that message.  In any regard, the message processor would successively dequeue messages, handle messages with the registered message handlers, appropriately discard them, and then grab the next message.</p><p>Part of the implication of an application scoped message processor in a multi-threaded application is that the only guarantee to message order is that the order the message enters the message queue will play a large role in the order that it appears in a particular log.</p><p>There are strategies for making message order more deterministic, but none will be perfect in all cases.  One way is to add a global message sequencer, and &#39;get_next&#39; from the sequencer when crafting each and every message, then insert into an indexed queue, and wait to dequeue until the next message in the sequence arrives.  This too has implications, most notably lost or discarded messages blocking the message queue.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-uml-diagrams-of-multi-threaded-applications/'>Architecture &#8211; UML Diagrams of Multi-Threaded Applications</a></li><li class="list-group-item"><a href='../c-pattern-for-accessing-mysql-connection/'>C++ &#8211; Pattern for Accessing MySQL connection</a></li><li class="list-group-item"><a href='../java-should-i-build-a-multi-threaded-system-that-handles-events-from-a-game-and-sorts-them-independently-into-different-threads-based-on-priority/'>Java &#8211; Should I build a multi-threaded system that handles events from a game and sorts them, independently, into different threads based on priority</a></li><li class="list-group-item"><a href='../concurrency-pattern-of-logger-in-multithreaded-application/'>Concurrency pattern of logger in multithreaded application</a></li><li class="list-group-item"><a href='../forcing-logger-appender-to-output-line-logged-at-lower-than-its-current-level/'>Forcing logger/appender to output line logged at lower than its current level</a></li><li class="list-group-item"><a href='../java-logging-in-a-latency-sensitive-system/'>Java &#8211; Logging in a latency sensitive system</a></li><li class="list-group-item"><a href='../c-logging-paradigms-di-ioc-object-hierarchies/'>C# &#8211; Logging paradigms, DI/IoC, object hierarchies</a></li><li class="list-group-item"><a href='../php-best-way-to-access-a-logger-across-an-application-website-in-php/'>Php &#8211; Best way to access a logger across an application/website in PHP</a></li><li class="list-group-item"><a href='../java-best-practice-for-exception-handling-in-java-threads/'>Java &#8211; Best practice for exception handling in Java threads</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>