<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Architecture &#8211; Designing a multi-tenant single page application for the web &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076997 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076997" class="post-1076997 software type-software status-publish hentry category-software tag-architecture tag-multitenancy tag-typescript tag-web-api"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Architecture &#8211; Designing a multi-tenant single page application for the web</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">multitenancy</span><span class="mr-2 badge badge-warning">typescript</span><span class="mr-2 badge badge-primary">web-api</span></p><div class="entry-content"><p>I&#39;m looking at designing a multi-tenant application (well I believe it is multi-tenant). We have a single page application, an API and common database.</p><p>We have groups of users, each with their own slightly different requirements. A user cannot be in more than one group <em>at the moment</em>.</p><p>The <strong>key features</strong> we have are:</p><ul><li>Searching: Search fields varying per group of users</li><li>Grid: Columns varying per group of users</li><li>Details panel: Varying fields to show for the result</li></ul><p>There are some common properties in each key feature above, but some are completely unique to each group.</p><p>I have two main considerations here:</p><ol><li>Handling the UI views per user group</li><li>Posting and serving back to the front-end an object with only the properties required.</li></ol><p>We are using TypeScript + Angular 1 for the front end, and .NET Web API for the backend.</p><p>I want to avoid:</p><ul><li>God objects that contain all the properties for all groups going back and forth over the wire.</li><li>Lots of <strong>if statements</strong> littered in the front-end code to show and hide based on the user group.</li></ul><p>With this in mind, the current design I am considering is as follows:</p><ul><li>Load different views per group at load-time of the front-end application</li><li>Bind different controllers depending on the view</li><li>Currently, this means the bundle of JS for all groups will be served to the client</li><li>This means we can have specific endpoints for the same operation, taking in specific request objects and returning specific objects.</li><li>From a folder structure perspective, separate by code feature, then group if it differs.</li></ul><p>The <strong>advantages</strong> of this are:</p><ul><li>Code specific to a group is easy to reason when it differs</li><li>Posting and receiving only what is relevant to the user.</li><li>If a user belongs to multiple groups, we can provide them a functionality to switch between the mini-applications by changing the active group they are in.</li></ul><p>The <strong>disadvantages</strong> of this are:</p><ul><li>A lot more plumbing on loading the views and controllers dependant on the group the logged in user falls into.</li><li>Serving all the front-end application code for all groups up front</li><li>Handling deep linking/routing for a group when a user belongs to multiple groups. I suppose this can be handled via querystring param. üôÅ</li></ul><p>Thoughts?</p><h2>Update 27/07/2017</h2><p>So using a made-up example:</p><p>The search criteria varies by having different fields per group.</p><ul><li><code>Group a: Name, Age, DOB, Car type, Car engine size</code></li><li><code>Group b: Name, Age, Shoe size, shirt size, favourite colour</code></li></ul><p>Extrapolating this, we have 8 groups, each having 10 common properties and 5 group specific properties. My conundrum is as follows:</p><p>If I go with a single search endpoint with a request object encapsulating all the properties for all groups. That&#39;s 50 properties (10 common + 5*8 group specific properties).</p><p>For any given group only 15 are relevant. I need to make the server-side code to use only the 15 appropriate ones and exclude the other 35.</p><p>Further more, the same occurs on the response. I will receive a large object, of which only a small subset contains data pertinent to the user in that group, the rest being null. I will have to place a fair amount of conditional statements to handle showing and hiding these things on the front-end side.</p><p>This is probably not considered multi-tenant, but I&#39;m trying seek advice on a good design for this type of problem.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You&#39;ve given scant details on your user base, but it sounds like you do not have a multi-tenant requirement.  There are also few details into how your views differ between each other.  On instinct, I would guess that you do not have mutli-tenant, but in fact have multiple groups.  I would also guess that you are leaning towards a solution which will cause you to be angry with yourself later on.  More specifically, separate implementations of each of the search view, grid view, and detail view.</p><p>I believe you should use standard user authentication via keystone, or keycloak, or another third party.  Take advantage of their users / groups / roles to assign a hierarchy of permissions.  Something like USER_BASIC_PERM would grant them access to an object&#39;s ID, Name, and Category.  USER_CASH_PERM would grant then access to cost, value, profit margin.  USER_ADMIN_PERM would let them see fields relating to 3rd party buyer, url to PO, etc.  You can use groups to put mutliple role permissions together and manage users more easily with a single group.</p><p>Then you can build your three views by including / excluding sub-views based on the user&#39;s permissions.  When they submit a search, you must validate their fields based on their roles server-side.  When returning details, you must put it through a permission filter before returning it to the client.  In the long run, this will be easier to maintain than implementing separate views for each of your tenants.</p><p>I think that if you consider that it&#39;s only permissions of a user that are the difference, then you&#39;ll see that the major functionality should be self-contained.  &#39;search&#39; would be one server-side module. Grid data access would be another.  Keeping similar functionality together on the server-side will lead towards less repetition. Separating server-side by group would mean that you need to visit 3 separate modules to fix one bug that spans all of your &#39;grid&#39; queries.</p><p>Think about long term - if you add 5 more tenants that are very close to the three you know about, which one will cause less pain to implement later.</p><p>Let&#39;s say you add a fourth view. Do you want to add it once with permission checks, or once for each of your now 8 tenants - even if most of them share the exact same view?</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/how-to-handle-db-authentication-in-multi-tenant-application-with-separate-databases/'>How to handle db authentication in multi tenant application with separate databases</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/how-to-handle-common-data-in-multi-tenant-applications/'>How to handle common data in multi-tenant applications</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>