<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Cleanest way to report errors in Haskell &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075791 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075791" class="post-1075791 software type-software status-publish hentry category-software tag-error-handling tag-haskell"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Cleanest way to report errors in Haskell</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">error handling</span><span class="mr-2 badge badge-info">haskell</span></p><div class="entry-content"><p>I&#39;m working on learning Haskell, and I&#39;ve come across three different ways of dealing with errors in functions I write:</p><ol><li>I can simply write <code>error &#34;Some error message.&#34;</code>, which throws an exception.</li><li>I can have my function return <code>Maybe SomeType</code>, where I may or may not be able to return what I&#39;d like to return.</li><li>I can have my function return <code>Either String SomeType</code>, where I can return either an error message or what I was asked to return in the first place.</li></ol><p>My question is: <strong>Which method of dealing with errors should I use, and why?</strong> Maybe I should different methods, depending on the context?</p><p>My current understanding is:</p><ul><li>It&#39;s &#34;difficult&#34; to deal with exceptions in purely functional code, and in Haskell one wants to keep things as purely functional as possible.</li><li>Returning <code>Maybe SomeType</code> is the proper thing to do if the function will either fail or succeed (i.e., there aren&#39;t different <em>ways it can fail</em>).</li><li>Returning <code>Either String SomeType</code> is the proper thing to do if a function can fail in any one of various ways.</li></ul></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Alright, first rule of error handling in Haskell: <strong>Never use <code>error</code></strong>.</p><p>It&#39;s just terrible in every way. It exists purely as an act of history and the fact that Prelude uses it is terrible. Don&#39;t use it.</p><p>The only conceivable time you could use it is when something is so internally terrible that something must be wrong with the very fabric of reality, thus rendering the outcome of your program moot.</p><p>Now the question becomes <code>Maybe</code> vs <code>Either</code>. <code>Maybe</code> is nicely suited to something like <code>head</code>, which may or may not return a value but there is only one possible reason to fail. <code>Nothing</code> is saying something like &#34;it broke, and you already know why&#34;. Some would say it indicates a partial function.</p><p>The most robust form of error handling is <code>Either</code> + an error ADT.</p><p>For example in one of my hobby compilers, I have something like</p><pre><code>data CompilerError = ParserError ParserError
                   | TCError TCError
                   ...
                   | ImpossibleError String

data ParserError = ParserError (Int, Int) String
data TCError = CouldntUnify Ty Ty
             | MissingDefinition Name
             | InfiniteType Ty
             ...

type ErrorM m = ExceptT CompilerError m -- from MTL
</code></pre><p>Now I define a bunch of error types, nesting them so that I have one glorious top level error. This can be an error from any stage of compilation or an <code>ImpossibleError</code>, which signifies a compiler bug.</p><p>Each of these error types try to keep as much information for as long as possible for pretty printing or other analysis. More importantly, by not having a string I can test that running an illtyped program through the type checker actually generates a unification error! Once something is a <code>String</code>, it&#39;s gone forever and any information it contained is opaque to the compiler/tests, so just <code>Either String</code> isn&#39;t great either.</p><p>Finally I pack this type into <code>ExceptT</code>, a new monad transformer from MTL. This is essentially <code>EitherT</code> and comes with a nice batch of functions for throwing and catching errors in a pure, pleasant way.</p><p>Finally, it&#39;s worth mentioning that Haskell has the mechanisms to support handling exceptions like other languages do, except that catching an exception lives in <code>IO</code>. I know some people like to use these for <code>IO</code> heavy applications where everything could potentially fail, but so infrequently that they don&#39;t like to think about it. Whether you use these impure exceptions or just <code>ExceptT Error IO</code> is really a matter of taste. Personally I opt for <code>ExceptT</code> because I like being reminded of the chance of failure.</p><hr/><p>As a summary,</p><ul><li><code>Maybe</code> - I can fail in one obvious way</li><li><code>Either CustomType</code> - I can fail, and I&#39;ll tell you what happened</li><li><code>IO</code> + exceptions - I sometimes fail. Check my docs to see what I throw when I do</li><li><code>error</code> - I hate you too user</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../is-return-type-only-polymorphism-in-haskell-a-good-thing/'>Is return-type-(only)-polymorphism in Haskell a good thing</a></li><li class="list-group-item"><a href='../haskell-idiom-for-trying-several-functions-and-stop-as-soon-as-one-succeeds/'>Haskell idiom for trying several functions and stop as soon as one succeeds</a></li><li class="list-group-item"><a href='../python-functional-style-exception-handling/'>Python &#8211; Functional style exception handling</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>