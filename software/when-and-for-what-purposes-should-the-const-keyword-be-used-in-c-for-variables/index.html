<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>When and for what purposes should the const keyword be used in C for variables &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1063445 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1063445" class="post-1063445 software type-software status-publish hentry category-software tag-c tag-const tag-patterns-and-practices tag-readability"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">When and for what purposes should the const keyword be used in C for variables</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">const</span><span class="mr-2 badge badge-warning">patterns-and-practices</span><span class="mr-2 badge badge-primary">readability</span></p><div class="entry-content"><p>While getting <a href="https://codereview.stackexchange.com/questions/28285/binary-search-in-c-optimization">my code reviewed here</a> the issue of using the <code>const</code> keyword came up. I understand that it is used for implementing read-only behaviour on variables.</p><p>I am confused about what are the various situations when it can be useful.</p><ul><li>Should it be used for the sake of clarity in function prototypes?</li><li>Should it be used as a security measure during code development?</li><li>Should it be used in the scope of various functions for declaring run-time constants?</li><li>Should it be used at all?</li></ul><p>These question are just examples of the confusion that I am facing. The general confusion is</p><ul><li>When should be the <code>const</code> keyword used in C programming?</li><li>What are the various types of benefits that can be gained by using this keyword in C?</li><li>Are there any cons of using <code>const</code> keyword?</li></ul><hr/><p>It has been pointed that this question may be too broad due to all these questions in the detail of my question. I just wanted to clarify that these questions are just to clarify the confusion regarding the main question.</p><blockquote><p>When and for what purposes should the const keyword be used in C for variables?</p></blockquote><p>It can also be rephrased as</p><blockquote><p>The proper use of <code>const</code> keyword in C` with the pros and cons of the same.</p></blockquote></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>When reviewing code, I apply the following rules:</p><ul><li><p>Always use <code>const</code> for function parameters passed by reference where the
function does not modify (or free) the data pointed to.</p><pre><code>int find(const int *data, size_t size, int value);
</code></pre></li><li><p>Always use <code>const</code> for constants that might otherwise be defined using a #define or an enum.  The compiler can locate the data in read-only memory (ROM) as a result (although the linker is often a better tool for this purpose in embedded systems).</p><pre><code>const double PI = 3.14;
</code></pre></li><li><p>Never use const in a function <strong>prototype</strong> for a parameter passed by <strong>value</strong>.  It has no meaning and is hence just &#39;noise&#39;.</p><pre><code>// don&#39;t add const to &#39;value&#39; or &#39;size&#39;
int find(const int *data, size_t size, int value); 
</code></pre></li><li><p>Where appropriate, use <code>const volatile</code> on locations that cannot be changed by the program but might still change.  Hardware registers are the typical use case here, for example a status register that reflects a device state:</p><pre><code>const volatile int32_t *DEVICE_STATUS =  (int32_t*) 0x100;
</code></pre></li></ul><hr/><p>Other uses are optional.  For example, the parameters to a function within the function <strong>implementation</strong> can be marked as const.</p><pre><code>// &#39;value&#39; and &#39;size can be marked as const here
int find(const int *data, const size_t size, const int value)  
{
     ... etc
</code></pre><p>or function return values or calculations that are obtained and then never change:</p><pre><code>char *repeat_str(const char *str, size_t n) 
{
    const size_t len = strlen(str);
    const size_t buf_size = 1 + (len * n);
    char *buf = malloc(buf_size);
    ...
</code></pre><p>These uses of <code>const</code> just indicate that you will not change the variable; they don&#39;t change how or where the variable is stored. The compiler can of course work out that a variable is not changed, but by adding <code>const</code> you allow it to enforce that.  This can help the reader and add some safety (although if your functions are big or
complicated enough that this makes a great difference, you arguably have other
problems). <em>Edit - eg. a 200-line densely coded function with nested loops and many long
or similar variable names, knowing that certain variables never change might
ease understaning significantly.  Such functions have been badly designed or
maintened.</em></p><hr/><p>Problems with <code>const</code>.  You will probably hear the term &#34;const poisoning&#34;.
This occurs when adding <code>const</code> to a function parameter causes &#39;constness&#39; to
propagate.</p><p><em>Edit - const poisoning: for example in the function:</em></p><pre><code>int function_a(char * str, int n)
{
    ...
    function_b(str);
    ...
}
</code></pre><p><em>if we change <code>str</code> to <code>const</code>, we must then ensure that <code>fuction_b</code> also takes
a <code>const</code>.  And so on if <code>function_b</code> passes the <code>str</code> on to <code>function_c</code>,
etc.  As you can imagine this could be painful if it propagates into many
separate files/modules.  If it propagates into a function that cannot be
changed (eg a system library), then a cast becomes necessary.  So sprinkling <code>const</code> around in existing code is perhaps asking for trouble.  In new code
though, it is best to <code>const</code> qualify consistently where appropriate.</em></p><p>The more insidious problem of <code>const</code> is that it was not in the original
language. As an add-on it doesn&#39;t quite fit.  For a start it has two meanings
(as in the rules above, meaning &#34;I&#39;m not going to change this&#34; and &#34;this cannot be modified&#34;).  But more than that, it can be dangerous. For example, compile and
run this code and (depending upon the compiler/options) it may well crash when
run:</p><pre><code>const char str[] = &#34;hello world\n&#34;;
char *s = strchr(str, &#39;\n&#39;);
*s = &#39;\0&#39;;
</code></pre><p><code>strchr</code> returns a <code>char*</code> not a <code>const char*</code>.  As its call parameter is <code>const</code> it must <strong>cast</strong> the call parameter to <code>char*</code>.  And in this case that
casts away the real read-only storage property. <em>Edit: - this applies generally to vars in read-only memory. By &#39;ROM&#39;, I mean not just physical ROM but any memory that is write-protected, as happens to the code section of programs run on a typical OS.</em></p><p>Many standard library functions behave in the same way, so beware: when you
have <strong>real</strong> constants (ie. stored in ROM) you must be very careful not to
lose their constness.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-passing-parameters-that-need-to-be-copied-by-value-or-const-reference/'>C++ &#8211; Passing parameters that need to be copied by value or const reference</a></li><li class="list-group-item"><a href='../what-are-the-benefits-of-a-device-driver-when-i-can-access-the-i-o-registers-directly/'>What are the benefits of a device driver when I can access the I/O registers directly</a></li><li class="list-group-item"><a href='../c-const-and-non-const-methods-and-possible-mutable-data-member/'>C++ &#8211; Const and non-const methods, and possible mutable data member</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>