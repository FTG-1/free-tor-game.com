<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; MVVM best practices with WPF client and WCF duplex service &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074615 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074615" class="post-1074615 software type-software status-publish hentry category-software tag-design tag-design-patterns tag-mvvm tag-wcf tag-wpf"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; MVVM best practices with WPF client and WCF duplex service</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">mvvm</span><span class="mr-2 badge badge-primary">wcf</span><span class="mr-2 badge badge-danger">wpf</span></p><div class="entry-content"><p>I&#39;ve been thinking about how to design my WPF application, which receives data from a WCF duplex service, but I&#39;m afraid of over engineering.</p><p>I thought about abstracting away the WCF communication completely from the WPF client by creating a &#34;proxy client&#34; library that implements the service and callback interfaces internally.</p><p>This way I don&#39;t have to create the callback class in the WPF application, but subscribe to events in the proxy client that are invoked when the callback methods in it are called by the service. This would allow me to also hide the service reference from WPF.</p><p>Then in WPF, all I will do is:</p><pre><code>var client = new ApiClient(); //This is the client library
var stuff = client.GetStuff(); //Some service method
client.StuffDeleted += OnStuffDeleted; //Event that is invoked by library on callback
</code></pre><p>I would probably instantiate the client only once as a Singleton object for all ViewModels to call.</p><p>Then I thought I could take this further by creating &#34;Model&#34; classes that are almost identical to the WCF service reference generated classes (data contracts), adding another layer on top of the proxy client, and using automapper to create my models, then returning those to WPF instead of data contract classes.</p><p>I figured this way I would achieve complete separation from my WCF service, and having an extra layer would allow me to add metadata to my models before returning them, and then in the WPF side I will use these Models to construct the ViewModel which is meant for viewing/binding only.</p><p>Having such a client would also make it easier to centralize business logic, error handling, and make it simpler to do unit testing since the WCF client is a single independent component.</p><p>The problem is that I&#39;m afraid of over engineering this. The database has EF entities, the WCF service has its own DTO classes, then I would have Models, and then ViewModels. I&#39;ve also noticed that the generated classes from WCF implement the INotifyPropertyChanged interface, which makes me think they were intended to be used as models (or to send an updates to the service?).</p><p>I&#39;ll try to summarize my main questions in bullet points:</p><ul><li>In M-V-VM, is it good practice to use the service reference genereated classes as Models?</li><li>Is there much benefit in completely abstracting away WCF from WPF with a proxy client?<ul><li>Callback methods would invoke events that WPF is subscribed to</li></ul></li><li>Why do the generated service reference classes implement INotifyPropertyChanged?</li></ul><p>Is this design overkill?</p><p>Thank you very much.</p><p><strong>UPDATE:</strong></p><p>Visualisation of what I&#39;m trying to do:</p><p><a href="../../../i.stack.imgur.com/JYsJb.png" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/JYsJb.png" alt="enter image description here"/></a></p><p>As can be seen, the Proxy client in the middle has 2 layers (classes):</p><p>The first class is what WPF instantiates as a Singleton and uses to get back model classes.</p><p>The second class is a wrapper around the Service Reference client, and is called by the first layer. This is purely for data access purposes.</p><p>I have not added the callback methods which will be events that WPF subscribes to.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I had a situation like this in the past, and we ended up creating a separate WPF Model layer for the application.</p><p>I&#39;m not sure how much has changed since then, however our reasons for it were :</p><ul><li><p>We wanted read-only properties in the application, and the DTOs generated by the DataContracts had to be read/write</p></li><li><p>Some classes were very large, but the UI model only needed a much smaller section of the data.</p></li><li><p>Some properties on the UI layer had custom logic. For example, we wanted to keep the db property as an int of 123, however for UI purposes we wanted a string of &#34;000123&#34;</p></li><li><p>We wanted to keep the possibility open in the future that we might change the technology stack of a layer, such as replace WCF or EF layer with some other alternate. By separating them out, we would only have to rewrite one layer instead of everything in the application.</p></li><li><p>We wanted to add an Encryption layer to some data, so data would be encrypted at rest or for transfer... I don&#39;t recall much about this requirement, but it did factor into our decision.</p></li></ul><p>Our end result was :</p><ul><li><p>Project for WPF Models that only creates the UI Models used by the application, using the correct properties, data types, and scope that the UI requires.</p></li><li><p>Project for Data Access Layer, which would take care of converting WPF models to DTO or EF models for transfer to database layer. We actually used AutoMapper for this too.</p></li><li><p>The actual WCF project, with auto-generated classes from WCF</p></li><li><p>The actual EF project, with auto-generated EF models and procedures</p></li></ul><p>If I remember correctly, from the WPF application layer, we would do something like :</p><pre><code>ISomeService service = DAL.SomeService();
ISomeModel stuff = service.GetStuff();
</code></pre><p>The DAL would return a service class that met some interface. If we ever wanted to replace the service layer with something else, we could without impacting the rest of the WPF application.</p><p>In addition, <code>ISomeModel</code> could implement items specific to the WPF application itself, such as custom logic or events. It didn&#39;t have to be tied to the data object we send/receive to the database.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-silverlight-5-and-mvvm-do-i-really-need-other-frameworks-what-is-the-best-way-for-rapid-development/'>Architecture &#8211; Silverlight 5 and MVVM. Do I really need other frameworks? What is the best way for rapid development</a></li><li class="list-group-item"><a href='../c-mvvm-reporting-app-approach-data-access-layer/'>C# &#8211; MVVM Reporting App Approach ? Data Access Layer</a></li><li class="list-group-item"><a href='../mvc-jquery-json-net-service-layer-to-wcf-or-not-to-wcf/'>Mvc &#8211; JQuery / JSON + .Net Service Layer &#8211; to WCF or Not to WCF</a></li><li class="list-group-item"><a href='../c-clients-with-multiple-proxy-and-multithreading-callbacks/'>C# &#8211; Clients with multiple proxy and multithreading callbacks</a></li><li class="list-group-item"><a href='../how-to-structure-an-application-that-combines-wcf-and-wpf/'>How to structure an application that combines WCF and WPF</a></li><li class="list-group-item"><a href='../architecture-mvvm-and-service-pattern/'>Architecture &#8211; MVVM and service pattern</a></li><li class="list-group-item"><a href='../mvc-advice-on-architecture-wcf-mvc/'>Mvc &#8211; Advice on architecture (WCF / MVC)</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>