<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Mvc &#8211; In MVC + SOA Architecture, What is the Rationale for Placing Business Logic in Models &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087439 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087439" class="post-1087439 software type-software status-publish hentry category-software tag-asp-net tag-business-logic tag-design tag-mvc tag-soa"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Mvc &#8211; In MVC + SOA Architecture, What is the Rationale for Placing Business Logic in Models</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asp.net</span><span class="mr-2 badge badge-info">business-logic</span><span class="mr-2 badge badge-warning">design</span><span class="mr-2 badge badge-primary">mvc</span><span class="mr-2 badge badge-danger">soa</span></p><div class="entry-content"><p>When writing web applications I place business logic in controllers.  This has worked well for my small App Dev team- our applications run reliably, perform well, and the code is easy to maintain.  See below for an explanation of my design.</p><p>Contrary to my architecture, the advice I find in programming forums usually advocates for placing business logic in models.  I&#39;d like to understand <em>why</em>.</p><blockquote><p>Based on your experience building MVC + SOA applications, why would<br /> you caution against placing logic in controllers and advocate for<br /> placing logic in models?  What is your rationale and what is the pro /<br /> con tradeoff compared to my design?</p></blockquote><p>I admit my design is influenced by my use of <a href="https://github.com/reactiveui/refit" rel="nofollow noreferrer">Refit</a>, a type-safe REST proxy for C#.  One of the reasons I don&#39;t want to place business logic in a model (or entity) is because I define service interfaces and entities in a Contract DLL that is shared by the service (WebAPI) and clients (MVC websites or console applications).  I don&#39;t want data-persistence details leaked to the client (via Load, Save, Approve, Reject, etc methods on the entity).</p><p>Another influence comes from my desire to resolve the contradiction in these familiar design principles:</p><ul><li>Entities should be persistence-agnostic.  That is, they should be unaware of how they&#39;re saved to a database or Content Management System (CMS).</li><li>In MVC, place business logic in the model.</li></ul><p>If &#34;business logic&#34; includes SQL or CMS statements, the principles are contradictory.  If &#34;business logic&#34; does not include SQL or CMS statements, this implies introducing yet another layer- the Data Transfer Object (DTO).  Oh God, not another layer.</p><p>Also, I feel inertia from the last popular paradigm is causing Object-Oriented (OO) design (where the object is everything) to creep into our MVC + SOA world.  Hence the advice to place business logic in the model (the object).</p><p>OK, enough introduction.  Here&#39;s my MVC + SOA architecture (for a Microsoft stack):</p><h2>MVC + SOA Design</h2><p>MVC = Model View Controller, SOA = Service Oriented Architecture</p><ul><li>A model transfers data and UI (validation rules, picklist choices,<br /> etc) between a controller and a view.</li><li>A view receives a model and renders HTML using Razor syntax.</li><li>A controller receives a model (via ASP.NET model binding) and runs business logic, either locally (2-tier architecture) or externally (3-tier architecture).<ul><li>If locally, controller communicates directly with a data store(s)<br /> (database or file).</li><li>If externally, controller communicates with an<br /> external service(s) using Refit proxy (and the service communicates<br /> directly with a data store).</li></ul></li><li>Minimize business logic in views and models.  A view should be thin, hence the name &#34;Razor&#34;.</li><li>Maximize business logic in controllers.</li><li>Note the difference between SOA and OO.<ul><li>SOA emphasizes encapsulating logic in service controllers, separate from data.<ul><li>Exposed via HTTP / JSON / Refit interfaces.</li><li>Models and entities are used for validation and data transfer.</li></ul></li><li>OO emphasizes encapsulating logic in objects, near the data.</li></ul></li></ul><p><strong>Business Entities</strong></p><ul><li>Similar to models, minimize business logic in entities.</li><li>Separate models from entities.<ul><li>A model transfers data and UI between a controller and a view (see above).</li><li>A model does <em>not</em> transfer data between a controller and a data store or service.<ul><li>This prevents <a href="https://andrewlock.net/preventing-mass-assignment-or-over-posting-in-asp-net-core/" rel="nofollow noreferrer">over-posting</a> (hacker adds additional form fields to override model&#39;s default values).</li><li>This facilitates multi-page, step-by-step forms with different fields required on each page.  Define a model for each page.  The union of all fields on all models = set of properties on entity.</li></ul></li><li>An entity transfers data between a controller and a data store or service.</li><li>An entity does not contain any UI (validation rules, picklist choices, etc).</li></ul></li><li>An entity may <em>not</em> reference a model.</li><li>A model may reference an entity.<ul><li>Constructor accepts entity parameter, maps entity properties to model properties.</li><li>ToEntity() method creates entity, maps model properties to entity properties.</li></ul></li><li>Dependencies flow in one direction:<ul><li>MVC Website &#8211;(depends on)&#8211;&gt; Entity</li><li>If local data store (2-tier architecture), MVC Website &#8211;(depends on)&#8211;&gt; ORM (such as <a href="https://github.com/StackExchange/Dapper" rel="nofollow noreferrer">Dapper</a> or <a href="https://docs.microsoft.com/en-us/ef/core/" rel="nofollow noreferrer">Entity Framework Core</a>)</li><li>If external data store (3-tier architecture), MVC Website &#8211;(depends on)&#8211;&gt; Refit Service Proxy</li></ul></li></ul><p><strong>Rationale</strong></p><ol><li>Prevention of over-posting attacks and flexibility of UI (present as complex form or split form across multiple pages) independent from entity.</li><li>Separation of concerns- models specify validation rules and transfer data to/from UI, entities transfer data to/from service, controllers sequence tasks and enforce business logic.</li><li>Change of backing services or data stores do not affect the model or view, only the controller.</li><li>The logic in service controllers is reusable- exposed via HTTP endpoints and callable from any client written in any language.</li><li>My use of Refit C# proxies in no way prevents AJAX.  In fact we do plenty of UI updates via jQuery calls to service controllers, secured by JWT tokens.</li></ol></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The Model-View-Controller pattern is a <strong>UI pattern</strong> that follows a few basic principles:</p><ol><li><p>The View is a User Interface, a thin veneer in front of the Controller.  The only logic that should be in the View (i.e. &#34;Code-Behind&#34;) is that logic which pertains directly to interacting with the user.</p></li><li><p>The Controller is a thin veneer in front of the Model.  It acts as a switch-yard, shunting requests from the View to the Model for processing.  The only logic that should be in the controller is logic that facilitates this communication.</p></li><li><p>The Model contains everything else about your application, including your Data Access layer (in your case Dapper or Entity Framework Code), your Repository Layer (which includes Entities and CRUD methods), and your <strong>Business Logic Layer.</strong></p></li></ol><p>The overall architecture so described looks something like this:</p><pre><code>Database --&gt; Data Access Layer --&gt; Repository --&gt; Business Layer --&gt; Controller --&gt; View
</code></pre><p>The arrows indicate the direction of the dependency knowledge; e.g. the View knows about the Controller, but not vice versa, and so on.</p><p>The Business Layer can be thought of as a CRUD/Business Transaction converter.  On the left side, it speaks Create, Read, Update and Delete, using entities from the Repository.  On the right side, it speaks business operations (things like &#34;Print an Invoice&#34; or &#34;Bill a Customer), using what I would call <strong>View Model</strong> objects.  These View Model objects are what the Controller uses to glue the UI to an underlying data representation.</p><p>Note in my example how the Business Layer has been abstracted from the Controller. <strong>This allows you to use different controllers with the same Business Layer.</strong></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../mvc-why-put-the-business-logic-in-the-model-what-happens-when-i-have-multiple-types-of-storage/'>Mvc &#8211; Why put the business logic in the model? What happens when I have multiple types of storage</a></li><li class="list-group-item"><a href='../mvc-business-logic-layer-in-mvc-application/'>Mvc &#8211; Business Logic Layer in MVC Application</a></li><li class="list-group-item"><a href='../mvc-design-pattern-to-combine-multiple-models-for-use/'>MVC Design Pattern to Combine Multiple Models for use</a></li><li class="list-group-item"><a href='../mvc-3-tier-architecture-in-game-what-is-the-business-layer/'>MVC &#038; 3 tier architecture in game &#8211; What is the business layer</a></li><li class="list-group-item"><a href='../mvc-entirely-separate-business-logic-layer-from-mvc/'>Mvc &#8211; Entirely separate business logic layer from MVC</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>