<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Workaround for Java checked exceptions &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064876 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064876" class="post-1064876 software type-software status-publish hentry category-software tag-exception-handling tag-exceptions tag-functional-programming tag-java tag-java8"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Workaround for Java checked exceptions</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">exception handling</span><span class="mr-2 badge badge-info">exceptions</span><span class="mr-2 badge badge-warning">functional programming</span><span class="mr-2 badge badge-primary">java</span><span class="mr-2 badge badge-danger">java8</span></p><div class="entry-content"><p>I appreciate a lot the new Java 8 features about lambdas and default methods interfaces. Yet, I still get bored with checked exceptions. For instance, if I just want to list all the visible fields of an object I would like to simply write this:</p><pre><code>    Arrays.asList(p.getClass().getFields()).forEach(
        f -&gt; System.out.println(f.get(p))
    );
</code></pre><p>Yet, since the <code>get</code> method might throw a checked exception, which does not agrees with the <code>Consumer</code> interface contract, then I must catch that exception and write the following code:</p><pre><code>    Arrays.asList(p.getClass().getFields()).forEach(
            f -&gt; {
                try {
                    System.out.println(f.get(p));
                } catch (IllegalArgumentException | IllegalAccessException ex) {
                    throw new RuntimeException(ex);
                }
            }
    );
</code></pre><p>However in most cases I just want the exception to be thrown as a <code>RuntimeException</code> and let the program handle, or not, the exception without compilation errors.</p><p>So, I would like to have your opinion about my controversial workaround for checked exceptions annoyance. To that end, I created an auxiliary interface <code>ConsumerCheckException&lt;T&gt;</code> and an utility function <code>rethrow</code> (<strong>updated according to the sugestion of <a href="https://softwareengineering.stackexchange.com/questions/225931/workaround-for-java-checked-exceptions?noredirect=1#comment450219_225931">Doval&#39;s comment</a></strong>) as follows:</p><pre><code>  @FunctionalInterface
  public interface ConsumerCheckException&lt;T&gt;{
      void accept(T elem) throws Exception;
  }

  public class Wrappers {
      public static &lt;T&gt; Consumer&lt;T&gt; rethrow(ConsumerCheckException&lt;T&gt; c) {
        return elem -&gt; {
          try {
            c.accept(elem);
          } catch (Exception ex) {
            /**
             * within sneakyThrow() we cast to the parameterized type T. 
             * In this case that type is RuntimeException. 
             * At runtime, however, the generic types have been erased, so 
             * that there is no T type anymore to cast to, so the cast
             * disappears.
             */
            Wrappers.&lt;RuntimeException&gt;sneakyThrow(ex);
          }
        };
      }

      /**
       * Reinier Zwitserloot who, as far as I know, had the first mention of this
       * technique in 2009 on the java posse mailing list.
       * http://www.mail-archive.com/javaposse@googlegroups.com/msg05984.html
       */
      public static &lt;T extends Throwable&gt; T sneakyThrow(Throwable t) {
          throw (T) t;
      }
  }
</code></pre><p>And now I can just write:</p><pre><code>    Arrays.asList(p.getClass().getFields()).forEach(
            rethrow(f -&gt; System.out.println(f.get(p)))
    );
</code></pre><p>I am not sure that this is the best idiom to turn around the checked exceptions, but as I explained, I would like to have a more convenient way of achieving my first example without dealing with checked exceptions and this is the simpler way that I found to do it.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p><strong>Advantages, disadvantages, and limitations of your technique:</strong></p><ul><li><p>If the calling-code is to handle the checked exception you MUST add it to the throws clause of the method that contains the stream.
The compiler will not force you to add it anymore, so it&#39;s easier to forget it. For example:</p><pre><code>public void test(Object p) throws IllegalAccessException {
    Arrays.asList(p.getClass().getFields()).forEach(rethrow(f -&gt; System.out.println(f.get(p))));
}
</code></pre></li><li><p>If the calling-code already handles the checked exception, the compiler WILL remind you to add the throws clause to the method declaration
that contains the stream (if you don&#39;t it will say: Exception is never thrown in body of corresponding try statement).</p></li><li><p>In any case, you won&#39;t be able to surround the stream itself to catch the checked exception INSIDE the method that contains the stream
(if you try, the compiler will say: Exception is never thrown in body of corresponding try statement).</p></li><li><p>If you are calling a method which literally can never throw the exception that it declares, then you should not include the throws clause.
For example: new String(byteArr, &#34;UTF-8&#34;) throws UnsupportedEncodingException, but UTF-8 is guaranteed by the Java spec to always be present.
Here, the throws declaration is a nuisance and any solution to silence it with minimal boilerplate is welcome.</p></li><li><p>If you hate checked exceptions and feel they should never be added to the Java language to begin with (a growing number of people think this way,
and I am NOT one of them), then just don&#39;t add the checked exception to the throws clause of the method that contains the stream. The checked
exception will, then, behave just like an UNchecked exception.</p></li><li><p>If you are implementing a strict interface where you don&#39;t have the option for adding a throws declaration, and yet throwing an exception is
entirely appropriate, then wrapping an exception just to gain the privilege of throwing it results in a stacktrace with spurious exceptions which
contribute no information about what actually went wrong. A good example is Runnable.run(), which does not throw any checked exceptions.
In this case, you may decide not to add the checked exception to the throws clause of the method that contains the stream.</p></li><li><p>In any case, if you decide NOT to add (or forget to add) the checked exception to the throws clause of the method that contains the stream,
be aware of these 2 consequences of throwing CHECKED exceptions:</p><ol><li><p>The calling-code won&#39;t be able to catch it by name (if you try, the compiler will say: Exception is never thrown in body of corresponding try
statement). It will bubble and probably be catched in the main program loop by some &#34;catch Exception&#34; or &#34;catch Throwable&#34;, which may be what you
want anyway.</p></li><li><p>It violates the principle of least surprise: it will no longer be enough to catch RuntimeException to be able to guarantee catching all
possible exceptions. For this reason, I believe this should not be done in framework code, but only in business code that you completely control.</p></li></ol></li></ul><h3>References:</h3><ul><li><a href="http://www.philandstuff.com/2012/04/28/sneakily-throwing-checked-exceptions.html" rel="nofollow noreferrer">http://www.philandstuff.com/2012/04/28/sneakily-throwing-checked-exceptions.html</a></li><li><a href="http://www.mail-archive.com/javaposse@googlegroups.com/msg05984.html" rel="nofollow noreferrer">http://www.mail-archive.com/javaposse@googlegroups.com/msg05984.html</a></li><li>Project Lombok annotation: @SneakyThrows</li><li>Brian Goetz opinion (against) here: <a href="https://stackoverflow.com/questions/27644361/how-can-i-throw-checked-exceptions-from-inside-java-8-streams">https://stackoverflow.com/questions/27644361/how-can-i-throw-checked-exceptions-from-inside-java-8-streams</a></li><li><a href="https://softwareengineering.stackexchange.com/questions/225931/workaround-for-java-checked-exceptions">Workaround for Java checked exceptions</a> *</li></ul><p><strong>NOTE:</strong> If you decide to use this technique, you may copy the <code>LambdaExceptionUtil</code> helper class from StackOverflow: <a href="https://stackoverflow.com/questions/27644361/how-can-i-throw-checked-exceptions-from-inside-java-8-streams">https://stackoverflow.com/questions/27644361/how-can-i-throw-checked-exceptions-from-inside-java-8-streams</a> . It gives you the complete implementation (Function, Consumer, Supplier...), with examples.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-better-way-to-define-an-exception-thrown-by-a-method-in-java/'>Java &#8211; better way to define an exception thrown by a method in Java</a></li><li class="list-group-item"><a href='../why-do-some-apis-simply-throw-exception/'>Why do some APIs simply throw Exception</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>