<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Php &#8211; I&#8217;ve unit tested the class, now how to get started with an integration test &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073525 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073525" class="post-1073525 software type-software status-publish hentry category-software tag-php tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Php &#8211; I&#8217;ve unit tested the class, now how to get started with an integration test</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">PHP</span><span class="mr-2 badge badge-info">unit testing</span></p><div class="entry-content"><p>I&#39;ve written a class that manages recipients on a MailChimp list, called MailChimpRecipient. It uses the MCAPI class, which is an third-party API wrapper.</p><p><a href="http://apidocs.mailchimp.com/api/1.3/">http://apidocs.mailchimp.com/api/1.3/</a><br /> http://apidocs.mailchimp.com/api/downloads/</p><p>I pass the MCAPI object into the constructor of the MailChimpRecipient object, so I have written unit tests using PHPUnit that test all of the logic in my own class (I am not testing the MCAPI class). I have 100% code coverage and all tests pass. This is done by mocking and stubbing the MCAPI object.</p><p>My next step was to write an integration test, also using PHPUnit, where I would construct the MailChimpRecipient fixture using a real MCAPI object, set up to use a real MailChimp list.</p><p>I have written what I think is an intergration test, which basically runs tests agains the public interface of the object, like:</p><pre><code>public function testAddedRecipientCanBeFound()
{
    $emailAddress = &#39;fred@fredsdomain.com&#39;;
    $forename = &#39;Fred&#39;;
    $surname = &#39;Smith&#39;;

    // First, delete the email address if it is already on the list
    $oldRecipient = $this-&gt;createRecipient();
    if($oldRecipient-&gt;find($emailAddress))
    {
        $oldRecipient-&gt;delete();
    }
    unset($oldRecipient);

    // Add the recipient using the test data
    $newRecipient = $this-&gt;createRecipient();
    $newRecipient-&gt;setForename($forename);
    $newRecipient-&gt;setSurname($surname);
    $newRecipient-&gt;setEmailAddress($emailAddress);
    $newRecipient-&gt;add();
    unset($newRecipient);

    // Assert that the recipient can be found using the same email address
    $this-&gt;assertTrue($this-&gt;_recipient-&gt;find($emailAddress));
}
</code></pre><p>The &#34;integration&#34; test doesn&#39;t test any of the internals of the class &#8211; it just makes sure that given a real MCAPI object, it behaves as advertised.</p><p>Is this correct? Is this the best way to run an intergation test? After all, the internals have been tested with a unit test. Am I right in thinking that the integration test is there to test that it really works, according the way its behaviour is advertised?</p><p>To take it a step further, the MailChimpRecipient class implements an interface, which will also be implemented by other classes. The idea is to use a factory to pass different types of mailing list recipient objects to my code, which all do the same thing, albeit using different mailing list providers. Since my integration tests test the that interface, how about using it for all of the classes that implement the interface? Then, in the future, if I design a new class to be used interchangably, I can run the same integration test before inserting it into a project.</p><p>Does this sound reasonable? The unit tests test the internals of an object, intergration tests make sure that it behaves as advertised?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>When testing your code you should pay attention to three areas:</p><ul><li>Scenario testing</li><li>Functional testing</li><li>Unit testing</li></ul><p>Normally the amount of test you have in each category would have the shape of a pyramid, meaning a lot unit tests at the bottom, some functional tests in the middle, and just a few scenario tests.</p><p>With a unit test you mock out everything that the class under test uses and you test it in pure isolation (this is why it&#39;s important to make sure that inside your class you retrieve all dependencies trough injection so they can be replaced under test).</p><p>With unit testing you test all possibilities, so not only the &#39;happy path&#39; but also all error conditions.</p><p>If you are completely certain that your all units work in isolation you write a couple of tests (functional tests) to make sure the units also work when combined.
Then you write a scenario test, which tests the wiring between all the functional modules.</p><p>For example, suppose you&#39;re testing a car.</p><p>You could assemble the whole car and as a driver check every possible condition but that would be really hard to do.</p><p>Instead you would test a small part of the engine with all possibilities (unit test)</p><p>Then you test the whole engine (separate from the car) which would be a functional test.</p><p>As a last test, you put your key in, start the car and drive it to the parking lot. If that&#39;s working then you know that all parts (battery, fuel, engine, ..) are connected and since you tested them in isolation you can be pretty sure that the whole car is functioning correctly.</p><p>So in your case, you tested all error conditions and the happy path in your unit test and know you only have to an end-to-end test with the &#39;real components&#39; to check if the wiring is correct.</p><p>A few other points,</p><ul><li>Avoid conditional logic in your unit test. If you have to clean up, your using some kind of global state and the tests can suddenly influence each other.</li><li>Don&#39;t specify any data that&#39;s not relevant for the test. If I would change forename, or surname, would the test fail? Probably not because it&#39;s the email address that&#39;s important but because you mention it explicitly in your test, I can&#39;t be sure. Try looking at the Builder Pattern for building your test data and making it explicit what&#39;s really important.</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-are-integration-tests-meant-to-be-redundant/'>Unit-testing &#8211; Are Integration Tests Meant to be Redundant</a></li><li class="list-group-item"><a href='../php-how-to-pass-a-mock-object-into-a-class-for-unit-tests/'>Php &#8211; How to pass a mock object into a class for unit tests</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>