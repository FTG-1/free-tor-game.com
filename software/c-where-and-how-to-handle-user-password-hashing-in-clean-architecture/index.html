<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Where and how to handle user password hashing in Clean Architecture &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087997 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087997" class="post-1087997 software type-software status-publish hentry category-software tag-architectural-patterns tag-architecture tag-c tag-design-patterns tag-hashing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Where and how to handle user password hashing in Clean Architecture</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">architectural-patterns</span><span class="mr-2 badge badge-info">Architecture</span><span class="mr-2 badge badge-warning">c</span><span class="mr-2 badge badge-primary">design-patterns</span><span class="mr-2 badge badge-danger">hashing</span></p><div class="entry-content"><p>I&#39;m currently building a new application and trying to apply some of the principles of <a href="http://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html" rel="nofollow noreferrer">Clean Architecture</a>. One of my first roadblocks is implementing my own <code>Identity</code> system (to avoid being tightly coupled to the <code>AspNetCore.Identity</code> library.</p><p>One of my concerns is password hashing and generation. I&#39;m looking at following a similar or the same process as the <a href="https://github.com/aspnet/Identity/blob/a8ba99bc5b11c5c48fc31b9b0532c0d6791efdc8/src/Microsoft.AspNetCore.Identity/PasswordHasher.cs" rel="nofollow noreferrer">AspNetCore.Identity Password Hasher</a>, but I&#39;m not quite sure where I should handle this logic.</p><p>My initial thought is since this is pertaining to my domain entities, I should put this in my <code>Domain</code> layer. However, I&#39;m concerned that this will create headaches and scattered logic in the future as I validate passwords. On the other hand, I could define my own <code>IPasswordHasher</code> interface in my application layer, but this has the negative consequence of my application layer dictating my hashing and validation scheme. In the event I share these entities with another application in the future, I would have to ensure that the hashing algorithm is the same.</p><p>But by that same token, it would be great to simply use the <code>IPasswordHasher</code> interface that&#39;s already defined in <code>Microsoft.AspNetCore.Identity</code>, but I don&#39;t want to have that tight coupling.</p><p>So what would be the ideal approach to implementing some sort of hashing logic (potentially even just using the PasswordHasher defined in AspNetCore) without having to reference the AspNetCore library in my application/domain layers? And where should I actually implement my password hashing, at the domain layer or the application layer?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Identity management is probably not part of your core problem domain, therefore it has no place among your core business logic. Also, your entities (the center in the Clean Architecture) should not depend on external systems such as databases or possibly specific identity management systems. Instead, you define an interface for the services required by the core, and then implement that service. This implementation would be on a similar level to an “application layer”, but note that the Clean Architecture specifically does not have up–down layers, only inside–out layers. The inside parts define interfaces that are implemented on the outside.</p><p>From the perspective of your core problem domain, the exact identity management scheme and password hashing algorithm is indeed irrelevant. It is therefore correct that these details are are decided by an external service. Of course that service could be implemented incorrectly (e.g. storing plaintext passwords), but so could any identity management within your entities. But exactly this possibility of things going wrong also implies flexibility that can be used to make tests go fast. Secure password hashing algorithms are perceptibly slow, by design. So you may not want to use the true identity management implementation for some tests but swap it out with a mock implementation!</p><p>“In the event I share these entities with another application in the future …” – no, that kind of assumption is usually wrong for two reasons. First, entities are the central model of your application. This is usually unique and not reusable. Second, consider YAGNI. Iff the need to reuse some component arises, you can refactor your code to make it reusable. That&#39;s the luxury of developing an application: you can change the design later. In contrast, libraries that are consumed externally do have to get their API design right the first time.</p><p>Note also that the whole goal of the Clean Architecture is to defer design decisions as long as possible. That&#39;s why dependencies only flow inwards. You can write your core business logic, without worry of how anything will actually work. If it needs an external service, you define an interface that you implement later. How? That&#39;s for the future to determine. The Clean Architecture implies a top-down approach to design. Decisions like choosing an identity management solution or choosing a web framework (or even choosing whether the software is a web app or a desktop app) can be deferred, at least in theory. I find this quite similar to the “Programming by <a href="http://wiki.c2.com/?WishfulThinking" rel="nofollow noreferrer">Wishful Thinking</a>” technique taught by SICP.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-ddd-creating-reusable-modules-and-service-type-distinctions-domain-infrastructure-application/'>Php &#8211; DDD: Creating reusable modules and service type distinctions (Domain, Infrastructure, Application)</a></li><li class="list-group-item"><a href='../c-ddd-factory-or-service/'>C# &#8211; DDD &#8211; Factory or Service</a></li><li class="list-group-item"><a href='../c-clean-architecture-cqrs-and-authentication/'>C# &#8211; Clean architecture, CQRS, and authentication</a></li><li class="list-group-item"><a href='../object-oriented-doesnt-repository-pattern-in-clean-architecture-violate-dependency-inversion-principle/'>Object-oriented &#8211; Doesn&#8217;t repository pattern in clean architecture violate Dependency inversion principle</a></li><li class="list-group-item"><a href='../c-implementing-clean-architecture/'>C# &#8211; Implementing clean architecture</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>