<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; How to handle configuration of Python modules, especially when used standalone and in frameworks like Django &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068676 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068676" class="post-1068676 software type-software status-publish hentry category-software tag-configuration tag-django tag-python"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; How to handle configuration of Python modules, especially when used standalone and in frameworks like Django</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">configuration</span><span class="mr-2 badge badge-info">django</span><span class="mr-2 badge badge-warning">python</span></p><div class="entry-content"><p>I am trying to package a Python module for pip, following <a href="https://packaging.python.org/en/latest/distributing.html" rel="noreferrer">the guide here</a>.</p><p>One area I would like feedback on is best practices or convention for making my module configurable. The module is a library for talking to federated RESTful services / local datastores, and we use it both as a command-line library as well as a Django app. So I would like it to be manually configurable as well as configurable from Django&#39;s settings.py file.</p><p>Our current method of doing this is horrible &#8212; it relies on a set of settings.py files inside of the library, which are overwritten whenever we pull from git, not changeable during runtime, etc.</p><p>My idea for a solution is to wrap the entire library in its own class, and in the <code>__init__</code> method, do something like:</p><pre><code>try:
    from django.conf import settings
    self._remote_host = settings.REMOTE_HOST
except:
    self._remote_host = DEFAULT_HOST
</code></pre><p>But that only seems to take care of Django and seems cumbersome &#8212; what if someone wants to use our library with Flask, or something else? Is there a more universal way to make a Python module configurable by external tools plus have a default? Or is this a lost cause, and I should stick to configuration on init via arguments?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>There are two problems come together here:</p><ol><li>Your package is a singleton although there exist many different configurations.</li><li>Where to store the data and how to migrate - which database to use.</li></ol><p><strong>Singleton</strong></p><p>I did a fun project with lots of modules which needed configuration themselves. The project was intended to run <strong>once per computer</strong>.</p><p>The alternative is to put everything into classes and instantiate them with a configuration. Tist would allow many different configurations to exist within one program. When you may have this need you should restructure your whole code.</p><p><strong>Database</strong></p><p>Maybe your project is for a company and shall be developed for a longer time and the configuration shall not be thrown away. Then you may need to keep in mind many previous configurations when changing the default values and updating the configuration. Proper databases have solved that problem.</p><p><strong>My tradeoff solution</strong></p><p>In my case</p><ul><li>The configuration can be thrown away if my model changes.</li><li>The package runs not only once per process but also once per computer.</li><li>Only one thread accesses the configuration.</li></ul><p>There is a module called <a href="https://github.com/niccokunzmann/mousemove/blob/master/mousemove/config.py" rel="nofollow">config.py</a> with the following methods:</p><pre><code>import config
config.load()
config.save()
</code></pre><p>You use it like this (Example1):</p><pre><code>config.load()
config.my_value = &#39;test&#39;
config.save()
</code></pre><p>There is also a file called <a href="https://github.com/niccokunzmann/mousemove/blob/master/mousemove/constants.py" rel="nofollow">constants.py</a> which should better be called <code>default_config.py</code>. It has the functions</p><pre><code>import constants
constants.default_configuration()
constants.config_file_name() # where to store the config data
</code></pre><p>And for (Example1) the constants.py should look like this:</p><pre><code>def default_configuration():
    return {&#39;my_value&#39; : &#39;default&#39;} # to avoid attribute errors
</code></pre><p>The config module saves and loads the configuration using pickle. If no configuration is found for a variable the default configuration is used.</p><p>You will need a coding style that always fetches the configuration from the config.py. It shall not be stored in a local variable or attribute over a longer time since it can change.</p><p>My previous version is called <a href="https://gist.github.com/niccokunzmann/5262590" rel="nofollow">runningConfiguration</a>. It has no explicit load and save and also no default attributes.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-translating-between-python-django-and-javascript/'>Object-oriented &#8211; Translating between Python-Django and Javascript</a></li><li class="list-group-item"><a href='../python-how-to-achieve-inheritance-when-using-just-modules-and-vanilla-functions-in-python/'>Python &#8211; How to achieve inheritance when using just modules and vanilla functions in Python</a></li><li class="list-group-item"><a href='../python-how-to-properly-handle-global-parameters-for-unit-testing-in-python/'>Python &#8211; How to properly handle global parameters for unit testing in python</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>