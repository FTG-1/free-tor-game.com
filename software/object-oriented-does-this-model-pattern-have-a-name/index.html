<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; does this model-pattern have a name &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082014 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082014" class="post-1082014 software type-software status-publish hentry category-software tag-design-patterns tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; does this model-pattern have a name</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span><span class="mr-2 badge badge-info">object-oriented</span></p><div class="entry-content"><p>A few years back, I wrote <a href="https://stackoverflow.com/a/7905448/283851">this answer</a> to a question from which the following idea emerged.</p><p>I call these &#34;Type Descriptors&#34;, as I have never been able to find this pattern documented or formally described anywhere &#8211; not to be confused with type descriptors in C#, but it&#39;s the most accurate name I&#39;ve been able to come up with, so bear with me.</p><p>Here&#39;s my first attempt at a &#34;formal&#34; description:</p><blockquote><p>A Type Descriptor is a type that provides meta-information about<br /> another type.</p><p>This pattern can be seen as an alternative to run-time reflection and<br /> annotations, and as such is equally applicable to languages that do or<br /> do not support reflection or annotations.</p><p>Type Descriptors are particularly useful as a means of describing<br /> aspects of model types found in for example domain and view-models, as<br /> well as in specialized types of models, such as form-models in a<br /> business- or web-application. Often such applications have many common<br /> aspects, such as the need to label inputs and perform common<br /> validations for e.g. required input, data types and formats, etc. &#8211;<br /> the information required by helper objects (or services) to handle<br /> these aspects fits comfortably in descriptors.</p><p>A descriptor mirrors the shape of the type it describes &#8211; for example,<br /> if a model type User has properties like id, name and email, it&#39;s type<br /> descriptor must have properties id, name and email, but where the<br /> properties on the model type have various value types (in this case<br /> for example integer and string) the properties of the descriptor are<br /> objects that provide information about those properties.</p><p>Maintaining identical model type and descriptor shapes may seem like<br /> duplication, in terms of property-names being identical in the model<br /> type and type descriptor &#8211; however, this does not violate the DRY<br /> principle as such, since the model type and descriptor, strictly<br /> speaking, are two different types that only happen to have the same<br /> shape, but do not have any overlapping concerns or duplication of any<br /> code; only the property names are duplicates.</p></blockquote><p>I program mostly in PHP on a daily basis, and have used this pattern successfully to build applications. The following example is in PHP, though this could be implemented in any language capable of resolving properties by name at run-time.</p><p>A tiny bit of framework is required to implement this, so here goes&#8230;</p><p>A model-type implementing the following interface can provide a &#34;type descriptor&#34; &#8211; a type that describes the model-type itself:</p><pre><code>interface TypeInfo
{
    function getType();
}
</code></pre><p>Individual model-properties are described by &#34;property descriptors&#34; in the &#34;type descriptor&#34;, for which I use a base class along the lines of this:</p><pre><code>abstract class PropertyInfo
{
    /** @var string */
    public $name;

    /** @var string */
    public $label;

    public function __construct($name)
    {
        $this-&gt;name = $name;
    }
}
</code></pre><p>From this class, I derive &#34;property descriptors&#34; for specific types of properties &#8211; for example, this type describes a string property:</p><pre><code>class StringInfo extends PropertyInfo
{
    /**
     * @var int|null
     */
    public $max_length;
}
</code></pre><p>Now here&#39;s a sample <code>User</code> model, and it&#39;s &#34;type descriptor&#34; <code>UserType</code>:</p><pre><code>class User implements TypeInfo
{
    /** @var string */
    public $name;

    /** @var string */
    public $email;

    /** @return UserType */
    public function getType()
    {
        return UserType::instance();
    }
}

class UserType
{
    /** @var StringInfo */
    public $name;

    /** @var StringInfo */
    public $email;

    public function __construct()
    {
        $this-&gt;name = new StringInfo(&#39;name&#39;);
        $this-&gt;name-&gt;label = &#39;Full Name&#39;;
        $this-&gt;name-&gt;max_length = 50;

        $this-&gt;email = new StringInfo(&#39;email&#39;);
        $this-&gt;email-&gt;label = &#39;E-mail Address&#39;;
        $this-&gt;email-&gt;max_length = 128;
    }

    /** @return self */
    public static function instance()
    {
        static $instance;

        return $instance ?: $instance = new static();
    }
}
</code></pre><p>As you can see, it&#39;s now possible to get the type descriptor either from a <code>User</code> instance by e.g. <code>$user-&gt;getType()</code> &#8211; notice that the property-names of the &#34;property descriptors&#34; in the &#34;type descriptor&#34; match the property-names in the actual model; using this pattern, it&#39;s my own responsibility to make sure the model and it&#39;s descriptor have the same shape.</p><p>Now I can write services and helpers etc. which may consume information from a &#34;type descriptor&#34; while working with model objects &#8211; for example, here&#39;s a very simple form helper:</p><pre><code>class FormHelper
{
    /** @var TypeInfo */
    public $model;

    /** @var string */
    public $prefix;

    /**
     * @param TypeInfo $model
     * @param string     $prefix
     */
    public function __construct(TypeInfo $model, $prefix)
    {
        $this-&gt;model = $model;
        $this-&gt;prefix = $prefix;
    }

    /**
     * @param StringInfo $prop
     *
     * @return string
     */
    public function text(StringInfo $prop)
    {
        $name = $prop-&gt;name;

        return &#39;&lt;label for=&#34;&#39; . $name . &#39;&#34;&gt;&#39; . htmlspecialchars($prop-&gt;label) . &#39;&lt;/label&gt;&#39;
            . &#39;&lt;input type=&#34;text&#34; name=&#34;&#39; . $this-&gt;prefix . &#39;[&#39; . $name . &#39;]&#34;&#39;
            . ($prop-&gt;max_length ? &#39; maxlength=&#34;&#39; . $prop-&gt;max_length . &#39;&#34;&#39; : &#39;&#39;)
            . &#39; value=&#34;&#39; . $this-&gt;model-&gt;$name . &#39;&#34; id=&#34;&#39; . $name . &#39;&#34; /&gt;&#39;;
    }
}
</code></pre><p>You would use the form helper like this:</p><pre><code>$user = new User;
$user-&gt;name = &#39;Rasmus&#39;;
$user-&gt;email = &#39;rschultz@gorges.us&#39;;

$form = new FormHelper($user, &#39;user&#39;);

$t = $user-&gt;getType();

echo $form-&gt;text($t-&gt;name) . &#34;\n&#34;;
echo $form-&gt;text($t-&gt;email) . &#34;\n&#34;;
</code></pre><p>Which would output something like this:</p><pre><code>&lt;label for=&#34;name&#34;&gt;Full Name&lt;/label&gt;&lt;input type=&#34;text&#34; name=&#34;user[name]&#34; maxlength=&#34;50&#34; value=&#34;Rasmus&#34; id=&#34;name&#34; /&gt;
&lt;label for=&#34;email&#34;&gt;E-mail Address&lt;/label&gt;&lt;input type=&#34;text&#34; name=&#34;user[email]&#34; maxlength=&#34;128&#34; value=&#34;rschultz@gorges.us&#34; id=&#34;email&#34; /&gt;
</code></pre><p>The two key reasons I enjoy working like this are (1) patterns like rendering forms, mapping post-data to model objects, mapping model-objects to database records, performing input validation and so forth can all be performed by formal helpers and service objects, all of which consume the same single source of information, and (2) everything is &#34;statically typed&#34;, meaning only a single unchecked property-reference (by name, as a string) is made and encapsulated inside the &#34;type descriptor&#34;, and type-hints and inference in a modern IDE (PhpStorm) can provide automated code inspections at development-time, I can safely use automated refactorings, and so forth.</p><p>Okay, a rather lengthy discourse, for what boils down to one question: does this pattern have a name? 🙂</p><p>Side question: does this constitute (reflective) meta-programming? (The use of this pattern is very similar to e.g. using reflection to obtain annotations from a model, though I find this to be much safer, less complicated, more flexible and transparent.)</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>That is an OOP <a href="http://en.wikipedia.org/wiki/Data_descriptor" rel="nofollow">Data Descriptor</a>.  Although you are describing additional information about a class rather than information about bits in memory, the fundamental parity still applies;  you&#39;re describing in one place useful aspects about data in another place.</p><p>I&#39;d advise you to adopt that name, write up a clearer definition of the pattern, and use the name in code.  (&#34;Type&#34; <a href="http://php.net/manual/en/language.types.php" rel="nofollow">already means something</a> in PHP, so you really shouldn&#39;t use it.)  So, your <code>user</code> class could be changed as follows:</p><pre><code>class User {
   ...
   public function getDescriptor() {
   }
}

class UserDescriptor {
   ...
}
</code></pre></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-is-it-an-anti-pattern-if-a-class-property-creates-and-returns-a-new-instance-of-a-class/'>Object-oriented &#8211; Is it an anti-pattern if a class property creates and returns a new instance of a class</a></li><li class="list-group-item"><a href='../architecture-domain-model-design-best-practices-for-robust-fluency-encapsulation-and-extensibility/'>Architecture &#8211; Domain Model Design &#8211; Best Practices for Robust Fluency, Encapsulation, and Extensibility</a></li><li class="list-group-item"><a href='../c-design-pattern-to-force-client-of-a-class-to-call-a-method/'>C# &#8211; Design pattern to force client of a class to call a method</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>