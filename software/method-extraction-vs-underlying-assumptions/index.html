<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Method extraction vs underlying assumptions &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1080687 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1080687" class="post-1080687 software type-software status-publish hentry category-software tag-functions tag-methods"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Method extraction vs underlying assumptions</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">functions</span><span class="mr-2 badge badge-info">methods</span></p><div class="entry-content"><p>When I split big methods (or procedures, or functions — this question <strong>is not</strong> specific to OOP, but since I work in OOP languages 99% of the time, it&#39;s the terminology that I&#39;m most comfortable with) into a lot of small ones, I often find myself displeased with the results. It becomes harder to reason about these small methods than when they were just blocks of code in the big one, because when I extract them, I lose a lot of underlying assumptions that come from the context of the caller.</p><p>Later, when I look at this code and see individual methods, I don&#39;t immediately know where are they called from, and think about them as ordinary private methods that can be called from anywhere in the file. For example, imagine an initialisation method (constructor or otherwise) split into a series of small ones: in the context of method itself, you clearly know that object&#39;s state is still invalid, but in an ordinary private method you probably go from assumption that object is already initialised and is in a valid state.</p><p>The only solution I&#39;ve seen for this is the <code>where</code> clause in Haskell, which allows you to define small functions that are used only in the &#34;parent&#34; function. Basically, it looks like this:</p><pre><code>len x y = sqrt $ (sq x) + (sq y)
    where sq a = a * a
</code></pre><p>But other languages I use don&#39;t have anything like this — the closest thing is defining a lambda in a local scope, which is probably even more confusing.</p><p>So, my question is — do you encounter this, and do you even see this is a problem? If you do, how do you typically solve it, particularly in &#34;mainstream&#34; OOP languages, like Java/C#/C++?</p><p><strong>Edit about duplicates:</strong> As others noticed, there are already questions discussing splitting methods and small questions that are one-liners. I read them, and they don&#39;t discuss the issue of <strong>underlying assumptions</strong> that can be derived from caller&#39;s context (in example above, object being initialised). That&#39;s the point of my question, and that&#39;s why my question is different.</p><p><strong>Update:</strong> If you followed this question and discussion underneath, you might enjoy <a href="http://number-none.com/blow/john_carmack_on_inlined_code.html" rel="nofollow">this article by John Carmack on the matter</a>, in particular:</p><blockquote><p>Besides awareness of the actual code being executed, inlining functions also has the benefit of not making it possible to call the function from other places. That sounds ridiculous, but there is a point to it. As a codebase grows over years of use, there will be lots of opportunities to take a shortcut and just call a function that does only the work you think needs to be done. There might be a FullUpdate() function that calls PartialUpdateA(), and PartialUpdateB(), but in some particular case you may realize (or think) that you only need to do PartialUpdateB(), and you are being efficient by avoiding the other work. Lots and lots of bugs stem from this. Most bugs are a result of the execution state not being exactly what you think it is.</p></blockquote></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>For example, imagine an initialisation method split into a series of small ones: in the context of method itself, you clearly know that object&#39;s state is still invalid, but in an ordinary private method you probably go from assumption that object is already initialised and is in a valid state. The only solution I&#39;ve seen for this is...</p></blockquote><p>Your concern is well-founded. There is another solution.</p><p>Take a step back. What fundamentally is the purpose of a method? Methods only do one of two things:</p><ul><li>Produce a value</li><li>Cause an effect</li></ul><p>Or, unfortunately, both. I try to avoid methods that do both, but plenty do.  Let&#39;s say that the effect produced or the value produced is the &#34;result&#34; of the method.</p><p>You note that methods are called in a &#34;context&#34;. What is that context?</p><ul><li>The values of the arguments</li><li>The state of the program outside of the method</li></ul><p>Essentially what you are pointing out is: <em>the correctness of the result of the method depends on the context in which it is called</em>.</p><p>We call the <em>conditions required before a method body begins for the method to produce a correct result</em> its <em>preconditions</em>, and we call the <em>conditions which will be produced after the method body returns</em> its <em>postconditions</em>.</p><p>So essentially what you are pointing out is: <em>when I extract a code block into its own method, I am losing contextual information about the preconditions and postconditions</em>.</p><p>The solution to this problem is <strong>make the preconditions and postconditions explicit in the program</strong>. In C#, for instance, you could use <code>Debug.Assert</code> or Code Contracts to express preconditions and postconditions.</p><p>For example: I used to work on a compiler which moved through several &#34;stages&#34; of compilation. First the code would be lexed, then parsed, then types would be resolved, then inheritance hierarchies would be checked for cycles, and so on. Every bit of the code was very sensitive to its context; it would be disastrous, for instance, to ask &#34;is this type convertible to that type?&#34; if the graph of base types was not yet known to be acyclic! So therefore every bit of code clearly documented its preconditions. We would <code>assert</code> in the method that checked for type convertibility that we had already passed the &#34;base types acylic&#34; check, and it then became clear to the reader where the method could be called and where it could not be called.</p><p>Of course there are lots of ways in which good method design mitigates the problem you&#39;ve identified:</p><ul><li>make methods that are useful for their effects or their value but not both</li><li>make methods that are as &#34;pure&#34; as possible; a &#34;pure&#34; method produces a value that depends <em>only</em> on its arguments, and produces no effect. These are the easiest methods to reason about because the &#34;context&#34; they need is very localized.</li><li>minimize the amount of mutation that happens in program state; mutations are points where code gets harder to reason about</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-whats-the-difference-between-a-function-and-a-method/'>Java &#8211; What&#8217;s the difference between a function and a method</a></li><li class="list-group-item"><a href='../java-why-is-cyclomatic-complexity-that-important-for-a-single-method/'>Java &#8211; Why is cyclomatic complexity that important for a single method</a></li><li class="list-group-item"><a href='../web-development-splitting-up-a-very-large-function-program-into-smaller-functions-effective/'>Web-development &#8211; Splitting up a very large function/program into smaller functions. Effective</a></li><li class="list-group-item"><a href='../c-long-method-refactoring-leaving-as-is-vs-separating-into-methods-vs-using-local-functions/'>C# &#8211; Long method refactoring: leaving as is vs separating into methods vs using local functions</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>