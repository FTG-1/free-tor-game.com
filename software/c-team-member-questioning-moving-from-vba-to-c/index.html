<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Team member questioning moving from VBA to C# &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1067554 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1067554" class="post-1067554 software type-software status-publish hentry category-software tag-c tag-excel tag-projects-and-solutions tag-vba"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Team member questioning moving from VBA to C#</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">excel</span><span class="mr-2 badge badge-warning">projects-and-solutions</span><span class="mr-2 badge badge-primary">vba</span></p><div class="entry-content"><p><strong>Background</strong></p><p>Last year, I was asked to create a tool to be used for business planning for around 10 users. This was done on behalf of another IT team who &#34;sub-contracted&#34; the work to me, and due to the project deadlines being a little unplanned on their side, I had to implement it in a bit of a rush.</p><p>At the time, we decided that the quickest way would be to create an Excel workbook with VBA and then have the users download this VBA-enhanced workbook from an Intranet to use on their PCs. Excel was a constraint in this case because the planning system (i.e. database) we use can only interact via an Excel add-in which must be loaded at the same time the planning workbook is open. However, VBA was not a constraint at that time.</p><p>The workbook I created around 4,000 lines of VBA code and whilst I tried to separate data and presentation layers, I couldn&#39;t in all cases due to the project deadlines. To be honest, whilst I am proud of creating this workbook, I am at the same time a little disappointed in that it could&#39;ve been done better, in both terms of coding and also deployment to the users.</p><p><strong>Today</strong></p><p>Back to today and the IT team has again come to me to request a similar workbook (so I could reuse parts of the other workbook above), but this time it is a lot more complicated and will be used by a greater number of users (around 200).</p><p>However, this time, it is a little better planned and I can see that we have a bit more time to plan things. Based on this, I thought about the solution and infrastructure as programming for 100 users has more of an impact than for 10 users. Therefore, I suggested to the team that perhaps we should consider migrating the existing code to a C# solution so that we could manage the code in a more refined way. I&#39;m still considering it as an add-in written using VSTO / Excel-DNA which can then be deployed to the users.</p><p>I discussed this with the IT team two weeks ago and everything seemed to be fine, until yesterday I received a mail from one of the team (who does not know VBA or C#) questioning why we should start this new project in C# versus using the same approach as before. Some of their concerns were:</p><ul><li>It is a fairly important project so it has to work &#8211; a C# solution would not be as stable or work as well as the existing a VBA-based solution.</li><li>We would have to throw away what we [I] had done in the VBA solution and recreate it from scratch in C#.</li><li>Someone will have to support two separate solutions, one in VBA and one in C#. [actually, they currently do not have anyone for support, I usually step in].</li></ul><p>Now, I can understand some of their concerns to some degree, but I need to come to a decision on next steps and what to go back to them with. Personally, I would like to implement in C# because I feel it would lend itself better to building an &#34;Enterprise&#34; solution like this. Furthermore, I would like to take this opportunity brush up on my C# skills as I am currently not as competent in C# as I am VBA and I&#39;d like a project like this to take me to the &#34;next level&#34;.</p><p>I prepared a list of points that I could use to try and convince them that a C# solution would be better for this project, this is what I have so far:</p><ul><li>Unit testing.</li><li>Source control.</li><li>Code documentation &#8211; for knowledge transfer to other support persons.</li><li>Better coding conventions &#8211; can use things like ReSharper to enforce better naming and structure.</li><li>Better IDE &#8211; fewer mistakes due to error highlighting.</li><li>More modularity through assemblies &#8211; can promote re-use in future tools.</li><li>Managed deployment &#8211; can control who this tool is used by.</li></ul><p><strong>Question: What other points could I add to convince them? Or am I trying to bite off more than I can chew with this project? Should I just keep quiet and do it in VBA anyway?</strong></p><p>I am aware that just moving to a new language because its &#34;newer&#34; or seen to be &#34;cooler&#34; should not be a basis for a decision and as such I have resisted to include it as a decision point &#8211; this is about facts.</p><p>Also, I am not asking for a literal comparison between C# and VBA as languages, as there are plenty of comparisons on SO.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The three points you listed seem fair:</p><blockquote><p>It is a fairly important project so it has to work - a C# solution would not be as stable or work as well as the existing a VBA-based solution.</p></blockquote><p>Indeed, later, you tell: &#34;I would like to take this opportunity brush up on my C# skills as <strong>I am currently not as competent in C# as I am VBA</strong>&#34; (emphasis mine).</p><p>In other words, you have a solution which works and went through intensive user testing. You want to throw all this and rewrite everything in a language you don&#39;t know well. See the problem?</p><blockquote><p>We would have to throw away what we [I] had done in the VBA solution and recreate it from scratch in C#.</p></blockquote><p><a href="http://www.joelonsoftware.com/articles/fog0000000069.html" rel="nofollow noreferrer">Things You Should Never Do</a> comes to mind. You are throwing the code, as well as the user testing. Not a good thing.</p><blockquote><p>Someone will have to support two separate solutions, one in VBA and one in C#. [actually, they currently do not have anyone for support, I usually step in].</p></blockquote><p>If the VBA version would still be used, the rewrite is indeed even more problematic. Why would you have two disparate systems which require your attention, when you may have only one which already works and which you can refactor and add features to?</p><hr/><p>Some of your points, on the other hand, can be criticized:</p><ul><li><p><strong>Unit testing.</strong></p><p><a href="https://stackoverflow.com/q/1792188/240613">You can unit test your current project as well.</a> If there is no convenient framework for that, create one.</p></li><li><p><strong>Source control.</strong></p><p>Source control deals with text. Your current code is text, therefore you can use source control for it.</p><p>The language, the operating system, the framework or the ecosystem are completely irrelevant. You can (and should) use source control for any code you write: code in Visual Studio, or a piece of code you draft in a few minutes in LINQPad, or PowerShell scripts which automate a task, <a href="http://blog.codinghorror.com/is-your-database-under-version-control/" rel="nofollow noreferrer">or database schema</a>, or Excel macros.</p></li><li><p><strong>Code documentation - for knowledge transfer to other support persons.</strong></p><p>Agreed.</p></li><li><p><strong>Better coding conventions - can use things like ReSharper to enforce better naming and structure.</strong></p><p>Define &#34;better&#34;. Are there coding conventions for Excel&#39;s macros? If yes, use them: they are not better or worse than any other. If not, create ones and publish them so that other people can use them too. <a href="https://stackoverflow.com/q/2131350/240613">The answers to a question posted in 2010</a> seem rather disappointing, but there may be new tools available since then.</p><p>Note that the important part of coding conventions is that they should be enforced on commit.</p></li><li><p><strong>Better IDE - fewer mistakes due to error highlighting.</strong></p><p>Agreed. The fact that <a href="https://stackoverflow.com/a/23173972/240613">we can&#39;t write macros in Visual Studio</a> is very unfortunate.</p></li><li><p><strong>More modularity through assemblies - can promote re-use in future tools.</strong></p><p>I&#39;m pretty sure your current product can use some degree of modularity as well.</p></li><li><p><strong>Managed deployment - can control who this tool is used by.</strong></p><p>Agreed.</p></li></ul><hr/><p>Instead of a complete rewrite, you might search for a way to <strong>progressively</strong> move code from the macro to an ordinary assembly written in VB.NET. Why in VB.NET? Three reasons:</p><ul><li><p>There is less difference between VBA and VB.NET as there is between VBA and C#.</p></li><li><p><em>You</em> know VBA better, and this alone is a good reason to use VB.NET instead of C#. If you want to &#34;brush up on your C# skills&#34;, do it with your personal projects, not business critical stuff.</p></li><li><p>Any rewrite from a language to another leads to potential bugs. You don&#39;t need that for this project.</p></li></ul><p>Moving to a .NET assembly can give you the convenient environment of Visual Studio, with the convenient unit testing, TFS and error highlighting you currently use in other projects.</p><p>At the same time, if you move your code step by step, you don&#39;t take the risk of a complete rewrite (i.e. spending four months creating something nobody wants to use because the high number of new bugs). For instance, you need to work on a specific feature? Think how you can move this particular feature to .NET first.</p><p>This is quite similar to refactoring. Instead of rewriting the whole thing because you learnt some new design patterns and language features, you simply do small changes on the code on which you work right now.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../security-concerns-with-password-storage-in-scripting-languages-vba/'>Security Concerns with password storage in Scripting Languages (VBA)</a></li><li class="list-group-item"><a href='../guidance-on-excel-vba-resource-scheduling-algorithm/'>Guidance on Excel VBA resource scheduling algorithm</a></li><li class="list-group-item"><a href='../managing-sets-of-configuration-data-for-an-excel-vba-program/'>Managing sets of configuration data for an Excel/VBA program</a></li><li class="list-group-item"><a href='../reverse-engineering-a-spreadsheet-into-a-model-and-controller/'>Reverse Engineering a Spreadsheet into a Model and Controller</a></li><li class="list-group-item"><a href='../python-really-make-python-work-with-vba/'>Python &#8211;  really make python work with VBA</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>