<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How are resource owner credentials stored in OAuth2 &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1078847 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1078847" class="post-1078847 software type-software status-publish hentry category-software tag-authentication tag-oauth2"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How are resource owner credentials stored in OAuth2</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">authentication</span><span class="mr-2 badge badge-info">oauth2</span></p><div class="entry-content"><p>I have been researching oauth2 as of recent and trying to draft an implementation plan. However I seem to be missing something, or something hasn&#39;t quite clicked yet.</p><p>I plan on creating an api and having certain endpoints be protected, requiring authorization. This api will be accessed via my 1rst party web application utilizing javascript/vuejs.</p><p>To accomplish this, the &#34;Resource Owner Password Flow&#34; seems to be the best choice for allowing resource owners to authenticate to gain access to parts of the api. The specific implementation I have chosen to use for oauth2 is laravel&#39;s &#34;Passport&#34;. Example code for the password flow is below as well as the table layout which this implementation uses:</p><pre><code>$response = $http-&gt;post(&#39;http://your-app.com/oauth/token&#39;, [
    &#39;form_params&#39; =&gt; [
        &#39;grant_type&#39; =&gt; &#39;password&#39;,
        &#39;client_id&#39; =&gt; &#39;client-id&#39;,
        &#39;client_secret&#39; =&gt; &#39;client-secret&#39;,
        &#39;username&#39; =&gt; &#39;taylor@laravel.com&#39;,
        &#39;password&#39; =&gt; &#39;my-password&#39;,
        &#39;scope&#39; =&gt; &#39;&#39;,
    ],
]);


+-------------------------+
|oauth_clients            |
+-------------------------+
|id                       |
|user_id                  |
|name                     |
|secret                   |
|redirect                 |
|personal_access_client   |
|revoked                  |
|updated_at               |
|created_at               |
+-------------------------+

+-------------------------+
|oauth_auth_codes         |
+-------------------------+
|id                       |
|user_id                  |
|client_id                |
|scopes                   |
|revoked                  |
|expires_at               |
+-------------------------+

+-------------------------+
|oauth_access_tokens      |
+-------------------------+
|id                       |
|user_id                  |
|client_id                |
|name                     |
|scopes                   |
|revoked                  |
|created_at               |
|updated_at               |
|expires_at               |
+-------------------------+

+-------------------------+
|oauth_refresh_tokens     |
+-------------------------+
|id                       |
|access_token_id          |
|revoked                  |
|expires_at               |
+-------------------------+

+------------------------------+
|oauth_personal_access_clients |
+------------------------------+
|id                            |
|client_id                     |
|updated_at                    |
|created_at                    |
+------------------------------+
</code></pre><p>In the example request above, a <code>client_id</code> and <code>client_secret</code> are required along with <code>username</code> and <code>password</code>. I fail to see how calling <code>http://your-app.com/oauth/token</code> with the provided parameters would allow a resource owner to authenticate, since there is no table that stores a resource owner&#39;s <code>username</code> and <code>password</code>.</p><p>Could someone explain to me what is happening here, or what pieces of the puzzle I am missing? Should the OAuth2 authorization server be tied to my api (resource server) in some way that allows the authorization server to authenticate user&#39;s based on their username and password?&#8230;</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Should the OAuth2 authorization server be tied to my api (resource
 server) in some way that allows the authorization server to
 authenticate user&#39;s based on their username and password?...</p></blockquote><p>It depends on the needs, but yes, that&#39;s a fairly common implementation. However, it has led many people to believe that OAuth2 is an authentication protocol too; when it&#39;s not.</p><blockquote><p><em>As an additional confounder to our topic, an OAuth process does
 usually include several kinds of authentication in its process: the
 resource owner authenticates to the authorization server in the
 authorization step, the client authenticates to the authorization
 server in the token endpoint, and there may be others. The existence
 of these authentication events within the OAuth protocol does not
 translate to the OAuth protocol itself being able to reliably convey
 authentication.</em></p><p>-<em><a href="https://oauth.net/articles/authentication/" rel="nofollow noreferrer">oauth.net</a></em>-</p></blockquote><p>The OAuth2 goal is to allow applications to inter-operate without having to share credentials. Without having to care about users. OAuth2 doesn&#39;t care how users are identified. It only expects tokens and the issuers of the tokens for further validations.</p><blockquote><p>I fail to see how calling <code>http://your-app.com/oauth/token</code> with the
 provided parameters would allow a resource owner to authenticate,
 since there is no table that stores a resource owner&#39;s <code>username</code> and <code>password</code>.</p></blockquote><p>That&#39;s because the credentials validation (authentication) should be delegated to someone else.</p><p>This someone else can be either your own application (for example a login endpoint) or an external one. For example Facebook, Google, Github, etc.</p><p>Say we have a web application named <em>MyApp.com</em>. We would like to allow new users to get registered and authenticated quickly by getting the data from some other applications we trust. For example, from Facebook accounts.</p><p>Obviously, we cannot ask users for their Facebook credentials. Instead, we delegate the hard job to Facebook. Our authentication process will redirect to Facebook&#39;s OAuth.</p><p>Users will log in to Facebook and grant us access to their profile data.</p><p>Facebook will generate a token as proof of a) user identity and b) privileges over the user account. This token is what we know as <em>ID token</em>.</p><p><em>ID tokens</em> are sent back to Facebook every time <em>Myapp.com</em> needs to inter-operate with Facebook.</p><p>After getting the ID token, the very first thing we do is to request the Facebook user profile. We send the <em>ID token</em> in the request. If Facebook accepts the token, we complete the registration/login and allow users to pass.</p><p>On the other hand, <em>MyApp.com</em> also has its own registry and log-in. If users send <em>MyApp.com</em> credentials, who do you guess is going to be the <em>Identity Provider</em>? You guess right. <em>MyApp.com</em> itself. As we see, authentication and authorization are different things.</p><blockquote><p>How are resource owner credentials stored in OAuth2?</p></blockquote><p>According to the above options, the credentials can be stored in your own application, in a centric and shared <em>Identity Provider</em> (also known as Federated Identity Provider) or they could be stored nowhere within your domain (Facebook, Google, etc).</p><h3>Considerations</h3><p>If your application is the only consumer of authorization, consider changing the auth model for something simpler (e.g JWT) and also consider having the service integrated within the application. Ultimately, it&#39;s just <em>the application&#39;s auth service</em>.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-how-should-an-api-use-http-basic-authentication/'>Rest &#8211; How should an API use http basic authentication</a></li><li class="list-group-item"><a href='../oauth-shared-authorization-server-for-multiple-apps/'>OAuth shared Authorization server for multiple apps</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>