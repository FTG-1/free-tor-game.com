<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; Using lambdas to improve readability of a C++ function &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1078834 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1078834" class="post-1078834 software type-software status-publish hentry category-software tag-c tag-lambda tag-readability"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; Using lambdas to improve readability of a C++ function</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">lambda</span><span class="mr-2 badge badge-warning">readability</span></p><div class="entry-content"><p>I&#39;m looking to improve the readability of a lengthy C++ function. This function contains a number (&gt; a dozen) variables that are used throughout. The main logic of the code is a long list of condition checks (sometimes nested, sometimes with loops) followed by various actions. Because of the lengthy number of lines detailing the actions to be performed mixed in with the logical/looping glue, it can be quite hard to follow what&#39;s going on. There&#39;s no simple way to siphon off these actions into separate functions without arbitrary, ugly function signatures noting whatever subset of variables happen to be needed. One drastic solution might be to replace the function with a singleton class, with the function&#39;s variables and sub-actions becoming private member variables and private member. However, I&#39;m looking for a simpler alternative. My idea is to define a list of actions at the top of my function through lambda functions, and then below this perform the function&#39;s logic using these one-off lambdas. This would look something like (entirely schematically);</p><pre><code>void function() {
    // variables
    int a, b, c, d, ...;

    // actions to be performed
    auto func1 = [&amp;] () { ... code using a,b, etc. };
    auto func2 = [&amp;] () { ... };
    auto func3 = [&amp;] () { ... };
    ...

    // main logic
    if (&lt;condition 1&gt;) {
        if (&lt;condition 2&gt;)
            func1();
        else
            func2();
    } else {
        func2();
        func3();
    }
    ... // etc
}
</code></pre><p>These lambda functions would occasionally save code, in the the cases where they replace repeated code fragments, but would usually just improve readability &#8212; at least to my eyes. Is this a good practice in general? Do others find that this improves readability, and what is the cost of using these lambda functions?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h3>Does it improve readability ?</h3><p>Your way of using lambdas to break-down a larger function in smaller parts is similar to the <a href="https://en.wikipedia.org/wiki/Nested_function" rel="noreferrer">nested functions</a> in Pascal, ADA and other languages.</p><p>It indeed improves the readability of the main part of your function body:  there are less statements to read to understand what it does. This is the main purpose of nested functions.  Of course, I assume that nowadays, most programmers are familiar with the syntax of lambdas.</p><h3>However, is it a good idea ?</h3><p>Scott Meyers, in his book <em>Effective Modern C++</em> warns against the use of default capture in lambdas.  His main worry is about dangling references (e.g. if a lambda is defined in a block and is used out of the scope of this block when the variable doesn&#39;t exist anymore), which seems not to be an issue in your case.</p><p>But he also underlines another problem:  the illusion of having a self-contained function. And here lies the major weakness of your approach:</p><ul><li>you have the impression that your lambda is self contained, but in fact it&#39;s completely dependent of the rest of the code,  and you don&#39;t see easily in your lambda where the captured values are coming from, which assumptions you can make on them, etc...</li><li>as the link with the main body is based on the captured variables,  which can be read or written, it is in fact very difficult to guess all the side effects hidden in your lambda invocation, which could influence your main part.</li><li>so it&#39;s very difficult to identify assumptions and invariants in the code, both of the lambda, and of your mega function</li><li>in addition, you could accidentally change a variable that you forgot to declare locally in your lambda, and one happens to have the same name in the function.</li></ul><p><strong>First advice:</strong> at least, enumerate explicitly the variables captured by your lambda, in order to better control the potential side effects.</p><p><strong>Second advice:</strong> once this works, you could think of strengthening your structure further, by evolving from capture to parameter passing.  If there are too many of them, you&#39;d have to refactor.  One approach could be to make your function a callable class, promoting your throw away lambdas to member functions, and making the variables used throughout the computation member variables. But it&#39;s difficult to say if it&#39;s the best option from the elements you gave.</p><h3>And why are you in such a situation ?</h3><p>The next think to think about, is why you have such a big function in the first place.  If you&#39;d follow Uncle Bob&#39;s advice given in his book <em>Clean Code</em> (summary of the function topic on this <a href="http://www.itiseezee.com/?p=119" rel="noreferrer">blog page</a>) you should have:</p><ul><li>small functions,</li><li>that do one thing (single responsibility),</li><li>and that do only things at one level of abstraction</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-using-lambdas-to-improve-encapsulation/'>Object-oriented &#8211; Using lambdas to improve encapsulation</a></li><li class="list-group-item"><a href='../does-simplicity-always-improve-readability/'>Does simplicity always improve Readability</a></li><li class="list-group-item"><a href='../java-in-java-8-is-it-stylistically-better-to-use-method-reference-expressions-or-methods-returning-an-implementation-of-the-functional-interface/'>Java &#8211; In Java 8, is it stylistically better to use method reference expressions or methods returning an implementation of the functional interface</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>