<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>A manual and automated CSV file upload solution for a website &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073999 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073999" class="post-1073999 software type-software status-publish hentry category-software tag-api tag-asp-net tag-ftp tag-iis tag-windows"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">A manual and automated CSV file upload solution for a website</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api</span><span class="mr-2 badge badge-info">asp.net</span><span class="mr-2 badge badge-warning">ftp</span><span class="mr-2 badge badge-primary">iis</span><span class="mr-2 badge badge-danger">windows</span></p><div class="entry-content"><h1>Problem</h1><p>I run a website which has a requirement for a new feature &#8211; to enable users to upload CSV files into the website. The users will only ever need to upload 1 CSV file at a time, and only 1 or 2 CSV files per day on average. I get to define the file format of the CSV, so I will be specifying what the fields are and the data types of each field, but I don&#39;t know how many rows will be in the file and I don&#39;t know what the specific data will be either. You can assume the CSV file will never be bigger than 1MB in size.</p><p>The website already exists, however the feature to upload CSV files is still in the planning stages. The website currently enables users to login and manage their data (ie. it has privilege control at the user level) and its all managed through an SQL Server database. The website runs ASP.NET on IIS7.5 &#8211; this cannot be altered. The server is not NATed but it is firewalled. If you need more information about the website, please ask.</p><p>From the user&#39;s perspective, they will be generating the CSV file on their PC using their own programs. 99% of the time the CSV file it will be generated by some form of commerial software package. The choice of package is up to them &#8211; there are many products in the market that generate the kinds of CSV file they will be uploading to my website (I don&#39;t want to be too specific here, so that I can maintain my privacy and that of my users). Some users may even occasionally generate the CSV file by creating or editing it in notepad or MS Excel. I will certainly <a href="http://sqlblog.com/blogs/jamie_thomson/archive/2009/12/02/why-you-shouldn-t-open-csv-files-in-excel.aspx" rel="nofollow noreferrer">recommend that they never use MS Excel</a>, however what they do on their own PC is beyond my control.</p><p>There are two scenarios for users uploading the CSV file into my website:</p><p><strong>Manual upload</strong></p><p>A user logs-in to the website and uploads a CSV file</p><p><strong>Automatic upload</strong></p><p>The user somehow configures their CSV generating software and their PC to automatically upload CSV files to my website. I have no control over how they choose to do this, though I have spoken with some of my users and they have told me that their software is able to automatically generate the required CSV files into a directory (ie. the new CSV files appear in a directory about once a day without human intervention). They could then uploaded these CSV files automatically to my website by some form of client kicked off by a scheduled task (again, I have no control over the client the user chooses, though I can offer advise). This is by no means a requirement &#8211; they can do the steps I have described manually by clicking on their CSV-generating software, creating a file, and then manually running the client themselves to upload the CSV into my website if they want to. However the whole point of the automatic upload is that they can just leave it to run by itself so that IT support can use their time more productively.</p><p>The upload would generally be on a daily basis, but I will not be imposing any limits through my site on the number of uploads done per day. If they want to upload a new CSV file every hour then that&#39;s fine by me. However, from my discussions with users it sounds like a frequency of <em>daily</em> is going to be most convenient, and the time of day doesn&#39;t matter.</p><p>If the automatic CSV upload fails then my website will notify the user of this fact. I haven&#39;t decided exactly what form this notification will take yet since it really depends on the chosen solution. In the case where the upload fails due to the uploaded CSV file containing bad data then the user will need to manage this by exception (ie. a human will have to get involved &#8211; this is not something that software can fix). They will need to investigate the reason for the fault and correct the CSV file, probably by correcting the data in their database then using their software package to re-generate the CSV file. They can then upload the corrected CSV file at their leisure &#8211; uploads are not time-critical, and bad CSV files will be simply ignored by my website, rather than being partially loaded into my database.</p><h1>Functional requirements</h1><ol><li>Users must be able to upload files manually themselves through the website</li><li>Users must be able to upload files automatically at scheduled intervals from their own PCs</li><li>Only CSV files (or the equivalent data a CSV file contains) will be processed into my website&#39;s database</li><li>The entire process MUST occur without intervention from my IT support (and preferably their IT support too, though that may be out of my control, depending on other chosen solution)</li><li>The file upload process must not introduce any security risks that would not also be present when submitting data through a form in the website</li><li>On my website&#39;s side, the file upload permissions must be configurable on a per-user basis using either IIS, ASP.NET or a table in SQL Server and the firewall must not block the uploads</li><li>Whatever solution I implement must be well supported for at least the next 10 years into the future (as of 2016)</li><li>The chosen solution must use standard software that is already cheaply available to users (preferably at no cost)</li><li>There MUST be automatic feedback to the user when bad data is uploaded so they can correct it and re-upload. The shorter the time delay between uploading and receiving feedback the better.</li></ol><p>(If you think I&#39;ve missed some requirement for a manual or automated CSV-file-upload interface then please let me know in the comments and I can add these in)</p><h1>Some thoughts on <em>users uploading bad-data</em></h1><p>Its almost a certainty that users will upload CSV files containing bad data. This may not even be intentional eg. they might accidentally put integers in a <em>date-only</em> field for example. However it could also be intentional, such as malicious users uploading executable files containing malware. For this reason the CSV file should only ever be read and parsed, never executed.</p><h1>Solutions I have considered</h1><p>The manual upload via the website is trivial and is not really the focus of this question. Users would log in as they currently do, and upload the file via the standard <a href="https://stackoverflow.com/questions/8659808/how-does-http-file-upload-work">multipart/form-data</a> interface in their web-browser. Once the upload is processed then they would receive feedback of any errors or a success message, along with auditing to show the history of uploads.</p><p><em>However I am trying to decide between two possible solutions for the automated upload interface and I can&#39;t decide which meets my functional requirements better (they both meet functional requirements 2, 3 and 4 equally in my opinion):</em></p><p><strong>FTPS/SFTP</strong></p><p>During the sign-up process, the website code would create a directory for each user to upload files to. They would each have unique login credentials for the FTP and these would be listed on the website once a user is logged in.</p><p>A Windows service would constantly scan the directories and when it detected that a user had uploaded a new file then it would process this file into the database.</p><p>If a CSV file with incorrect data were uploaded then I would send an email to the user, warning them that their CSV-file-upload has failed. The user could then login to the website to check the specific errors in that file. They could then re-try the upload either manually via the website (multipart/form-data interface) or via FTPS/SFTP.</p><p>As part of the file-upload process <a href="https://stackoverflow.com/q/7241978/339874">the user would need to signal to my Windows service that the upload is complete</a>, either by renaming the uploaded CSV file, or by uploading a signal-file (eg. <code>csv-xyz.complete</code>) once the CSV file is uploaded.</p><p>Looking at this solution in light of the functional requirements&#8230;</p><ol start="6"><li><p><a href="http://www.iis.net/learn/get-started/whats-new-in-iis-7/what39s-new-for-microsoft-and-ftp-in-iis-7#00" rel="nofollow noreferrer">IIS can only handle FTPS, it cannot handle SFTP</a>. Also, SFTP runs on a single port, whereas FTPS runs on multiple ports, which is probably no good with my firewall (I will test and update this). Are there any SFTP programs which run outside IIS that can be configured via ASP.NET? Is it possible to set up SFTP/FTPS directories with .NET? <a href="http://www.sftp-net.com/" rel="nofollow noreferrer">At a glance it seems so</a>, however I would like to know if there are any limitations?</p></li><li><p>How likely is SFTP/FTPS to be around in 10 years? It seems like an extremely popular technology today, but I would like to know if it is about to be superseded or is going obsolete without my knowledge.</p></li></ol><p><strong>API</strong></p><p>The website already features an API, however this API does not currently have any file-upload capabilities. However, I could implement such a feature in an API and then users could upload the CSV-file data via this interface. The data would then never need to be placed into a CSV file at all &#8211; it would simply be security checked and sanity checked, then placed straight into the database.</p><p>Feedback to the user would be immediate &#8211; if any bad data is encountered then the response to the upload would contain an error message with specific details.</p><p>However it seems to me that it would require a lot of effort on the user&#39;s part to create the program to communicate with my API. I do not know of any standardized API file-upload clients to read a CSV and transmit the data to an API, though maybe some exist? If they do not then I doubt that many of my users would go to the effort of creating a whole new program just to upload a file to my website.</p><p>I have considered building a client and distributing it to users so that they can use it to upload CSVs via the API. But then raises a whole set of new problems &#8211; how would new releases be distributed? Would it be compatible with users&#39; PCs? Would we get lots of queries of the form &#34;its broken, how do I &#8230;&#34;? Would file permissions be a problem? Etc.</p><p>So again, looking at this solution in light of the functional requirements&#8230;</p><ol start="4"><li><p>If I were to develop an API client then IT support would probably get a lot of calls of the type &#34;how do I do x using <em>your</em> client&#34;. On the other hand if I did not design a client, then IT support would probably still get calls about the specifics of the API, and since these would be of a technical nature then I would probably have to respond-to and work closely-with the end-users myself to resolve these.</p></li><li><p>Would the API offer any security advantages not already available to SFTP/FTPS? The main difference would be that no CSV file would be uploaded, and so there would never be the possibility of someone loading malware onto the server (even if it is immediately detected as not being a CSV file and deleted).</p></li><li><p>This would definitely be compatible with IIS</p></li><li><p>If I were to create an executable client for users then this may become obsolete in future versions of Windows, and would probably not function on Mac or Linux. It is also an extra piece of code floating around that would require bugfixes and upgrades.</p></li><li><p>I am not aware of any standard for an API which implements a file upload. Google drive seems to have implemented one, but I don&#39;t know how widely accepted this is, and as far as I know they don&#39;t have a client which runs on a PC with access to the filesystem. If I don&#39;t develop an API client to give out to users then each user would be looking at weeks of development just to be able to upload a file into my website.</p></li><li><p>The feedback to the user is more immediate and probably more &#34;automatable&#34; from a user perspective. Its not very easy for a program to scan for emails indicating a fault has occurred, however it is easy to take action when a HTTP response contains an error.</p></li></ol><h1>In conclusion</h1><p>I&#39;m leaning towards SFTP/FTPS simply because it satisfies more of the functional requirements. However, it does depend a bit on my further research to answer the questions raised above. Answers or thoughts on these would be very welcome.</p><p>I&#39;m also after some advise from people who have already been there and tried one or both of these methods. What works well? What doesn&#39;t work? What are the non-obvious pitfalls? If you have no personal experience in this area but have links to where I can read up on this comparison then please post the links.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You want to connect two endpoints you cannot change - the file generation program, and the http or ftp endpoint, as your user sees it. And since there is no standard &#34;plug&#34;, you need to create one, which has to be a script or program. If you want this to be user-friendly, and not only usable by &#34;some IT experts&#34;, better bite the bullet and write and deploy a program.</p><p>You are not the first one who did this successfully, you can offer maintenance for every paying user (in fact, it is a motivation for your customers to pay for your service). If you write the program by yourself, it actually does not matter if your program uses ftp, ftps, sftp, or an http based api. For what you have in mind, you might also have a look on curl or libcurl. Consider to make your program cross-platform, either using Java, or Qt if you are a C++ guy.</p><p>Concerning this &#34;must be supported for at least the next 10 years&#34; - you are way IMHO too much thinking in terms of &#34;I do never want to be bothered by my users&#34; - better think in terms like &#34;lets offer the users a solution which works now, and support them (in return for some money) if the solution does not work any more in the future&#34;. I mean, Internet communication technologies are so widely used that chances are high that whatever you choose, if is not too exotic, it will be still supported in 10 years for reasons of backwards compatibility. But even if is not, it is not so a big deal as long as your company is still alive in that period and can provide support. Just provide an update of your program to your users using a different technology under the hood.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>