<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Php &#8211; random unique pair numbers from two range &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1072652 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1072652" class="post-1072652 software type-software status-publish hentry category-software tag-algorithms tag-php tag-random"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Php &#8211; random unique pair numbers from two range</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">PHP</span><span class="mr-2 badge badge-warning">random</span></p><div class="entry-content"><p>I want to write a function that return random unique pair numbers every time call it from a range until resetting it.<br /> Something like this:</p><pre><code>function randomUniquePairs($ranges, $reset = false){
   if ($reset === false){
      // some code for reseting
   }
   /*
     some code for creating random unique pair numbers
   */
   return $result;  
} 

randomUniquePairs(range(1,10), range(1,20));
/*
  this function returns for example:
   array(2,9)
*/
randomUniquePairs(range(1,10), range(1,20));
/*
  this function returns for example:
   array(5,19)
*/

randomUniquePairs(range(1,10), range(1,20));
/*
  this function returns for example:
   array(5,9)
*/
 //this function returns random unique pairs until we pass reset paramer true
</code></pre><p>I tried two approaches:</p><p><strong>Approach 1</strong><br /> My first attempt was to make an array of all of possible pairs then select from them randomly, but it is very inefficient, because if ranges are so wide, it consumes a lot of memory.<br /> the code:</p><pre><code>  class a {
    private $asqar;

    function __construct() ($range) {

        // cycle for ranges
        foreach ($range[0] as  $v1) {
            foreach ($range[1] as $v2) {
                $asqar[] =  array(
                    $v1,
                    $v2,
                );
            }
        }
    }

    function randomUniquePairs($reset = false){

        if ($reset === true){
           $this-&gt;asgar = array();
        }

        $rndKey = array_rand($this-&gt;asgar);
        $result = $this-&gt;asqar[$rndkey];
        unset($this-&gt;asqar[$rndkey]);
        return $result;
    }
}

$c = new a(range(1,10), range(1,20));
$c-&gt;randomUniquePairs();
</code></pre><p><strong>Approach 2</strong><br /> My second attempt was to write a function that produce a pair from these ranges, then store it in a variable, every time that function calls after producing a pair , it checks if this pair produced before call function recursively, it continues until it produce a unique pair.<br /> Here&#39;s the code:</p><pre><code>class a{ 

    private $__uniqueVariables = array();

    public function randomUniquePairs($range, $reset = false) {

        if ($reset === true){
       $this-&gt;__uniqueVariables = array();
    }

    // cycle for each value
    foreach ($range as $value) {

        // shuffle
        shuffle($value);

        // selected id
        $selectedId[] = $value[0];
    }

    // check for selected variable
    if (in_array($rndUnqNum, $this-&gt;__uniqueVariables)) {

        // return for try again
        return $this-&gt;uniqueVariable($range);
    }

    // added to current unique variables
    $this-&gt;__uniqueVariables[] = $rndUnqNum;

    // return
    return $rndUnqNum;
}

}
</code></pre><p>but this second approach has an issue that sometimes throw <code>Fatal error: Maximum function nesting level of &#39;100&#39; reached</code>.</p><p>I&#39;m looking for a better approach to my algorithm.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Something you need to determine is how &#39;fair&#39; you want this to be and the performance as the unused space becomes exhausted.</p><p>In essence, you want a random box from a N dimensional array.  Its not the box itself that is important, but the location of the box that is important.</p><p>Under the covers, a 10x20 array is often represented as a 1x200 array with some math behind it to access the right spot.  If you were to access <code>[5][13]</code>, you are actually accessing location <code>[5*20 + 13]</code>.  You can use the same approach to go from a number back to the position.  Location 113 goes to the integer devision by 20 and remainder giving <code>5 r13</code>.</p><p>So now, you don&#39;t need to actually store 200 pairs (though that isn&#39;t a lot), you just need a bitfield of 200 bits long.  Generate a random number within the proper range and mark it as used in the bitfield.</p><p>Now, the question of how do you handle it when you&#39;ve got a collision?  This goes to the various hash collision techniques used in <a href="http://en.wikipedia.org/wiki/Hash_table#Collision_resolution" rel="nofollow">hash tables</a>.  Some won&#39;t work for this application, but its a good read nonetheless.</p><p>A simple approach would be once you have one collision, just start incrementing where you are looking at until you find one that wasn&#39;t used.  The increment could be 1, or any number that is <a href="http://mathworld.wolfram.com/RelativelyPrime.html" rel="nofollow">relativity prime</a> to the size of the space.</p><hr/><p>Ok, I&#39;m at a place I can sit down and write something.  Its perl.  Shouldn&#39;t be too far off of php and is rather straight forward.</p><pre><code>#!/usr/bin/perl

my $x = shift @ARGV;
my $y = shift @ARGV;
my $f = shift @ARGV; # fill factor
my $t = $x * $y;    # total space
my $v = &#39;&#39;;

foreach (1 .. int($t * $f)) {
    my $r = int(rand($t));  # random number from 0 .. $t-1
    my $yp = int($r / $x); # y&#39; (y prime)
    my $xp = int($r % $x); # x&#39; (x prime)

    print &#34;Trying $r: $xp $yp...\n&#34;;
    while(vec($vec, $r, 1)) {
        $yp = int($r / $x);
        $xp = int($r % $x);
        print &#34;\tcollision at $r: $xp $yp\n&#34;;
        $r += 1;
        $r %= $t;   # scale $r to within $t
    }
    $yp = int($r / $x);
    $xp = int($r % $x);
    vec($vec, $r, 1) = 1; # set the $r th bit
    print &#34;\tsettled at $r: $xp $yp\n&#34;;
}
</code></pre><p>Ultimately, the &#39;settled&#39; values are the ones that you want.</p><p>You read two numbers from the command line and assign them to <code>x</code> and <code>y</code>.  The total search space is <code>t</code> - this is how big all the possible numbers are.  Additionally, read a fill factor as <code>$f</code>, this should be a value less than 1 and is used to limit the list iteration.  Setting a value greater than 1 will present an infinite loop.</p><p>I&#39;m filling up the space to the specified value (the <code>foreach (1 .. ($t * $f))</code>). No, there isn&#39;t any error checking on <code>$f</code> to make sure it is less than or equal to 1, but there should be.</p><p>So pick a random number from 0 to <code>$t</code> - 1.  The spot that this represents is <code>$yp</code> and <code>$xp</code> - y prime and x prime.</p><p>There is some perlish things here, <a href="http://perldoc.perl.org/functions/vec.html" rel="nofollow">vec</a> works with a bit vector of arbitrary size.  There are a number of ways of doing this in a given language, its just rather easy with perl.  With Java, one could use a <a href="http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html" rel="nofollow">BitSet</a> (this is big enough to hold maxint bits, which could represent a pair of 46340 numbers).</p><p>You then test the bit at the <code>$r</code>th location to see if it has been used.  If it has, increment <code>$r</code> and roll it over if it becomes larger than the total space (so if you have a 10 and 20 (0 .. 199) and you hit 200, it becomes 0).</p><p>Once you find an unused bit, set it and output your values.</p><p>This is what the output looks like though:</p><pre><code>Trying 96: 6 9...
        settled at 96: 6 9
Trying 117: 7 11...
        collision at 117: 7 11
        settled at 118: 8 11
Trying 115: 5 11...
        settled at 115: 5 11
Trying 153: 3 15...
        settled at 153: 3 15
Trying 90: 0 9...
        settled at 90: 0 9
Trying 140: 0 14...
        collision at 140: 0 14
        collision at 141: 1 14
        collision at 142: 2 14
        settled at 143: 3 14
Trying 73: 3 7...
        settled at 73: 3 7
</code></pre><p>This is tested on a unix system thus:</p><pre><code>% rndpair.pl 10 20 0.5 | grep settled | sort | uniq | wc -l
     100
</code></pre><p>This shows that with 100 numbers there are 100 unique pairs printed out (just look at the &#39;settled&#39; lines).</p><p>There&#39;s a fair bit of debugging information in there (you don&#39;t really need to keep resetting the value of <code>$yp</code> and <code>$xp</code> until the end.</p><p>And then there&#39;s the question of how fast is it?  This is to generate 50% of the available pairs for the available space.  Realize that there is some time tied up in the sort and uniq (of possibly some not small bits of text):</p><pre><code>% time ./rndpair.pl 500 500 0.5 | grep settled | sort| uniq | wc -l
  125000

real    0m3.528s
user    0m3.901s
sys     0m0.045s
</code></pre><p>Lets kick it up a notch and remove the other applications from the chain.</p><pre><code>% time ./rndpair.pl 5000 5000 0.5 &gt; /dev/null

real    0m34.668s
user    0m34.482s
sys     0m0.180s
</code></pre><p>How much room did that 5k x 5k storage space take?  25,000,000 bits, or about 3 megabytes.</p><p>Note that the performance of this drops as the fill factor goes up. For a search space of 6, 80610 (a previous comment if I read it right) this runs quite quickly (note the increasing times as the fill factor goes up):</p><pre><code>% time ./rndpair.pl 6 80610 0.5 | grep settled | wc -l
  241830

real    0m0.827s
user    0m1.562s
sys     0m0.029s
% time ./rndpair.pl 6 80610 0.75 | grep settled | wc -l
  362745

real    0m1.721s
user    0m3.151s
sys     0m0.043s
% time ./rndpair.pl 6 80610 0.9 | grep settled | wc -l
  435294

real    0m3.993s
user    0m7.031s
sys     0m0.079s
</code></pre></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-of-inherently-random-non-deterministic-algorithms/'>Unit-testing of inherently random/non-deterministic algorithms</a></li><li class="list-group-item"><a href='../unit-testing-how-should-i-test-randomness/'>Unit-testing &#8211; How should I test randomness</a></li><li class="list-group-item"><a href='../algorithmic-problem-combining-overlapping-ranges/'>Algorithmic problem &#8211; Combining overlapping ranges</a></li><li class="list-group-item"><a href='../how-does-pearson-hashing-compare-with-other-non-cryptographic-hashing-algorithms/'>How does Pearson hashing compare with other non-cryptographic hashing algorithms</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>