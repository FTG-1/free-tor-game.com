<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Understanding DDD when using an ORM such as Hibernate &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079164 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079164" class="post-1079164 software type-software status-publish hentry category-software tag-domain-driven-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Understanding DDD when using an ORM such as Hibernate</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">domain-driven-design</span></p><div class="entry-content"><p>I&#39;ve reading about Domain Driven Design and Anemic models.</p><p>I generally work with an ORM such as Hibernate, and I&#39;m struggling to understand in DDD what a business model can and can&#39;t do.</p><p>For example, if I have a Customer object, I would need to pass this off to a Service class in order to have it persisted to the database as it&#39;s not advised that you inject your ORM classes (repositories) into the domain model, I&#39;m fine with this.</p><p>The issue comes when I want to check that a Customer object is valid, some recommend that the Customer object must know this, but in order to know it needs to query your datasource to check for other matching customers (i.e. via the email address).</p><p>It seems that behaviour needs to be on the Customer object itself, but what do you do when the behaviour requires data from the database? Do you pass that behaviour off to a Domain Service class?</p><p>EDIT:</p><p>Or, to put it another way, lets say we have a Customer and Film, on the Customer object we have a behaviour watch(Film). There&#39;s a business rule that states that a customer can only watch one new film per month. I would place a rule in the watch(Film) method to handle this. The problem is that the Customer object would need to access the datasource to get a list of all films the user has watched, determine how many have been watched and also check to see if the current film is one of them, and if so allow it to be watched as it&#39;s not a new film to the Customer, how would it do that?</p><p>a) when you create the Customer object, create properties to store a list of films watched this month<br /> b) create a Service class to handle this rule so it can query the data source on the fly rather than having the data leaded eagerly?</p><p>With option a), I&#39;d be concerned about bloating the Customer object will data that is only required for a single specific use case, and it seems sensible to me to only grab the data required when it&#39;s actually required.</p><p>This is a hypothetical situation, I&#39;m trying to understand how to apply domain driven design.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Your understanding of the problem in terms of DDD is being obfuscated by your focus on your data model (database) instead of the behavior of the system (domain).</p><p>To reiterate, the purpose of DDD is to model the <em>behavior</em> of a system such that the result is a useful abstraction of its functional requirements. What the above means is that a properly designed domain is modeled according to the behavior of the system, not the data. The single biggest pitfall developers run into when embarking on DDD is to start by using a data model as a domain model, because the data is hardly ever a good starting point when trying to model a system’s functional requirements.</p><p>What does the above mean? It means that you need to slice up your data model <em>vertically</em> according to behavior. In practical terms, it means that it is unlikely that there will be a domain entity named <code>Customer</code>. The reason is because <code>Customer</code> doesn’t denote much behavior and likely contains too much knowledge. What do your <code>Customers</code> do? Buy things? <code>Buyer</code>. View things (this one’s for you)? <code>Viewer</code>. Manage a website account? <code>AccountManager</code>. You get the idea.</p><p>The point is that the properties of the above domain entities do not necessarily map directly to a single database table (and in some cases use fields from the same table). Each <code>Buyer</code> might have a collection of previous <code>OrderReceipts</code>. Each <code>Viewer</code> has a collection of <code>Screenings</code> containing details like <code>MovieId</code>, <code>Location</code>, <code>Datetime</code>, <code>DeviceId</code>, etc for each time they watched something. And <code>AccountManager</code> might have <code>Username</code> and <code>Password</code>. And ALL of the above might have the same <code>CustomerId</code>.</p><p>The most important thing to understand about the above entities is that each one represents the single and unambiguous authority responsible for protecting invariants that may apply to the data for which it holds. Follow that rule and you are golden.</p><p>In your case, a <code>Viewer</code> is just an aggregate responsible for protecting your viewership rules. It contains just enough extra data necessary to enforce your business rules. In this case a collection of <code>Screening</code> value objects from the last month (or maybe even less data <code>ScreeningCount</code>). Does that make sense?</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-does-ddd-make-sense-for-apps-which-mostly-present-data/'>Architecture &#8211; Does DDD make sense for apps which mostly present data</a></li><li class="list-group-item"><a href='../where-should-business-logic-go-in-a-layered-architecture/'>Where should business logic go in a layered architecture</a></li><li class="list-group-item"><a href='../n-elegant-way-to-check-unique-contraints-on-domain-object-attributes-without-moving-business-logic-into-service-layer/'>N elegant way to check unique contraints on domain object attributes without moving business logic into service layer</a></li><li class="list-group-item"><a href='../why-not-use-an-orm-with-ddd/'>Why not use an ORM with DDD</a></li><li class="list-group-item"><a href='../c-where-should-i-put-validation-logic-when-using-cqrs/'>C# &#8211; Where should I put Validation Logic when using CQRS</a></li><li class="list-group-item"><a href='../is-domain-persistence-model-isolation-usually-this-awkward/'>Is domain/persistence model isolation usually this awkward</a></li><li class="list-group-item"><a href='../how-to-handle-a-many-to-many-relationship-with-an-orm-mapped-to-a-domain-model-when-there-are-no-technical-constraints/'>How to handle a many to many relationship with an ORM mapped to a Domain Model when there are no technical constraints</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>