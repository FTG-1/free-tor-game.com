<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>The best way to allow a user to specify a SQL server and database from a Windows application &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076807 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076807" class="post-1076807 software type-software status-publish hentry category-software tag-sql-server tag-winforms tag-wpf"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">The best way to allow a user to specify a SQL server and database from a Windows application</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">sql server</span><span class="mr-2 badge badge-info">winforms</span><span class="mr-2 badge badge-warning">wpf</span></p><div class="entry-content"><p>I am working on building a Windows application that will require a connection to at least two different Microsoft SQL Server databases (for example, a source and a target), which may or may not be on the same server.</p><p>So, in the application settings, I would like the user to be able to specify both the server(s) involved, as well as the source and target databases. I did a little bit of research and immediately found this article on Code Project:</p><p><a href="http://www.codeproject.com/Articles/31826/SQL-Server-Authentication-using-SMO" rel="nofollow">http://www.codeproject.com/Articles/31826/SQL-Server-Authentication-using-SMO</a></p><p>It uses something I wasn&#39;t previously aware of called, SQL Server Management Objects:</p><p><a href="http://msdn.microsoft.com/en-us/library/ms162169(v=sql.105).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms162169(v=sql.105).aspx</a></p><p>Anyway, I am wondering if SMO is the best way to handle establishing connections to data sources that are not known to me, but will be known by the user of the application. Part of the reason I am asking is that most information I am finding seems to be from roughly 5 years ago and want to make sure there isn&#39;t a better way to do this today.</p><p>Technical Details: I am looking at building it with Windows Forms or as a WPF application and will be dealing with Microsoft SQL Server 2008 R2 and up (likely 2012 and potentially 2014).</p><p>Thank you in advance for any advice, thoughts, or suggestions.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>If you want to allow users to discover servers/databases on the network SMO is the way to go. If you just want to allow them to enter known (to them) connection information, just collect the information in a form and use a <a href="http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder(v=vs.110).aspx" rel="nofollow">SqlConnectionStringBuilder</a>. <a href="http://weblogs.asp.net/psheriff/using-the-connectionstringbuilder-class" rel="nofollow">Here is a nice article</a> showing how to use it</p><pre><code>using System.Data.SqlClient;

private void CreateConnectionString()
{
  SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder();

  builder.DataSource = &#34;(local)&#34;;
  builder.InitialCatalog = &#34;Northwind&#34;;
  builder.UserID = &#34;user1&#34;;
  builder.Password = &#34;P@ssw0rd&#34;;

  MessageBox.Show(builder.ConnectionString);
}
</code></pre><blockquote><p>This is a pretty easy class to use. You can just fill in the basic information such as the DataSource, InitialCatalog, the UserId and
 Password and it will create a connection string for you. The output
 from the above code will be: &#34;Data Source=(local);Initial
 Catalog=Northwind;User ID=user1;Password=p@ssword&#34;.</p><p>To add on additional keywords for your connection string you may use
 the Add method. This method takes the keyword and the value and will
 add them in the appropriate format to your connection string.</p><p>As mentioned, each ADO.NET data provider supplies one of these
 classes. For example, if you are using Oracle, you would use the
 System.Data.OracleClient namespace, then use the
 OracleConnectionStringBuilder.</p><p>The ConnectionStringBuilder class allows you to parse the individual
 elements of a connection string and put them into the corresponding
 properties in the ConnectionStringBuilder. In the following example
 you take an existing connection string like the one shown in the code
 below and place it into the ConnectionString property of the
 ConnectionStringBuilder. The ConnectionStringBuilder will then break
 it into the appropriate properties.</p></blockquote></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../are-there-any-special-advantages-of-sql-server-with-visual-studio/'>Are there any special advantages of SQL Server with Visual Studio</a></li><li class="list-group-item"><a href='../database-at-least-one-database-view-per-database-table-is-this-good-or-bad-design-and-why/'>Database &#8211; At least one database view per database table-Is this good or bad design and why</a></li><li class="list-group-item"><a href='../database-storing-application-users-in-sql-create-a-new-users-table-or-use-built-in-database-user-management/'>Database &#8211; Storing application users in SQL: create a new &#8220;Users&#8221; table or use built-in database user management</a></li><li class="list-group-item"><a href='../running-sql-server-express-on-micro-extra-small-vm/'>Running SQL Server Express on Micro/Extra Small VM</a></li><li class="list-group-item"><a href='../c-is-entity-framework-6-agnostic-enough-different-sql-server-and-os-platforms/'>C# &#8211; Is Entity Framework 6 agnostic enough different sql server and OS platforms</a></li><li class="list-group-item"><a href='../sql-scripts-in-tfs-without-putting-them-into-solutions/'>SQL scripts in TFS without putting them into solutions</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>