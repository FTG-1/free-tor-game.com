<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Benefits of RTOS vs Bare Metal for MCU Programming &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066656 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066656" class="post-1066656 software type-software status-publish hentry category-software tag-arm tag-c tag-operating-systems tag-real-time"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Benefits of RTOS vs Bare Metal for MCU Programming</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">arm</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">operating systems</span><span class="mr-2 badge badge-primary">real time</span></p><div class="entry-content"><p><strong>Please note:</strong> This question specifically mentions two RTOSes but is more generic and can probably be answered by anybody who has written C code for embedded RTOSes before, and had their software run directly on MCUs.</p><p>I am interested in learning more about embedded RTOSes and writing applications for them. I am currently looking at <a href="https://github.com/embox/embox">Embox</a> and <a href="http://www.riot-os.org/">RIOT</a> because they&#39;re open source, modern, active and seem to have excellent documentation. My goal has two phases: Phase 1 is to figure out how to compile and flash these OSes to an MCU (probably AVR or ARM). Phase 2 is to then write a simple C program (basically a headless daemon), that would evolve over time as a &#34;hobby app&#34;. I would then flash/deploy this program to the same MCU, thereby successfully deploying an appstack consisting of Embox/RIOT and my app residing on top of it.</p><p>Before I go down any roads that ultimately lead to dead ends, I stumbled across <a href="https://www.raspberrypi.org/forums/viewtopic.php?f=72&amp;t=10850">this article</a> that does a pretty good job of explaining why real-time apps, written in C/assembler and flashed to MCUs, don&#39;t <em>really</em> need RTOSes underneath them.</p><p>So now I&#39;m really confused, and am questioning some of my fundamental understanding of computing theory. I guess I&#39;m trying to make the decision of whether or not to even use Embox/RIOT in the first place, either:</p><ul><li>Stay the course and go with an &#34;app stack&#34; on the MCU of both OS + app; or</li><li>Heed the article&#39;s warning and just go with an MCU running my app &#34;bare metal&#34;</li></ul><p>Obviously, the former is more work, and so there had better be a good reason/payoff for going that route. So I ask: what are the <strong>real benefits</strong> these (and similar) embedded RTOSes offer to MCU/C app developers? What specific features could my C app benefit from (perhaps by not reinventing the wheel?) by using an RTOS? What is lost by ditching the RTOS and going bare metal?</p><p><strong>I&#39;m asking for concrete examples here, not the media hype you get when you go to the wikipedia entry for RTOSes ðŸ˜‰</strong></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Microcontroller programs consist of a number of <em>tasks</em>.  Let&#39;s say you wanted to make a computer-controlled telescope mount.  The tasks would be:</p><ul><li>Retrieve a new byte of input from the USB serial buffer.</li><li>Check if we&#39;ve received a complete command.</li><li>If so, execute that command.</li><li>Read the sensors for the current telescope position.</li><li>Set the proper output to control the next step of the motors.</li></ul><p>This is a fairly typical set of tasks for something you would use a microcontroller for, and are pretty easy to manage with an infinite loop, like:</p><pre><code>while(TRUE) {
  uint8_t input = readUsbBuffer();
  parseCommand(input);
  readSensors();
  setMotors();
}
</code></pre><p>If you keep adding and adding features, you eventually start coming across common problems you want to create abstractions for, like:</p><ul><li>Your buffer is overflowing, so you want to make sure that task can interrupt other tasks before it overflows.</li><li>You want to save battery by sleeping when nothing is needed.</li><li>You want to make sure all tasks get a fair shot.  If <code>readSensors</code> takes too long, you want to be able to interrupt it and come back to it later.</li><li>You want to be able to just reset one task without affecting others.</li><li>You want a memory leak or other bug in one task to not take out the other tasks.</li><li>You want to be able to give different tasks different priorities.</li><li>You want to be able to sandbox an untrusted task.</li><li>You want to be able to execute tasks at different rates.  Perhaps your sensors can only be read 10 times per second, but you want to execute a motor step 100 times per second.</li></ul><p>One or two of these items can be handled manually relatively easily.  If you have enough of these kinds of problems frequently enough that you start generalizing them into libraries, you&#39;ve basically reinvented an RTOS.  If your program&#39;s task management is complex enough, even if you don&#39;t use an off-the-shelf RTOS, you will eventually end up reinventing one poorly.</p><p>However, in my experience, the line where you want an RTOS is very close to the line where you want a microprocessor instead of a microcontroller.  If you anticipate your firmware getting that complex, it&#39;s usually better to go the microprocessor route from the beginning.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../what-are-the-advantages-of-programming-to-under-an-os-as-opposed-to-bare-metal-executive/'>What are the advantages of programming to under an OS as opposed to bare metal executive</a></li><li class="list-group-item"><a href='../virtual-machine-for-a-high-level-programming-language-vs-an-operating-system/'>Virtual machine for a high level programming language vs an operating system</a></li><li class="list-group-item"><a href='../compiling-and-deploying-a-c-program-to-an-mcu-running-an-rtos/'>Compiling and deploying a C program to an MCU running an RTOS</a></li><li class="list-group-item"><a href='../java-cross-compiling-java-app-to-run-directly-on-arm/'>Java &#8211; Cross-compiling Java app to run directly on ARM</a></li><li class="list-group-item"><a href='../c-programming-advantages-and-disadvantages-of-using-opaque-pointers-for-structure-handling/'>C programming &#8211; Advantages and disadvantages of using opaque pointers for structure handling</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>