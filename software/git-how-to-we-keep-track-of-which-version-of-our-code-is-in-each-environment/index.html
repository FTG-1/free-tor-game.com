<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Git &#8211; How to we keep track of which version of our code is in each environment &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070802 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070802" class="post-1070802 software type-software status-publish hentry category-software tag-deployment tag-development-environment tag-development-process tag-git tag-version-control"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Git &#8211; How to we keep track of which version of our code is in each environment</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">deployment</span><span class="mr-2 badge badge-info">development-environment</span><span class="mr-2 badge badge-warning">development-process</span><span class="mr-2 badge badge-primary">git</span><span class="mr-2 badge badge-danger">version control</span></p><div class="entry-content"><p>My team currently uses a fairly simple branching/deployment process that looks like this:</p><pre><code>                ┌────────┐ ┌────┐ ┌──────┐
 Environments:  │  DEV   │ │ QA │ │ PROD │
                └────────┘ └────┘ └──────┘

                     ▲       ▲       ▲
                     │       │       │

                ┌────────┐ ┌────┐ ┌──────┐
 Builds:        │  DEV   │ │ QA │ │ PROD │
                └────────┘ └────┘ └──────┘

                     ▲       ▲       ▲
                     │       │       │

                ┌────────┐ ┌────┐ ┌──────┐
 Branches:      │ master │ │ qa │ │ prod │
                └────────┘ └────┘ └──────┘
</code></pre><p>Each environment has its own branch (we use <a href="https://git-scm.com/">git</a>) and its own build that uses that branch.  When we want to promote from one environment to another, for example, from DEV to QA, we merge the <code>master</code> branch into <code>qa</code> and kick off a new QA build (which is then automatically deployed to the QA environment).</p><p>We&#39;re considering moving to a new process that would do away with having a dedicated branch and build for each environment.  Instead, a single release build would create a &#34;deployment package&#34; which could then be deployed to any environment.  We&#39;re imagining a typical workflow would look something like this:</p><pre><code>                ┌────────┐     ┌────┐     ┌──────┐
 Environments:  │  DEV   │ ──► │ QA │ ──► │ PROD │
                └────────┘     └────┘     └──────┘

                      ▲ 
                       \ 

                        ┌───────────────┐
 Builds:                │ release build │
                        └───────────────┘

                                ▲
                                │

                ┌────────┐ ┌─────────┐
 Branches:      │ master │ │ release │
                └────────┘ └─────────┘
</code></pre><p>Promoting from one environment to another would no longer be handled in source control; rather, we&#39;d just take the already-built binaries (the &#34;deployment package&#34;) and drop that on the new environment.</p><p>This new system would allow us to deploy any build to any environment, which has several advantages. For example, it&#39;s trivial to test PROD bug fixes in DEV and QA.  Our current system doesn&#39;t provide an easy way to do this without rolling back a branch, which we&#39;d obviously like to avoid.</p><p>The biggest drawback with this new system is that we no longer have an automatic way of tracking what code is in which environment.  If we need to make a fix in PROD, we no longer have a dedicated branch in sync with the current production codebase.  The same goes for QA &#8211; if we want to push a quick change to QA without dredging up in-progress work from <code>master</code>, we no longer have a branch that reflects the current state of the QA environment.</p><p><strong>How can we keep track of what code is in each environment?</strong></p><p>Some options we&#39;re considering:</p><ul><li>utilizing <a href="https://git-scm.com/book/en/v2/Git-Basics-Tagging">git tags</a> to keep track of which commit is in which environment</li><li>embedding the git commit used by the build into each deployment package</li></ul></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Git tags are what you really want to use to designate releases. The reason is that they have meaning to you and can be used to quickly recognize the linkage between the state deployed code and any information that the build server may have (such as build number).</p><p>While that is the answer you are looking for, it only solves half the problem. The other is &#34;hey, here&#39;s the deployed <code>.[wje]ar</code> on the server, what build did it come from?&#34;  We know that you&#39;ll never have different versions of the application deployed on dev and qa or prod. Right?</p><p>The solution to that part of the question is to have the build server put the information into the manifest.  Coming from a maven and svn example that I have in front of me:</p><pre><code>&lt;manifestEntries&gt;
    &lt;Specification-Title&gt;${project.name}&lt;/Specification-Title&gt;
    &lt;Specification-Version&gt;${project.version}&lt;/Specification-Version&gt;
    &lt;Build-Number&gt;${build.number}&lt;/Build-Number&gt;
    &lt;Build-Id&gt;${build.id}&lt;/Build-Id&gt;
    &lt;Svn-Revison&gt;${svn.revision}&lt;/Svn-Revison&gt;
&lt;/manifestEntries&gt;
</code></pre><p>That&#39;s in the maven-war-plugin archive configuration. But you can find it in other plugins too.  Then in Hudson, part of the maven build invocation is:</p><pre><code>-Dbuild.number=${BUILD_NUMBER}
-Dsvn.revision=${SVN_REVISION}
-Dbuild.id=${BUILD_ID}
</code></pre><p>which sets those defines that then maven picks up.  And then its just a matter of looking in the MANIFEST.MF file that has been deployed on the server to see what version it is.</p><p>There&#39;s a <a href="https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin">git plugin</a>, that offers a similar set of environment variables including:</p><ul><li><code>GIT_COMMIT</code> - SHA of the current</li><li><code>GIT_BRANCH</code> - Name of the remote repository (defaults to origin), followed by name of the branch currently being used, e.g. &#34;origin/master&#34; or &#34;origin/foo&#34;</li></ul><p>The combination of these two practices allows you to easily identify the build (because build numbers go forward, and have meaning, unlike sha checksums) and the specific git commit that it is built from.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../source-control-branch-design-for-deployed-environments/'>Source control branch design for deployed environments</a></li><li class="list-group-item"><a href='../git-branching-strategy-for-long-running-unreleased-code/'>Git branching strategy for long-running unreleased code</a></li><li class="list-group-item"><a href='../web-development-best-way-to-manage-git-branches-in-different-environments/'>Web-development &#8211; Best way to manage Git branches in different environments</a></li><li class="list-group-item"><a href='../feature-based-deployment-with-multiple-environments/'>Feature-based Deployment with Multiple Environments</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>