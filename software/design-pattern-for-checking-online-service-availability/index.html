<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; Pattern for checking online service availability &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1081666 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1081666" class="post-1081666 software type-software status-publish hentry category-software tag-client-server tag-design tag-polling tag-web-services"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; Pattern for checking online service availability</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">client-server</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">polling</span><span class="mr-2 badge badge-primary">web services</span></p><div class="entry-content"><p>I&#39;m not sure that this is entirely on-topic, but I&#39;ll try to make it so.</p><p>I have an online service (API) and an Android application that uses it for <em>all actions in the app</em>. At the current moment, nothing is stored locally, so I have to depend on the API being online, and would like to warn the user when it&#39;s not (for whatever reason).</p><p>I&#39;m wondering what the preferred method of checking availability is. As this is the first time I&#39;ve ever done this, I&#39;ve tried to do my research and have come up with three potential solutions:</p><h2>1. Check availability on action</h2><p>When the user takes an action, check the API&#39;s status. Currently I&#39;m doing this (Java):</p><pre><code>public class ServiceAvailability implements Runnable {

    private volatile boolean available;

    @Override
    public void run() {

        available = false;

        try {
            HttpURLConnection connection =
                    (HttpURLConnection) new URL(&#34;http://myservice.com&#34;).openConnection();
            connection.setConnectTimeout(3000);
            connection.setReadTimeout(1000);
            connection.setRequestMethod(&#34;HEAD&#34;);

            int responseCode = connection.getResponseCode();

            if (200 &lt;= responseCode &amp;&amp; responseCode &lt;= 399) {
                available = true;
            }
        } catch (IOException exception) {
            exception.printStackTrace();
        }
    }

    public boolean isAvailable() {

        return available;
    }
</code></pre><p>It works just fine. Just send a HTTP HEAD request to the site and see if the response is a good one. Every time the user takes an action (e.g., runs a search, clicks someone&#39;s profile, etc.) it calls the <code>isAvailable()</code> method, and displays an error message in the event that the <code>available = false</code>.</p><p>The advantage of this is that if the service goes down, the user will immediately know, and will be warned that they will not be able to use the app until the service is brought online again.</p><p>I can&#39;t think of any disadvantages of this at the moment&#8230;</p><h2>2. Check availability on interval</h2><p>The other solution (that I haven&#39;t actually implemented) is run a thread in the background and HTTP HEAD the service every <code>X</code> seconds/minutes and update the status accordingly; at that point, I could call <code>isAvailable()</code> which would simply return the boolean set by the result of the HEAD request.</p><p>The advantage to this is that a visual can be shown (for the duration) when the service is not online, letting the user know ahead of time that their request will not be processed.</p><p>The disadvantage that I see is that while HEAD requests are very minimal in the amount of bandwidth they use, 3G users with very little data or users with slow connections might have trouble sending the HEAD and receiving the response in a timely manner.</p><h2>3. Combine the two</h2><p>The last approach that I see is a combination, where the thread in the background checks availability every <code>X</code> seconds, and action methods using the API also check availability through an additional HEAD request.</p><p>The advantage that I see here is that the user will know (visually) when the service is offline for the duration, as well as have a fallback if the status of the API happens to change during the <code>X</code> seconds duration that the API was last checked.</p><p>From what I can see, the Facebook Messenger app (iOS at least) implements this. When you open the app, it &#39;attempts to connect&#39; (visual up top) and if your connection drops, it will let you know with a bright red visual. Trying to take action when you&#39;re not connected (to their service) also gives you an error.</p><h2>Question</h2><p>Is there a single one of these 3 methods that are preferable, or a different method that I haven&#39;t mentioned? Furthermore, is there an actual design pattern for this (e.g., Singleton on a thread), one more preferable than what I&#39;ve implemented?</p><p><strong>Edit</strong>: As a user of the app myself, I feel that a pretty visual telling me that I won&#39;t be able to do something before I actually <em>try</em> is better than trying and failing. Furthermore, I want to implement this in order to determine more than just an &#39;up&#39; or &#39;down&#39; status of the API. For example, when the API is in maintenance for an update, I want to be able to receive a <code>503</code> and let the user know visually that the service is in maintenance mode, will be online shortly, and not to panic.</p><p>I&#39;m not exactly sure how many users will be using the app in the long run, so I&#39;m trying to prepare ahead of time in the event of API outages and maintenance. I don&#39;t have a large-scale infrastructure that can support millions of users like Facebook, so I believe that this availability check is reasonable in order to provide good (decent?) user experience, as I know for a fact that the API will not have 100% up-time. Not to mention that I&#39;m the sole developer and the service might go down while I&#39;m sleeping!</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I would Check Availability on <strong>Failed</strong> Action.  Just issue your calls normally and if you get a failure, then call the Service Availability function to verify.</p><p>Assume service is up, if one gets and error, then issue the additional call to verify availability.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../design-client-server-connection-response-timeout-issues/'>Design &#8211; Client-Server connection response timeout issues</a></li><li class="list-group-item"><a href='../c-best-approach-for-propagating-errors-in-service-access-layer-of-a-multiplatform-mobile-app/'>C# &#8211; Best approach for propagating errors in service access layer of a multiplatform mobile app</a></li><li class="list-group-item"><a href='../design-how-to-check-if-app-is-offline/'>Design &#8211; How to check if app is offline</a></li><li class="list-group-item"><a href='../architecture-for-oauth2-backendserver-frontendserver/'>Architecture for OAuth2 &#8211; BackendServer &#8211; FrontendServer</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>