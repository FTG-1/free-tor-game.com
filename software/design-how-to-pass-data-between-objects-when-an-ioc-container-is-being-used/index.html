<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; How to pass data between objects when an IoC container is being used &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1080776 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1080776" class="post-1080776 software type-software status-publish hentry category-software tag-design tag-inversion-of-control tag-ioc-containers"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; How to pass data between objects when an IoC container is being used</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">inversion-of-control</span><span class="mr-2 badge badge-warning">ioc-containers</span></p><div class="entry-content"><p>I&#39;m working with a project that our architect has decided to use dependency injection for almost everything.  We use an IoC container.  One of the main issues that I keep coming across when using this pattern is &#34;How do I pass this bit of data here to a different object that will be used later?&#34;</p><p>Often, the easiest solution is to mark a specific class as being a &#34;singleton&#34; with our specific injector/container.  This is bad for a few reasons.  As we all know, singletons are evil and should never be used.  Sometimes the class marked as &#34;singleton&#34;, should actually have multiple instances when used in different parts of the code.  Marking a class as a &#34;singleton&#34; creates a new dependency that we use an injector/container that supports the concept of marking a class as a &#34;singleton&#34;.</p><p>Another solution is the modify how the injector/container creates the object by writing closures, or other specific logic when the injector is instantiating the object based on what is client is using it and the state of the clients.  This is bad because it creates a new dependency of this functionality existing in the injector/container.  It also violates the separation of concerns because it now makes the inject/container concerned with several different classes.</p><p>Here is an example use case of this problem:</p><ol><li>I am using ClassA early in the application from ClassB.  I have some state/data I want to store in ClassA and use it later.</li><li>Some more stuff happens in the application.  The object of ClassA is either still on the stack farther down, or that part of the stack no longer exists and maybe there are no references to the object of ClassA.  The method of classB may or may not still be on the call stack.</li><li>Later in the application, I want to refer to the state/data of ClassA from ClassC.</li></ol><p>Update &#8211; I&#39;m adding an example</p><pre><code>class ClassA {
private:
    shared_ptr&lt;ClassState&gt; state;
    shared_ptr&lt;ClassB&gt; b;
public:
    ClassA(shared_ptr&lt;ClassState&gt; state, shared_ptr&lt;ClassB&gt; b) {
        this-&gt;state = state;
        this-&gt;b = b;
    }
    void run() {
        // do stuff
        if (true /* blah blah blah */) {
            state-&gt;setState(true);
        } else {
            state-&gt;setState(false);
        }
        // do more stuff
        b-&gt;run();
    }
};

class ClassB {
private:
    shared_ptr&lt;ClassC&gt; c;
public:
    ClassB(shared_ptr&lt;ClassC&gt; c) {
        this-&gt;c = c;
    }
    void run() {
        // do stuff
        c-&gt;run();
        // do more stuff
    }
};


class ClassC {
private:
    shared_ptr&lt;ClassState&gt; state;
public:
    ClassC(shared_ptr&lt;ClassState&gt; state) {
        this-&gt;state = state;
    }
    void run() {
        //This is where I want to use that data that was stored earlier
        // in the application
        if (state-&gt;getState()) {
            // do stuff
        }
    }
};

void main() {
    // Create whatever magicaly IOC dependency injector
    shared_ptr&lt;ClassA&gt; a = injector.create&lt;ClassA&gt; ();
    a-&gt;run();
}
</code></pre></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>It sounds like you&#39;re wanting to just reach out and grab things as soon you need them. That&#39;s typical of procedural programming. No language, framework, pattern, or tool can stop you if you insist on working this way.</p><p>However, there is another way. <a href="https://pragprog.com/articles/tell-dont-ask" rel="nofollow noreferrer">Tell, don&#39;t ask</a> says not to reach out for what you need (as is typically done through getters and static references) but to just let what ever you need be handed to you. That way you don&#39;t have to know how to find it. It finds you.</p><p>So you have <code>ClassC</code> that needs something from <code>ClassA</code>. Rather than write <code>ClassB.ClassA.getNeededThing()</code> write</p><pre><code>class ClassC {
    String neededThing;
    public ClassC(String neededThing) { 
        this.neededThing = neededThing;
    }         
} 
</code></pre><p>This way <code>ClassC</code> doesn&#39;t even exist until it has what it needs to be useful. And it doesn&#39;t care if it was <code>ClassA</code> or <code>ClassB</code> that figured out how to get it what it needs.</p><p>Now that&#39;s just object creation. After objects are created they can still talk to each other if they have references to each other. Say there was <code>anotherNeededThing</code> that <code>ClassC</code> needs from <code>ClassA</code>.</p><pre><code>class ClassA {
    ClassC c;
    String someOtherNeededThing;
    public ClassA(ClassC c, String someOtherNeededThing){ 
        this.c = c;
        this.someOtherNeededThing = someOtherNeededThing;
    }
    public void timeToGiveTheThing() {
        c.doYourThingWith(someOtherNeededThing);
    }      
} 
</code></pre><p>Done this way <code>ClassC</code> doesn&#39;t even need to know <code>ClassA</code> exists.</p><p>You might think you need a fancy DI container to make all this work but it can be done in <code>main</code> (if you have one, if not find your &#34;composition root&#34; and do it there).</p><pre><code>int main() {
    ClassC c = new ClassC(&#34;Hello &#34;);
    ClassA a = new ClassA(&#34;world&#34;, c);
    a.timeToGiveTheThing();
}
</code></pre><p>But you&#39;re stuck with a DI container you say? Fine, just list C as one of A&#39;s dependencies. So long as you get a reference to it you can talk to it. So long as whatever knows when this should happen has a reference to you then you will talk to it when you should. No need to ask.</p><p>If you come from procedural programming This will feel very different from your usual way of programming. It is a different way. We call this style object oriented programming. If you thought that you were doing that before because you were using an OOP language I&#39;m sorry, that doesn&#39;t guarantee you&#39;re using OOP.</p><p>Once you get your head around this you&#39;ll likely find yourself creating constructors and method signatures with tons of arguments. That&#39;s when it&#39;s time to learn about primitive obsession and parameter objects. Just don&#39;t confuse parameter objects with encapsulated objects.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../dependency-injection-ioc-container-practices-when-writing-frameworks/'>Dependency Injection/IoC container practices when writing frameworks</a></li><li class="list-group-item"><a href='../c-manager-container-class-vs-static-class-methods/'>C# &#8211; Manager/Container class vs static class methods</a></li><li class="list-group-item"><a href='../c-breaking-the-ubiquitous-language-by-having-an-ioc-container-in-domain-model/'>C# &#8211; Breaking the &#8220;ubiquitous language&#8221; by having an IoC Container in Domain Model</a></li><li class="list-group-item"><a href='../c-database-context-and-singleton-injection-with-ioc/'>C# &#8211; Database Context and Singleton injection with IoC</a></li><li class="list-group-item"><a href='../object-oriented-ioc-containers-break-oop-principles/'>Object-oriented &#8211; IOC Containers break OOP Principles</a></li><li class="list-group-item"><a href='../c-dependency-injection-with-adapter-pattern/'>C# Dependency Injection with Adapter Pattern</a></li><li class="list-group-item"><a href='../how-to-you-use-di-without-di-framework-in-a-reasonably-complex-project/'>How to you use DI without DI framework in a reasonably complex project</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>