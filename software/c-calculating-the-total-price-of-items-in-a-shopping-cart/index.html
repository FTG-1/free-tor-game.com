<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Calculating the total price of items in a shopping cart &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070076 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070076" class="post-1070076 software type-software status-publish hentry category-software tag-c tag-design tag-object-oriented tag-object-oriented-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Calculating the total price of items in a shopping cart</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">object-oriented</span><span class="mr-2 badge badge-primary">object-oriented-design</span></p><div class="entry-content"><p>I am making a shopping cart. A shopping cart will have a total amount of money you&#39;ve got to pay for the products you&#39;ve selected.</p><p>I&#39;d like to approach the problem using both OOP (encapsulating it) and more anaemically or functionally (without encapsulation).</p><p>I&#39;m using the simplest Product model:</p><pre><code>public class Product
{
    public string Name { get; set; }
    public decimal Price { get; set; }
}
</code></pre><h1>1. Using encapsulation (aka rich-domain modeling)</h1><p>TotalPrice can only be calculated inside the shopping cart class.</p><h2>a) On the fly calculation</h2><pre><code>public class ShoppingCart
{
    private List&lt;Product&gt; _products = new List&lt;Product&gt;();

    public decimal TotalPrice { get; private set; }
    public IReadOnlyCollection&lt;Product&gt; Products =&gt; _products;

    public void AddProduct(Product product)
    {
        _products.Add(product);
        TotalPrice += product.Price;
    }

    public void RemoveProduct(Product product)
    {
        _products.Remove(product);
        TotalPrice -= product.Price;
    }
}
</code></pre><h2>b) On the fly calculation with RecalculateTotalPrice method</h2><p>Seems less performant than approach above or using computed property. We&#39;re executing a loop on each Add and Remove.</p><pre><code>public class ShoppingCart
{
    private List&lt;Product&gt; _products = new List&lt;Product&gt;();
    public decimal TotalPrice { get; private set; }

    public void AddProduct(Product product)
    {
        _products.Add(product);
        RecalculateTotalPrice();
    }

    public void RemoveProduct(Product product)
    {
        _products.Remove(product);
        RecalculateTotalPrice();
    }

    private void RecalculateTotalPrice()
    {
        var totalPrice = 0m;
        foreach (var product in _products)
        {
            totalPrice += product.Price;
        }
        TotalPrice = totalPrice;
    }
}
</code></pre><h2>c) Computed property</h2><p>Calculated only when accessed <code>TotalPrice</code>. <code>AddProduct</code> and <code>RemoveProduct</code> don&#39;t calculate. The disadvantage is we can&#39;t easily persist this with some ORM.</p><pre><code>public class ShoppingCart
{
    private List&lt;Product&gt; _products = new List&lt;Product&gt;();
    public decimal TotalPrice =&gt; CalculateTotalPrice();

    public void AddProduct(Product product)
    {
        _products.Add(product);
    }

    public void RemoveProduct(Product product)
    {
        _products.Remove(product);
    }

    private decimal CalculateTotalPrice()
    {
        var totalPrice = 0m;
        foreach (var product in _products)
        {
            totalPrice += product.Price;
        }
        return totalPrice;
    }
}
</code></pre><h1>2. No encapsulation</h1><p>Our TotalPrice will be calculated outside the class.</p><pre><code>public class ShoppingCart
{
    public ICollection&lt;Product&gt; Products { get; set; } = new List&lt;Product&gt;();
    public decimal TotalPrice { get; set; }
}
</code></pre><p>Calculation of TotalPrice can happen from anywhere. The advantage of this is we can decouple calculation from the shopping cart and even have special calculator class for it that can be extended with custom calculation rules and so on. Some interface like <code>IShoppingCartCalculator</code>.</p><p>Currently, I&#39;m using the 1a approach but I was wondering if making it a POCO would result in more extendable and maintainable code managed from the outside.</p><p>No encapsulation results in simpler code that is easier to follow. <strong>There&#39;s 1 less business layer to maintain</strong>. We&#39;re losing benefits of encapsulation but we&#39;re gaining more possibilities and <strong>we&#39;re more resistant to changes</strong></p><p>So our pipeline works like (request → handler → invoking some calculator service method) instead of (request → handler → invoking some ShoppingCart method)</p><p>Should I give up on encapsulation to gain more possibilities and more re-usable classes or even functions in case of functional programming?</p><p>Is encapsulation a thing of the past that didn&#39;t meet expectations of reality?</p><p>I&#39;m open to any suggestions.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Unless we&#39;re talking about tens of thousands of products, recalculating the total price every time is not worth considering in terms of performance.  My guess is in a typical shopping list, you&#39;re rarely going to see more than 10 items.  However, if that&#39;s not your case, feel free to write me in the comments and I&#39;ll reevaluate this.</p><p>Once performance is out of the picture, something which does need to be taken into consideration is writing code in such a way that it doesn&#39;t potentially leave holes.  By this I mean your 1a solution.  If you were to add a product, then change the price <em>afterwards</em>, the total price would be inconsistent.  Of course, you may very well not ever do this in your program, but you&#39;re asking which method is best.  Writing code which allows these sorts of problems is <em>not</em> best.</p><p>Your 1b solution is at least consistent, but recalculating each and everytime is unnecessary.  Ideally for 100 products added to the list, you only really need to calculate it once.  Again, performance is not an issue, but lets not make unnecessary calculations if we can avoid it.</p><p>Your 2 solution without encapsulation means you would necessarily have to port this logic elsewhere, and it seems a very natural thing that this logic should be present in the container itself, at least if you insist on having a <code>TotalPrice</code> property.</p><p>I would lean towards your 1c solution.  The fact that it may cause problems with ORM is a technical oversight to an otherwise excellent solution.  Most ORMs provide a means to disregard certain properties, so I would be surprised if there weren&#39;t something similar in your case.  Also considering that the need for an <code>AddProduct</code> and <code>RemoveProduct</code> are unnecessary, I would eliminate these from the class.  If you later needed to know if products were added or removed, you could use an observable list to hold the products.</p><p>If performance were an issue, you could always lazily calculate the total price with an internal boolean to indicate whether or not the current total is possibly dirty.  When products are added or removed, the dirty flag is set and you know next call to <code>TotalPrice</code> should require recalculation.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../design-how-to-handle-frequent-ajax-requests-in-shopping-cart/'>Design &#8211; How to handle frequent ajax requests in shopping cart</a></li><li class="list-group-item"><a href='../c-using-xml-datatype-to-store-a-shopping-cart/'>C# &#8211; Using xml datatype to store a &#8220;shopping cart&#8221;</a></li><li class="list-group-item"><a href='../c-how-to-add-properties-to-subclasses-and-access-them-without-casting-from-a-superclass/'>C# &#8211; How to add properties to subclasses and access them without casting from a superclass</a></li><li class="list-group-item"><a href='../object-oriented-implementing-buy-one-get-one-for-free-coupon-logic-for-shopping-cart/'>Object-oriented &#8211; Implementing &#8220;buy one get one for free&#8221; coupon logic for shopping cart</a></li><li class="list-group-item"><a href='../java-how-to-design-the-classes-for-a-simple-shopping-cart-example-using-strategy-design-patterns/'>Java &#8211; How to design the classes for a simple shopping cart example using Strategy Design Patterns</a></li><li class="list-group-item"><a href='../how-to-prevent-dependency-injection-from-killing-object-oriented-programming/'>How to prevent dependency injection from killing object oriented programming</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>