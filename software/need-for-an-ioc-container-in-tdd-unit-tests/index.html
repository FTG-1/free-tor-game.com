<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Need for an IoC container in TDD unit tests &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1077960 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1077960" class="post-1077960 software type-software status-publish hentry category-software tag-ioc-containers tag-tdd"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Need for an IoC container in TDD unit tests</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">ioc-containers</span><span class="mr-2 badge badge-info">tdd</span></p><div class="entry-content"><p>While I do see the benefits of IoC containers (as I&#39;ve used them a fair bit), I don&#39;t see how they can be incorporated within TDD unit tests (note, I&#39;m only interested in <strong>unit</strong> tests here, not integration tests).</p><p>When I TDD, I refactor constructors to use IoC, so that I can inject fake dependencies wherever I might need to. Implementing a container implies that I&#39;d be deviating from the red-green-refactor-repeat loop and adding code that wouldn&#39;t be covered by my tests.</p><p>Now let&#39;s say that you somehow (with great design prowess) managed to hook in a container in your TDD life-cyle. You certainly aren&#39;t meant to create instances in your unit test by resolving dependencies, as strictly speaking, that turns it into an integration test (bringing in multiple production components).</p><p>So my questions are:</p><p>1) In what scenario might you need a container while unit testing within TDD?</p><p>2) Assuming a valid scenario for (1) exists, how would you go about incorporating a container without breaking away from red-green-refactor-repeat?</p><p>I should clarify that by &#39;need&#39;, I&#39;m talking about a stage you&#39;d get to where manually managing DI gets tedious because you have a massive object graph.</p><p><strong>IMPORTANT</strong>: I&#39;m not asking about containers for your test. I&#39;m asking strictly about production containers. I have a feeling that an IoC container cannot be implemented in a TDD life-cyle without breaking away from red-green-refactor-repeat (rgrr) and managing the container would have to be done in a sort of <em>parallel</em> way, if that makes sense.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><ol><li>In what scenario might you need a container while unit testing within TDD?</li></ol></blockquote><p>I don&#39;t see how IoC containers factor into this. Even if you were taking a pure DI approach where you write explicit methods to instantiate your components (which in turn chains to all of that component&#39;s dependencies&#39; methods), your question would remain the same: how do you test those pure DI methods?</p><p>Whether you use a container or a set of prebuilt Pure DI methods that instantiate your objects for you, it serves the same purpose, and you would write the same test for it.</p><p>However, as I&#39;ll elaborate in this answer, I don&#39;t quite agree that you need to write tests for either of them.</p><blockquote><p>note, I&#39;m only interested in unit tests here, not integration tests</p></blockquote><p>This sort of undoes your argument, or at least shifts the goal posts a bit. Unit tests don&#39;t care about a chained stack of dependencies, specifically because they are <strong>unit</strong> tests.</p><p>Any issues in wiring the IoC container will be spotted by your integration tests, since those tests are built specifically to test how your individual components are wired together.</p><p>To put it another way, a bad IoC registration doesn&#39;t in fact invalidate the units that you test themselves, and therefore their unit tests shouldn&#39;t fail.</p><blockquote><p>Implementing a container implies that I&#39;d be deviating from the red-green-refactor-repeat loop and adding code that wouldn&#39;t be covered by my tests.</p></blockquote><p>There&#39;s two approaches here. The pedantically correct one, and the reasonably practical one.</p><p><strong>The reasonably practical approach</strong></p><p>Most devs I&#39;ve worked with, including myself, tend to consider the configuration of the DI container to be startup logic, which falls outside of the application logic scope, which is what your tests cover.</p><p>Startup logic tends to be trivial, and is the runtime equivalent of linking projects at compile time. It&#39;s not the target for unit tests, because it&#39;s &#34;meta logic&#34;, in the sense that it doesn&#39;t contain business logic but rather the setup logic for the framework in which you will be housing your meta logic.</p><p>My reasoning for not testing this is that these tests wouldn&#39;t exist to test a behavior, but they are just a &#34;write it again&#34; exercise to confirm that the expected object graph is the same in both your production code and your test.<br/> I find it a waste of time for the same reason that I hate &#34;confirm your email address again&#34; textboxes, and I always end up copy/pasting the email address from the first box into the second one, which defeats the purpose entirely.</p><p>Another counterargument here, though slightly outdated nowadays, is that some older IoC setups used <em>config files</em> to configure their container, and you can make a reasonable case here for not needing to unit test values from a config file.</p><p><strong>The pedantically correct appraoch</strong></p><p>But if you choose to read 100% coverage as 100% coverage of everything, nothing is stopping you from writing tests that confirm the IoC container has been hooked up correctly - at least to the point of not throwing exceptions about missing dependency registrations (the specific behaviors are better tested using more concrete integration tests).</p><p>In essence, you could consider the wiring up logic as a unit in and of itself, and thus write tests for it to confirm that it correctly wired your object graph.</p><blockquote><p>You certainly aren&#39;t meant to create instances in your unit test by resolving dependencies, as strictly speaking, that turns it into an integration test</p></blockquote><p>If I create a container, register one real dependency (i.e. the one I&#39;m unit testing), and then register a bunch of mocks, then I&#39;m not turning my unit test into an integration test.</p><p>There&#39;s little purpose to using such a custom built container for the purpose of a unit test (though I can&#39;t guarantee that it&#39;s <em>never</em> useful), but it doesn&#39;t inherently turn your unit test into an integration test.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-does-a-project-using-proper-tdd-have-a-lot-of-code-without-tests/'>Unit-testing &#8211; Does a project using proper TDD have a lot of code without tests</a></li><li class="list-group-item"><a href='../unit-testing-why-not-write-all-tests-at-once-when-doing-tdd/'>Unit-testing &#8211; Why not write all tests at once when doing TDD</a></li><li class="list-group-item"><a href='../dependency-injection-ioc-container-practices-when-writing-frameworks/'>Dependency Injection/IoC container practices when writing frameworks</a></li><li class="list-group-item"><a href='../object-oriented-do-we-need-logging-when-doing-tdd/'>Object-oriented &#8211; Do we need Logging when doing TDD</a></li><li class="list-group-item"><a href='../c-i-get-dependency-injection-but-can-someone-help-me-understand-the-need-for-an-ioc-container/'>C# &#8211; I get dependency injection, but can someone help me understand the need for an IoC container</a></li><li class="list-group-item"><a href='../workflow-of-test-driven-development-to-follow-solid-principles/'>Workflow of Test driven development to follow SOLID principles</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>