<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Is it ever okay to violate the LSP &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075215 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075215" class="post-1075215 software type-software status-publish hentry category-software tag-design-patterns tag-inheritance tag-java"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Is it ever okay to violate the LSP</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span><span class="mr-2 badge badge-info">inheritance</span><span class="mr-2 badge badge-warning">java</span></p><div class="entry-content"><p>I&#39;m following up on <a href="https://stackoverflow.com/questions/46841630/using-the-strategy-pattern-to-avoid-downcasting">this question</a>, but I&#39;m switching my focus from code to a principle.</p><p>From my understanding of the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle" rel="noreferrer">Liskov substitution principle</a> (LSP), whatever methods are in my base class, they must be implemented in my subclass, and according to <a href="https://www.tomdalling.com/blog/software-design/solid-class-design-the-liskov-substitution-principle/" rel="noreferrer">this</a> page, if you override a method in the base class and it does nothing or throws an exception, you&#39;re in violation of the principle.</p><p>Now, my problem can be summed up like this: I have an abstract <code>Weapon</code> <code>class</code>, and two classes, <code>Sword</code> and <code>Reloadable</code>. If <code>Reloadable</code> contains a specific <code>method</code>, called <code>Reload()</code>, I would have to downcast to access that <code>method</code>, and, ideally, you&#39;d want to avoid that.</p><p>I then thought of using the <code>Strategy Pattern</code>. This way each weapon was only aware of the actions it&#39;s capable of performing, so for example, a <code>Reloadable</code> weapon, can obviously reload, but a <code>Sword</code> can&#39;t, and isn&#39;t even aware of a <code>Reload class/method</code>. As I stated in my Stack Overflow post, I don&#39;t have to downcast, and I can maintain a <code>List&lt;Weapon&gt;</code> collection.</p><p>On <a href="https://www.gamedev.net/forums/topic/692868-using-the-strategy-pattern-to-avoid-downcasting/" rel="noreferrer">another forum</a>, the first answer suggested to allow <code>Sword</code> to be aware of <code>Reload</code>, just don&#39;t do anything. This same answer was given on the Stack Overflow page I linked to above.</p><p>I don&#39;t fully understand why. Why violate the principle and allow Sword to be aware of <code>Reload</code>, and leave it blank? As I said in my Stack Overflow post, the SP, pretty much solved my problems.</p><p>Why isn&#39;t it a viable solution?</p><pre><code>public final Weapon{

    private final String name;
    private final int damage;
    private final List&lt;AttackStrategy&gt; validactions;
    private final List&lt;Actions&gt; standardActions;

    private Weapon(String name, int damage, List&lt;AttackStrategy&gt; standardActions, List&lt;Actions&gt; attacks)
    {
        this.name = name;
        this.damage = damage;
        standardActions = new ArrayList&lt;Actions&gt;(standardActions);
        validAttacks = new ArrayList&lt;AttackStrategy&gt;(validActions);
    }

    public void standardAction(String action){} // -- Can call reload or aim here.  

    public int attack(String action){} // - Call any actions that are attacks. 

    public static Weapon Sword(String name, damage, List&lt;AttackStrategy&gt; standardActions, List&lt;Actions&gt; attacks){
        return new Weapon(name, damage,standardActions, attacks) ;
    }

}
</code></pre><p><strong>Attack Interface and Implementation:</strong></p><pre><code>public interface AttackStrategy{
    void attack(Enemy enemy);
}

public class Shoot implements AttackStrategy {
    public void attack(Enemy enemy){
        //code to shoot
    }
}

public class Strike implements AttackStrategy {
    public void attack(Enemy enemy){
        //code to strike
    }
}
</code></pre></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The LSP is concerned about subtyping and polymorphism. Not all code actually uses these features, in which case the LSP is irrelevant. Two common use cases of inheritance language constructs that are not a case of subtyping are:</p><ul><li><p>Inheritance used to inherit the implementation of a base class, but not its interface. In nearly all cases composition should be preferred. Languages like Java can&#39;t separate inheritance of implementation and interface, but e.g. C++ has <code>private</code> inheritance.</p></li><li><p>Inheritance used to model a sum type/union, e.g.: a <code>Base</code> is either <code>CaseA</code> or <code>CaseB</code>. The base type does not declare any relevant interface. To use its instances, you must cast them to the correct concrete type. The casting can be done safely and is not the issue. Unfortunately, many OOP languages are not able to restrict the base class subtypes to only the intended subtypes. If external code can create a <code>CaseC</code>, then code assuming that a <code>Base</code> can only be a <code>CaseA</code> or <code>CaseB</code> is incorrect. Scala can do this safely with its <code>case class</code> concept. In Java, this can be modelled when the <code>Base</code> is an abstract class with a private constructor, and nested static classes then inherit from the base.</p></li></ul><p>Some concepts like conceptual hierarchies of real-world objects map very badly into object oriented models. Thoughts like “A gun is a weapon, and a sword is a weapon, therefore I&#39;ll have a <code>Weapon</code> base class from which <code>Gun</code> and <code>Sword</code> inherit” are misleading: real-word is-a relationships do not imply such a relationship in our model. One related issue is that objects may belong to multiple conceptual hierarchies or may change their hierarchy affiliation during run time, which most languages cannot model since inheritance is usually per-class not per-object, and defined at design-time not run-time.</p><p>When designing OOP models we should not think about the hierarchy, or how one class “extends” another. A base class is not a place to factor out the <em>common</em> parts of multiple classes. Instead, think about how your objects will be used, i.e. what kind of behaviour the users of these objects need.</p><p>Here, users may need to <code>attack()</code> with weapons and maybe <code>reload()</code> them. If we are to create a type hierarchy, then both of these methods must be in the base type, though non-reloadable weapons may ignore that method and do nothing when called. So the base class does not contain the common parts, but the combined interface of all subclasses. The subclasses don&#39;t differ in their interface, but only in their implementation of this interface.</p><p>It is not necessary to create a hierarchy. The two types <code>Gun</code> and <code>Sword</code> may be entirely unrelated. Whereas a <code>Gun</code> can <code>fire()</code> and <code>reload()</code> a <code>Sword</code> may only <code>strike()</code>. If you need to manage these objects polymorphically, you can use the Adapter Pattern to capture the relevant aspects. In Java 8 this is possible rather conveniently with functional interfaces and lambdas/method references. E.g. you might have an <code>Attack</code> strategy for which you supply <code>myGun::fire</code> or <code>() -&gt; mySword.strike()</code>.</p><p>Finally, it is sometimes sensible to avoid any subclasses at all, but model all objects through a single type. This is particularly relevant in games because many game objects do not fit nicely into any hierarchy, and may have many different capabilities. E.g. a role playing game may have an item that is both a quest item, buffs your stats with +2 strength when equipped, has a 20% chance on ignoring any damage received, and provides a melee attack. Or maybe a reloadable sword because it is *magic*. Who knows what the story requires.</p><p>Instead of trying to figure out a class hierarchy for that mess, it is better to have a class that provides slots for various capabilities. These slots can be changed at runtime. Each slot would be a strategy/callback like <code>OnDamageReceived</code> or <code>Attack</code>. With your weapons, we may have <code>MeleeAttack</code>, <code>RangedAttack</code>, and <code>Reload</code> slots. These slots may be empty, in which case the object does not provide this capability. The slots are then called conditionally: <code>if (item.attack != null) item.attack.perform()</code>.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-does-the-state-pattern-violate-liskov-substitution-principle/'>Java &#8211; Does the state Pattern violate Liskov Substitution Principle</a></li><li class="list-group-item"><a href='../java-is-it-ever-okay-to-catch-stackoverflowerror-in-java/'>Java &#8211; Is it *ever* okay to catch StackOverflowError in Java</a></li><li class="list-group-item"><a href='../java-is-it-okay-to-have-objects-that-cast-themselves-even-if-it-pollutes-the-api-of-their-subclasses/'>Java &#8211; Is it okay to have objects that cast themselves, even if it pollutes the API of their subclasses</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>