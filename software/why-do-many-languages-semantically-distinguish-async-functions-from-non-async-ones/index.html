<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Why do many languages semantically distinguish &#8220;async&#8221; functions from &#8220;non-async&#8221; ones &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087245 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087245" class="post-1087245 software type-software status-publish hentry category-software tag-asynchronous-programming tag-language-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Why do many languages semantically distinguish &#8220;async&#8221; functions from &#8220;non-async&#8221; ones</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asynchronous-programming</span><span class="mr-2 badge badge-info">language-design</span></p><div class="entry-content"><p>I&#39;ve seen this in C#, Hack, and now Kotlin: <code>await</code> or an equivalent operation can only be performed in special &#34;async&#34; contexts. Return values from these are, to borrow Hack&#39;s terminology, &#34;awaitable&#34; in turn, so the special async-ness of some low-level async system function call bubbles to the top unless it transformed to a synchronous operation. This partitions the codebase into synchronous and asynchronous ecosystems. After working for a while with async-await in Hack, however, I&#39;m beginning to question the need. <strong>Why does the calling scope need to know that it&#39;s calling an async function?</strong> Why can&#39;t async functions look like sync functions that just happen to throw control somewhere else on occasion?</p><p>I&#39;ve found all of the distinctiveness of async code I&#39;ve written to come from three consequences:</p><ol><li>Race conditions are possible when two parallel coroutines share common state</li><li>Time information about the transient/unresolved state might be embedded in async objects, which can enforce certain ordering rules</li><li>The underlying work of a coroutine can be mutated by other coroutines (e.g. cancellation)</li></ol><p>I&#39;ll concede the first one is tempting. Annotating an ecosystem as <code>async</code> screams &#34;beware: race conditions might live here!&#34; However, attention to race conditions can be completely localized to combining functions (e.g. <code>(Awaitable&lt;Tu&gt;, Awaitable&lt;Tv&gt;, ...) -&gt; Awaitable&lt;(Tu, Tv, ...)&gt;</code>) since without them, two coroutines cannot execute in parallel. Then, the problem becomes very specific: &#34;make sure all terms of this combining function do not race.&#34; This is beneficial to clarity. So long as it&#39;s understood that combining functions are useful for async code (but obviously not limited to it; async code is a superset of sync code), and there are a finite number of canonical ones (language constructs as they often are), I feel that this <em>better</em> communicates the risks of race conditions by localizing their sources.</p><p>The other two are a matter of language design by how the lowest-level async objects are represented (Hack&#39;s <code>WaitHandle</code>s for instance). Any mutation of a high-level async object is necessarily confined to a set of operations against the underlying low-level async objects that come from system calls. Whether or not the calling scope is synchronous is irrelevant, since mutability and the effects of mutation are purely functions of that underlying state at a single point in time. Aggregating them into a nondescript async object does not make the behavior any clearer â€” if anything, to me, it obscures it with the illusion of determinism. This is all moot when the scheduler is opaque (as in Hack and, from what I gather, Kotlin as well) where the information and mutators are hidden anyways.</p><p>Otherwise, the result is all the same for the calling scope: it eventually gets a value or an Exception and does its synchronous thing. Am I missing a part of the design thinking behind this rule? Alternatively, are there examples where async function contracts are indistinguishable from synchronous ones?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The reason you need to mark methods as <code>async</code> in C# in order to use <code>await</code> as a keyword inside of them is that C# was already a well-established language by the time this was added as a new feature, and it&#39;s reasonable to assume that there was code out there that used <code>await</code> as an identifier, which would have broken under the new system.</p><p>By introducing a new syntax that was never valid before, (methods marked as <code>async</code> in the method declaration,) the C# compiler team could ensure that all the existing code continued to work as usual, and the use of <code>await</code> as a pseudo-keyword would only come into play when the coder explicitly asked for it in code written for the new feature.</p><p>Other languages probably did it that way for similar reasons, or &#34;because that&#39;s how C# did it.&#34;</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-calling-non-member-functions-with-the-same-syntax-of-member-ones/'>C++: calling non-member functions with the same syntax of member ones</a></li><li class="list-group-item"><a href='../why-are-so-many-languages-passed-by-value/'>Why are so many languages passed by value</a></li><li class="list-group-item"><a href='../c-blurring-the-lines-between-async-and-regular-functions-in-c-5-0/'>C# &#8211; Blurring the lines between async and regular functions in C# 5.0</a></li><li class="list-group-item"><a href='../why-do-programming-languages-allow-shadowing-hiding-of-variables-and-functions/'>Why do programming languages allow shadowing/hiding of variables and functions</a></li><li class="list-group-item"><a href='../providing-a-non-blocking-io-api-in-a-c-library/'>Providing a non-blocking IO API in a C library</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>