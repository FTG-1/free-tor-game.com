<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; Why don&#8217;t RDBMSes return joined tables in a nested format &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070262 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070262" class="post-1070262 software type-software status-publish hentry category-software tag-design tag-rdbms tag-sql"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; Why don&#8217;t RDBMSes return joined tables in a nested format</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">rdbms</span><span class="mr-2 badge badge-warning">sql</span></p><div class="entry-content"><p>For example, say I want to fetch a User and all of his phone numbers and email addresses. The phone numbers and emails are stored in separate tables, One user to many phones/emails. I can do this quite easily:</p><pre><code>SELECT * FROM users user 
    LEFT JOIN emails email ON email.user_id=user.id
    LEFT JOIN phones phone ON phone.user_id=user.id
</code></pre><p>The problem* with this is that it&#39;s returning the user&#39;s name, DOB, favorite color, and all the other information stored in the user table over-and-over again for each record (users×emails×phones records), presumably eating up bandwidth and slowing down the results.</p><p>Wouldn&#39;t it be nicer if it returned a  single row for each user, and within that record there was a <em>list</em> of emails and a <em>list</em> of phones? It would make the data much easier to work with too.</p><p>I know you can get results like this using LINQ or perhaps other frameworks, but it seems to be a weakness in the underlying design of relational databases.</p><p>We could get around this by using NoSQL, but shouldn&#39;t there be some middle ground?</p><p>Am I missing something? Why doesn&#39;t this exist?</p><p>* Yes, it&#39;s designed this way. I get it. I&#39;m wondering why there isn&#39;t an alternative that is easier to work with. SQL could keep doing what it&#39;s doing but then they could add a keyword or two to do a little bit of post-processing that returns the data in a nested format instead of a cartesian product.</p><p>I know this can be done in a scripting language of your choice, but it requires that the SQL server either sends redundant data (example below) or that you to issue multiple queries like <code>SELECT email FROM emails WHERE user_id IN (/* result of first query */)</code>.</p><hr/><p>Instead of having MySQL return something akin to this:</p><pre><code>[
    {
        &#34;name&#34;: &#34;John Smith&#34;,
        &#34;dob&#34;: &#34;1945-05-13&#34;,
        &#34;fav_color&#34;: &#34;red&#34;,
        &#34;email&#34;: &#34;johnsmith45@gmail.com&#34;,
    },
    {
        &#34;name&#34;: &#34;John Smith&#34;,
        &#34;dob&#34;: &#34;1945-05-13&#34;,
        &#34;fav_color&#34;: &#34;red&#34;,
        &#34;email&#34;: &#34;john@smithsunite.com&#34;,
    },
    {
        &#34;name&#34;: &#34;Jane Doe&#34;,
        &#34;dob&#34;: &#34;1953-02-19&#34;,
        &#34;fav_color&#34;: &#34;green&#34;,
        &#34;email&#34;: &#34;originaljane@deerclan.com&#34;,
    }
]
</code></pre><p>And then having to group on some unique identifier (which means I need to fetch that too!) client-side to reformat the result set how you want it, just return this:</p><pre><code>[
    {
        &#34;name&#34;: &#34;John Smith&#34;,
        &#34;dob&#34;: &#34;1945-05-13&#34;,
        &#34;fav_color&#34;: &#34;red&#34;,
        &#34;emails&#34;: [&#34;johnsmith45@gmail.com&#34;, &#34;john@smithsunite.com&#34;]
    },
    {
        &#34;name&#34;: &#34;Jane Doe&#34;,
        &#34;dob&#34;: &#34;1953-02-19&#34;,
        &#34;fav_color&#34;: &#34;green&#34;,
        &#34;emails&#34;: [&#34;originaljane@deerclan.com&#34;],
    }
]
</code></pre><p>Alternatively, I can issue 3 queries: 1 for the users, 1 for the emails, and 1 for the phone numbers, but then the email and phone number result sets need to contain the user_id so that I can match them back up with the users I previously fetched. Again, redundant data and needless post-processing.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Deep down, in the guts of a relational database, its all rows and columns.  That is the structure that a relational database is optimized to work with. <a href="http://www.oracle.com/technetwork/issue-archive/2013/13-mar/o23plsql-1906474.html" rel="nofollow noreferrer">Cursors</a> work on individual rows at a time.  Some operations create temporary tables (again, it needs to be rows and columns).</p><p>By working with only rows and returning only rows, the system is able to better deal with memory and network traffic.</p><p>As mentioned, this allows for certain optimizations to be done (indexes, joins, unions, etc...)</p><p>If one was to want a nested tree structure, this requires that one pulls <em>all</em> the data at once.  Gone are the optimizations for the cursors on the database side.  Likewise, the traffic over the network becomes one big burst that can take much longer than the slow trickle of row by row (this is something that is occasionally lost in today&#39;s web world).</p><p>Every language has arrays within it.  These are easy things to work with and interface with.  By using a very primitive structure, the driver between the database and program - no matter what language - can work in a common way.  Once one starts adding trees, the structures in the language become more complex and more difficult to traverse.</p><p>It isn&#39;t that hard for a programing language to convert the rows returned into some other structure.  Make it into a tree or a hash set or leave it as a list of rows that you can iterate over.</p><p>There is also history at work here.  Transferring structured data was something ugly in the days of old.  Look at the EDI format to get an idea of what you might be asking for.  Trees also imply recursion - which some languages didn&#39;t support (the two most important languages of the old days didn&#39;t support recursion - <a href="http://fortranwiki.org/fortran/show/recursion" rel="nofollow noreferrer">recursion didn&#39;t enter Fortran until F90</a> and of the era COBOL didn&#39;t either).</p><p>And while the languages of today have support for recursion and more advanced data types, there isn&#39;t really a good reason to change things.  They work, and they work well.  The ones that <em>are</em> changing things are the nosql databases.  You can store trees in documents in a document based one.  LDAP (its actually oldish) is also a tree based system (though its probably not what you&#39;re after).   Who knows, maybe the next thing in nosql databases will be one that returns back the query as a json object.</p><p>However, the &#39;old&#39; relational databases... they&#39;re working with rows because thats what they&#39;re good at and everything can talk to them without trouble or translation.</p><blockquote><ol start="12"><li>In protocol design, perfection has been reached not when there is nothing left to add, but when there is nothing left to take away.</li></ol></blockquote><p>From <a href="https://www.rfc-editor.org/rfc/rfc1925" rel="nofollow noreferrer">RFC 1925 - The Twelve Networking Truths</a></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-why-dont-relational-databases-support-returning-information-in-a-nested-format/'>Database &#8211; Why don&#8217;t relational databases support returning information in a nested format</a></li><li class="list-group-item"><a href='../database-would-these-two-scenarios-be-good-candidates-for-a-nosql-database/'>Database &#8211; Would these two scenarios be good candidates for a NoSQL database</a></li><li class="list-group-item"><a href='../rest-api-should-api-return-nested-json-objects/'>REST API &#8211; Should API Return Nested JSON Objects</a></li><li class="list-group-item"><a href='../why-not-just-make-non-parameterized-queries-return-an-error/'>Why not just make non-parameterized queries return an error</a></li><li class="list-group-item"><a href='../ny-technical-reason-why-in-programming-the-default-date-format-is-yyyymmdd-and-not-something-else/'>Ny technical reason why, in programming, the default date format is YYYYMMDD and not something else</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>