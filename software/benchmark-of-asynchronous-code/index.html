<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Benchmark of asynchronous code &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069505 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069505" class="post-1069505 software type-software status-publish hentry category-software tag-asynchronous-programming tag-node-js tag-performance"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Benchmark of asynchronous code</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asynchronous-programming</span><span class="mr-2 badge badge-info">node.js</span><span class="mr-2 badge badge-warning">performance</span></p><div class="entry-content"><p>Asynchronous programming seems to be getting quite popular these days. One of the most quoted advantages is performance gain from removing operations that block threads. But I also saw people saying that the advantage is not that great. And that properly configured thread pool can have same effect as fully asynchronous code.</p><p>My question is, are there any real benchmarks that compare blocking vs. asynchronous code? It can be any language, but I think C# and Java would be most representative. Not sure how good would this benchmark be with Node.js or similar.</p><p><strong>Edit</strong> : My attempt at general question combined with unclear terminology seems to have failed. By &#34;asynchronous code&#34;  I mean what some answers described as event or callback programming. In the final result, operations that would block thread are instead delegated to some callback system so threads can be utilized better.</p><p>And if I wanted to ask specific question : <em>Are there any benchmarks that compare throughput/latency gain of async/await server code in .NET? Or any other similar comparison?</em></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Based on your comments, it seems that you&#39;re really interested in &#34;non-blocking IO.&#34; This differs from my definition of &#34;asynchronous programming,&#34; which is an approach to decomposing work exemplified by Erlang processes or Goroutines.</p><p>And, if that is your definition, then yes, there have been <a href="http://paultyma.blogspot.com/2008/03/writing-java-multithreaded-servers.html" rel="nofollow">benchmarks</a>. But, like all benchmarks, they shouldn&#39;t be accepted blindly. Instead, you need to think about what goes on behind the scenes.</p><ul><li><em>A thread is the unit of OS scheduling.</em> Platforms such as Erlang and Go build their own schedulers on top of the OS scheduler, allowing multiple units of execution to share the same thread. This is great, as long as your units of execution are lightweight, because it avoids the overheads associated with threads.<sup>*</sup> However, IO operations require a trip to the kernel, which means that you need a real thread to do them. And if you&#39;re implementing a sub-thread scheduler, you need to be smart about not scheduling sub-thread tasks on a thread that&#39;s blocked in a kernel operation.</li><li><em>All IO operations have the potential to block.</em><sup>**</sup> When you make a <code>read</code> or <code>write</code> request, the kernel looks to see if there is data available or (for write) room in a buffer. If not, the kernel suspends the thread until the operation can complete. This makes thread-per-connection servers really simple to implement, but worries people who think about thread overheads.</li><li><em>Operating systems provide a way to block on multiple IO channels simultaneously.</em> The <code>select</code> call on POSIX is one of these: you provide it with a list of channels (file descriptors / sockets) that you care about, and it will tell you when one of them is ready to read or write (read is what most people care about). You still have to make a kernel call, and you&#39;ll still end up blocking a thread if nothing&#39;s available, but that&#39;s only <em>one</em> thread. This is <a href="http://nodejs.org/about/" rel="nofollow">how Node.js works</a>: when data is available, the proper event handler is called (I don&#39;t know the internals of Node, but hope that they also verify that write buffers are available before calling <code>write</code>).</li><li><em>When you max CPU, you&#39;re done.</em> It doesn&#39;t matter whether you use <code>select</code> or a thread-per-connection approach, you still need to spend CPU to do whatever your server is meant to do. With the thread-per-connection approach, you don&#39;t really pay attention to that: the scheduler will assign threads to cores, and you&#39;ll degrade gracefully. With <code>select</code>, you will need to hand connections off to threads when they&#39;re ready for processing, or you&#39;ll be limited by the performance of a single core (Node.js gets around that by letting you spawn multiple servers).</li></ul><p>As I said, benchmarks shouldn&#39;t be accepted blindly; they&#39;re only valid as long as they model the real-world problem that you&#39;re trying to solve. The author of the linked benchmark works for (worked for?) Mailinator, which if you haven&#39;t used it, is a <em>poste restante</em> service for ad hoc email addresses. Which means that it&#39;s going to be getting short-lived, high-activity connections from a relatively small number clients. This is a perfect use case for thread-per-connection scheduling. As noted in the comments, a chat server (long-lived, low activity) might be different.</p><p>In my mind, the question of blocking versus non-blocking IO is rather boring: most real-world servers don&#39;t have that many concurrent connections. More interesting to me is the programming model: a worker-based model like Erlang or Go means that you can focus on your business logic, and not care how connections are being managed.</p><p><sup>* These overheads include kernel scheduling structures, and perhaps most important, a multi-megabyte thread stack, most of which goes unused. While 2MB doesn&#39;t seem like much, it adds up quickly if you have 100k processes ... which most applications don&#39;t have.</sup></p><p><sup>** Not 100% true, but I don&#39;t want to get too deep into the weeds here.</sup></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../how-to-benchmark-concurrent-key-value-stores/'>How to benchmark concurrent key-value stores</a></li><li class="list-group-item"><a href='../c-async-await-pedantry-vs-the-debugger/'>C# async/await: Pedantry vs. the Debugger</a></li><li class="list-group-item"><a href='../is-there-really-a-fundamental-difference-between-callbacks-and-promises/'>Is there really a fundamental difference between callbacks and Promises</a></li><li class="list-group-item"><a href='../an-elegant-way-to-detect-the-end-of-an-asynchronous-recursive-file-search/'>An elegant way to detect the end of an asynchronous recursive file search</a></li><li class="list-group-item"><a href='../java-is-the-c-async-task-construct-equivalent-to-javas-executor-future/'>Java &#8211; Is the C# async/Task construct equivalent to Java&#8217;s Executor/Future</a></li><li class="list-group-item"><a href='../c-why-is-it-necessary-for-every-new-api-to-be-async/'>C# &#8211; Why is it necessary for every new api to be async</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>