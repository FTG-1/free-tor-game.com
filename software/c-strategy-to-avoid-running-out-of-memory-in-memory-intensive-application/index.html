<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Strategy to avoid running out of memory in memory intensive application &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1065811 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1065811" class="post-1065811 software type-software status-publish hentry category-software tag-c tag-memory-usage"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Strategy to avoid running out of memory in memory intensive application</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">memory usage</span></p><div class="entry-content"><p>My C# .NET application has to read lots of files with electrical readings. There are several calculation to be done and output files need to be generated.<br /> Due to the nature of the input it would be very inefficient to output after each input line or even after one file, so it would be better to do so after a chunk of files.</p><p>The reason for this is, that each file contains a list of readings/electrical units for one time stamp, but the output needs to be files for each unit.<br /> So for instance the input would be 100 files each containing e.g. volt, ampere, watt, status code for one timestamp (2015_08_31_00_00_00.txt, 2015_08_31_00_00_05.txt &#8230;).<br /> The output should be per electrical unit and e.g. one file per day <br />(c://ampere/2015_08_31.txt, c://volt/2015_08_31.txt &#8230;).</p><p>Note that this is a simplified picture of the application. In reality there are several different input and output formats, directory structures etc.</p><p>What I want to do is, keep the calculated and ready for output values in memory and output them according to different strategies. This could be e.g. until all input files are processed.</p><p>As some strategies like this one can result in too much data in memory, I would like to monitor the memory usage and decide if I need to output sooner.</p><p><strong>I do know how to get the used memory of my program</strong>, but how do I safely get an estimation on the available memory?</p><p>As far as I understand this is not a simple task due to memory fragmentation, paging, trashing and so on. I do know in this case that I got the 32-Bit induced memory limit with the current build settings, but I would like to get a general answer which could also be applied to a 64-Bit program.</p><p>How do I estimate when enough memory is still available to write to disk, but use a good amount of RAM to optimize I/O?</p><p><strong>Update</strong> <br /> <br /> I have not yet implemented this feature so I cannot tell if memory problems would occur under usual circumstances. Thanks to all your comments and answers I see it isn&#39;t easily accomplishable.</p><p>My current idea is to use a fixed input limit based on the size of the input files. This still would not protect against problems if other programs creates heavy load.<br /> Each file is always just a few KB.</p><p><strong>I will keep the SQLite idea in mind but I will have to check if I get an OK</strong></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Unfortunately, there&#39;s really no good way to answer the question &#34;how much RAM is my program using?&#34; or &#34;how close am I to hitting the <code>OutOfMemoryException</code> wall?&#34;, for a number of reasons. It&#39;s a lot more complicated than it looks like it should be.</p><p>One thing you might want to do, though, is make sure that you&#39;re not holding on to the input data unnecessarily.  For example, depending on how you&#39;re processing the data, it could be feasible to read the file, and perform the relevant calculations, one line at a time, or one small batch of lines at a time.  If you hold on to aggregate results, but don&#39;t keep the input data around, that should keep the memory usage down.</p><p>If that doesn&#39;t help, because your results just keep piling up, the best way to handle <em>that</em> is to offload them out of memory.  Put them in a relational database, for example, as fast as they come in, and then they end up on disc instead.  And then at the end of the day, perform a query that will pull in the day&#39;s results (HINT: this is a lot easier if you have a timestamp field that gets set when you insert the records) and save them out to their final version in your output files.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-moving-from-local-storage-to-a-remote-database-how-should-i-cache-the-data-locally/'>C# &#8211; Moving from local storage to a remote database: how should I cache the data locally</a></li><li class="list-group-item"><a href='../c-optimize-reading-of-multiple-files/'>C# &#8211; Optimize Reading of Multiple files</a></li><li class="list-group-item"><a href='../c-application-to-read-xml-files-parsing-them-storing-locally-in-data-structure-and-writing-to-csv/'>C# application to read xml files, parsing them, storing locally in data structure and writing to csv</a></li><li class="list-group-item"><a href='../if-i-need-to-use-a-piece-of-memory-throughout-the-lifespan-of-the-program-is-it-really-necessary-to-free-it-right-before-program-termination/'>If I need to use a piece of memory throughout the lifespan of the program, is it really necessary to free it right before program termination</a></li><li class="list-group-item"><a href='../c-the-use-cases-for-azure-file-storage/'>C# &#8211;  the use cases for Azure file storage</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>