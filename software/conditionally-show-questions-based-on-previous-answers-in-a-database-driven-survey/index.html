<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Conditionally show questions based on previous answers in a database driven survey &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082122 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082122" class="post-1082122 software type-software status-publish hentry category-software tag-algorithms tag-database-design tag-dependencies"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Conditionally show questions based on previous answers in a database driven survey</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">database-design</span><span class="mr-2 badge badge-warning">dependencies</span></p><div class="entry-content"><p>I&#39;m trying to design survey-type application that uses user responses to  determine what the next question should be. For simplicity&#39;s sake, question types can be either combo boxes (they have a set of distinct answers to choose from) or images (user selects an image file from their system). I require this to be database-driven, so questions (and any answers they depend on) need to be stored in the database.</p><p>Here is a sample question flow:</p><p><a href="../../../i.stack.imgur.com/8U3bz.png" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/8U3bz.png" alt="Sample question flow"/></a></p><p>There are several use cases in this example. Initially, the user would be presented with question Q1 (no other questions visible at this time). If the user answers &#34;Yes&#34;, both Q2 and Q10 become visible. If Q1 is &#34;No&#34;, then Q3 becomes visible instead. This is the simplest case.</p><p>Another common scenario is shown later on. Q5, Q6, and Q7 are all shown at the same time. If the user answers those specific questions with &#34;Yes&#34;, &#34;Dogs&#34;, and &#34;Yes&#34;, respectively, then Q10 is shown. In all other cases, Q8 is shown instead.</p><p>The final scenario is where two branches both lead to the same question. For example, if the user answers Q8 with &#34;Yes&#34;, then Q10 is shown. If the answer is &#34;No&#34;, then Q9 is shown instead, and Q10 is only revealed once the user has answered Q9 (with any result).</p><p>There can be any combination of the above scenarios. Additionally, as you can see, some questions can be reached from several different branches (Q10, for example, can be accessed on 3-4 different question flows).</p><p>The issue I&#39;m having is coming up with a good database design to accommodate these requirements. The approach I&#39;ve been aiming for to tackle this is to define some kind of dependency lookup table in the database.</p><p>Here&#39;s the general (simplified) structure I came up with:</p><pre><code>----------
|Question|
----------
QuestionID,
QuestionText

---------------
|QuestionGroup|
---------------
GroupID, 
QuestionID

--------------------
|QuestionDependency|
--------------------
ParentGroupID,
ParentGroupValue,
ChildGroupID
</code></pre><p>The idea here is that each question could belong to one or more &#34;groups&#34;, meaning that a single answer could enable several questions at once (by activating just one group). The QuestionDependency tables is used to look up which question groups to activate based on the ParentGroupValue field. Let&#39;s look at a concrete example based on the sample question flow from above:</p><p><a href="../../../i.stack.imgur.com/tUylP.png" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/tUylP.png" alt="Question Tables for Sample Flow"/></a></p><p>(In these tables, <code>&lt;ans&gt;</code> means the question has been answered and is not blank &#8211; can be any other value.)</p><p>So for example, as you can see in the QuestionDependency table, once the answers in G1 (which only has one question) are equal to &#34;Yes&#34;, then G2 (which contains Q2 and Q10) is enabled. Otherwise if the answer is &#34;No&#34;, G3 is enabled. Similarly for G5, if the answers for questions Q5, Q6, and Q7 are &#34;Yes&#34;, &#34;Dogs&#34;, and &#34;Yes&#34; respectively (parsing logic will be handled separately, don&#39;t worry about that), then questions in G8 are enabled. In all other combinations (assuming each question is actually answered), G6 is enabled instead.</p><p>The problem with this approach is that when questions belong to multiple groups (as with Q10), there&#39;s no way of knowing from the code which group is currently being accessed. If the user answers Q10, are they answering from G2 or G8? I&#39;m unable to determine that.</p><p>My main question is, can you think of a better way to approach this problem? I&#39;ve been trying to think of a better solution for several days now and this is unfortunately the best I&#39;ve come up with.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>First, three observations.</p><p>Already covered by Christophe in the previous answer: the table that controls the flow to another question group needs to have the QuestionID as a foreign key.  Otherwise the answers &#34;Yes&#34; or &#34;Dogs&#34; can&#39;t be related to a question.</p><p>I would change the terminology from &#34;ParentGroup/ChildGroup&#34; to &#34;QuestionGroup/FollowingGroup&#34;, because Parent/Child has a narrow, technical meaning that doesn&#39;t apply here.</p><p>Your Question Dependency table doesn&#39;t cater for conditions that involve multiple questions - for example &#34;If Q1 answer is Yes, and Q2 answer is &#34;Dogs&#34;, go to G4&#34;.  To do this you&#39;d have to normalise this table out into two tables:</p><pre><code>Flow
FlowID OriginGroup       NextGroup
F1     G1                G2
F2     G1                G4

FlowDependency
FlowID   QID     Value
F2       Q1      Yes
F2       Q2      Dogs
</code></pre><p>And two further points:</p><p><strong>Further possible answers</strong> There are two further possible answers that you may need to somehow encode in the QuestionDependency table: <em>no answer</em>, and <em>any answer</em>.  (If you have independent code that globally enforces an &#34;answers to all questions are mandatory&#34; rule, then the former won&#39;t apply).</p><p><em>No answer</em> would have to be encoded as a conventional string that will never be used as an actual question answer.  Alternatively, it could be encoded as a row in the table with Value=NULL, so that the answer to that question is never even considered by the particular &#34;flow&#34;.</p><p><em>Any answer</em> could be encoded as the absence of a row.  For example, say there&#39;s a question group G1 with questions Q3, Q4, Q5.  If the user answers &#34;Hovercraft&#34; to Q3, and &#34;Eels&#34; to Q4, then they should be redirected to group G4 (which shows a Monty Python video about Hungarians speaking English).  Q5 is about their favourite breakfast cereal, and is irrelevant to the flow between question groups.  This could be encoded as</p><pre><code>Group        Question        Value       FollowingGroup
G1           Q3              Hovercraft  G4
G1           Q4              Eels        G4
</code></pre><p>The code that interprets these rules would match the answers to Q3 and Q4 to the Values in the table, not consider Q5 at all, and since it finds that everything matches, direct the user to G4.</p><p><strong>Default flow</strong> It would be very difficult to guarantee coverage of all possible answers/combinations of answers: in other words, to guarantee by populating a QuestionDependency table that, whatever answers the user gives, they go <em>somewhere</em> when they press &#34;Next&#34;.  So I suggest that each question group have a &#34;default next group&#34; specified.  If none of the conditions in QuestionDependency are matched, the user goes to the default next group.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../how-would-an-algorithm-that-splits-sorts-numbers-into-three-groups-to-make-them-equally-large-work/'>How would an algorithm that splits/sorts numbers into three groups to make them equally large work</a></li><li class="list-group-item"><a href='../php-examples-of-designing-a-database-that-handles-point-tracking/'>Php &#8211; Examples of designing a database that handles point tracking</a></li><li class="list-group-item"><a href='../database-design-for-storing-user-groups-based-on-filter-criteria/'>Database design for storing user groups based on filter criteria</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>