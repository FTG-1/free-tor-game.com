<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; Should we mock entities and value objects when doing DDD &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069509 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069509" class="post-1069509 software type-software status-publish hentry category-software tag-domain-driven-design tag-object-oriented tag-tdd tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; Should we mock entities and value objects when doing DDD</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">domain-driven-design</span><span class="mr-2 badge badge-info">object-oriented</span><span class="mr-2 badge badge-warning">tdd</span><span class="mr-2 badge badge-primary">unit testing</span></p><div class="entry-content"><p>After reading a <a href="http://misko.hevery.com/2008/09/30/to-new-or-not-to-new/" rel="noreferrer">few</a> <a href="http://www.loosecouplings.com/2011/01/how-to-write-testable-code-overview.html" rel="noreferrer">articles</a> about <strong>Newable</strong> vs <strong>Injectable</strong> objects and how these concepts relate to DDD&#39;s services, entities and value objects, I was left with some doubts about using newables in my code especially in my unit tests.</p><p>Main candidates for newables were Entities and Value objects meaning that instead of injecting these dependencies into other objects one should just <code>new</code> an instance of these objects and use them directly in the code.</p><p>However, good DDD practices advocate assigning responsibilities to entities and value objects if they were deemed appropriate. So the entities and value objects will end having some serious business logic in them.</p><p>Now if a service operates on an entity or a value object should I mock the entity or value object and pass the mock to the service (mocking will require an <code>interface</code> for the value objects or entities which seems to be advocated against) ?</p><p>Or should I just <code>new</code> an entity/value object and pass a concrete implementation to the service and thus violating the unit testing principle of testing only one unit?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m reading that you&#39;re of the opinion that unit tests, much like SOLID objects, must have &#34;one reason to break&#34;. It&#39;s a noble goal, but I think you&#39;ll find that in many cases it is simply not feasible. One of those cases is here, where you have a &#34;rich&#34; domain object (DDD differentiates between Entities and Value Objects, which both comprise the &#34;domain model&#34;) that is a dependency of the system under test.</p><p>In these situations, I have the philosophy that, <em>given</em> the domain object has its own comprehensive unit test coverage, trusting that the object will work as designed in a unit test for a different SUT does not necessarily violate the unit test. If this test were to break because of a breaking change to the domain, then I would expect the domain object&#39;s unit test to break as well, leading me toward something to investigate. If the domain object&#39;s unit test had been updated properly as a red test, then made green with the change, and this other test then failed, that&#39;s not necessarily a bad thing either; it means that the expectations of this other test conflict with the new expectations for the domain, and I need to make sure both of them agree with each other and the overarching acceptance criteria of the system.</p><p>As such, I would only mock a domain object if said domain object produced &#34;side effects&#34; that were undesirable from a unit-testing perspective (i.e. touching external resources like data stores), or if the logic of the domain object were sufficiently complex that placing it in the proper state for the test becomes a roadblock to defining and passing the test.</p><p>That then becomes the driving question; which is easier? To use the domain object for its intended purpose within the test, or to mock it? Do whichever is easier, until it&#39;s no longer the easier option, such as when a functional change breaks the test of the service in a complex way; if this happens, then rewrite the test to produce a mock that exposes the functional requirements depended on by the service, without the complexity that breaks it.</p><p>Understand that either way, there should be an integration test that uses the real domain object plugged into the real service that tests the interaction between these two at a higher level of abstraction (such as testing, for instance, not only the functionality behind a service endpoint, but a proxy across which the domain object is serialized and sent).</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../ddd-and-value-objects-are-mutable-value-objects-a-good-candidate-for-non-aggr-root-entity/'>DDD and Value Objects. Are mutable Value Objects a good candidate for Non Aggr. Root Entity</a></li><li class="list-group-item"><a href='../ddd-can-immutable-objects-also-be-entities/'>DDD: Can immutable objects also be entities</a></li><li class="list-group-item"><a href='../c-how-to-use-mock-objects-c-without-passing-them-as-arguments-to-functions/'>C++ &#8211; How to use mock objects [C++] without passing them as arguments to functions</a></li><li class="list-group-item"><a href='../architecture-implementing-ddd-by-vernon-value-object-or-not/'>Architecture &#8211; &#8220;Implementing DDD&#8221; by Vernon: value object or not</a></li><li class="list-group-item"><a href='../java-is-it-really-a-bad-practice-to-mock-a-pojo-value-object-if-you-dont-care-about-what-it-contains/'>Java &#8211; Is it really a bad practice to mock a POJO (value object) if you don&#8217;t care about what it contains</a></li><li class="list-group-item"><a href='../c-should-i-mock-a-domain-service/'>C# &#8211; Should I mock a Domain Service</a></li><li class="list-group-item"><a href='../unit-testing-how-to-detect-dependency-problems-with-unit-tests-when-you-use-mock-objects/'>Unit-testing &#8211; How to detect dependency problems with unit tests when you use mock objects</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>