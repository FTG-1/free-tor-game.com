<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; What are the problems of bringing C++-like const into a language &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074483 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074483" class="post-1074483 software type-software status-publish hentry category-software tag-c tag-const tag-language-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; What are the problems of bringing C++-like const into a language</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">const</span><span class="mr-2 badge badge-warning">language-design</span></p><div class="entry-content"><p>I am interested in the idea of C++-like <code>const</code> not that particular execution (like casting away <code>const</code>).</p><p>Take for example C# &#8212; it lacks C++-like const, and the reason for it is the the usual &#8212; people and time. Here additionally<br /> it seems the C# team looked at the C++ execution of <code>const</code>, marketing CLR and had enough at this point (see <a href="https://stackoverflow.com/q/4150478/41071">why there is no const member method in c# and const parameter</a> ; thank you Svick). Be if <strong>we</strong> move further than that, is anything else?</p><p>Is there something deeper? Take for example multi-inheritance &#8212; it is usually seen as hard to grasp (for the user) and thus not added to the language (like diamond problem).</p><p>Is there something in <strong>NATURE</strong> of <code>const</code> that pose a problem that it is better for language to avoid it? Something like deciding if <code>const</code> should be deep or shallow (having <code>const</code> container does it mean I cannot add new element or alter existing elements as well; what if elements are of reference type)?</p><p><strong>UPDATE</strong>: while I mention C#, and thus making a historical perspective I am interested in the nature of potential problems of <code>const</code> to the language.</p><p><em>This is not a challenge of the languages. Please ignore such factors as current trends or popularity &#8212; I am interested only in technical issues &#8212; thank you.</em></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Note sure if this qualifies for you, but in functional languages like Standard ML everything is immutable by default. Mutation is supported through a generic <code>ref</code>erence type. So an <code>int</code> variable is immutable, and a <code>ref int</code> variable is a mutable container for <code>int</code>s. Basically, variables are <em>real</em> variables in the mathematical sense (an unknown but fixed value) and <code>ref</code>s are &#34;variables&#34; in the imperative programming sense - a memory cell that can be written to and read from. (I like to call them <em>assignables</em>.)</p><p>I think the problem with <code>const</code> is two-fold. First, C++ lacks garbage collection, which is necessary to have non-trivial <a href="http://en.wikipedia.org/wiki/Persistent_data_structure" rel="noreferrer">persistent data structures</a>. <code>const</code> <em>must</em> be deep to make any sense, yet having fully immutable values in C++ is impractical.</p><p>Second, in C++ you need to opt into <code>const</code> rather than opt out of it. But when you forget to <code>const</code> something and later fix it, you&#39;ll end up in the &#34;const poisoning&#34; situation mentioned in @RobY&#39;s answer where the <code>const</code> change will cascade throughout the code. If <code>const</code> was the default, you wouldn&#39;t find yourself applying <code>const</code> retroactively. Additionally, having to add <code>const</code> everywhere adds a lot of noise to the code.</p><p>I suspect the mainstream languages that followed (e.g. Java) were heavily shaped by C and C++&#39;s success and way of thinking. Case in point, even with garbage collection most languages&#39; collection APIs assume mutable data structures. The fact that everything is mutable and immutability is seen as a corner case speaks volumes about the imperative mindset behind popular languages.</p><p><strong>EDIT</strong>: After reflecting on <a href="https://softwareengineering.stackexchange.com/questions/231269/what-are-the-problems-of-bringing-c-like-const-into-a-language#comment461045_231342">greenoldman&#39;s comment</a> I realized that <code>const</code> isn&#39;t directly about the immutability of data; <code>const</code> encodes into the type of the method whether it has side effects on the instance.</p><p>It&#39;s possible to use mutation to achieve <a href="http://en.wikipedia.org/wiki/Referential_transparency_(computer_science)" rel="noreferrer">referentially transparent</a> behavior. Suppose you have a function that when called successively returns different values - for example, a function that reads a single character from <code>stdin</code>. We could use cache/memoize the results of this function to produce a referentially transparent stream of values. The stream would be a linked list whose nodes will call the function the first time you try to retrieve their value, but then cache the result. So if <code>stdin</code> constains <code>Hello, world!</code>, the first time you try to retrieve the value of the first node, it&#39;ll read one <code>char</code> and return <code>H</code>. Afterwards it&#39;ll continue to return <code>H</code> without further calls to read a <code>char</code>. Likewise, the second node would read a <code>char</code> from <code>stdin</code> the first time you try to retrieve its value, this time returning <code>e</code> and caching that result.</p><p>The interesting thing here is that you&#39;ve turned a process that&#39;s inherently stateful into an object that&#39;s seemingly stateless. However, it was necessary to mutate the object&#39;s internal state (by caching the results) to achieve this - the mutation was a <em>benign effect</em>. It&#39;s impossible to make our <code>CharStream</code> <code>const</code> even though the stream <em>behaves</em> like an immutable value. Now imagine there&#39;s a <code>Stream</code> interface with <code>const</code> methods, and all your functions expect <code>const Streams</code>. Your <code>CharStream</code> can&#39;t implement the interface!</p><p><em>(<strong>EDIT 2:</strong> Apparently there&#39;s a C++ keyword called <code>mutable</code> that <a href="http://blog.aaronballman.com/2011/06/when-const-isnt-const-its-mutable/" rel="noreferrer">would allow us to cheat and make <code>CharStream</code> <code>const</code></a>. However, this loophole destroys <code>const</code>&#39;s guarantees - now you really can&#39;t be sure something won&#39;t mutate through its <code>const</code> methods. I suppose it&#39;s not that bad since you must explicitly request the loophole, but you&#39;re still completely reliant on the honor system.)</em></p><p>Secondly, suppose you have high-order functions - that is, you can pass functions as arguments to other functions. <code>const</code>ness is part of a function&#39;s signature, so you wouldn&#39;t be able to pass non-<code>const</code> functions as arguments to functions that expect <code>const</code> functions. Blindly enforcing <code>const</code> here would lead to a loss of generality.</p><p>Finally, manipulating a <code>const</code> object doesn&#39;t guarantee that it&#39;s not mutating some external (static or global) state behind your back, so <code>const</code>&#39;s guarantees aren&#39;t as strong as they initially appear.</p><p><strong>It&#39;s not clear to me that encoding the presence or absence of side effects into the type system is universally a good thing.</strong></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../javascript-language-design-are-languages-like-python-and-coffeescript-really-more-comprehensible/'>Javascript &#8211; Language Design: Are languages like Python and CoffeeScript really more comprehensible</a></li><li class="list-group-item"><a href='../when-and-for-what-purposes-should-the-const-keyword-be-used-in-c-for-variables/'>When and for what purposes should the const keyword be used in C for variables</a></li><li class="list-group-item"><a href='../object-oriented-what-are-the-caveats-of-implementing-fundamental-types-like-int-as-classes/'>Object-oriented &#8211; What are the caveats of implementing fundamental types (like int) as classes</a></li><li class="list-group-item"><a href='../banning-zero-argument-functions-what-problems-could-it-cause-in-a-hypothetical-language/'>Banning zero-argument functions &#8212; what problems could it cause in a hypothetical language</a></li><li class="list-group-item"><a href='../c-why-c-core-language-is-becoming-fused-with-the-standard-library/'>C++ &#8211; Why C++ core language is becoming fused with the standard library</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>