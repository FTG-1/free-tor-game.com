<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Use a timestamp parameter for cache invalidation &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082463 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082463" class="post-1082463 software type-software status-publish hentry category-software tag-caching"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Use a timestamp parameter for cache invalidation</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">caching</span></p><div class="entry-content"><p>I am considering a scheme for passing a timestamp value in a cached response, and then sending it back to the service to perform cache invalidation. I&#39;m wondering if that&#39;s a valid approach. Is that a common approach?</p><p>For example, if I have a service that returns a &#34;Foo&#34; record, which is a combination of DB lookups and calculations. Let&#39;s say Foo is identified with a key. To speed things up, I want to keep a local cache of results.</p><p>The problem is, across a bank of servers, the local caches will get out of sync, because the calculated results will change over time.</p><p>So my thought is:</p><ul><li>for a request, calculate a Foo</li><li>store the Foo in local cache with an &#34;as of&#34; timestamp</li><li>return the Foo along with the &#34;as of&#34; timestamp</li><li>when the client wants to fetch a Foo, it passes the key as well as the &#34;as of&#34; timestamp.</li><li>if the server finds the key in the local cache, and the &#34;as of&#34; timestamp in cache is newer than the &#34;as of&#34; parameter, return the cached Foo with the Foo, key and &#34;as of&#34; timestamp</li><li>otherwise recalculate the Foo, cache it, and return the (new) Foo, key and (new) &#34;as of&#34; timestamp</li></ul><p>The client would need to keep track of both the key and the &#34;as of&#34; timestamp, but then it would essentially control when service instances refresh their local cache, without the service instances talking to each other or some back-end storage for coordination.</p><p>If the client wanted to force a cache refresh, it could pass &#34;as of&#34; of max value, which would force a refresh on any service instance it hits.</p><p>Certainly I could put a caching layer in front of my service, and I could also save results in a distributed cache. Those solutions have their own data replication and expiration issues too. But for the purpose of this question, I really want to consider local caching &amp; consider the architectural questions separately.</p><p>Q: Does that work? Is it valid or good to use a timestamp parameter as a mechanism for cache invalidation?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Local caching is simpler to implement.  The issues to watch out for are:</p><ol><li>Multiple cache misses during the cache population event.</li><li>Cache population fails.</li><li>Depending on which server the request hits will return a different answer.</li></ol><p>With .NET I handled the cache miss problem by having the cache store the Task&lt;&gt; asynchronous wrapper, and using locking to ensure that only one Task&lt;&gt; to obtain the cached value was created.  This worked well.</p><p>When the process to obtain the cache value fails, what does your application do?  Does it cache the failure returning the error until the cache expires?  Or do you create a new attempt to obtain the value?</p><p>When you have a multiple servers with independent caches and the underlying values changing regularly the answer will depend entirely on which server handles that request.  This may not be an issue in your application, but think long and hard about what this means for your user and their confidence in your competence.  If you keep getting conflicting data it can undermine trust.</p><p>Implementing a distributed cache with riak and key expiration solves many of these issues when you have multiple application servers.  However it does not solve the cache population issue, when multiple threads on multiple servers all decide that the cache needs re-populating.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-whats-the-best-way-to-cache-a-growing-database-table-for-html-generation/'>Database &#8211; What&#8217;s the best way to cache a growing database table for html generation</a></li><li class="list-group-item"><a href='../java-forcing-cache-refresh/'>Java &#8211; Forcing Cache Refresh</a></li><li class="list-group-item"><a href='../how-does-redis-or-any-typical-distributed-cache-handle-replication-conflicts/'>How does Redis (or any typical distributed cache) handle replication conflicts</a></li><li class="list-group-item"><a href='../architecture-preventing-abuse-of-api-which-is-called-via-client-side-javascript/'>Architecture &#8211; Preventing abuse of API which is called via client side Javascript</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>