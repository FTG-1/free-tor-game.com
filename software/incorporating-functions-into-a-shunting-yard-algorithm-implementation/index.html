<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Incorporating functions into a Shunting-Yard algorithm implementation &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082641 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082641" class="post-1082641 software type-software status-publish hentry category-software tag-algorithms tag-grammar tag-parsing tag-programming-languages tag-shunting-yard"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Incorporating functions into a Shunting-Yard algorithm implementation</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">grammar</span><span class="mr-2 badge badge-warning">parsing</span><span class="mr-2 badge badge-primary">programming-languages</span><span class="mr-2 badge badge-danger">shunting-yard</span></p><div class="entry-content"><p><strong>tl;dr</strong> What would be a simple way of incorporating functions into a Shunting-Yard algorithm implementation?</p><p>If only expressions like <code>function(arg1, arg2, arg3)</code> were allowed (where <code>function</code> is some builtin function), then it would be really easy, since I could just treat <code>function</code> like an operator. But consider a case where the user defines their own function like <code>f = function</code>, then calls <code>f(arg1, arg2, arg3)</code>. In this case I would need a strongly-typed AST to detect at compile time what <code>f</code>&#39;s type is in order to see that the proceeding tokens (<code>(arg1, arg2, arg3)</code>) are actually a function call, and not just a construction of a tuple.</p><p>Even worse, consider <code>(f)()</code> where <code>f</code> is a user-defined nullary function. Then when I get to <code>f</code>, even if I know that it&#39;s a function, the next token will be <code>)</code>, which is not the start of a valid function call. What about <code>(l[i])()</code>, where <code>l</code> is a list of functions?</p><p>At the most general level, I understand grammatically that when we have a statement like <code>[expression], &#34;(&#34;, [expression], &#34;)&#34;</code>, then we know that we&#39;re calling a function. However, I&#39;m not quite sure how to check this without implementation an AST (which, for simplicity&#39;s sake, I would rather not do).</p><p>I could store a list of all operator and &#34;bracket&#34; tokens, and then when I reach the &#34;(&#34; in a supposed function call I just check whether the last non-bracket token was an operator. If it was an operator then the &#34;(&#34; represents a subexpression, like in <code>5 * (3 - 8)</code>. If it wasn&#39;t an operator, then the &#34;(&#34; represents a function call. However, this method feels easily broken. For example, what if there where some operator <code>$</code> that was &#34;unary left-associative&#34;, so that <code>(expression $)(args)</code> was valid? Then the algorithm would fail unless I had special checking for <code>$</code>. What if there was a comment between the function and the function call, like <code>function \* comment *\ (args)</code>? Or even worse, something like</p><pre><code>function \\ lol the last token in this comment is an operator +
    (args)
</code></pre><p>These would require implementing handlers a lot of special cases, and I&#39;m wondering if there&#39;s a better way of doing it.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I use a two state, two stack model similar to the Shunting Yard algorithm.  The two states are the unary state and the binary state.  In each state, you handle tokens (or issue errors) and then either continue the same state or switch to the other state.</p><p>In the unary state, if you find an open paren, <code>(</code>, it is operator grouping, and, you stay in the unary state.  (In the unary state, an identifier is a variable reference you push it onto the operand stack, and switch to the binary state; a minus, <code>-</code>, is a unary negation, and you stay in unary state.)</p><p>In the binary state, if you find an open paren, it is a function invocation (and you switch to the unary state).  Differentiating between the two states also help you deal with unary and pre/post-fix operators.  (Here a minus, <code>-</code>, is a binary subtraction and you switch to unary state.)</p><hr/><p>ok, for the expression <code>(*p[i++])()</code>, <code>p</code> is a pointer to pointer to function, right?  So,</p><p><a href="../../../i.stack.imgur.com/6tdFT.png" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/6tdFT.png" alt="enter image description here"/></a></p><p>(Note that the empty parameter list expression should only be allowed when function calls are actually present; there are various ways and places for detecting the various possible errors.)</p><p>The actual tokens handled in unary state and in binary state are determined by the language you&#39;re trying to parse.  I allow separate code sections for the unary state and the binary state.  There seems to be no point in mixing them and then you don&#39;t need a state variable either (the code section just knows which one it is).</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../python-coming-up-with-tokens-for-a-lexer/'>Python &#8211; Coming up with tokens for a lexer</a></li><li class="list-group-item"><a href='../precedence-of-function-in-shunting-yard-algorithm/'>Precedence of function in Shunting-yard algorithm</a></li><li class="list-group-item"><a href='../algorithm-to-go-from-infix-notation-to-a-tree/'>Algorithm to go from infix notation to a tree</a></li><li class="list-group-item"><a href='../right-way-to-read-from-token-list-to-implement-parse-tree/'>Right way to read from token list to implement parse tree</a></li><li class="list-group-item"><a href='../shunting-yard-algorithm-and-unary-minus/'>Shunting-yard algorithm and unary minus</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>