<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Best practices regarding type mapping and extension methods &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064951 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064951" class="post-1064951 software type-software status-publish hentry category-software tag-c tag-type-conversion"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Best practices regarding type mapping and extension methods</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">type conversion</span></p><div class="entry-content"><p>I want to ask some questions about best practices regarding mapping types and using extension methods in C#. I know this topic has been discussed multiple times over past few years, but I&#39;ve read a lot of posts and still have doubts.</p><p>The problem I encountered was extending class that I own with &#34;convert&#34; functionality. Let&#39;s say that I have class &#34;Person&#34; that represents an object which will be used by some logic. I also have a class &#34;Customer&#34; that represents a response from external API (actually there will be more than one API, so I need to map each API&#39;s response to common type: Person). I have access to both classes&#39; source code and theoretically can implement my own methods there. I need to convert Customer to Person so I can save it to database. The project doesn&#39;t use any automatic mappers.</p><p>I have 4 possible solutions in mind:</p><ol><li><p>.ToPerson() method in Consumer class. It&#39;s simple, but it seems like breaking the Single Responsibility pattern to me, especially that the Consumer class is mapped to other classes (some required by another external API) as well, so it would need to contain multiple mapping methods.</p></li><li><p>Mapping constructor in Person class taking Consumer as an argument. Also easy and also seems like breaking Single Responsibility pattern. I&#39;d need to have multiple mapping constructors (since there will be class from another API, providing the same data as Consumer but in slightly different format)</p></li><li><p>Converters class with extension methods. This way I can write .ToPerson() method for Consumer class and when another API is introduced with it&#39;s own NewConsumer class, I can just write another extension method and keep it all in the same file. I&#39;ve heard an opinion that extension methods are evil in general and should be used only if absolutely necessary so that&#39;s what is holding me back. Otherwise I like this solution</p></li><li><p>Converter/Mapper class. I create separate class that will handle conversions and implement methods that will take source class instance as an argument and return destination class instance.</p></li></ol><p>To sum up, my problem can be reduced to number of questions (all in context to what I described above):</p><ol><li><p>Is putting conversion method inside (POCO?) object (like .ToPerson() method in Consumer class) considered breaking single responsibility pattern?</p></li><li><p>Is using converting constructors in (DTO-like) class considered breaking single responsibility pattern? Especially if such class can be converted from multiple source types, so multiple converting constructors would be required?</p></li><li><p>Is using extension methods while having access to original class source code considered bad practice? Can such behavior be used as viable pattern for separating logic or is it an anti-pattern?</p></li></ol></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Is putting conversion method inside (POCO?) object (like .ToPerson() method in Consumer class) considered breaking single responsibility pattern?</p></blockquote><p>Yes, because conversion is another responsibility.</p><blockquote><p>Is using converting constructors in (DTO-like) class considered breaking single responsibility pattern? Especially if such class can be converted from multiple source types, so multiple converting constructors would be required?</p></blockquote><p>Yes, conversion is another responsibility. It makes no difference if you do it via constructors or via conversion methods (e.g. <code>ToPerson</code>).</p><blockquote><p>Is using extension methods while having access to original class source code considered bad practice?</p></blockquote><p>Not necessarily. You can create extension methods even if you have the source code of the class that you want to extend. I think that whether you create an extension method or not should be determined by the nature of such method. For example, does it contain a lot of logic? Does it depend on anything other that the members of the object itself? I would say that you shouldn&#39;t have an extension method that requires dependencies to work or that contains complex logic. Only the simplest of logic should be contained in an extension method.</p><blockquote><p>Can such behavior be used as viable pattern for separating logic or is it an anti-pattern?</p></blockquote><p>If the logic is complex, then I think that you shouldn&#39;t use an extension method. As I noted earlier, you should use extension methods only for the simplest things. I wouldn&#39;t consider conversion simple.</p><p>I suggest that you create conversion services. You can have a single generic interface for it like this:</p><pre><code>public interface IConverter&lt;TSource,TDestination&gt;
{
    TDestination Convert(TSource source_object);
}
</code></pre><p>And you can have converters like this:</p><pre><code>public class PersonToCustomerConverter : IConverter&lt;Person,Customer&gt;
{
    public Customer Convert(Person source_object)
    {
        //Do the conversion here. Note that you can have dependencies injected to this class
    }
}
</code></pre><p>And you can use <a href="https://en.wikipedia.org/wiki/Dependency_injection">Dependency Injection</a> to inject a converter (e.g. <code>IConverter&lt;Person,Customer&gt;</code>) to any class that requires the ability to convert between <code>Person</code> and <code>Customer</code>.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-when-to-use-abstract-classes-instead-of-interfaces-with-extension-methods-in-c/'>C# &#8211; When to use abstract classes instead of interfaces with extension methods in C#</a></li><li class="list-group-item"><a href='../c-how-to-share-methods-and-properties-between-custom-web-controls/'>C# &#8211; How to share methods and properties between custom web controls</a></li><li class="list-group-item"><a href='../c-how-does-go-improve-productivity-with-implicit-interfaces-and-how-does-that-compare-with-cs-notion-of-extension-methods/'>C# &#8211; How does Go improve productivity with &#8220;implicit&#8221; interfaces, and how does that compare with C#&#8217;s notion of Extension Methods</a></li><li class="list-group-item"><a href='../c-should-timeout-be-a-public-static-property-or-a-parameter-to-every-function/'>C# &#8211; Should timeout be a public static property or a parameter to every function</a></li><li class="list-group-item"><a href='../c-interface-extension-method-returning-the-interface-type-in-c/'>C# &#8211; Interface extension method returning the interface type in C#</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>