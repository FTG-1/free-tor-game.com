<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; caching on multiple servers &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079104 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079104" class="post-1079104 software type-software status-publish hentry category-software tag-caching tag-performance tag-python tag-synchronization tag-web-applications"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; caching on multiple servers</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">caching</span><span class="mr-2 badge badge-info">performance</span><span class="mr-2 badge badge-warning">python</span><span class="mr-2 badge badge-primary">synchronization</span><span class="mr-2 badge badge-danger">web-applications</span></p><div class="entry-content"><p>Because we need to keep response times low, we get tons of requests, and we need to basically process ALMOST the same data (which I&#39;ll refer to as X) each request (the inputs are different though, so we can&#39;t cache responses), we are using a technique where we grab a new copy of X every 90 seconds from the database and store it locally in memory as a python list of dictionaries, on our application servers (we are using uwsgi).</p><p>The kink in the machine: There are temporary analytics that we need to keep track of in those 90 seconds to adjust our data each iteration, and each iteration is dependent on what we calculate from the last iteration.</p><p>The trouble with this is, we have multiple application servers that are storing the same data, X, in memory and each of those servers need to refresh X at the same time to keep calculations consistent for the next interval.  I&#39;ve tried some techniques, like broadcasting a message after each calculation to reload each server&#39;s X, but it hasn&#39;t been as effective as I would hope, and it just makes things more complicated.</p><p>I should say, the reason we haven&#39;t used memcached or something similar is because we don&#39;t want to sacrifice any speed if we can.  Maybe I am ignorant on how fast we can retrieve and load the list into python objects from memcached.</p><p>I understand my explanation isn&#39;t the greatest, and will answer any questions to give a better picture of the situation.</p><p>Edit:<br /> we are at about 5000 request/second, the size of the data we process is about 2MB at the moment but will continue to grow, so we&#39;d like to avoid sending it over the wire for each request.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Your question is interesting, thought to give a quick answer but it is more complicated.</p><p>You have a set of data (please supply size and amount of requests indication!). It should be equal at all machines at a given moment. That is interesting because it makes distributed systems less use-full. You get to a more transaction based system where you can really trust the data.</p><p><em>You state it is a requirement (and so important).</em></p><p>First thing to ensure yourself of is: Do I really need to distribute this data? If you use a central storage you don&#39;t have all the synchronisation and replication issues at all. So if there is no problem you don&#39;t have to fix it. (In this case hardware might be a much cheaper solution).</p><p>And I assume based on your story that there is no reason. Why? Because it is possible for you to get every 90 seconds &#34;all&#34; data. You could even do that on a broadcast. So your central storage seems to be able to deliver that instant.</p><p>Though you have multiple servers so it seems needed. Now they store the data, do calculations on it, reset itself to the new data and start servicing again. That means the expectation is that the response delay will increase significantly when you ask the data from you central storage instead of your local Python dictionary.</p><p>Sounds reasonable. Did you measure this? Are you really sure that&#39;s not possible? <strong>Really really sure?</strong></p><p>Ok, let&#39;s say it is impossible: The you need to have a distributed system which guarantees that the data will be there always when you start with a new session. I personally think you should forget about that 90 sec. period anyway. So, in that case you get into realtime, near-realtime, solutions. This is possible but I think you make it yourself very hard.</p><p>Generally all no-sql solutions which are distributed weakened the guarantees for syncing data. So find yourself an easier way out or create the almost real-time cluster. Those are your best bets.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../web-development-is-gae-an-infrastructure-capable-of-hosting-an-app-used-by-millions-of-active-users/'>Web-development &#8211; is GAE an infrastructure capable of hosting an app used by millions of active users</a></li><li class="list-group-item"><a href='../architecture-using-memcached-is-it-good-practice-to-update-the-cache-when-updating-the-database/'>Architecture &#8211; Using Memcached: is it good practice to update the cache when updating the database</a></li><li class="list-group-item"><a href='../caching-by-in-memory-dictionaries-are-we-doing-it-all-wrong/'>Caching by in-memory dictionaries. Are we doing it all wrong</a></li><li class="list-group-item"><a href='../idea-to-develop-a-caching-server-between-iis-and-sql-server/'>Idea to develop a caching server between IIS and SQL Server</a></li><li class="list-group-item"><a href='../shared-cache-invalidation-best-practice/'>Shared Cache &#8211; Invalidation Best Practice</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>