<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How to securely implement roles in a Windows Form application &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1071621 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1071621" class="post-1071621 software type-software status-publish hentry category-software tag-active-directory tag-application-design tag-roles tag-security tag-windows"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How to securely implement roles in a Windows Form application</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">active-directory</span><span class="mr-2 badge badge-info">application-design</span><span class="mr-2 badge badge-warning">roles</span><span class="mr-2 badge badge-primary">Security</span><span class="mr-2 badge badge-danger">windows</span></p><div class="entry-content"><p>As an <a href="https://en.wikipedia.org/wiki/Independent_software_vendor" rel="nofollow">ISV</a>, what is considered best practice for implementing application role based security? In other words, only allow users to access certain features in the application based on what roles they belong to.</p><p>We currently just use a table in our database to store this, but it has been suggested that for maximum <a href="https://en.wikipedia.org/wiki/Health_Insurance_Portability_and_Accountability_Act" rel="nofollow">HIPAA</a> compliance, this isn&#39;t secure enough.</p><p>My first thought was to just use <a href="http://en.wikipedia.org/wiki/Active_Directory" rel="nofollow">Active Directory</a> groups, as it would seem that is what they are designed for, however, it just doesn&#39;t seem practical to rely on our clients IT departments to create groups and assign users to them for groups that are specific only to our application. This can&#39;t be best practice for ISVs&#8230;</p><p>At this point it my research, it seems that possibly the best solution might be to use something like <a href="https://en.wikipedia.org/wiki/Active_Directory#Lightweight_Directory_Services" rel="nofollow">Active Directory Application Mode</a> (ADAM) (Active Directory Lightweight Directory Services) and possibly AzMan (Windows Authorization Manager)?</p><p>Again, this is for a <a href="http://en.wikipedia.org/wiki/Windows_Forms" rel="nofollow">Windows Forms</a> application, not a Web application or in an &#34;in house&#34; solution.</p><p>If it matters, we are also in the process of transitioning our home-baked authentication to instead use active directory for authentication.</p><p>Also of note is this needs to be secure (HIPAA compliant).</p><p>All the information I can find on these subjects seems to be for developing applications for in house use, or for web applications, and neither of these approaches feels appropriate for a Windows Forms application.</p><p>(We are using .NET for development.)</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Moving the roles to LDAP / <a href="http://en.wikipedia.org/wiki/Active_Directory" rel="nofollow">AD</a> as a solution isn&#39;t going to address your root problem in a simple fat client architecture, but that isn&#39;t a reason not to do it, read on...</p><p>In the case of <a href="https://en.wikipedia.org/wiki/Health_Insurance_Portability_and_Accountability_Act" rel="nofollow">HIPAA</a> security, we want to implement a system such that someone that knows database security and .NET internals can&#39;t hack your system by reverse engineering your application. If I were to audit your application, a disassembler and a network sniffer are two of the tools I&#39;d use.</p><p>Don&#39;t get distracted with &#34;we don&#39;t know who has the database password...&#34; and all that. HIPAA doesn&#39;t depend on that. That isn&#39;t the application&#39;s concern. Actually in a HIPAA-secure environment, you will assume that certain people are authorized to maintain the system data, and it isn&#39;t up to you to solve all potential security problems in the organization. Likely the owner/doctor and system administrators will have access to all of it. Much of HIPAA is legal contract. A HIPAA security implementation requires you to place some level of burden on the customer to maintain the appropriate policies and procedures at their healthcare practice.</p><p>The customer, and their staff, will have all signed HIPAA contracts that pertain to their role in the customer organization. So will you, if you are engaged to install, maintain or support the system in any capacity that means you may touch data. All other partners, associates, including system administrators and third-party contractor, will usually be covered by <a href="https://en.wikipedia.org/wiki/Broad_Agency_Announcement" rel="nofollow">BAA</a> agreements, based on who they are and what data they may handle.</p><p>For an <a href="https://en.wikipedia.org/wiki/Role-based_access_control" rel="nofollow">RBAC</a> architecture, our job is to secure the application. As an PHI Application Architect, we are concerned, in our application, with security of PHI data from:</p><ol><li>Unauthenticated users</li><li>Unauthorized users - Example: If I have roles(Technician), I should never be able to view data for roles(Physician, Nurse, Admin)</li><li>Spoofed roles - the user is a Tech but claims he is a Doctor</li></ol><p>To be HIPAA compliant the application must:</p><ol><li>Identify unauthorized access</li><li>Identify which data was accessed</li><li>Identify when it was accessed</li><li>Identify where it was accessed</li><li>Identify who accessed it</li><li>Record the event</li><li>Notify appropriate parties of the access in a timely fashion</li></ol><p>Some companies use very broad definitions for a HIPAA compliant application, but in designing several <a href="https://en.wikipedia.org/wiki/Electronic_health_record" rel="nofollow">EMR</a> systems and having had to answer a lot of hard questions from customers, CEOs, auditors, and critics, I&#39;ve learned that if I use sound computer science, I can formally prove that the system is secure (bugs notwithstanding).</p><p>So in that light, what does LDAP accomplish? There are a couple of benefits that have nothing to do with security:</p><ol><li>Stores roles for the organization in a standard format that a Windows system administrator might be more comfortable with.</li><li>Centralizes roles such that other applications can share these roles, and you don&#39;t have to repeat yourself.</li></ol><p>So it&#39;s a good thing. Large organizations have a lot of separate systems and a lot of duplicate data and entry. Particularly hospitals! If you can support LDAP and <a href="https://en.wikipedia.org/wiki/Health_Level_7" rel="nofollow">HL7</a>, you can possibly plug in to their IT infrastructure (but usually with a bit of customization). To be competitive, it is a good feature.</p><p>But LDAP alone solves nothing regarding enforcement of roles and data access; you shouldn&#39;t make it a requirement to run your application (unless you are in the mid- to high-end space where the cost and skill set requirement is minor compared to the overall price of the application, or your application is for a specific organization that already has AD). For small &#34;mom and pop&#34; practices, your application should be turnkey, probably on a simple architecture of one or two PCs or a PC and a cheap server. We often think of healthcare practices as cash rich, but as I&#39;m sure you know, the truth is many of them are not, or if they were, they have already been burned over and over by software vendors claiming to have the total solution. That said, I&#39;ll proceed now on pure technical aspects and leave your business to you.</p><p><strong>Technical Perspective:</strong></p><p>A good practice is to think as if your front end application is written in <a href="http://en.wikipedia.org/wiki/Ruby_(programming_language)" rel="nofollow">Ruby</a> (or some other scripting language). I can compromise a compiled binary if I have read-access to that binary program. On most OSes, if I can run it, I can read it. The privileges are Read Write and Execute (X), and X doesn&#39;t come without (R). So assume with a .NET local application, that I can decompile the application.</p><p>Don&#39;t entrust authorization and role management to the client application. I should not be able to use knowledge of the code to obtain data from the database that I have no rights for. If I decompile the end user application, replace the string &#34;TECH&#34; with &#34;ADMIN&#34;, it should only impact the application, not the data access. However, it is perfectly acceptable to use these roles in the application for controlling which screens are presented. Screen access doesn&#39;t dictate data access. Don&#39;t burn up man-hours trying to control screen visibility. Assume <em>a well-behaved user</em>. If he tries hard enough, he gets a blank screen, but it isn&#39;t usually worth writing code for, just worry about the data.</p><p>If the application is designed to use individual database users (i.e. I authenticate to Oracle as MSMITH, and MSMITH has its own views to protect the base table data) then you can still get away with direct database access, as long as the roles are protected, and enforced. However, many (most) designs use shared-schema multitenancy and application/LDAP managed users and roles, and in that case, to really solve the problem, you have to introduce a middle layer; a gatekeeper that doesn&#39;t trust the application. The gatekeeper will independently authenticate and authorize the user&#39;s role and only serve up data accordingly.</p><p>Storing the roles in a database isn&#39;t less secure. We just can&#39;t allow people to assign roles to themselves (unless that is their role). And we can&#39;t allow the RBAC to be circumvented.</p><p>That leaves you with a decision regarding your architecture. Whether to move the database and/or gatekeeper of the data into a realm that isn&#39;t accessible to the user or front-end application, except through some communication protocol. This is one reason that <a href="http://en.wikipedia.org/wiki/Software_as_a_service" rel="nofollow">SaaS</a> is more secure for EMR applications, it provides a clean solution; the user can&#39;t read or directly execute the application, because he doesn&#39;t own it or the domain it runs in; he just accesses it through the exposed interface. Many people think SaaS means &#34;cloud&#34;, or that they login to some remote application across the Internet. But it simply means your user accesses the software as a service, and the software is centrally hosted. If you think about it, you can architect your <a href="http://en.wikipedia.org/wiki/Windows_Forms" rel="nofollow">Windows Forms</a> application to use the benefits of the SaaS model, or narrow it down to <a href="https://en.wikipedia.org/wiki/Data_as_a_service" rel="nofollow">DaaS</a> (data as a service). Move your database off of the client, so it isn&#39;t co-resident, or if you must make it work on a single computer, put it in a separate user account or secure VM, and run the application without administration privileges, to communicate with the database through a service layer. The DaaS server might run in a back computer room, or at a remote office; that part isn&#39;t relevant.</p><p>This solves the security problem completely in that the server can perform the authentication, authorization, and administration of the roles, and no amount of spoofing roles in the client is going to override the server. If your client application has to request data through a service layer, then the security is out of his control, and secure. It may sound expensive to implement; it isn&#39;t too bad if you already have an <a href="https://en.wikipedia.org/wiki/Model–view–controller" rel="nofollow">MVC</a> / <a href="https://en.wikipedia.org/wiki/Model–view–presenter" rel="nofollow">MVP</a> and/or <a href="https://en.wikipedia.org/wiki/Service-oriented_architecture" rel="nofollow">SOA</a> architecture. And if rearchitecting your application is unreasonable or cost-prohibitive, there are ways to do it purely at the database level with most robust relational databases.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-how-to-handle-database-security-from-a-desktop-application/'>Database &#8211; How to handle database security from a desktop application</a></li><li class="list-group-item"><a href='../web-development-securely-storing-secret-data-in-a-client-side-web-application/'>Web-development &#8211; Securely storing secret data in a client-side web application</a></li><li class="list-group-item"><a href='../best-practice-in-application-design-sql-authentication/'>Best practice in application design / SQL authentication</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>