<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Design pattern for processing a huge CSV file &#8212; Java &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070562 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070562" class="post-1070562 software type-software status-publish hentry category-software tag-design-patterns tag-java tag-object-oriented tag-object-oriented-design tag-programming-practices"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Design pattern for processing a huge CSV file &#8212; Java</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span><span class="mr-2 badge badge-info">java</span><span class="mr-2 badge badge-warning">object-oriented</span><span class="mr-2 badge badge-primary">object-oriented-design</span><span class="mr-2 badge badge-danger">programming practices</span></p><div class="entry-content"><p>I am learning design patterns in Java and also working on a problem where I need to handle huge number of requests streaming into my program from a huge CSV file on the disk. Each CSV line is one request, and the first field in each line indicates the message type. There are 7 types of messages, each of which should be handled differently.</p><p>The code is something like the following:</p><pre><code>class Handler {
    private CustomClass {….}
    Map&lt;String, CustomClass&gt; map = new HashMap&lt;String, CustomClass&gt;();
    Public void runFile() {
        // Read the huge CSV file with millions of records, line by line
        // for each line, get the string before the first comma (say X)
        switch (X) {
        case 1 : myMethod1(….); break;
        case 2 : myMethod2(….); break;
        case 3 : myMethod3(….); break;
        // ...
        default: // ...
        }
    }
    // Methods 1, 2, 3 declarations
}
</code></pre><p>Note 1: Some of the methods affect the map and others don&#39;t.<br /> Note 2: Each request (method) uses different variables from the CSV line and executes a different logic.<br /> Note 3: requests/methods are NOT connected; i.e. <code>myMethod2()</code> does not logically follow <code>myMethod1()</code>.</p><p>Now my question – What is an appropriate design pattern for this problem? Is it fine if I keep the whole logic in one class (similar to the code above) without changing?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I assume the code sample you show is just a simplified example and that the real problem is more complex, so as to deserve using a pattern.</p><ul><li>Make <code>CustomClass</code> an external class(*).</li><li>Have several processors that implement the same interface</li><li>Have a map of processors using the integer that identifies the format of the CSV line as the key (you call it x).</li><li>Retrieve a processor from the map (with the correspoding key) and make it process the line.</li><li>This similar to <a href="https://en.wikipedia.org/wiki/Strategy_pattern" rel="noreferrer">strategy pattern</a>, it defines a family of algorithms,encapsulates each algorithm, and makes the algorithms interchangeable within that family.</li></ul><p><strong>Advantages:</strong> flexibility, if you create the map of processors outside the handler and pass it in the constructor, more processors can be added later and Handler will not need to be changed (for example to add a new case the switch control structure).</p><p><a href="../../../i.stack.imgur.com/fd5aB.png" rel="noreferrer"><img src="../../../i.stack.imgur.com/fd5aB.png" alt="enter image description here"/></a></p><p>(*) You can achieve the same results having the interface and the processors as well as the customclass as inner classes/interfaces inside Handler, but it would pollute the solution a lot.</p><p>==&gt; CustomClass.java &lt;==</p><pre class="lang-java prettyprint-override"><code>public class CustomClass {}
</code></pre><p>==&gt; IMessageProcessor.java &lt;==</p><pre class="lang-java prettyprint-override"><code>import java.util.Map;

public interface IMessageProcessor {
    public void processLine(Map&lt;String, CustomClass&gt; map, String line);     
}
</code></pre><p>==&gt; ProcessorA.java &lt;==</p><pre class="lang-java prettyprint-override"><code>import java.util.Map;

public class ProcessorA implements IMessageProcessor {
    @Override
    public void processLine(Map&lt;String, CustomClass&gt; map, String line) {
        // TODO Auto-generated method stub
    }
}
</code></pre><p>==&gt; ProcessorB.java &lt;==</p><pre class="lang-java prettyprint-override"><code>import java.util.Map;

public class ProcessorB implements IMessageProcessor {
    @Override
    public void processLine(Map&lt;String, CustomClass&gt; map, String line) {
        // TODO Auto-generated method stub
    }
}
</code></pre><p>==&gt; ProcessorC.java &lt;==</p><pre class="lang-java prettyprint-override"><code>import java.util.Map;

public class ProcessorC implements IMessageProcessor {
    @Override
    public void processLine(Map&lt;String, CustomClass&gt; map, String line) {
        // TODO Auto-generated method stub
    }
}
</code></pre><p>==&gt; Handler.java &lt;==</p><pre class="lang-java prettyprint-override"><code>import java.util.HashMap;
import java.util.Map;

public class Handler {
    private Map&lt;String, CustomClass&gt; map = new HashMap&lt;String, CustomClass&gt;();
    private Map&lt;Integer,IMessageProcessor&gt; processors = new HashMap&lt;Integer,IMessageProcessor&gt;();
    public processFile(){
        // store the processors in their map with the appropiate keys 
        processors.put(1, new ProcessorA());
        processors.put(2, new ProcessorB());
        processors.put(3, new ProcessorC());

        // Read the huge CSV file with millions of records, line by line
        // for each line, get the string before the first comma (say x)
        processors.get(x).processLine(map,line);
    }
}
</code></pre><p><strong>Note:</strong> You might wish to validate first whether the processor for the key x exists, and it it doesnt, fall back to a default processor, say, stored with key -1, or any other value garanteed not to exist in the CSV file.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-more-elegant-way-to-avoid-hard-coding-the-format-of-a-a-csv-file/'>Java &#8211; More elegant way to avoid hard coding the format of a a CSV file</a></li><li class="list-group-item"><a href='../php-good-way-to-use-the-front-controller-pattern-for-command-line-applications/'>Php &#8211;  good way to use the front controller pattern for command line applications</a></li><li class="list-group-item"><a href='../java-implementing-strategy-pattern-multiple-variables/'>Java &#8211; Implementing strategy pattern multiple variables</a></li><li class="list-group-item"><a href='../java-processing-a-large-file-concurrently/'>Java &#8211; Processing a large file concurrently</a></li><li class="list-group-item"><a href='../design-pattern-for-inter-dependent-values/'>Design pattern for inter-dependent values</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>