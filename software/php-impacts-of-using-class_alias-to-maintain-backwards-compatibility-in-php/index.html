<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Php &#8211; Impacts of using class_alias() to maintain backwards compatibility in PHP &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1086033 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1086033" class="post-1086033 software type-software status-publish hentry category-software tag-backward-compatibility tag-namespace tag-object-oriented-design tag-php tag-refactoring"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Php &#8211; Impacts of using class_alias() to maintain backwards compatibility in PHP</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">backward compatibility</span><span class="mr-2 badge badge-info">namespace</span><span class="mr-2 badge badge-warning">object-oriented-design</span><span class="mr-2 badge badge-primary">PHP</span><span class="mr-2 badge badge-danger">refactoring</span></p><div class="entry-content"><p>Scenario: An open-source PHP project that has existed for several years has too many classes in the main namespace that we want to refactor some of them into another namespace, but we have a widely used and diverged plugin API, and refactoring may cause a major backwards incompatibility. This plugin API is basically loading external PHP files that interact with the classes and functions in the core code.</p><p>This project is not a Composer project (don&#39;t ask why), and it uses an class autoloading library maintained by ourselves.</p><p>I recently discovered the function <a href="https://php.net/class-alias" rel="noreferrer"><code>class_alias</code></a>, which might help with this problem.</p><p>I am considering refactoring the classes in the main namespace into a sub-namespace, and update references to them in the project. For the PHP files that originally contained the refactored classes (now they have been moved), I want to put something like this:</p><pre><code>&lt;?php
class_alias(NewClassName::class, OldClassName::class);
</code></pre><p>This will be loaded by the autoloading library when a plugin requires the use of OldClassName. I have tested this method and primary tests show that it works well.</p><p>Next step is to clean up the main namespace directory to fulfill the real motive of our refactoring &#8211; there are too many files in the main namespace directory. Hence, I am creating a new directory next to the source directory called <code>als</code> (alias directory), and making <code>als</code> a secondary source folder where alias class files are located.</p><p>Before, the project looked like this:</p><pre><code>src/
    src/Foo/Bar.php
</code></pre><p>Now, the project looks like this:</p><pre><code>src/
    src/Foo/Bar/Bar.php

als/
    als/Foo/Bar.php
</code></pre><p>Tests show that this method is working well so far.</p><p>However, are there any possible side-effects, from technical/performance perspective, documentation perspective or code structure perspective? We have never tried doing something like this and have never seen anyone doing this. Many developers are watching the repository for reference of the API, so we want to be more careful before trying these changes.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I have done it and it&#39;s possible, though there are a few pitfalls around autoloading to consider. I described the approach in a blog post:</p><blockquote><p><a href="https://www.schmengler-se.de/en/2016/09/php-using-class_alias-to-maintain-bc-while-move-rename-classes/" rel="nofollow noreferrer">PHP: Using class_alias to maintain BC while moving/renaming classes</a></p></blockquote><h2>Summary:</h2><ul><li><p>Do not put the <code>class_alias()</code> code into the original class file</p><blockquote><p>The problem is that <strong>type hints do not trigger the autoloader</strong>. Similar to the <code>::class</code> constant, type hints are resolved to a class name which is compared to the class name of the passed object, without actually looking for the type hinted class! Thatâ€™s why it is important to have the alias in place as soon as the real class is loaded.</p><p>Otherwise passing a <code>NewClass</code> instance to the following function would fail because <code>&#34;NewClass&#34; != &#34;OldClass&#34;</code> and the alias is not defined yet:</p><pre><code>function oldFunction(OldClass $old)
</code></pre></blockquote></li><li><p>If you do not use composer or a single bootstrap file that is always loaded, the best way I found is to put <code>class_alias()</code> into the new class file:</p><pre><code>\class_alias(NewClass::class, OldClass::class)
</code></pre><p>Then you have to make sure that the new class with the alias is also loaded if somebody tries to actually instantiate the old class (or use static properties, methods or constants). To do this, I trigger the autoloader in the old class file:</p><pre><code>\class_exists(NewClass::class);
</code></pre></li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/php-dynamic-class-inheritance-for-php/'>Php &#8211; Dynamic Class Inheritance For PHP</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/php-design-pattern-a-single-class-with-multiple-purposes-or-multiple-extended-classes-each-with-their-own-purpose-in-php/'>Php &#8211; Design Pattern: A single class with multiple purposes, or multiple extended classes each with their own purpose in PHP</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>