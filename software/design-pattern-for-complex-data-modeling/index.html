<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design Pattern for Complex Data Modeling &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1078901 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1078901" class="post-1078901 software type-software status-publish hentry category-software tag-database-design tag-design-patterns tag-relational-database"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design Pattern for Complex Data Modeling</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database-design</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">relational-database</span></p><div class="entry-content"><p>I&#39;m developing a program that has a SQL database as a backing store.  As a very broad description, the program itself allows a user to generate records in any number of user-defined tables and make connections between them.  As for specs:</p><ol><li>Any record generated must be able to be connected to any other record in any other user table (excluding itself&#8230;the record, not the table).  Yes, this creates a arbitrary user-generated relational map.</li><li>These &#34;connections&#34; are directional: Incoming, outgoing, and bi-directional.</li><li>The list of connections a record has is user ordered.</li><li>A record must &#34;know&#34; of connections made <em>from</em> it to others as well as connections made <em>to</em> it from others.</li><li>A record&#39;s field can also include aggregate information from it&#39;s connections (like obtaining average, sum, etc) that must be updated on change from another record it&#39;s connected to.</li><li>To conserve memory, only relevant information must be loaded at any one time (can&#39;t load the entire database in memory at load and go from there).</li><li>I cannot assume the backing store is local.  Right now it is, but eventually this program will include syncing to a remote db.</li><li>I cannot depend on a specific implementation of a backing store.  This means I cannot be certain the backing store is, in fact, relational.  Thus all relational data is stored explicitly.</li></ol><p>The connections are kind of the point of this program, so there is a strong possibility that the number of connections made is very high, especially if the user is using the software as intended.  Neither the user tables, connections or records are known at design time as they are user generated.</p><p>I&#39;ve spent a lot of time trying to figure out how to design the backing store and the object model to best fit these specs.  In my first design attempt on this, I had one object managing all a table&#39;s records and connections.  I attempted this first because it kept the memory footprint smaller (records and connections were simple dicts), but maintaining aggregate and link information between tables became&#8230;.onerous (ie&#8230;a huge spaghettified mess).  Tracing dependencies using this method almost became impossible.  Instead, I&#39;ve settled on a distributed smart graph where each record and connection is &#39;aware&#39; of what&#39;s around it by managing it own data and connections to other records.  Doing this increases my memory footprint but also let me create a faulting system so connections/records aren&#39;t loaded into memory until they&#39;re needed.  It&#39;s also much easier to code: trace dependencies, eliminate cycling recursive updates, etc.  My biggest problem is storing/loading the connections.  I&#39;m not happy with any of my current solutions/ideas so I wanted to ask and see if anybody else has any ideas of how this should be structured.  Connections are fairly simple.  They contain: fromRecordID, fromTableID, fromRecordOrder, toRecordID, toTableID, toRecordOrder.    Here&#39;s what I&#39;ve come up with so far:</p><ol><li>Store all the connections in one big table. If I do this, either I load all connections at once (one big db call) or make a call every time a user table is loaded.  The big issue here: the size of the connections table has the potential to be huge, and I&#39;m afraid it would slow things down.</li><li>Store in separate tables all the outgoing connections for each user table.    This is probably the worst idea I&#39;ve had.  Now my connections are &#39;spread out&#39; over multiple tables (one for each user table), which means I have to load each table just to find all the incoming connections for a particular user table.  I&#39;ve avoided making &#34;one big ass table&#34;, but I&#39;m not sure the cost is worth it.</li><li>Store in separate tables all outgoing AND incoming connections for each user table (using a flag to distinguish between incoming vs outgoing).  This is the idea I&#39;m leaning towards, but it will essentially double the total storage for all the connections (as each connection will be stored in two tables).  It also means I have to make sure connection information is kept in sync in both places (each &#39;from&#39; connection has a corresponding &#39;to&#39; connection in the appropriate table.  This is obviously not ideal but it does mean that when I load a user table, I only need to load one &#39;connection&#39; table and have all the information I need.  This also presents a separate problem, that of connection object creation.  Since each user table has a list of all connections, there are two opportunities for a connection object to be made.  However, connections objects (designed to facilitate communication between records) should only be created once.  This means I&#39;ll have to devise a common caching/factory object to make sure only one connection object is made per connection.</li></ol><p>Does anybody have any ideas of a better way to do this?  Once I&#39;ve committed to a particular design pattern I&#39;m pretty much stuck with it, so I want to make sure I&#39;ve come up with the best one possible.</p><p>I&#39;ll also note that my current backing store is SQLite.  I&#39;ve written the program to not depend on a specific backing store, though, by introducing an adapter layer to disassociate the data retrieval from the the rest of the program.  So the backing store could be anything, even a simple text file.  I use the backing store exclusively for storage and data retrieval, nothing else.  I don&#39;t use any specific database/SQL relational features and I don&#39;t use the database to perform calculations (aggregate or otherwise).  All of that is handled in program logic.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>All your requirements, save for #8, are implemented by relational databases (consider <code>INFORMATION_SCHEMA</code>, which is a standard relational database feature- the information schema contains views which describe the tables in the database, which columns they have, etc.- your app would work <em>a lot</em> with the <code>INFORMATION_SCHEMA</code> data).</p><p>Thanks to #8, you have basically cornered yourself into writing your own relational database engine.</p><p>It sounds like you are implementing Access which... implements its own relational database (Jet); it also sucks because implementing a relational engine is quite hard (more if you are subject to the constraints that Access has), and in the end, Access doesn&#39;t really make hard things easy.</p><p>Implementing a relational database engine on top of another datastore might simplify things, of course (i.e. Berkeley DB is useful for implementing an RDBMS, and Berkeley DB is <em>everywhere</em>. See <a href="https://softwareengineering.stackexchange.com/questions/150354/how-would-one-build-a-relational-database-on-a-key-value-store-a-la-berkeley-db/154532#154532">a related answer I gave recently</a>), but I would think hard about requirement #8 and the viability of your project.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../the-hierarchical-db-schema-for-this-xml/'>The hierarchical DB schema for this xml</a></li><li class="list-group-item"><a href='../relational-table-design-for-data-ownership/'>Relational table design for data ownership</a></li><li class="list-group-item"><a href='../database-proper-modeling-and-name-convention-for-an-intermediate-table-between-intermediates/'>Database &#8211; Proper modeling and name convention for an intermediate table between intermediates</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>