<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Php &#8211; How to handle monetary values in PHP and MySql &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1065068 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1065068" class="post-1065068 software type-software status-publish hentry category-software tag-database tag-design tag-mysql tag-php tag-web-development"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Php &#8211; How to handle monetary values in PHP and MySql</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">MySQL</span><span class="mr-2 badge badge-primary">PHP</span><span class="mr-2 badge badge-danger">web-development</span></p><div class="entry-content"><p>I&#39;ve inherited a huge pile of legacy code written in PHP on top of a MySQL database. The thing I noticed is that the application uses <code>doubles</code> for storage and manipulation of data.</p><p>Now I came across of numerous posts mentioning how <code>double</code> are not suited for monetary operations because of the rounding errors. However, I have yet to come across a complete solution to how monetary values should be handled in PHP code and stored in a MySQL database.</p><p>Is there a best practice when it comes to handling money specifically in PHP?</p><p>Things I&#39;m looking for are:</p><ol><li>How should the data be stored in the database? column type? size?</li><li>How should the data be handling in normal addition, subtraction. multiplication or division?</li><li>When should I round the values? How much rounding is acceptable if any?</li><li>Is there a difference between handling large monetary values and low ones?</li></ol><p><strong>Note:</strong><br /> A <strong>VERY</strong> simplified sample code of how I might encounter money values in everyday life (various security concerns were ignored for simplification. Of course in real life I would never use my code like this):</p><pre><code>$a= $_POST[&#39;price_in_dollars&#39;]; //--&gt;(ex: 25.06) will be read as a string should it be cast to double?
$b= $_POST[&#39;discount_rate&#39;];//--&gt;(ex: 0.35) value will always be less than 1
$valueToBeStored= $a * $b; //--&gt; any hint here is welcomed 

$valueFromDatabase= $row[&#39;price&#39;]; //--&gt; price column in database could be double, decimal,...etc.

$priceToPrint=$valueFromDatabase * 0.25; //again cast needed or not?
</code></pre><p>I hope you use this sample code as a means to bring out more use cases and not to take it literally of course.</p><p><strong>Bonus Question</strong><br /> If I&#39;m to use an ORM such as Doctrine or PROPEL, how different will it be to use money in my code.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>It can be quite tricky to handle numbers with PHP/MySQL. If you use decimal(10,2) and your number is longer or has higher precision it will be truncated without error (unless you set proper mode for your db server).</p><p>To handle large values or high precision values you can use library like <a href="http://www.php.net/manual/en/book.bc.php" rel="noreferrer">BCMath</a> it will allow you to make basic operation on the large numbers and keep required precision.</p><p>I&#39;m not sure what exactly calculations you will make but you have to also keep in mind that (0.22 * 0.4576) + (0.78 * 0.4576) will not equal 0.4576 if you will not use proper precision through the process.</p><p>Maximum size of DECIMAL in MySQL is 65 so it should be more than enough for any purpose. If you use DECIMAL field type it will be returned as string regardless of the use of an ORM or just plain PDO/mysql(i).</p><blockquote><p>How should the data be stored in the database? column type? size?</p></blockquote><p>DECIMAL with precision you need. If you are using exchange rates then you will need at least four decimal places</p><blockquote><p>How should the data be handling in normal addition, subtraction. multiplication or division?</p></blockquote><p>Use BCMath to be on save side and why using <a href="http://php.net/manual/en/language.types.float.php" rel="noreferrer">float</a> may not be a good idea</p><blockquote><p>When should I round the values? How much rounding is acceptable if any?</p></blockquote><p>For monetary values normal two decimal places are acceptable but you may need more if for example you are using exchange rates.</p><blockquote><p>Is there a difference between handling large monetary values and low ones?</p></blockquote><p>Depends on what you mean by large. There is definitely a difference between handling numbers with high precision.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-face-recognitionopencv-with-mysql-and-php/'>C++ &#8211; Face Recognition(OpenCV) with MySQL and PHP</a></li><li class="list-group-item"><a href='../object-oriented-repository-pattern-implementation-that-knows-nothing-about-the-database-table-and-column-names/'>Object-oriented &#8211; Repository pattern implementation that knows nothing about the database table and column names</a></li><li class="list-group-item"><a href='../whats-the-best-way-to-track-updates-when-syncing-data-from-mysql-remote-server-to-local-sqlite-database/'>What&#8217;s the best way to track updates when syncing data from MySQL remote server to local SQLite database</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>