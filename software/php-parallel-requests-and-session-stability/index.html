<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>PHP Parallel Requests and Session Stability &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073572 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073572" class="post-1073572 software type-software status-publish hentry category-software tag-php tag-web-development"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">PHP Parallel Requests and Session Stability</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">PHP</span><span class="mr-2 badge badge-info">web-development</span></p><div class="entry-content"><p>I&#39;ve experienced a lot of issues that were the result of the nature of PHP living within the bounds of a stateless HTTP request, especially considering the asynchronous environment expected of modern web applications.</p><p>Namely, regeneration of session handles can cause session self-destructs if parallel requests are occurring.  Additionally, unless a request locks the session for its duration, session updates on parallel requests are at risk of conflicting and being overwritten by the other.  If they do lock the session, it forces serialization of the requests.</p><p>What did you find to be the most effective response to this problem?</p><p>Do you just live with it and implement workarounds?  Did you ultimately migrate to a different platform that didn&#39;t have this flaw?  Or is there a PHP solution to this problem I&#39;m not aware of?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The simple solution would be to call <code>session_start()</code> just before you actually need <code>$_SESSION</code> (and not at the head of the script) and <code>session_write_close()</code> just after you finished with it. That&#39;s a bit awkward, but it works fairly well.</p><p>The not so simple solution would be to write a custom database backed session handler (see: <a href="http://php.net/manual/en/class.sessionhandler.php">SessionHandler</a> for PHP 5.4), fined tuned locking is a bit easier with a database. For example for MySQL/InnoDB you could have locking reads with &#34;<a href="http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html">SELECT ... FOR UPDATE</a>&#34;. If InnoDB sounds too resource hungry for you, you could go for a <a href="http://dev.mysql.com/doc/refman/5.1/en/memory-storage-engine.html">Memory</a> table, but locking will be a bit more complicated.</p><p>That said, what you really need to ask yourself is whether you&#39;re relying on <code>$_SESSION</code> a bit too much, especially the default file based flavour. Have you considered <a href="http://memcached.org/">Memcached</a>? As a session backend <em>and</em> as an alternative persistence mechanism.</p><p>There are a lot other, perhaps more exotic choices, I&#39;m currently exploring Amazon&#39;s <a href="http://aws.amazon.com/dynamodb/">DynamoDB</a> as a session backend. Here&#39;s a <a href="http://www.newvem.com/blog/main/2012/05/php-sessions-with-a-dynamodb-backend.html">brief outline of Dynamo backed sessions</a>, written by our CTO, who couldn&#39;t resist calling me out:</p><blockquote><p>Do not use session variables as a replacement for caching. For example, we have seen developers saving whole HTML blocks in the session array.</p></blockquote></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-php-and-performance/'>Java &#8211; PHP and performance</a></li><li class="list-group-item"><a href='../javascript-can-php-and-javascript-do-backend-together/'>Javascript &#8211; Can PHP and Javascript do backend together</a></li><li class="list-group-item"><a href='../php-make-php-sessions-truly-last-until-the-browser-closes-and-regenerating-session-on-page-requests/'>Php &#8211; Make PHP sessions truly last until the browser closes, and regenerating session on page requests</a></li><li class="list-group-item"><a href='../php-is-it-right-to-keep-users-permissions-in-php-session/'>Php &#8211; Is it right to keep users permissions in php session</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>