<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Isn&#8217;t CQRS overengineering &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068120 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068120" class="post-1068120 software type-software status-publish hentry category-software tag-asp-net tag-asp-net-mvc-web-api tag-cqrs tag-net tag-web-api"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Isn&#8217;t CQRS overengineering</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asp.net</span><span class="mr-2 badge badge-info">asp.net-mvc-web-api</span><span class="mr-2 badge badge-warning">cqrs</span><span class="mr-2 badge badge-primary">net</span><span class="mr-2 badge badge-danger">web-api</span></p><div class="entry-content"><p>I still remember good old days of repositories. But repositories used to grow ugly with time. Then CQRS got mainstream. They were nice, they were a breath of fresh air. But recently I&#39;ve been asking myself again and again why don&#39;t I keep the logic right in a Controller&#39;s Action method (especially in Web Api where action is some kind of command/query handler in itself).</p><p>Previously I had a clear answer for that: I do it for testing as it&#39;s hard to test Controller with all those unmockable singletons and overall ugly ASP.NET infrastructure. But times have changed and ASP.NET infrastructure classes are much more unit tests friendly nowadays (especially in ASP.NET Core).</p><p>Here&#39;s a typical WebApi call: command is added and SignalR clients are notified about it:</p><pre><code>public void AddClient(string clientName)
{
    using (var dataContext = new DataContext())
    {
        var client = new Client() { Name = clientName };

        dataContext.Clients.Add(client);

        dataContext.SaveChanges();

        GlobalHost.ConnectionManager.GetHubContext&lt;ClientsHub&gt;().ClientWasAdded(client);
    }
}
</code></pre><p>I can easily unit test/mock it. More over, thanks to OWIN I can setup local WebApi and SignalR servers and make an integration test (and pretty fast by the way).</p><p>Recently I felt less and less motivation to create cumbersome Commands/Queries handlers and I tend to keep code in Web Api actions. I make an exception only if logic is repeated or it&#39;s really complicated and I want to isolate it. But I&#39;m not sure if I&#39;m doing the right thing here.</p><p>What is the most reasonable approach for managing logic in a typical modern ASP.NET application? When is it reasonable to move your code to Commands and Queries handlers? Are there any better patterns?</p><p><strong>Update.</strong> I found <a href="https://www.simple-talk.com/dotnet/net-framework/take-your-crud-to-the-next-level-with-ddd-concepts/" rel="noreferrer">this article</a> about DDD-lite approach. So it seems like my approach of moving complicated parts of code to commands/queries handlers could be called CQRS-lite.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Is CQRS a relatively complicated and costly pattern ? Yes.</p><p>Is it over-engineering ? Absolutely not.</p><p>In the <a href="http://martinfowler.com/bliki/CQRS.html" rel="noreferrer">original article where Martin Fowler talks about CQRS</a> you can see a lot of warnings about not using CQRS where it&#39;s not applicable:</p><blockquote><p>Like any pattern, CQRS is useful in some places, but not in others.</p><p>CQRS is a significant mental leap for all concerned, so <strong>shouldn&#39;t be tackled unless the benefit is worth the jump</strong>.</p><p>While I have come across successful uses of CQRS, <strong>so far the majority of cases I&#39;ve run into have not been so good</strong>...</p><p>Despite these benefits, <strong>you should be very cautious about using CQRS</strong>.</p><p>...adding CQRS to such a system can <strong>add significant complexity</strong>.</p></blockquote><p>My emphasis above.</p><p>If your application is using CQRS for everything, than it&#39;s not CQRS that&#39;s over-engineered, it&#39;s your application. This is an excellent pattern to solve some specific problems, especially high performance/high volume applications where write concurrency may be a major concern.</p><p>And it may not be the entire application, but only a small part of it.</p><p>A live example from my work, we employ CQRS in the Order Entry system, where we cannot lose any orders, and we do have spikes where thousands of orders come at the same time from different sources, in some specific hours. CQRS helped us to keep the system alive and responsive, while allowing us to scale well the backend systems to process these orders faster when needed (more backend servers) and slower/cheaper when not needed.</p><p>CQRS is perfect for the problem where you have several actors collaborating in the same set of data or writing to the same resource.</p><p>Other than that, spreading a pattern made to solve a single problem to all your problems will just create more problems to you.</p><hr/><p>Some other useful links:</p><p><a href="http://udidahan.com/2011/04/22/when-to-avoid-cqrs/" rel="noreferrer">http://udidahan.com/2011/04/22/when-to-avoid-cqrs/</a></p><p><a href="http://codebetter.com/gregyoung/2012/09/09/cqrs-is-not-an-architecture-2/" rel="noreferrer">http://codebetter.com/gregyoung/2012/09/09/cqrs-is-not-an-architecture-2/</a></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../net-cqrs-frameworks-ncqrs-vs-lokad-cqrs/'>.NET CQRS Frameworks nCQRS vs Lokad.CQRS</a></li><li class="list-group-item"><a href='../rest-service-and-cqrs/'>REST Service and CQRS</a></li><li class="list-group-item"><a href='../architecture-benefits-of-using-separate-api-and-ui-servers-for-web-application/'>Architecture &#8211; Benefits of using separate API and UI servers for Web application</a></li><li class="list-group-item"><a href='../how-exactly-should-a-cqrs-command-be-validated-and-transformed-to-a-domain-object/'>How exactly should a CQRS Command be validated and transformed to a domain object</a></li><li class="list-group-item"><a href='../c-clean-architecture-cqrs-and-authentication/'>C# &#8211; Clean architecture, CQRS, and authentication</a></li><li class="list-group-item"><a href='../cqrs-using-queries-or-read-services-only/'>CQRS using queries or read services only</a></li><li class="list-group-item"><a href='../what-are-the-problems-with-command-handlers-returning-data-in-cqrs/'>What are the problems with command handlers returning data in CQRS</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>