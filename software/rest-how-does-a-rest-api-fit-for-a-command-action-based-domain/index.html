<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; How does a REST API fit for a command/action based domain &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064835 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064835" class="post-1064835 software type-software status-publish hentry category-software tag-api-design tag-cqrs tag-domain-driven-design tag-rest"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; How does a REST API fit for a command/action based domain</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api-design</span><span class="mr-2 badge badge-info">cqrs</span><span class="mr-2 badge badge-warning">domain-driven-design</span><span class="mr-2 badge badge-primary">rest</span></p><div class="entry-content"><p>In this <a href="https://restful-api-design.readthedocs.io/en/latest/methods.html#actions">article</a> the author claims that</p><blockquote><p>Sometimes, it is required to expose an operation in the API that inherently is non RESTful.</p></blockquote><p>and that</p><blockquote><p>If an API has too many actions, then thatâ€™s an indication that either it was designed with an RPC viewpoint rather than using RESTful principles, or that the API in question is naturally a better fit for an RPC type model.</p></blockquote><p>This reflects what I have read and heard elsewhere as well.</p><p>However I find this quite confusing and I would like to get a better understanding of the matter.</p><h2>Example I: Shutting down a VM through a REST interface</h2><p>There are, I think, two fundamentally different ways to model a shutdown of a VM. Each way might have a few variations, but let&#39;s concentrate on the most fundamental differences for now.</p><h3>1. Patch the resource&#39;s state property</h3><pre><code>PATCH /api/virtualmachines/42
Content-Type:application/json  

{ &#34;state&#34;: &#34;shutting down&#34; }
</code></pre><p>(Alternatively, <code>PUT</code> on the sub-resource <code>/api/virtualmachines/42/state</code>.)</p><p>The VM will be shutting down in the background and at some later point in time depending of wether shutting down will succeed or not the state might be internally updated with &#34;power off&#34;.</p><h3>2. PUT or POST on the resource&#39;s actions property</h3><pre><code>PUT /api/virtualmachines/42/actions
Content-Type:application/json  

{ &#34;type&#34;: &#34;shutdown&#34; }
</code></pre><p>The result is exactly the same as in the first example. The state will be updated to &#34;shutting down&#34; immediately and maybe eventually to &#34;power off&#34;.</p><p>Are both designs RESTful?</p><p>Which design is better?</p><h2>Example II: CQRS</h2><p>What if we have a CQRS domain with many such &#34;actions&#34; (aka commands) that might potentially lead to updates of multiple aggregates or cannot be mapped to CRUD operations on concrete resources and sub-resources?</p><p>Should we try to model as many commands as concrete creates or updates on concrete resources, where ever possible (following the first approach from example I) and use &#34;action endpoints&#34; for the rest?</p><p>Or should we map all the commands to action endpoints (as in the second approach of example I)?</p><p>Where should we draw the line? When does the design become less RESTful?</p><p>Is a CQRS model a better fit for an RPC like API?</p><p>According to the quoted text above it is, as I understand it.</p><p>As you can see from my many questions, I am a little bit confused about this topic. Can you help me to get a better understanding of it?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>In the first case (shut-down of VMs), I&#39;d consider none of the OP alternatives RESTful. Granted, if you use the <a href="http://martinfowler.com/articles/richardsonMaturityModel.html" rel="noreferrer">Richardson maturity model</a> as a yardstick, they are both <strong>leve 2</strong> APIs because they use resources and verbs.</p><p>Neither of them, though, use hypermedia controls, and in my opinion, that&#39;s the only type of REST that <em>differentiates</em> RESTful API design from RPC. In other words, stick with level 1 and 2, and you&#39;re going to have an RPC-style API in most cases.</p><p>In order to model two different ways of shutting down a VM, I&#39;d expose the VM itself as a resource that (among other things) contains links:</p><pre><code>{
    &#34;links&#34;: [{
        &#34;rel&#34;: &#34;shut-down&#34;,
        &#34;href&#34;: &#34;/vms/1234/fdaIX&#34;
    }, {
        &#34;rel&#34;: &#34;power-off&#34;,
        &#34;href&#34;: &#34;/vms/1234/CHTY91&#34;
    }],
    &#34;name&#34;: &#34;Ploeh&#34;,
    &#34;started&#34;: &#34;2016-08-21T12:34:23Z&#34;
}
</code></pre><p>If a client wishes to shut down the <code>Ploeh</code> VM, it ought to <strong>follow the link</strong> with the <code>shut-down</code> relationship type. (Normally, as outlined in the <a href="http://amzn.to/2h5b0c5" rel="noreferrer">RESTful Web Services Cookbook</a>, you&#39;d use an IRI or more elaborate identification scheme for relationship types, but I chose to keep the example as simple as possible.)</p><p>In this case, there&#39;s little other information to provide with the action, so the client should simple make an empty POST against the URL in the <code>href</code>:</p><pre><code>POST /vms/1234/fdaIX HTTP/1.1
</code></pre><p>(Since this request has no body, it&#39;d be tempting to model this as a GET request, but GET requests should have no observable side-effects, so POST is more correct.)</p><p>Likewise, if a client wants to power off the VM, it&#39;ll follow the <code>power-off</code> link instead.</p><p>In other words, the relationship types of the links provide <strong>affordances</strong> that indicate intent. Each relationship type has a specific semantic significance. This is the reason we sometimes talk about <em>the semantic web</em>.</p><p>In order to keep the example as clear as possible, I intentionally obscured the URLs in each link. When the hosting server receives the incoming request, it&#39;d know that <code>fdaIX</code> means <em>shut down</em>, and <code>CHTY91</code> means <em>power off</em>.</p><p>Normally, I&#39;d just encode the action in the URL itself, so that the URLs would be <code>/vms/1234/shut-down</code> and <code>/vms/1234/power-off</code>, but when teaching, that blurs the distinction between relationship types (semantics) and URLs (implementation details).</p><p>Depending on which clients you have, you may consider <a href="http://blog.ploeh.dk/2013/05/01/rest-lesson-learned-avoid-hackable-urls" rel="noreferrer">making RESTful URLs non-hackable</a>.</p><h1>CQRS</h1><p>When it comes to CQRS, one of the few things that Greg Young and Udi Dahan agrees about is that <strong>CQRS isn&#39;t a top-level architecture</strong>. Thus, I&#39;d be cautious about making a RESTful API too CQRS-like, because that&#39;d mean that clients become part of your architecture.</p><p>Often, the driving force behind a real (level 3) RESTful API is that you want to be able to evolve your API without breaking clients, and without having control of clients. If that&#39;s your motivation, then CQRS wouldn&#39;t be my first choice.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-how-to-deal-with-multiple-entry-points-for-an-action-in-a-rest-api/'>Rest &#8211; How to deal with multiple &#8220;entry points&#8221; for an action in a REST API</a></li><li class="list-group-item"><a href='../rest-a-separate-endpoint-specifically-for-sync-in-a-rest-api/'>Rest &#8211; A separate endpoint specifically for sync in a REST api</a></li><li class="list-group-item"><a href='../rest-conceptual-mismatch-between-ddd-application-services-and-rest-api/'>Rest &#8211; Conceptual mismatch between DDD Application Services and REST API</a></li><li class="list-group-item"><a href='../rest-partitioning-rest-api-resources-into-areas-based-on-business-domains/'>Rest &#8211; Partitioning REST API resources into areas based on business domains</a></li><li class="list-group-item"><a href='../rest-how-to-design-a-rest-api-to-handle-non-crud-operations/'>Rest &#8211; How to design a REST API to handle non-CRUD operations</a></li><li class="list-group-item"><a href='../rest-api-design-how-to-break-down-the-api-object-to-make-more-scalable-and-robust-api/'>REST API Design: How to break down the API object to make more scalable and robust API</a></li><li class="list-group-item"><a href='../rest-design-update-properties-on-an-entity-in-a-restful-resource-based-api/'>Rest &#8211; Design: Update properties on an entity in a RESTful, resource-based, API</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>