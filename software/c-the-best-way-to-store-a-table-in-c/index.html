<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211;  the best way to store a table in C++ &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066440 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066440" class="post-1066440 software type-software status-publish hentry category-software tag-c tag-data-structures"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211;  the best way to store a table in C++</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">data structures</span></p><div class="entry-content"><p>I&#39;m programming a decision tree in C++ using a slightly modified version of the <a href="http://en.wikipedia.org/wiki/C4.5_algorithm" rel="nofollow">C4.5 algorithm</a>. Each node represents an attribute or a column of your data set and it has a children per possible value of the attribute.</p><p>My problem is how to store the training data set having in mind that I have to use a subset for each node so I need a quick way to only select a subset of rows and columns.</p><p>The main goal is to do it in the most memory and time efficient possible (in that order of priority).</p><p>The best way I have thought of is to have an array of arrays (or std::vector), or something like that, and for each node have a list (array, vector, etc) or something with the <code>column,line</code>(probably a tuple) pairs that are valid for that node.</p><p>I now there should be a better way to do this, any suggestions?</p><p><strong>UPDATE:</strong> What I need is something like this:</p><p>In the beginning I have this data:</p><pre><code>Paris    4    5.0    True
New York 7    1.3    True
Tokio    2    9.1    False
Paris    9    6.8    True
Tokio    0    8.4    False
</code></pre><p>But for the second node I just need this data:</p><pre><code>Paris    4    5.0
New York 7    1.3
Paris    9    6.8
</code></pre><p>And for the third node:</p><pre><code>Tokio    2    9.1
Tokio    0    8.4
</code></pre><p>But with a table of millions of records with up to hundreds of columns.</p><p>What I have in mind is keep all the data in a matrix, and then for each node keep the info of the current columns and rows. Something like this:</p><pre><code>Paris    4    5.0    True
New York 7    1.3    True
Tokio    2    9.1    False
Paris    9    6.8    True
Tokio    0    8.4    False
</code></pre><p>Node 2:</p><pre><code>columns = [0,1,2]
rows = [0,1,3]
</code></pre><p>Node 3:</p><pre><code>columns = [0,1,2]
rows = [2,4]
</code></pre><p>This way on the worst case scenario I just have to waste</p><pre><code>size_of(int) * (number_of_columns + number_of_rows) * node
</code></pre><p>That is a lot less than having an independent data matrix for each node.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Last time I tried to understand C4.5, I failed, but I have implemented a variant of ID3 - originally out of curiosity, but it eventually got used as part of an overkill multiple-dispatch code generator. This never deals with large data sets, though, and it&#39;s a good job. You wouldn&#39;t do well to imitate most of what I did, but maybe with a few exceptions, and of course I learned a bit from the mistakes.</p><p>I tend to think in terms of building a decision tree for an expert system, so I tend to use the following terms - sorry if that&#39;s confusing...</p><pre><code>Column = Question ..... A question the expert system might ask
Row    = Conclusion ... A possible conclusion the expert system might reach
Cell   = Answer ....... For the question and conclusion, what answer should
                        the user be expected to give
</code></pre><p>Actually, in my case, I made the conclusion into another column - similar to a truth table for a logic gate. Row numbers were therefore just row numbers. This allowed me to handle XOR-style problems which can&#39;t even be represented if the same conclusion cannot appear on several rows. I&#39;m not sure if this is relevant to you or not. In any case, I&#39;m ignoring this below - it doesn&#39;t really make a lot of difference unless until you look at the details of choosing which question to ask next anyway. For data mining, you probably don&#39;t have a particular piece of information to treat as the target conclusion anyway - the &#34;conclusion&#34; is just whatever is left when you decide to stop asking questions.</p><p>So - for each decision tree node derived so far, you have a set of outstanding questions (columns) and a set of not-yet-eliminated conclusions (rows). That&#39;s what I did. The only point worth adding is I used bit-vectors.</p><p>IIRC, the C++ <code>std::vector&lt;bool&gt;</code> and <code>std::array&lt;bool&gt;</code> <em>may</em> be implemented as bit-vectors, but you&#39;re still reliant on the STL algorithms for set operations, which operate one item at a time. I used my own bit-vector class which has been gradually built up over a period of time, and which uses bitwise operators on the underlying <code>std::vector&lt;CHUNK&gt;</code> (where <code>CHUNK</code> is an unsigned int type, usually 32 bits wide).</p><p>There may be a better bit-vector option in C++11 or in Boost, and there must be some good libraries out there some where - there&#39;s plenty of kinds of program where you end up working with sets of unsigned integers. I just don&#39;t know much about them because I&#39;ve been too lazy to switch from using my own.</p><p>However, bit-vectors are at there best when sets are mostly dense. In this case, the set of rows is the obvious problem. Only the root node of the decision tree will have a perfectly dense row-set. As you get further from the root, the row sets get sparser and sparser, with each question answered resulting in the set of rows been distributed between two or more disjoint next-node row sets.</p><p>So a simple sorted-array-of-row-numbers might be the best representation for these sets. However, it&#39;s also possible that a &#34;sparse bit-vector&#34; might be worthwhile. One possible implementation is a sorted array of pairs where the first of each pair is the first row-ID of a block and the second is a fixed-size bitvector for that block. For example, the row number 35 might be stored in block 32 (<code>35 &amp; ~(32 - 1)</code>) in bit position 3 (<code>35 &amp; (32 - 1)</code>). If you only save the pairs where the bitvector is non-zero, this gives something between a sorted array of IDs and a simple bitvector - it handles sparse arrays reasonably well, especially when IDs tend to cluster closely together in sets.</p><p>Also, it may be worthwhile using a class that can switch from a bitvector to a sorted-array representation when the size gets small enough. The extra complication, purely to benefit a few nodes near the root, is probably pointless though.</p><p>Anyway, however these sets are represented, as they refer back to a single constant &#34;database&#34;, this saves a lot in data-copying and space-waste as the algorithm runs. But it&#39;s still worth looking at that &#34;database&#34;.</p><p>I used an associative data structure, allowing me to look up using a tuple of question-ID and conclusion-ID to get a answer-ID. That means I had a per-item overhead for the key (question-ID and conclusion-ID) and in this case B+-style tree overhead as well. The reason - basically habit. I have containers that are very flexible, and I tend to use them a lot because it saves on anticipating what capabilities I&#39;ll actually need later. There&#39;s a price for that, but that&#39;s just the old premature optimisation thing.</p><p>In your case, you&#39;re using a matrix - I assume a two-dimensional array indexed by question-ID and answer-ID.</p><p>The only way I can imagine my version being more efficient that yours is if most answers aren&#39;t known. In a matrix, you need a special not-known answer ID for that, taking the same space as a known answer-ID. In an associative container, you exclude those rows.</p><p>Even so, a sorted array would be more efficient than my B+ tree based solution. You don&#39;t need to allow for efficient inserts, so the only necessary overhead is for the keys.</p><p>If you use two key fields (question and conclusion, row and column) that might be a problem (I don&#39;t really remember) - you maybe can&#39;t just keep one copy of the table in one sorted order. But if you use a single computed key along the lines of <code>(row * num_columns) + column</code>, you&#39;re basically implementing a two dimensional sparse array anyway.</p><p>For me, the presence of unknown/undefined answers for a particular question means I&#39;m not allowed to ask that question yet - and even that was just the theory I used back when I first implemented the algorithm. I never actually put that to use. There&#39;s a use I could put it to, but I never got around to it. For the record, in that multiple-dispatch code generator, one idea was to dispatch based on fields in the type. As the type itself is polymorphic, those fields may not even be there, so it&#39;s only valid to look at them once you&#39;ve confirmed that they must be present.</p><p>If you don&#39;t have an application for unknown/undefined answers, your existing matrix is probably the best solution already.</p><p>So basically, that&#39;s it - I can&#39;t really offer any clearly better options, and what you&#39;re doing is probably already better than what I did. However, there are some trade-off possibilities that you might consider - assuming that&#39;s not premature (and possibly false) optimisation, of course.</p><p>The main trade-off issue relates to the efficiency of representations of sparse vs. dense sets of values, so it isn&#39;t really specific to C4.5 or decision-tree building. And a more &#34;sophisticated&#34; approach is often less efficient than a simple one that was chosen with care.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-the-best-way-to-store-dictionary-from-file/'>C++ &#8211; The best way to store dictionary from file</a></li><li class="list-group-item"><a href='../how-to-store-data-that-is-recorded-with-different-frequency/'>How to store data that is recorded with different frequency</a></li><li class="list-group-item"><a href='../whats-the-most-efficient-way-to-store-this-data-csv-flat-files-same-row-headings-tree-structure/'>What’s the most efficient way to store this data? (csv flat files, same row headings, tree structure)</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>