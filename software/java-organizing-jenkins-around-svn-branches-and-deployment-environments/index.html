<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Organizing Jenkins around SVN branches and deployment environments &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1080202 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1080202" class="post-1080202 software type-software status-publish hentry category-software tag-automation tag-deployment tag-java tag-jenkins"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Organizing Jenkins around SVN branches and deployment environments</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">automation</span><span class="mr-2 badge badge-info">deployment</span><span class="mr-2 badge badge-warning">java</span><span class="mr-2 badge badge-primary">Jenkins</span></p><div class="entry-content"><h3>Current setup</h3><p>We currently have one Jenkins server that automates deployments for about 15 different Java web applications. Each application has three deployment environments on separate Linux boxes.</p><ol><li>Development</li><li>Test</li><li>Production</li></ol><p>In Jenkins every application has it&#39;s own &#34;view&#34;.  Inside every view there is a job for every branch.  Those jobs simply build a war file and place it on the Jenkins server.  Then to deploy a DevOps person will SSH into the deployment environment (whether its dev, test, prod) for a particular application and run a SCP script that moves the war file from the Jenkins server to the deployment environment (usually into a Tomcat webapps folder for deployment).</p><h3>Issues</h3><p>Obviously this is a very silly process.  I want to have a Jenkins deployment process that actually deploys the application (so no one needs to SSH into a box and run an SCP script shell script).  I have got this process working for some of our smaller applications, but I am running into two issues.</p><ol><li>I don&#39;t know the best way to organize my jobs</li><li>Some coworkers are worried about how easy this would be to accidentally push a production build.</li></ol><h3>Explained further</h3><p><strong>On issue #1</strong> &#8211; An obvious brute force way would be to create a job for each deployment environment.  However, in that case I don&#39;t know how to make it so that the &#34;Test deployment environment&#34; job can take in as a parameter the branch I wish to deploy.  I don&#39;t want to have to make three jobs for every new branch (one for each deployment environment).  Additionally, I could create a job for every branch, but then I don&#39;t know how send the deployment environment in as a parameter?  I don&#39;t want to have to reconfigure these jobs each build which is the only way I&#39;ve found thus far.</p><p><strong>On issue #2</strong> &#8211; Is there any type of plugin or generally strategy used to protect against nefarious production deployments?  I realize this question might be heavily based off my answer to question #1.  Is having a separate account specifically for production builds an efficient way to protect against this?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m going to suggest you move to a slightly more complex but far more flexible system. Basically, I recommend you shift away from SVN branches that are linked to environments. We used this for several years and had no serious problems.</p><ul><li>If you don&#39;t already have one, install a repository product like Nexus.</li><li>Write deployment jobs for Jenkins that deploy a numbered version to Nexus, but do not deploy to the DEV, UAT or PROD hosts. This job will tag all files with the version number, and put the versioned .war file into Nexus. Assuming you use Maven or Gradle as your build tool, this is out of the box functionality for Jenkins.</li><li>Write deployment jobs for Jenkins that ask the user for a version number and target host. These are simply jobs that use SVN checkouts augmented by bash scripts that Jenkins will execute. You will need to add a few Jenkins plugins to make life easier (e.g Setenv to set variables visible to the whole job)</li><li>Install a second Jenkins instance for use of DEVOPS. This will host jobs that deploy a particular version to the the higher environments. This is mainly for security if developers are not allowed to do deployments to some environments.</li><li>Your use of SVN will change. We simply used the trunk for development, and branches for each deployed version. You only need to create version branches on demand (branch from tag). You typically will also create an occasional branch to try out a new feature.</li><li>Put up a white board in a prominent position that lists what versions are currently in each environment.</li></ul><p>So what will this give you?</p><ul><li>You don&#39;t need to do a code merge when moving between environments, as branches are no longer linked to environments.</li><li>You can quickly regress any environment to a different version. This is great for chasing obscure bugs.</li><li>Insist that defect reports include the version number. This gives good traceability of when the defect was fist detected.</li></ul><p>There are a few fish hooks.</p><ul><li>Your code must be written so that the same .war file will run in any environment. This means all configuration data must be stored as environment variables and/or JNDI variables. You can also use configuration files that are separately controlled and versioned (typically by DEVOPS). The actual location of these files will be specified by an environment or JNDI variable.</li><li>You will need to setup certificate-based trust between Jenkins and the target deployment machines. This is necessary so that you can use SSH to move files to the target hosts and execute commands on the target host - SSH does not support username/password authentication from a script.</li></ul><p>I realise this may be quite a change for your team, so good luck!</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../how-to-automate-production-deployments-without-experiencing-extreme-anxiety/'>How to automate production deployments without experiencing extreme anxiety</a></li><li class="list-group-item"><a href='../should-the-deploy-script-be-an-artifact-of-the-build/'>Should the deploy script be an artifact of the build</a></li><li class="list-group-item"><a href='../jenkins-to-automate-deployment-of-asp-net-applications/'>Jenkins to automate deployment of ASP.NET applications</a></li><li class="list-group-item"><a href='../handling-deployment-to-multiple-environments/'>Handling Deployment to Multiple Environments</a></li><li class="list-group-item"><a href='../git-how-to-we-keep-track-of-which-version-of-our-code-is-in-each-environment/'>Git &#8211; How to we keep track of which version of our code is in each environment</a></li><li class="list-group-item"><a href='../what-are-build-teams-build-farms-and-build-servers/'>What are Build Teams, Build Farms and Build Servers</a></li><li class="list-group-item"><a href='../how-to-apply-environment-specific-changes-within-the-classic-git-branching-model/'>How to apply environment specific changes within the classic Git branching model</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>