<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; Do you need to think about encapsulation if you can ensure immutability &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068475 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068475" class="post-1068475 software type-software status-publish hentry category-software tag-encapsulation tag-functional-programming tag-immutability tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; Do you need to think about encapsulation if you can ensure immutability</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">encapsulation</span><span class="mr-2 badge badge-info">functional programming</span><span class="mr-2 badge badge-warning">immutability</span><span class="mr-2 badge badge-primary">object-oriented</span></p><div class="entry-content"><p><strong>Encapsulation</strong></p><blockquote><p>In object-oriented programming (OOP), encapsulation refers to the<br /> bundling of data with the methods that operate on that data, or the<br /> restricting of direct access to some of an object&#39;s components.<a href="https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)" rel="noreferrer">1</a><br /> Encapsulation is used to hide the values or state of a structured data<br /> object inside a class, preventing unauthorized parties&#39; direct access<br /> to them. <a href="https://en.wikipedia.org/wiki/Encapsulation_(computer_programming)" rel="noreferrer">Wikipedia &#8211; Encapsulation (Computer Programming)</a></p></blockquote><p><strong>Immutability</strong></p><blockquote><p>In object-oriented and functional programming, an immutable object (unchangeable object) is an object whose state cannot be modified after it is created.<a href="https://en.wikipedia.org/wiki/Immutable_object" rel="noreferrer">Wikipedia &#8211; Immutable object</a></p></blockquote><p>If you can guarantee immutability, do you need to think about encapsulation?</p><p>I have seen these concepts being used in explaining ideas in object-oriented programming (OOP) and functional programming (FP).</p><p>I tried to investigate on the topics of encapsulation, immutability and their relation to one another. I couldn&#39;t find a post that explicitly asked if encapsulation is guaranteed if you have immutability.</p><p>Please correct me if I have misunderstood anything on the topic of encapsulation or immutability. I wish to understand these concepts better. Also, direct me to any other posts that have been done on the topic which answers the question above.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h2>The question</h2><p>Casting your question to real life:</p><blockquote><p>Is it okay for your doctor to post your private medical records publicly to Facebook, provided no one (other than you) is able to change it?</p><p>Is it okay for me to let strangers in your house, provided they can&#39;t steal or damage anything?</p></blockquote><p>It&#39;s asking the same thing. The core assumption of your question is that the only concern with exposing data is that it can be changed. As per your reference material:</p><blockquote><p>Encapsulation is used to hide the values or state of a structured data object inside a class, preventing unauthorized parties&#39; <strong>direct access</strong> to them.</p></blockquote><p>The ability to change values or state is definitely the biggest concern, but it&#39;s not the only concern. &#34;Direct access&#34; entails more than just write access. Read access can be a source of weakness as well.</p><p>A simple example here is that you are generally advised to not show stacktraces to an end user. Not just because errors shouldn&#39;t occur, but because stacktraces sometimes reveal specific implementations or libraries, which leads to an attacker knowing about the internal structure of your system.</p><p>The exception stacktrace is readonly, but it can be of use to those who wish to attack your system.</p><blockquote><p><em><strong>Edit</strong></em><br/> Due to confusion mentioned in the comments, the examples given here are not intended to suggest that encapsulation is used for data protection (such as medical records).<br/> This part of the answer so far has only addressed the core assertion that your question is built upon, i.e. that read access without write access is not harmful; which I believe to be incorrect, hence the simplified counterexamples.</p></blockquote><hr/><h2>Encapsulation as a safety guard</h2><p>Additionally, in order to prevent write access, you would need to have immutability all the way to the bottom. Take this example:</p><pre class="lang-cs prettyprint-override"><code>public class Level1
{
    public string MyValue { get; set; }
}

public class Level2 // immutable
{
    public readonly Level1 _level1;

    public Level2(Level1 level1) { _level1 = level1; }
}

public class Level3 // immutable
{
    public readonly Level2 _level2;

    public Level3(Level2 level2) { _level2 = level2; }
}
</code></pre><p>We&#39;ve let <code>Level2</code> and <code>Level3</code> expose their readonly fields, which is doing what your question is asserting to be safe: read access, no write access.</p><p>and yet, as a consumer of a <code>Level3</code> object, I can do this:</p><pre class="lang-cs prettyprint-override"><code>// fetch the object - this is allowed behavior
var myLevel3 = ...; 

// but this wasn&#39;t the intention!
myLevel3.Level2.Level1.MyValue = &#34;SECRET HACK ATTACK!&#34;;
</code></pre><p>This code compiles and runs perfectly fine. Because read access on a field (e.g. <code>myLevel3.Level2</code>) gives you access to an object (<code>Level2</code>) which in turn exposes read access to another object (<code>Level1</code>), which in turn exposes <strong>read and write</strong> access to its <code>MyValue</code> property.</p><p>And this is the danger of brazenly making everything immutably public. Any mistake will be visible and become an open door for unwanted behavior. By needlessly exposing some things that could easily have been hidden, you have opened them up to scrutiny and abuse of weakness if any exists.</p><p><em><strong>Edit</strong></em><br/> <em>Caleth mentioned that a class is not immutable if it exposes something that itself is not immutable. I think that this is a semantical argument. <code>Level2</code>&#39;s properties are readonly, which ostensibly makes it immutable.</em></p><p><em>To be fair, if the law of Demeter had been followed in my example, the issue wouldn&#39;t have been as glaring since <code>Level2</code> wouldn&#39;t expose direct access to <code>Level1</code> (but that precludes the issue I was trying to highlight); but the point of the matter is that it&#39;s a fool&#39;s errand to try and ensure the immutability of an entire codebase. If someone makes one adjustment in a single class (that a lot of other classes depend on in some way), that could lead to an entire assembly worth of classes becoming mutable without anyone noticing it.</em></p><p><em>This issue can be argued to be a cause of a lack of encapsulation or not following the law of Demeter. Both contribute to the issue. But regardless of what you attribute it to the fact remains that the this is unmistakably a problem in the codebase.</em></p><hr/><h2>Encapsulation for clean code</h2><p>But that&#39;s not all you use encapsulation for.</p><p>Suppose my application wants to know the time, so I make a <code>Calendar</code> which tells me the date. Currently, I read this date as a string from a file (let&#39;s assume there is a good reason for this).</p><pre class="lang-cs prettyprint-override"><code>public class Calendar
{
    public readonly string fileContent; // e.g. &#34;2020-01-28&#34;

    public DateTime Date =&gt; return DateTime.Parse(fileContent);

    public Calendar()
    {
        fileContent = File.ReadAllText(&#34;C:\\Temp\\calendar.txt&#34;);
    }
}
</code></pre><p><code>fileContent</code> should have been an encapsulated field, but I&#39;ve opened it up because of your suggestion. Let&#39;s see where that takes us.</p><p>Our developers have been using this calender. Let&#39;s look at Bob&#39;s library and John&#39;s library:</p><pre class="lang-cs prettyprint-override"><code>public class BobsLibrary
{
    // ...

    public void WriteToFile(string content)
    {
        var filename = _calendar.fileContent + &#34;.txt&#34;; // timestamp in filename
        var filePath = $&#34;C:\\Temp\\{filename}&#34;;

        File.WriteAllLines(filePath , content);
    }
}
</code></pre><p>Bob has used <code>Calendar.fileContent</code>, the field that should&#39;ve been encapsulated, but wasn&#39;t. But his code works and the field was public after all, so there&#39;s no issue right now.</p><pre class="lang-cs prettyprint-override"><code>public class JohnsLibrary
{
    // ...

    public void WriteToFile(string content)
    {
        var filename = _calendar.Date.ToString(&#34;yyyy-MM-dd&#34;) + &#34;.txt&#34;; // timestamp in filename
        var filePath = $&#34;C:\\Temp\\{filename}&#34;;

        File.WriteAllLines(filePath , content);
    }
}
</code></pre><p>John has used <code>Calendar.Date</code>, the property that should always be exposed. At first glance, you&#39;d think John is doing unnecessary work by converting the <code>string</code> to a <code>DateTime</code> and back to a <code>string</code>. But his code does work, so no issue is raised.</p><p>Today, we have learned something that will save us a lot of money: you can get the current date from the internet! We no longer have to hire an intern to update our calendar file every midnight. Let&#39;s change our <code>Calendar</code> class accordingly:</p><pre class="lang-cs prettyprint-override"><code>public class Calendar
{
    public DateTime Date { get; }

    public Calendar()
    {
        Date = GetDateFromTheInternet(&#34;http://www.whatistodaysdate.com&#34;);
    }
}
</code></pre><p>Bob&#39;s code has broken! He no longer has access to the <code>fileContent</code>, since we&#39;re no longer parsing our date from a string.</p><p>John&#39;s code, however, has kept working and does not need to be updated. John used <code>Date</code>, the intended public contract for the calendar. <strong>John did not build his code to rely on implementation details</strong> (i.e. the <code>fileContent</code> from which we parsed the date in the past), <strong>and therefore his code can effortlessly handle changes to the implementation.</strong></p><p>This is why encapsulation matters. It allows you to disconnect your consumers (Bob, John), from your implementation (the calendar file) by having an intermediary interface (the <code>DateTime Date</code>). <strong>As long as the intermediary interface is untouched, you can change the implementation <em>without affecting the consumers</em>.</strong></p><p><em>My example is a bit simplified, you&#39;d more likely use an <code>interface</code> here and swap out the concrete class that implements the interface for another class that implements the same interface. But the issue I pointed out remains the same.</em></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-what-did-alan-kay-mean-by-assignment-in-the-early-history-of-smalltalk/'>Object-oriented &#8211; What did Alan Kay mean by &#8220;assignment&#8221; in The Early History of Smalltalk</a></li><li class="list-group-item"><a href='../object-oriented-is-functional-programming-a-superset-of-object-oriented/'>Object-oriented &#8211; Is functional programming a superset of object oriented</a></li><li class="list-group-item"><a href='../does-immutability-entirely-eliminate-the-need-for-locks-in-multi-processor-programming/'>Does immutability entirely eliminate the need for locks in multi-processor programming</a></li><li class="list-group-item"><a href='../in-functional-programming-does-having-most-of-the-data-structures-immutable-require-more-memory-usage/'>In functional programming, does having most of the data structures immutable require more memory usage</a></li><li class="list-group-item"><a href='../uses-of-persistent-data-structures-in-non-functional-languages/'>Uses of persistent data structures in non-functional languages</a></li><li class="list-group-item"><a href='../object-oriented-complete-immutability-and-object-oriented-programming/'>Object-oriented &#8211; Complete immutability and Object Oriented Programming</a></li><li class="list-group-item"><a href='../object-oriented-do-non-oop-paradigms-support-concepts-such-as-encapsulation/'>Object-oriented &#8211; Do non-OOP paradigms support concepts such as encapsulation</a></li><li class="list-group-item"><a href='../object-oriented-can-we-really-use-immutability-in-oop-without-losing-all-key-oop-features/'>Object-oriented &#8211; Can we really use immutability in OOP without losing all key OOP features</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>