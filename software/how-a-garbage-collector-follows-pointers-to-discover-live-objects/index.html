<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How a Garbage Collector follows pointers to discover live objects &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1085767 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1085767" class="post-1085767 software type-software status-publish hentry category-software tag-garbage-collection"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How a Garbage Collector follows pointers to discover live objects</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">garbage-collection</span></p><div class="entry-content"><p>I have read through <a href="http://jayconrod.com/posts/55/a-tour-of-v8-garbage-collection" rel="nofollow noreferrer">A tour of V8: Garbage Collection</a> and am stuck on this part:</p><blockquote><p>Distinguishing pointers and data on the heap is the first problem any garbage collector needs to solve. The GC needs to follow pointers in order to discover live objects.</p></blockquote><p>I understand the rest of the document for the most part, talking about how to actually perform the garbage collection once you have the live objects. But I don&#39;t understand how you identify the live objects.</p><p>After that quote they go on to describe 3 ways of distinguishing pointers from data, but the second one is glossed over a bit:</p><blockquote><p>As long as we can identify what class an object comes from, we can find all of its pointers.</p></blockquote><p>That sounds nice, I would like to know how to do that. I assume they mean when you construct a new class like <code>new Foo()</code>, under the hood it associates the instance of the class with a pointer to the actual class. But I don&#39;t see how the garbage collector then uses this information to determine which objects are live or not.</p><p>Likewise, <a href="https://stackoverflow.com/questions/6650677/how-do-garbage-collectors-track-all-live-objects">this resource</a> is a bit vague on the same detail:</p><blockquote><p>The garbage collector works in two phases: the mark phase, and the sweep phase. In the mark phase, the garbage collector starts walks object references in order to find objects that are still reachable. The garbage collector starts at a few basic places where the object references are stored and given names (the stack, and global storage, and static storage), and then traverses references in the objects.</p></blockquote><p><a href="http://web.eecs.umich.edu/~weimerw/2008-415/reading/bacon-garbage.pdf" rel="nofollow noreferrer">This</a> is a bit more helpful, but still pretty vague:</p><blockquote><p>Tracing garbage collection traverses the object graph forward,<br /> starting with the roots, to find the live data. Reference counting<br /> traverses the object graph forward, starting with the anti-roots (the<br /> set of objects whose reference counts were decremented to 0), to<br /> find dead data.</p><p>Intuitively, one can think of tracing as operating on “matter” and<br /> reference counting as operating on “anti-matter”.</p></blockquote><p>I don&#39;t see how you can traverse objects, and know that it is ready to be garbage collected or not. Any tips on understanding that part would be of help. Thank you!</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m sure Erik&#39;s answer has lots of great info but I think you are stuck on the fundamentals.  I&#39;m more familiar with Java GC but the basic principles are pretty universal.</p><blockquote><p>I understand the rest of the document for the most part, talking about how to actually perform the garbage collection once you have the live objects. But I don&#39;t understand how you identify the live objects.</p></blockquote><p>The thing I think you are missing is that there is necessarily a set of root references.  In Java that&#39;s your stack, and static values etc.  In JS, I&#39;d guess it&#39;s things like the <code>window</code> object.  I think a picture helps here:</p><p><a href="../../../i.stack.imgur.com/bl1Ml.jpg" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/bl1Ml.jpg" alt="Objects in memory"/></a></p><p>The circles represent objects and the arrows are references to other objects.  On the left I&#39;ve labelled three objects as being part of the root references.  What that is exactly isn&#39;t terribly important but what you need to know is that these are basically implicit/hardcoded.  They are fundamental to the runtime environment i.e. there&#39;s no need to find them.  We know what and where they are inherently.</p><p>I think the easiest algorithm to understand is the mark-sweep and it&#39;s guaranteed to find all the garbage unlike other approaches such as reference counting.  The first step is to mark.</p><p><a href="../../../i.stack.imgur.com/xxuxd.jpg" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/xxuxd.jpg" alt="enter image description here"/></a></p><p>I&#39;ve added a green checkmark to each object that is referenced from the roots.  You should be able to verify whether I&#39;ve gotten it right (please do!)  Just start with each root and follow it&#39;s references.  Then follow the references from those until there are no more paths to follow.  This is the &#39;live set&#39; of objects.</p><p>Now comes the sweep:</p><p><a href="../../../i.stack.imgur.com/rw66o.jpg" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/rw66o.jpg" alt="enter image description here"/></a></p><p>Everything that wasn&#39;t identified as live is considered part of the &#39;dead set&#39;.  These are what can be removed.  Notice the cycle of references in the lower-right corner.  These are all in the dead set even though there are reference to them.  This is because there is no path from the roots to any of those objects.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../how-does-a-garbage-collector-prevent-the-whole-memory-from-being-scanned-on-every-collect/'>How does a garbage collector prevent the whole memory from being scanned on every collect</a></li><li class="list-group-item"><a href='../when-a-garbage-collector-compacts-objects-in-the-heap-does-it-change-the-references-on-the-stack/'>When a garbage collector compacts objects in the heap, does it change the references on the stack</a></li><li class="list-group-item"><a href='../garbage-collectors-and-pointers-reference/'>Garbage collectors and pointers/ reference</a></li><li class="list-group-item"><a href='../c-why-are-reference-counting-smart-pointers-so-popular/'>C++ &#8211; Why are reference-counting smart pointers so popular</a></li><li class="list-group-item"><a href='../would-using-a-hash-table-in-garbage-collection-solve-the-stop-the-world-problem-of-mark-and-sweep/'>Would using a hash table in garbage collection solve the stop the world problem of mark and sweep</a></li><li class="list-group-item"><a href='../python-when-should-i-worry-about-freeing-objects-from-memory-in-python/'>Python &#8211; When should I worry about freeing objects from memory in Python</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>