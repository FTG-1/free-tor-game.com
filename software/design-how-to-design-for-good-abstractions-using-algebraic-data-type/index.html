<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; How to design for good abstractions using algebraic data type &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1086305 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1086305" class="post-1086305 software type-software status-publish hentry category-software tag-algebraic-data-type tag-design tag-functional-programming"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; How to design for good abstractions using algebraic data type</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algebraic-data-type</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">functional programming</span></p><div class="entry-content"><p>Every now and then I have peaked at Haskell Tutorials and found the Algebraic data types quite interesting. I took their purpose to be to represent types that have completely separable states. Sadly, I never got to write more Haskell than tutorial level projects, and so I never had to really design programs using this pattern.</p><p>Now I am writing some Rust, and I have algebraic datatypes (enums) in the toolbox. However, I am not very confident in using them.</p><p>Let me start with an example where I am confident that such an enum is a proper choice.</p><pre><code>enum Tree {
    Leaf(i: String),
    Branch(Tree, Tree)
}
</code></pre><p>The same example would be applicaple for an XML-like structures, etc.</p><p>With other data, I am not so confident about using enum types. Let&#39;s take a connection object</p><pre><code>enum Connection {
    UnConnected(...),
    ConnectedConnection(....)
}
</code></pre><p>Here we would have a Connection type with two possible values, one representing the state where a connection is not yet established, the other one could represent the state of a connected connection (and wrapping a connection handle for example).</p><p>The other possibility would be to introduce 2 types for a Connection-Template and a connected connection.</p><p>Another example that I found in rust code is that in the <code>hyper</code> library. There is the type <code>Response</code> that represents a HTTP response. It is a generic type.<br /> <code>Response&lt;Fresh&gt;</code> represents the state where headers are not yet frozen. Once upon it is mapped to a <code>Response&lt;Streaming&gt;</code>, which can be used to write the body of the response. It seems like what Hyper models here with different types (<code>Response&lt;Fresh&gt;</code> vs <code>Response&lt;Streaming&gt;</code>) could have been modeled with <code>enum</code> types as well.</p><p>The approach with different types allows for more safety, <code>Response&lt;Fresh&gt;</code> does not implement streaming (I think) and <code>Response&lt;Streamimg&gt;</code> does.</p><p><strong>Do you know of guidelines and best practices that guide through modelling logic in types properly?</strong></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Even though you said algebraic data types, you seem to mostly be asking about sum types, so I will focus on those.  Product types are more common and more easily understood.</p><p>Sum types are most easily understood not by thinking about what you&#39;re modeling, but by thinking about the code that <em>uses</em> it.  People tend to think of sum types as representing states that are mutually exclusive, but this isn&#39;t the entire picture.  To use a sum type, you should also have a use for the encompassing type.  This represents an indeterminate state, where at the point of calling the function, you know you either have or need one of the term types, but you don&#39;t know which one.  If you always know which one statically, you should just create separate types.</p><p>For your <code>Tree</code> example, that means you should have functions that actually take or return a <code>Tree</code>.  As you traverse down the tree, you have this state where you don&#39;t know if the next node down is going to be a <code>Leaf</code> or a <code>Branch</code>, so you need a type that can be either.  If you only had functions that take or return <code>Leaf</code>s or <code>Branch</code>es, you wouldn&#39;t need a sum type.</p><p>Your <code>Connection</code> example is a completely different matter.  At some point, you have a <code>connect</code> function that takes in an <code>Unconnected</code> and returns a <code>Connected</code>.  At some later point, you have a <code>disconnect</code> function that does the reverse.  There is no point where you don&#39;t know statically if a connection is connected or not, therefore you don&#39;t need a type that can hold either.</p><p>If you have a hard time seeing appropriate situations to use sum types, my recommendation is to start out <em>not</em> using them.  If they are appropriate, at some point you&#39;ll hit a function that can&#39;t be written otherwise, then you can add it then.  Forcing a sum type when it&#39;s not needed leads to a lot of unnecessary pattern matching that could be much cleaner with separate functions.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/java-how-to-encode-algebraic-data-types-in-a-c-or-java-like-language/'>Java &#8211; How to encode Algebraic Data Types in a C#- or Java-like language</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/design-how-do-we-keep-dependent-data-structures-up-to-date/'>Design &#8211; How do we keep dependent data structures up to date</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-a-good-design-for-a-method-that-can-return-several-logically-different-results/'>C# &#8211;  a good design for a method that can return several logically different results</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/what-problem-do-algebraic-data-types-solve/'>What problem do algebraic data types solve</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>