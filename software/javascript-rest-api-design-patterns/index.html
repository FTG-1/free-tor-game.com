<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Javascript &#8211; REST Api Design Patterns &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1086437 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1086437" class="post-1086437 software type-software status-publish hentry category-software tag-api tag-api-design tag-javascript tag-resources tag-rest"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Javascript &#8211; REST Api Design Patterns</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api</span><span class="mr-2 badge badge-info">api-design</span><span class="mr-2 badge badge-warning">javascript</span><span class="mr-2 badge badge-primary">resources</span><span class="mr-2 badge badge-danger">rest</span></p><div class="entry-content"><p>I&#39;m developing a REST Api using <strong>Node.js &amp; Express.js</strong>. Recently I&#39;ve started looking towards best practices for REST Api design but it&#39;s bit confusing so please bear with me.</p><p><strong>For Example:</strong></p><p>Lets say I have the following API Collections:</p><ol><li>Users</li><li>Tasks (every task must belong to a User)</li></ol><p>And Have these resources:</p><ul><li>GET <code>/api/users</code> returns all Users</li><li>GET <code>/api/users/:id</code> returns a specific User</li><li>POST <code>/api/users</code> will create a single User</li><li>POST <code>/api/users/:id</code> will update a specific User</li><li>POST <code>/api/tasks</code> will create a new Task but will assign it to the loggedIn User.</li><li>POST <code>/api/tasks/:id</code> will update a specific Task</li><li>GET <code>/api/tasks</code> will get all Tasks</li><li>GET <code>/api/users/:id/tasks</code> will get all Tasks for a specific User</li><li>GET <code>/api/users/:id/tasks/:id</code> will get a specific Task for a Specific User</li></ul><p>Now each <strong>&#34;Resource&#34;</strong> above is redirected towards a <strong>&#34;Controller</strong>&#34; that actually performs actions.</p><p>For example:</p><pre><code>POST (&#39;/api/users&#39;, myController)

let myController = (req,res) =&gt; {
    Create new User
    Save to Database
    Call Private Send an Email to Admin function etc
 }
</code></pre><p><strong>Questions:</strong></p><p>Lets say I have to perform some queries on a resource such as <code>filter</code> should I:</p><p><strong>OPTION 1:</strong></p><p>Create a new resource like so <code>/api/users/:id/tasks/filter</code> and within my Controller and perform the filtering actions on the database within the controller</p><p><strong>OPTION 2:</strong></p><p>Use Query Strings like so <code>/api/users/:id/tasks?filter=title::someValue&amp;priority::someOtherValue</code>. According my knowledge doing this will <strong>NOT</strong> create a new resource but will simply call the <code>/api/users/:id/tasks</code> resource with the above Query Strings.</p><p>If I follow <strong>OPTION 2</strong> thats means I will only have one Controller that manages the <code>/api/users/:id/tasks</code> actions so to handle any Queries for this Resource should I do the following:</p><pre><code>GET (&#39;/api/users/:id/tasks&#39;, myController)

let myController = (req,res) =&gt; {

    if(req.filter)
    {handle Query here and get data from database and return to user}

    else if(some other query)
    {handle query here}

    else if(some other query)
    {handle query here}

    else {
      if there are NO queries then get get all Tasks for a specific User.
    }

 }
</code></pre><p><strong><em>Is the above implementation/concept correct? To me it seems messy and confusing. So what am I doing wrong here? What&#39;s the correct way of handling queries? Should a single Controller for a resource handle everything for that particular resource?</em></strong></p><p>I&#39;m having trouble thinking in &#34;REST&#34; there is so much information I&#39;m not sure what right and whats wrong. So my basics are a bit weak so any guidance towards that would be very helpful (any articles or online resources).</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h3>Disclaimer</h3><p>Despite the question has been scoped as REST, the truth is that it has nothing to do with REST.</p><p>Long story short, <strong>how to map the request parameters to an specific query language is implementation details</strong>. So, for now, lets leave REST aside.</p><hr/><blockquote><p>Is the above implementation/concept correct?</p></blockquote><p>For us to say whether is correct or not, we would need to be familiar with the project and its requirements. So far, what we can say is: <em>the solution is not flexible</em>.</p><p>Flexible in the sense of <em>scaling in the long run</em>. Every new <code>filter</code> would take you (at least) to modify the <code>controller</code>, the service layer and maybe the data access layer too. From the management standpoint, is hard to buy so much work for so little feature. In other words, the maintenance looks  expensive.</p><p>Nevertheless, it depends on how often you add new parameters to the query.</p><blockquote><p>So what am I doing wrong here?</p></blockquote><p>You are missing two possible abstractions.</p><ol><li>The one that maps a dynamic set of request parameters to an specific model of the API.</li><li>The one that maps the previous model to your specific <a href="https://en.m.wikipedia.org/wiki/Query_language" rel="nofollow noreferrer">query language</a>.</li></ol><p><strong><em>Note</em></strong><em>: Some frameworks makes #1 optional.</em></p><p>Right now the mapping is hardcoded as a <code>if/else</code> block. Too rigid for scaling well.</p><p>Instead, It could be similar to:</p><pre><code>myController(req,res){

   var query = new QueryParametersMapper(req);

   var page = new PageParametersMapper(req);

   var sort = new SortParametersMapper(req);

   var dataSet = myRepository.find(query, page, sort);

  // etc...
}
</code></pre><blockquote><p>What&#39;s the correct way of handling queries?</p></blockquote><p><strong>Making the mapping more dynamic and reusable</strong>.</p><p>At this point, my first advice would be <em>look for libraries</em> compatible with your framework or programming language.</p><p>My second advice would be, <em>pick the one that supports <a href="https://en.m.wikipedia.org/wiki/Convention_over_configuration" rel="nofollow noreferrer">Convention over configuration</a></em>.</p><p>Even if It doesn&#39;t prevent you from making changes, at least (I&#39;m sure) the costs of the changes will be lesser than they are now.<sup>*</sup></p><hr/><p><sup>* If we consider the code given as example in the question.</sup></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-api-concepts/'>REST API concepts</a></li><li class="list-group-item"><a href='../rest-api-design-dilemma-to-rest-or-not-to-rest/'>Rest &#8211; API design dilemma: to REST or not to REST</a></li><li class="list-group-item"><a href='../rest-what-api-design-makes-the-most-sense-for-changing-a-users-password/'>Rest &#8211; What API design makes the most sense for changing a user&#8217;s password</a></li><li class="list-group-item"><a href='../rest-how-to-approach-user-related-resources-on-a-rest-api/'>Rest &#8211; How to approach user related resources on a REST API</a></li><li class="list-group-item"><a href='../rest-api-design-multiple-resources-and-authorization/'>REST API Design: Multiple resources and authorization</a></li><li class="list-group-item"><a href='../rest-how-to-design-a-rest-api-that-can-prompt-the-client-about-long-running-operations/'>Rest &#8211; How to design a REST API that can &#8220;prompt&#8221; the client about long-running operations</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>