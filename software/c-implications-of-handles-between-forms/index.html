<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Implications of handles between forms &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1078538 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1078538" class="post-1078538 software type-software status-publish hentry category-software tag-c tag-object-oriented tag-winforms"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Implications of handles between forms</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">object-oriented</span><span class="mr-2 badge badge-warning">winforms</span></p><div class="entry-content"><p>I was developing a WindowsForm application in C#, with 2 forms. Regardless of what they both did specifically I needed to access values in <code>form2</code> and send them to <code>form1</code> and vice versa. For this to happen I found someone talking about constructor overload and it worked for me as I explain in the code.</p><p>Form1:</p><pre><code>namespace miniDldMngr
{
    public partial class Main : Form
    {
        miniDldMngr.SettingsForm settingsForm; //Instantiate settingsForm

        private void settingsToolStripButton_Click(object sender, EventArgs e)
        {
            settingsForm = new miniDldMngr.SettingsForm(this); //Create handle for Form1
            settingsForm.ShowDialog(); //Form properties were changed to act like a dialog
        }
</code></pre><p>Form2:</p><pre><code>namespace miniDldMngr
{
    public partial class SettingsForm : Form
    {
        private Main HandleToForm1; //local variable to store handle to Form1

        public SettingsForm()
        {
            InitializeComponent();
        }

        public SettingsForm(Main frm1Handle) //overloaded constructor with handle to Form1
        {
            InitializeComponent();
            HandleToForm1 = frm1Handle;
            txtIni.Text = HandleToForm1.comboLoad.Text; //here&#39;s how i access controls on form1 for example, as long as modifiers are public
        }
</code></pre><p>I came across <a href="https://stackoverflow.com/a/8650452/1067465">this answer</a> on Stack Overflow and user codesparkle commented:</p><blockquote><p>It&#39;s neither scalable nor OOP-like.</p></blockquote><p>Which lead me to believe that it might not have been the best choice to solve my initial issue. (S)He further added:</p><blockquote><p>One approach is to create an event in the class that knows the information which needs to be shown. The form can then register one of its methods as an event handler. Once the information becomes available, the class notifies the Form by calling that handler with an argument containing the displayable information. The beauty of this approach is that the class is decoupled (not dependent on) the implementation of Form. The MVC and MVVM design patterns are other robust ways of doing it.</p></blockquote><p>Now I&#39;m left with some questions:</p><ol><li>What are the implications of the procedure I used?</li><li>Why isn&#39;t it an object-oriented approach?</li><li>What would be the best practice to send information back and forth between classes/forms?</li><li>How would you go about creating the event mentioned by codesparkle?</li><li>I don&#39;t know anything about MVC or MVVM design patterns, so some links to a structured explanation would be appreciated.</li></ol><p>Please consider that I&#39;m very new to programming and I won&#39;t understand you if you talk like I know what I am doing. Code examples work wonders with me, since I can test them.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>To answer each of your questions:</p><h3>What are the implications of the procedure I used?</h3><p>In this instance, you are passing a reference from a parent object (the Main form) to the child object (the Settings form).  The result of this is that the Settings form must know a lot of things about the Main form in order to work properly.  Some not-so-desirable implications:</p><ol><li>The Settings form must know the names of all the controls in the Main form in order to work properly.</li><li>You have to make a lot of things in the Main form public.  Making things public isn&#39;t a mortal sin by any stretch, however now your Main form is advertising a lot of functionality that it doesn&#39;t need to advertise to the outside world.  This is more of an issue when your project grows, or if you work with more than one developer, who will be poking around the public members of your objects to figure out how to work with your code from the outside.</li><li>Down the road, if for some reason the main form and the settings form were in two different assemblies (DLL files), you might run into trouble because you cannot create circular references.</li></ol><h3>Why isn&#39;t it an object-oriented approach?</h3><p>Well, what you are doing is object-oriented, however because you have a child object depending on a parent object, you are going against the <a href="http://en.wikipedia.org/wiki/Dependency_inversion_principle" rel="nofollow">Dependency Inversion Principle</a> and are thus causing <strong>tight coupling</strong> between objects.</p><p>When people on SO and other sites talk about how &#34;object oriented&#34; something is, they often are referring to <a href="http://en.wikipedia.org/wiki/SOLID_(object-oriented_design)" rel="nofollow">S.O.L.I.D.</a>, which are five key principles of object oriented design.</p><h3>What would be the best practice to send information back and forth between classes/forms?</h3><p>I think in this instance the easiest way to accomplish this would be to create properties in your Settings form that represent the values that are modified within the settings window.</p><p>For example, this code would be in your Settings form:</p><pre><code>public string UserName
{
   get { return txtUserName.Text; }
   set { txtuserName.Text = value; }
}
</code></pre><p>And this code would be in your Main Form:</p><pre><code>private void settingsToolStripButton_Click(object sender, EventArgs e)
{
    settingsForm = new miniDldMngr.SettingsForm() { UserName = lblUserName.Text };
    settingsForm.ShowDialog(); 
    lblUserName.Text = settingsForm.UserName;
}
</code></pre><p>It is slightly more code, but now you are free to make as many changes as you want to the main form, and the settingsform won&#39;t need to be updated.</p><p>There are of course many other approaches you can take, which leads me to your last two questions:</p><h3>How would you go about creating the event mentioned by codesparkle?</h3><p>Creating and raising an event is another way to avoid tight coupling between two classes.  Notice how the Windows Forms objects, such as ToolStrip are able to call methods in your code (settingsToolStripButton_Click), even though the Windows Forms code is not linked to your code.  That is the beauty of events.  My opinion is that it is overkill in this situation, since you are showing the form as a Dialog (where you can just read all of the values after the dialog closes), but nonetheless here is an example:</p><p>First, you would have code like this in your SettingsForm:</p><pre><code>public string UserName
{
   get { return txtUserName.Text; }
   set { txtuserName.Text = value; }
}

public event EventHandler UserNameChanged;
protected void OnUserNameChanged(EventArgs e)
{
   if(UserNameChanged != null)
   {
       UserNameChanged(this, e);
   }
}

private void txtUserName_TextChanged(object sender, EventArgs e)
{
    OnUserNameChanged(EventArgs.Empty);
}
</code></pre><p>Then, you would have code similar to this in your MainForm:</p><pre><code>private void settingsToolStripButton_Click(object sender, EventArgs e)
{
    settingsForm = new miniDldMngr.SettingsForm() { UserName = lblUserName.Text };
    settingsForm.ShowDialog(); 

    lblUserName.UserNameChanged += 
        (sender, args) =&gt; lblUserName.Text = settingsForm.UserName;
}
</code></pre><h3>I don&#39;t know anything about MVC or MVVM design patterns, so some links to a structured explanation would be appreciated.</h3><p>The MVVM pattern is a pattern championed by Microsoft, primarily for use in WPF.  You can read a nice description here:</p><p><a href="http://msdn.microsoft.com/en-us/magazine/dd419663.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/magazine/dd419663.aspx</a></p><p>You can use this pattern in Windows Forms, however I wouldn&#39;t recommend it, as WPF has more of the basic plumbing complete in order to actually make it work.</p><p>Happy coding!</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-best-design-for-windows-forms-that-will-share-common-functionality/'>C# &#8211; Best design for Windows forms that will share common functionality</a></li><li class="list-group-item"><a href='../architecture-form-inheritance-be-avoided/'>Architecture &#8211;  form inheritance be avoided</a></li><li class="list-group-item"><a href='../c-adding-model-into-another-view-models-collection/'>C# &#8211; Adding model into another view model&#8217;s collection</a></li><li class="list-group-item"><a href='../c-is-it-good-practice-to-use-user-controls-to-structure-wpf-forms-even-if-these-user-controls-are-only-used-once/'>C# &#8211; Is it good practice to use user controls to structure WPF forms even if these user controls are only used once</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>