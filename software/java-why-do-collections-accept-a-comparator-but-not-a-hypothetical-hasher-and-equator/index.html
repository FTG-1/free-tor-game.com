<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java: why do collections accept a Comparator but not (a hypothetical) Hasher and Equator &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1071645 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1071645" class="post-1071645 software type-software status-publish hentry category-software tag-collections tag-java"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java: why do collections accept a Comparator but not (a hypothetical) Hasher and Equator</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">collections</span><span class="mr-2 badge badge-info">java</span></p><div class="entry-content"><p>This issue is most apparent when you have different implementations of an interface, and for the purposes of a particular collection you only care about the interface-level view of the objects. For example, suppose you had an interface like this:</p><pre><code>public interface Person {
    int getId();
}
</code></pre><p>The usual way to implement <code>hashcode()</code> and <code>equals()</code> in implementing classes would have code like this in the <code>equals</code> method:</p><pre><code>if (getClass() != other.getClass()) {
    return false;
}
</code></pre><p>This causes problems when you mix implementations of <code>Person</code> in a <code>HashMap</code>. If the <code>HashMap</code> only cares about the interface-level view of <code>Person</code>, then it could end up with duplicates that differ only in their implementing classes.</p><p>You could make this case work by using the same liberal <code>equals()</code> method for all the implementations, but then you run the risk of <code>equals()</code> doing the wrong thing in a different context (such as comparing two <code>Person</code>s that are backed by database records with version numbers).</p><p>My intuition tells me that equality should be defined per collection instead of per class. When using collections that rely on ordering, you can use a custom <code>Comparator</code> to pick the right ordering in each context. There is no analogue for hash-based collections. Why is this?</p><p>Just to clarify, this question is distinct from &#34;<a href="https://softwareengineering.stackexchange.com/questions/283168/why-is-compareto-in-an-interface-while-equals-is-in-a-class-in-java">Why is .compareTo() in an interface while .equals() is in a class in Java?</a>&#34; because it deals with the implementation of collections. <code>compareTo()</code> and <code>equals()</code>/<code>hashcode()</code> both suffer from the problem of universality when using collections: you can&#39;t pick different comparison functions for different collections. So for the purposes of this question, the inheritance hierarchy of an object doesn&#39;t matter at all; all that matters is whether the comparison function is defined per-object or per-collection.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This design is sometimes known as &#34;Universal Equality&#34;, it is the belief that whether two things are equal or not is a universal property.</p><p>What&#39;s more, equality is a property of <em>two</em> objects, but in OO, you always call a method on <em>one single object</em>, and that object gets to solely decide how to handle that method call. So, in a design like Java&#39;s, where equality is a property of one of the two objects being compared, it isn&#39;t even possible to guarantee some basic properties of equality such as symmetry (<code>a == b</code> ⇔ <code>b == a</code>), because in the first case, the method is being called on <code>a</code> and in the second case it is being called on <code>b</code> and due to the basic principles of OO, it is solely <code>a</code>&#39;s decision (in the first case) or <code>b</code>&#39;s decision (in the second case) whether or not it considers itself equal to the other one. The only way to gain symmetry is to have the two objects cooperate, but if they don&#39;t… tough luck.</p><p>One solution would be to make equality not a property of one object, but either a property of two objects, or a property of a third object. That latter option also solves the problem of universal equality, because if you make equality a property of a third &#34;context&#34; object, then you can imagine having different <code>EqualityComparer</code> objects for different contexts.</p><p>This <em>is</em> the design chosen for Haskell, for example, with the <code>Eq</code> typeclass. It is also the design chosen by some third-party Scala libraries (ScalaZ, for example), but not the Scala core or standard library, which uses universal equality for compatibility with the underlying host platform.</p><p>It is, interestingly, also the design chosen with Java&#39;s <code>Comparable</code>/<code>Comparator</code> interfaces. The designers of Java clearly were aware of the problem, but for some reason only solved it for ordering, but not for equality (or hashing).</p><p>So, as to the question</p><blockquote><p>why is there a <code>Comparator</code> interface but no <code>Hasher</code> and <code>Equator</code>?</p></blockquote><p>the answer is &#34;I don&#39;t know&#34;. Clearly, the designers of Java were aware of the problem, as evidenced by the existence of <code>Comparator</code>, but they obviously didn&#39;t think it a problem for equality and hashing. Other languages and libraries make different choices.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-why-do-different-java-collections-have-different-default-capacity/'>Java &#8211; Why do different java collections have different default capacity</a></li><li class="list-group-item"><a href='../java-why-doesnt-java-8-include-immutable-collections/'>Java &#8211; Why doesn&#8217;t Java 8 include immutable collections</a></li><li class="list-group-item"><a href='../java-why-does-java-collections-not-supply-a-function-for-the-index-of-max-value/'>Java &#8211; Why does java collections not supply a function for the index of max value</a></li><li class="list-group-item"><a href='../java-in-java-why-does-unsorted-set-implement-iterable-but-sortedmap-does-not/'>Java &#8211; In Java, why does (unsorted) Set implement Iterable, but SortedMap does not</a></li><li class="list-group-item"><a href='../java-collections-why-are-vectors-not-used-anymore-but-are-still-around/'>Java &#8211; Collections: Why are Vectors not used anymore but are still around</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>