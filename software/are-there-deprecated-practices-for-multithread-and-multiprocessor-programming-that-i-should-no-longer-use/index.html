<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Are there deprecated practices for multithread and multiprocessor programming that I should no longer use &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073387 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073387" class="post-1073387 software type-software status-publish hentry category-software tag-coding-standards tag-concurrency tag-multi-core tag-multithreading"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Are there deprecated practices for multithread and multiprocessor programming that I should no longer use</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">coding-standards</span><span class="mr-2 badge badge-info">concurrency</span><span class="mr-2 badge badge-warning">multi-core</span><span class="mr-2 badge badge-primary">multithreading</span></p><div class="entry-content"><p>In the early days of FORTRAN and BASIC, essentially all programs were written with GOTO statements.  The result was spaghetti code and the solution was structured programming.</p><p>Similarly, pointers can have difficult to control characteristics in our programs.  C++ started with plenty of pointers, but use of references are recommended.  Libraries like STL can reduce some of our dependency.  There are also idioms to create smart pointers that have better characteristics, and some version of C++ permit references and managed code.</p><p>Programming practices like inheritance and polymorphism use a lot of pointers behind the scenes (just as for, while, do structured programming generates code filled with branch instructions).  Languages like Java eliminate pointers and use garbage collection to manage dynamically allocated data instead of depending on programmers to match all their new and delete statements.</p><p>In my reading, I have seen examples of multi-process and multi-thread programming that don&#39;t seem to use semaphores.  Do they use the same thing with different names or do they have new ways of structuring protection of resources from concurrent use?</p><p>For example, a specific example of a system for multithread programming with multicore processors is OpenMP.  It represents a critical region as follows, without the use of semaphores, which seem not to be included in the environment.</p><pre><code>th_id = omp_get_thread_num();
#pragma omp critical
{
  cout &lt;&lt; &#34;Hello World from thread &#34; &lt;&lt; th_id &lt;&lt; &#39;\n&#39;;
}
</code></pre><p>This example is an excerpt from: <a href="http://en.wikipedia.org/wiki/OpenMP">http://en.wikipedia.org/wiki/OpenMP</a></p><p>Alternatively, similar protection of threads from each other using semaphores with functions wait() and signal() might look like this:</p><pre><code>wait(sem);
th_id = get_thread_num();
cout &lt;&lt; &#34;Hello World from thread &#34; &lt;&lt; th_id &lt;&lt; &#39;\n&#39;;
signal(sem);
</code></pre><p>In this example, things are pretty simple, and just a simple review is enough to show the wait() and signal() calls are matched and even with a lot of concurrency, thread safety is provided.  But other algorithms are more complicated and use multiple semaphores (both binary and counting) spread across multiple functions with complex conditions that can be called by many threads.  The consequences of creating deadlock or failing to make things thread safe can be hard to manage.</p><p>Do these systems like OpenMP eliminate the problems with semaphores?<br /> Do they move the problem somewhere else?<br /> How do I transform my favorite semaphore using algorithm to not use semaphores anymore?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Are there concurrent programming techniques and practices that one should no longer use? I&#39;d say <strong>yes</strong>.</p><p>One early concurrent programming technique that seems rare nowadays is <strong>interrupt-driven</strong> programming. This is how UNIX worked in the 1970s. See the Lions <em>Commentary on UNIX</em> or Bach&#39;s <em>Design of the UNIX Operating System</em>. Briefly, the technique is to suspend interrupts temporarily while manipulating a data structure, and then to restore interrupts afterward. The <a href="http://www.unix.com/man-page/FreeBSD/9/spl/" rel="nofollow noreferrer">BSD spl(9) man page</a> has an example of this style of coding. Note that the interrupts are hardware-oriented, and the code embodies an implicit relationship between the kind of hardware interrupt and the data structures associated with that hardware. For example, code that manipulates disk I/O buffers needs to suspend interrupts from disk controller hardware while working with those buffers.</p><p>This style of programming was employed by operating systems on uniprocessor hardware. It was much rarer for applications to deal with interrupts. Some OSes had software interrupts, and I think people tried to build threading or coroutine systems on top of them, but this wasn&#39;t very widespread. (Certainly not in the UNIX world.) I suspect that interrupt-style programming is confined today to small embedded systems or real-time systems.</p><p><strong>Semaphores</strong> are an advance over interrupts because they are software constructs (not related to hardware), they provide abstractions over hardware facilities, and they enable multithreading and multiprocessing. The main problem is that they are unstructured. The programmer is responsible for maintaining the relationship between each semaphore and the data structures it protects, globally across the entire program. For this reason I think bare semaphores are rarely used today.</p><p>Another small step forward is a <strong><a href="http://en.wikipedia.org/wiki/Monitor_(synchronization)" rel="nofollow noreferrer">monitor</a></strong>, which encapsulates concurrency control mechanisms (locks and conditions) with the data being protected. This was carried over into  the <a href="http://research.microsoft.com/en-us/um/people/blampson/23-processesinmesa/Abstract.html" rel="nofollow noreferrer">Mesa</a> <a href="http://dl.acm.org/citation.cfm?id=358824" rel="nofollow noreferrer">(alternate link)</a> system and from there into Java. (If you read this Mesa paper, you can see that Java&#39;s monitor locks and conditions are copied almost verbatim from Mesa.) Monitors are helpful in that a sufficiently careful and diligent programmer can write concurrent programs safely using only local reasoning about the code and data within the monitor.</p><p>There are additional library constructs, such as those in Java&#39;s <code>java.util.concurrent</code> package, which includes a variety of highly concurrent data structures and thread pooling constructs. These can be combined with additional techniques such as thread confinement and effective immutability. See <em>Java Concurrency In Practice</em> by Goetz et. al. for further discussion. Unfortunately, many programmers are still rolling their own data structures with locks and conditions, when they really ought to just be using something like <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentHashMap.html" rel="nofollow noreferrer">ConcurrentHashMap</a> where the heavy lifting has already been done by the library authors.</p><p>Everything above shares some significant characteristics: they have multiple threads of control that interact over <strong>globally shared, mutable state</strong>. The problem is that programming in this style is still highly error-prone. It&#39;s quite easy for a small mistake to go unnoticed, resulting in misbehavior that is hard to reproduce and diagnose. It may be that no programmer is &#34;sufficiently careful and diligent&#34; to develop large systems in this fashion. At least, very few are. So, I&#39;d say that <strong>multi-threaded programming with shared, mutable state should be avoided if at all possible.</strong></p><p>Unfortunately it&#39;s not entirely clear whether it can be avoided in all cases. A lot of programming is still done in this fashion. It would be nice to see this supplanted by something else. Answers from <a href="https://softwareengineering.stackexchange.com/questions/161058/are-there-deprecated-practices-for-multithread-and-multiprocessor-programming-th/161065#161065">Jarrod Roberson</a> and <a href="https://softwareengineering.stackexchange.com/questions/161058/are-there-deprecated-practices-for-multithread-and-multiprocessor-programming-th/161061#161061">davidk01</a> point to techniques such as immutable data, functional programming, STM, and message-passing. There is much to recommend them, and all are being actively developed. But I don&#39;t think they&#39;ve fully replaced good old-fashioned shared mutable state just yet.</p><p>EDIT: here&#39;s my response to the specific questions at the end.</p><p>I don&#39;t know much about OpenMP. My impression is that it can be very effective for highly parallel problems such as numeric simulations. But it doesn&#39;t seem general-purpose. The semaphore constructs seem pretty low-level and require the programmer to maintain the relationship between semaphores and shared data structures, with all the problems I described above.</p><p>If you have a parallel algorithm that uses semaphores, I don&#39;t know of any general techniques to transform it. You might be able to refactor it into objects and then build some abstractions around it. But if you want to use something like message-passing, I think you really need to reconceptualize the entire problem.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../parallelism-implies-concurrency-but-not-the-other-way-round-right/'>Parallelism implies concurrency but not the other way round right</a></li><li class="list-group-item"><a href='../how-to-program-thread-allocation-on-multicore-processors/'>How to program thread allocation on multicore processors</a></li><li class="list-group-item"><a href='../java-how-to-make-a-universal-construction-more-efficient/'>Java &#8211; How to make a universal construction more efficient</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>