<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Php &#8211; Modern recommendations for password recovery &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082704 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082704" class="post-1082704 software type-software status-publish hentry category-software tag-authentication tag-passwords tag-php tag-security"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Php &#8211; Modern recommendations for password recovery</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">authentication</span><span class="mr-2 badge badge-info">passwords</span><span class="mr-2 badge badge-warning">PHP</span><span class="mr-2 badge badge-primary">Security</span></p><div class="entry-content"><p>I&#39;m going to implements password recovery in my authentication. I haven&#39;t put this together in a while and wondering if there is anything I ought to be aware of.</p><p>My idea at the moment is:</p><ol><li>User clicks &#34;Forgot my password&#34; to go the password recover page: a<br /> form with an email field</li><li>They enter their email, and an email is sent to that address with a<br /> link and password recover token/key (MD5 string &#8211; it just needs to<br /> be somewhat random and long right?). An entry is also made in the<br /> password_recovery database table which ties that token to their<br /> account, and an expire date (1 hour?)</li><li>They retrieve the email and click the link to take them to a<br /> password set page: two fields to enter their password, and confirm<br /> their password again.</li><li>Done, please login again with new password</li></ol><p>Does that seem OK? Anything changed over the years where this approach is no longer recommended?</p><p>UPDATE</p><p>Additions that I opted for:</p><ul><li>I store the token in the database hashed. If a hacker we to be able to access the database table somehow, they wouldn&#39;t be able to use the stored tokens .. hopefully (hashed with sha256)</li></ul></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Does that seem OK?</p></blockquote><p>Yes, assuming emails are the primary form of authentication of your site.</p><blockquote><p>Anything changed over the years where this approach is no longer recommended?</p></blockquote><p>Not that I know of.</p><p>Here are some points that you need to take into consideration.</p><h1>What type of feedback you will give the user</h1><p>When the email does not exist, what will you say and do?</p><ul><li>If you display a message like &#34;Sorry, this email doesn&#39;t exist&#34;, you are effectively leaking information about who is or isn&#39;t in your database.</li><li>So instead, you can display a message along the lines of &#34;If this email corresponds to a user account, you will get further instructions&#34;. This is more secure, but it might confuse your users (&#34;why didn&#39;t I get the email?&#34;).</li><li>A third option is to <em>always</em> send an email, only with a different content if the email wasn&#39;t in your database. This opens up your form for abuse though, as anybody could type anybody else&#39;s email, and your emails would eventually be spammed.</li></ul><p>If your system uses username, it might be better to ask for the username, not the email address. You send the recovery email to email address associated with the account, <em>without disclosing it</em> to the user.</p><h1>How do you protect the process against abuse</h1><ul><li>It&#39;s easy to see how somebody can use this form to generate emails, and then use social engineering to incite a user to click the link (or worse, forward the email). Therefore, you should make it very clear in your email.</li><li>You need to protect this form against brute force one way or another. Some examples: no more than one active request per account (do no resend emails until the previous one expires), limited number of tries per IP addresses, throttling, CAPTCHA, etc.</li></ul><h1>The token</h1><p>The token is really a <em>One Time Password</em> for a user account.</p><ul><li>The token should be <em>random</em> and <em>unpredictable</em>, and stored in the database with an association to the corresponding user ID, and the timestamp. You do no need MD5, nor do you need to encode anything in the token. Example in PHP, for a 32 character token: <code>bin2hex(openssl_random_pseudo_bytes(16));</code></li><li><strong>The token must have a short life time.</strong> 1 hour seems a bit long for me, I assume if you forgot your password you want to recover it <em>now</em>, so 30 minutes is probably plenty, but honestly this is up to you. The point is to limit the token lifetime.</li><li><strong>You must disable the token as soon as it has been used</strong>.</li><li><strong>You should not have more than one active token per user at any given time.</strong> From an relational database point of view, it&#39;s easier to enforce this rule when using a (nullable) field in your <code>users</code> table, rather than a separate table.</li><li>I&#39;m unsure as to the usefulness of hashing the reset token. From your database, the risk is already mitigated by the short lifetime, and one-time-only usage. The real risk is in the transport, as they are sent by email (unsecure), so they can be compromised then. But why not.</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-is-this-a-secure-solution-for-restful-authentication/'>Rest &#8211; Is this a secure solution for RESTful authentication</a></li><li class="list-group-item"><a href='../updating-password-hashing-without-forcing-a-new-password-for-existing-users/'>Updating password hashing without forcing a new password for existing users</a></li><li class="list-group-item"><a href='../php-matching-usernames-with-their-password/'>Php &#8211; matching usernames with their password</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>