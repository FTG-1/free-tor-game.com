<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Should a Rich Domain Model have repositories injected in some situations &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079986 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079986" class="post-1079986 software type-software status-publish hentry category-software tag-c tag-design-patterns tag-domain-driven-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Should a Rich Domain Model have repositories injected in some situations</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">domain-driven-design</span></p><div class="entry-content"><p>Please see the code below, which I took from Jimmy Bogards wicked domain models:</p><pre><code>public Offer AssignOffer(OfferType offerType, IOfferValueCalculator valueCalculator)
        {
            DateTime dateExpiring = offerType.CalculateExpirationDate();
            int value = valueCalculator.CalculateValue(this, offerType);

            var offer = new Offer(this, offerType, dateExpiring, value);

            _assignedOffers.Add(offer);

            NumberOfActiveOffers++;

            return offer;
        }
</code></pre><p>Unfortunately he has not posted the code contained in the implementation of: IOfferValueCalculator.  I have a feeling that the class will contain logic that determines what offers a member is entitled to.  However, surely the domain object has to go to the database (via the repository) to get details of the offers e.g. date expiring etc.  However, I understand that the domain layer in a rich domain model should not go to the database.  Therefore how does the domain layer get the offers? Are all the offers injected into the domain layer by the application layer?</p><p>I believe there is a pattern here that I am missing? I already know of Command Responsibility Segregation.  However, I believe in my case that the command object needs to access the database.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>If you need to access a database to solve your particular problem, then... Well, you need to access a database.  Doesn&#39;t matter what Jimmy Bogards, Eric Evans or anyone else says.  If their rules don&#39;t allow you to do that, then break their rules, follow someone else&#39;s rules, or make up your own.</p><p>When you read some rule on the internet that someone has devised, try to understand the motivations behind it first, before you apply it.  That way, you have a reasonable assurance that the application of said rule aligns with your own needs and expectations.</p><p>Rules like the one you cited from Eric Evans generally have one of two motivations:</p><ol><li>Separation of Concerns, and</li><li>Decoupling.</li></ol><p><strong>Separation of Concerns</strong> mostly means &#34;write each class or method so that it has one area of expertise and does that well.&#34;  Often, that means writing some module that specializes in database access only, allowing other modules/classes to focus on their own specific concerns without being concerned with the details of data retrieval.  It also means that your classes can be &#34;persistent-ignorant,&#34; meaning they don&#39;t have to know how to save or retrieve themselves from a database, especially some <em>specific</em> database technology.</p><p><strong>Decoupling,</strong> within the context of database access, generally means one of two things:</p><ol><li>You want to isolate data retrieval from the rest of the system, just in case you might someday change out the database implementation for something else, or</li><li>You want to mock the data retrieval mechanism for unit testing purposes.</li></ol><p>There are two commonly-accepted ways to access data from a database.  The first way is to use CRUD operations (create, read, update, delete).  The second is to provide a Business Logic Layer.  A business logic layer has methods on it like <code>GetOffers()</code> which provides more intelligent (and optimized) retrieval of data than create, read, update and delete.</p><p>Now then.  Jimmy Bogard&#39;s Wicked Domain Models:</p><blockquote><p><strong>What is a domain model?</strong></p><p>An object model of the domain that incorporates both behavior and data.</p><p><strong>Why should I care?</strong></p><p>A lot of times – you shouldn’t.</p><p>When you should – complex domain, or a long-lived project where behavior gets added piece by piece.</p></blockquote><p>So even Jimmy Bogard says &#34;use it only if you need it.&#34;</p><p>Many software developers today suffer from &#34;Pattern-Matching disease.&#34;  They think everything in software development is a pattern, and that writing a program is an exercise in stitching patterns together.  Unfortunately, that&#39;s not quite the way it works, nor is slavishly following somebody&#39;s ideas about &#34;best practices&#34; without understanding why.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-where-to-validate-domain-model-rules-that-depend-on-database-content/'>Architecture &#8211; Where to validate domain model rules that depend on database content</a></li><li class="list-group-item"><a href='../how-exactly-should-a-cqrs-command-be-validated-and-transformed-to-a-domain-object/'>How exactly should a CQRS Command be validated and transformed to a domain object</a></li><li class="list-group-item"><a href='../c-should-a-domain-service-have-dependencies/'>C# &#8211; Should a Domain Service have dependencies</a></li><li class="list-group-item"><a href='../c-is-it-normal-for-a-domain-model-not-to-have-an-id/'>C# &#8211; Is it normal for a Domain Model not to have an ID</a></li><li class="list-group-item"><a href='../c-where-should-i-put-validation-logic-when-using-cqrs/'>C# &#8211; Where should I put Validation Logic when using CQRS</a></li><li class="list-group-item"><a href='../is-domain-persistence-model-isolation-usually-this-awkward/'>Is domain/persistence model isolation usually this awkward</a></li><li class="list-group-item"><a href='../c-multiple-apis-v-one-api/'>C# &#8211; Multiple APIs v One API</a></li><li class="list-group-item"><a href='../confused-about-commands-domain-events-and-external-events-in-event-sourcing/'>Confused about commands, domain events and external events in event sourcing</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>