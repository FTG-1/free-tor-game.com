<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Race conditions in JVM languages versus C/C++ &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087512 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087512" class="post-1087512 software type-software status-publish hentry category-software tag-c tag-java tag-multithreading"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Race conditions in JVM languages versus C/C++</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">java</span><span class="mr-2 badge badge-warning">multithreading</span></p><div class="entry-content"><p>I was thinking about thread synchronization issues in compiled languages like C++, versus synchronization issues in languages like Java.</p><p>I&#39;m wondering how a JVM language like Java <em>doesn&#39;t</em> (at least in practice) suffer from coredumps/segfaults/undefined behavior when race conditions occur.</p><p>Consider a C++ program with 2 threads.  Suppose each thread shares a reference to an <code>std::vector&lt;int&gt;</code>.  Each thread continuously loops, and calls <code>std::vector&lt;int&gt;::push_back()</code> &#8211; with <em>no</em> synchronization, no locking whatsoever.  In this scenario, it&#39;s very likely the program will segfault immediately, at least on any mainstream platform/compiler.  The reason is obvious: if one thread triggers a reallocation via a call to <code>push_back</code>, and the other thread ends up writing to the old, free&#39;d memory buffer, your program is likely to core dump immediately.  Plus, the internal vector <code>size</code> and <code>capacity</code> values may get corrupted, leading to all sorts of undefined behavior and crashing.</p><p>But this doesn&#39;t seem to happen in Java.  Given the same scenario, where you have two threads, each with a reference to some unsynchronized data structure (like an <code>ArrayList&lt;Integer&gt;)</code>, and each thread calls <code>ArrayList&lt;Integer&gt;.add()</code>, the worst that ever seems to happen in practice is an exception is thrown, probably an <code>ArrayIndexOutofBounds</code> exception &#8211; and of course, the order of insertion is totally random.</p><p>I realize the JVM is just executing byte code (except when it&#39;s executing JIT&#39;d code), but ultimately that byte code or JIT machine code needs to interact with actual system memory.  I assume that Java automatically checks array indices with each access, and the language semantics and garbage collector ensure that all references are non-dangling &#8211; but with an unsynchronized data structure, when memory could literally be <em>pulled out from under the program&#39;s feet</em> by another thread, at any time, how is the JVM not segfaulting in this scenario unless it&#39;s somehow synchronizing memory reads/writes?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Java implements the <a href="http://en.wikipedia.org/wiki/Java_Memory_Model" rel="nofollow">Java Memory Model</a> which states what should happen in certain situations, and dumping core is not mentioned anywhere in this document. So any Java implementation must take care to implement what the memory model says, and thus throwing core is not permitted. It does sometimes happen, though rarely, but only as a result of bugs in the implementation.</p><p>How a particular implementation achieves adherence to the Memory Model rules is left to the implementor - it is only the final behavior which matters. Others have already mentioned that the Garbage Collector plays an important role here and that in particular as long as you have references to an object in any thread, that object can not be freed from memory.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../why-is-multithreading-often-preferred-for-improving-performance/'>Why is multithreading often preferred for improving performance</a></li><li class="list-group-item"><a href='../testing-multi-threaded-race-conditions/'>Testing multi-threaded race conditions</a></li><li class="list-group-item"><a href='../java-how-to-make-a-universal-construction-more-efficient/'>Java &#8211; How to make a universal construction more efficient</a></li><li class="list-group-item"><a href='../java-the-advantage-of-swingutilities-invokelater-method/'>Java &#8211;  the advantage of &#8216;SwingUtilities.invokeLater()&#8217; method</a></li><li class="list-group-item"><a href='../database-strategies-for-handling-or-avoiding-race-conditions/'>Database &#8211; Strategies for handling or avoiding race conditions</a></li><li class="list-group-item"><a href='../c-why-cant-i-check-whether-a-mutex-is-locked/'>C++ &#8211; Why can&#8217;t I check whether a mutex is locked</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>