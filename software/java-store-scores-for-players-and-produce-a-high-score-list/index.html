<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Store scores for players and produce a high score list &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076350 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076350" class="post-1076350 software type-software status-publish hentry category-software tag-java tag-scalability"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Store scores for players and produce a high score list</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">java</span><span class="mr-2 badge badge-info">scalability</span></p><div class="entry-content"><p>This question is derived from an interview question that I got for a job I was declined.  I have asked for code review for my solution at the dedicated Stack Exchange site (<a href="https://codereview.stackexchange.com/q/51842/43237">https://codereview.stackexchange.com/q/51842/43237</a>). But I hope this question is sufficiently rephrased and asked with a different motivation not to be a duplicate of the other question.</p><p>Consider the following scenario:</p><p>You should store player scores in the server back end of a game. The server is written in Java.</p><p>Every score should be registered, that is, one player may have any number of scores for any number of levels.</p><p>A high score list should be produced with the fifteen top scores for a given level, but only one score per user (to the effect that even if player X has the two highest scores for level Y, only the first position is counted and player Z has the second place).</p><p>No information should be persisted and only Java 1.7+ standard libraries should be used. No third party libraries or frameworks are acceptable.</p><p>With the number of players as the primary factor, what would be the best data structure in terms of scalability and concurrency?</p><p>How would you access the structure to register a single score given a level and a player id?</p><p>How would you access the structure to compile the high score list?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This might be a trick question, since it&#39;s implying that you should be able to represent the scores for every single level for every single player in a single data structure.  While that may be true in general, we&#39;re talking about a game with many <em>many</em> players.  Therefore, trying to hold everything in memory might work initially, but it&#39;s not reasonable to assume it would scale, and since <em>scalability</em> is important here, you should flat out tell your interviewer that a java data structure of any form could not reasonably be thought to hold all the information required.</p><p>What comes to mind is a database for such things, since it is both scalable as well as completely supporting concurrency, both of which are requirements in this case.  If the interviewer wants to go into details in that regard you can, but I think the key point here is that you wouldn&#39;t try to stuff everything into the server&#39;s memory.</p><p>However on that point, you should probably add that it would be also inefficient to have to load all scores after each level in order to see if you&#39;ve got a spot on the top scores list.  Therefore to that effect, I do think keeping the top scores for each level is a reasonable compromise for performance.  In terms of memory, top 10 slots X 100 levels is 1000 slots, perfectly reasonable amount of space and more importantly, it <em>does not grow</em>.</p><p>I would represent this using a <code>Map&lt;int, SortedMap&lt;long, Player&gt;&gt;</code>.  The outer map is used to store a map for each level (no need searching in other levels other than the one I&#39;ve just beaten).  It is also irrelevant what type the Map is, since it just has to find the given level.  The inner <code>SortedMap</code> stores the score as the key and the associated <code>Player</code> class which got that score.  In this case it <em>is</em> relevant that it is a <code>SortedMap</code>, since you may likely want to access them sequentially based on score.</p><p>When a player finishes a level, you can do a quick check in memory to see if the player has made it to the top score list for that given level without making an explicit fetch to the database each time.  If so, in a <em>synchronized</em> action, you should insert the player into the <code>SortedMap</code> for that level (removing the worst score afterwards) and then update the database.  It must be synchronized in order to guarantee that it is also consistent with the database and consistent with the multiple requests that will be done.</p><p>Does that answer your question?</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-high-load-java-server-for-multiplayer/'>Java &#8211; High-Load Java Server for Multiplayer</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>