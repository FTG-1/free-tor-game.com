<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Unit-testing &#8211; How to test local/nested conditional logic branches and variables that cannot be easily manipulated &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079862 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079862" class="post-1079862 software type-software status-publish hentry category-software tag-test-coverage tag-testing tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Unit-testing &#8211; How to test local/nested conditional logic branches and variables that cannot be easily manipulated</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">test-coverage</span><span class="mr-2 badge badge-info">testing</span><span class="mr-2 badge badge-warning">unit testing</span></p><div class="entry-content"><p>It is easy enough to create unit tests for conditional blocks which follow the expected path, but it can sometimes be difficult to contrive data for sources/objects I do not directly control, (databases I do not want to modify or access, environmental variables, etc.) <strong>without modifying the source code to add debugging logic (using only unit tests as functions</strong>. How would one construct unit tests to test the following specified control blocks?</p><pre><code>function(int x)
{
   if(x &gt; 10)
   {
       if(system.day() == &#34;Monday&#34;)
           print &#34;Monday&#34;
       else
           // TEST THIS SPACE (BUT ON A MONDAY :)
           print &#34;Not Monday&#34;
   }
   else
   {
       ....
   }
}
</code></pre><p>In the previous function, I can write a function and pass whatever value I like in for x, but how can I test the nested conditional which relies on a a System.date() call that I cannot (easily) modify?</p><p>Another example using databases which I do not control and cannot access:</p><pre><code>function(int x)
{
    try
    {
        if(x &gt; 10)
        {
             query_result = database.query()
             if(query_results != NULL)
             {
                 print &#34;QUERY NOT NULL&#34;
             }
             else
             {
                 // TEST THIS SPACE 
                 print &#34;QUERY IS NULL&#34;
             }
        }
    }
}
</code></pre><p>Obviously, if I was passing in the query, I could control it, but in this case I cannot. These are simple and contrived examples, please expand on these particular cases and any related scenarios which I may not have considered.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You want to use dependency injection.  I&#39;ll give you an example in C#, since I&#39;m most familiar with it.  Your first example:</p><pre><code>class YourClass
{
    ITimeService _timeService;
    IOutputService _outputService;

    public YourClass(ITimeService timeService, IOutputService outputService)
    {
        _timeService = timeService;
        _outputService = outputService;
    }    

    public function(int x)
    {
       if(x &gt; 10)
       {
           if(_timeService.GetDayOfWeek() == &#34;Monday&#34;)
               _outputService.Print(&#34;Monday&#34;)
           else
               // TEST THIS SPACE (BUT ON A MONDAY :)
               _outputService.Print(&#34;Not Monday&#34;)
       }
       else
       {
           ....
       }
    }
</code></pre><p>where the two services are defined as following</p><pre><code>interface ITimeService
{
    string GetDayOfWeek();
}

interface IOutputService 
{
    void Print(string text);
}
</code></pre><p>and implemented like this:</p><pre><code>class RealTimeService : ITimeService
{
    public string GetDayOfWeek()
    {
        return system.day(); //not C#
    }
}

class RealOutputService : IOutputService
{
    public void Print(string text)
    {
        print text; //not C#
    }
}
</code></pre><p>Now in your program, in your main function (also known as &#39;composition root&#39; using dependency injection terminology), you would instantiate your class as following:</p><pre><code>void main()
{
     YourClass yourClass = new YourClass(new RealTimeService(), new RealOutputService());

     yourClass.function(11);
}
</code></pre><p>However, if you wanted to test your code, instead of injecting RealTimeService and RealOutputService, you would inject FakeTimeService, and FakeOutputService.  For example, this FakeTimeService will let you return any day of the week you want:</p><pre><code>public class FakeTimeService : ITimeService
{
    private string _dayOfWeek;

    public FakeTimeService(string dayOfWeek)
    {
        _dayOfWeek = dayOfWeek;
    }

    public string GetDayOfWeek()
    {
        return _dayOfWeek;
    }
}
</code></pre><p>and this FakeOutputService will store whatever was output to it, so your test can verify it was correct:</p><pre><code>public class FakeOutputService : IOutputService
{
    public string _printedText = &#34;&#34;;

    public Print(string text)
    {
        _printedText += text;
    }
}
</code></pre><p>Finally, inside your test code you&#39;d instantiate and test the class as follows:</p><pre><code>[Test]
void When_It_Is_Monday_Output_Should_Be_Monday()
{
    FakeOutputService fakeOutputService = new FakeOutputService();
    YourClass yourClass = new YourClass(new FakeTimeService(&#34;MONDAY&#34;), fakeOutputService);

    yourClass.function(11);

    Assert.AreEqual(fakeOutputService._printedText, &#34;Monday&#34;);
}

[Test]
void When_It_Is_Tuesday_Output_Should_Be_Not_Monday()
{
    FakeOutputService fakeOutputService = new FakeOutputService();
    YourClass yourClass = new YourClass(new FakeTimeService(&#34;TUESDAY&#34;), fakeOutputService);

    yourClass.function(11);

    Assert.AreEqual(fakeOutputService._printedText, &#34;Not Monday&#34;);
}
</code></pre><p>Now granted, this seems like a lot of typing, which is why most of the time you&#39;d use a mocking framework to do it for you.  For example in C#, I would use <a href="https://github.com/Moq/moq4/wiki/Quickstart" rel="nofollow noreferrer">Moq framework</a>, which takes care of creating fake objects for you.</p><p>Also, if you want another DI in Unit Testing example, check out my answer from a few months ago <a href="https://softwareengineering.stackexchange.com/a/334617/148949">here</a>.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-how-should-i-test-randomness/'>Unit-testing &#8211; How should I test randomness</a></li><li class="list-group-item"><a href='../unit-testing-need-unit-tests-for-testing-repository-methods/'>Unit-testing &#8211;  need unit tests for testing repository methods</a></li><li class="list-group-item"><a href='../why-is-sit-called-sit-when-it-serves-for-system-testing/'>Why is SIT called SIT when it serves for system testing</a></li><li class="list-group-item"><a href='../python-how-to-keep-unit-tests-independent/'>Python &#8211; How to keep unit tests independent</a></li><li class="list-group-item"><a href='../unit-testing-how-to-unit-test-method-that-returns-a-collection-while-avoiding-logic-in-the-test/'>Unit-testing &#8211; How to unit test method that returns a collection while avoiding logic in the test</a></li><li class="list-group-item"><a href='../unit-testing-unit-test-json-parsing-code/'>Unit-testing &#8211; Unit test JSON parsing code</a></li><li class="list-group-item"><a href='../unit-testing-are-integration-tests-meant-to-be-redundant/'>Unit-testing &#8211; Are Integration Tests Meant to be Redundant</a></li><li class="list-group-item"><a href='../unit-testing-are-database-integration-tests-bad/'>Unit-testing &#8211; Are (database) integration tests bad</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>