<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Git &#8211; What to do about large svn history when moving to git &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069651 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069651" class="post-1069651 software type-software status-publish hentry category-software tag-git tag-svn"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Git &#8211; What to do about large svn history when moving to git</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">git</span><span class="mr-2 badge badge-info">svn</span></p><div class="entry-content"><p><em>Edit: unlike some similar questions such as <a href="https://softwareengineering.stackexchange.com/questions/223177">Moving a multi-GB SVN repo to Git</a><br /> or<br /> <a href="https://stackoverflow.com/questions/540535/managing-large-binary-files-with-git">https://stackoverflow.com/questions/540535/managing-large-binary-files-with-git</a><br /> My scenario doesn&#39;t involve several subprojects that can be easily converted into git submoduels, nor a few very large binary files that are well suited for git-annex. It is a single repository where the binaries are the test suite which tightly coupled to the main source code of the same revision, much like if they were compile time assets such as graphics.</em></p><p>I&#39;m investigating switching an old medium/large sized (50 users, 60k revisions, 80Gb history, 2Gb working copy) code repository from svn. As the number of users have grown, there is a lot of churn in trunk, and features are often spread out on multiple commits making code review hard to do. Also without branching there is no way to &#34;gate&#34; bad code out, reviews can only be done <em>after</em> it is committed to trunk. I&#39;m investigating alternatives. I was hoping we could move to git, but I&#39;m having some problems.</p><p>The problem with the current repo as far as git goes is size. There is a lot of old cruft in there, and cleaning it with &#8211;filter-branch when converting to git can cut it down in size by an order of magnitude, to around 5-10GB. This is still too big. The biggest reason for the large repository size is that there are a lot of binary documents being inputs to tests. These files vary between .5mb and 30mb, and there are hundreds. They also have quite a lot of changes. I have looked at submodules, git-annex etc, but having the tests in a submodule feels wrong, as does having annex for many files for which you want full history.</p><p>So the distributed nature of git is really what&#39;s blocking me from adopting it. I don&#39;t really care about distributed, I just want the cheap branching and powerful merging features. Like I assume 99.9% of git users do, we will use a blessed, bare central repository.</p><p>I&#39;m not sure I understand why each user has to have a full local history when using git? If the workflow isn&#39;t decentralized, what is that data doing on the users&#39; disks? I know that in recent versions of git you can use a shallow clone with only recent history. My question is: is it viable to do this as the standard mode of operation for an entire team? Can git be configured to always be shallow so you can have a full history only centrally, but users by default only have 1000 revs of history? The option to that of course would be to just convert 1000 revs to git, and keep the svn repo for archeology. In that scenario however, we&#39;d encounter the same problem again after the next several thousand revisions to the test documents.</p><ul><li>What is a good best practice for using git with large repos containing many binary files that you <em>do</em> want history for? Most best practices and tutorials seem to avoid this case. They solve the problem of few huge binaries, or propose dropping the binaries entirely.</li><li>Is shallow cloning usable as a normal mode of operation or is it a &#34;hack&#34;?</li><li>Could submodules be used for code where you have a tight dependency between the main source revision and the submodule revision (such as in compile time binary dependencies, or a unit test suite)?</li><li>How big is &#34;too big&#34; for a git repository (on premises)? Should we avoid switching if we can get it down to 4GB? 2GB?</li></ul></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Wow, that&#39;s a long question (and a complex problem). I&#39;ll try to have a
go at it.</p><blockquote><p>I&#39;m not sure I understand why each user has to have a full local
 history when using git?</p></blockquote><p>This is a central design decision with git. For the exact reasons you&#39;d
need to ask the author (Linus Torvalds), but as far as I know, the main
reason is speed: Having everything local (on a fast disk or even cached
in RAM) makes operations on history much faster by avoiding network
access.</p><blockquote><p>The biggest reason for the large repository size is that there are a
 lot of binary documents being inputs to tests. These files vary
 between .5mb and 30mb, and there are hundreds. They also have quite a
 lot of changes.</p></blockquote><p>That is the point I would think about first. Having so many constantly
changing binary files in source control seems problematic to me (even
with SVN). Can&#39;t you use a different approach? Ideas:</p><ul><li><p>Unlike source code, a 3 MB binary file is probably not written by
hand. If some tool/process generates it, consider integrating that
into your build, instead of storing the data.</p></li><li><p>If that is not practical, binary files are typically better off in an
artifact repository (such as Artifactory for Maven &amp; co.). Maybe that
is an option for you.</p></li></ul><blockquote><p>I have looked at submodules, git-annex etc, but having
 the tests in a submodule feels wrong, as does having annex for many
 files for which you want full history.</p></blockquote><p>Actually, this looks like git-annex would fit perfectly. git-annex
basically allows you to store file contents outside a git repository
(the repository contains a placeholder instead). You can store the file
contents in a variety of ways (central git repo, shared drive, cloud storage...), and you can control which contents you want to have locally.</p><p>Did you maybe misunderstand how git-annex works? git-annex does store
full history for all the files it manages - it just lets you choose
which file contents you want to have locally.</p><p>Finally, about your questions:</p><blockquote><p>What is a good best practice for using git with large repos containing
 many binary files that you do want history for?</p></blockquote><p>In my experience, the options usually are:</p><ul><li>avoid the need for binaries in the repo (generate them on demand,
store them elsewhere)</li><li>use git-annex (or a similar solution, such as Git LFS)</li><li>live with a big repo (not all git operations are affected by big
files, and if you have a fast computer and drive, it can be quite
workable)</li></ul><blockquote><p>Is shallow cloning usable as a normal mode of operation or is it a
 &#34;hack&#34;?</p></blockquote><p>That might be doable; however, I don&#39;t think this will solve your
problem:</p><ul><li>you&#39;d lose of git&#39;s benefits that come from having full history, such
as quick searching of the history</li><li>merges can become tricky, because AKAIK you must have at least the
history back to the branch point to merge</li><li>users would need to re-clone periodically to keep the size of their
clone small</li><li>it&#39;s just an uncommon way of using git, so you&#39;d likely run into
problems with many tools</li></ul><blockquote><p>How big is &#34;too big&#34; for a git repository (on premises)? Should we
 avoid switching if we can get it down to 4GB? 2GB?</p></blockquote><p>That depends on the structure of the repo (few/many files etc.), on what
you want to do, on how beefy your computers are, and on your patience
:-).</p><p>To give you a quick idea: On my (newish, but low-spec) laptop,
committing a 500 MB file takes 30-60s. Just listing history (git log
etc.) is not affected by big files; things like &#34;git log -S&#34; which must
scan file content are very slow - however, the speed is mainly dominated
by I/O, so it&#39;s not really git&#39;s fault.</p><p>On a 3 GB repo with a handful of revisions, &#34;git log -S&#34; takes about a
minute.</p><p>So I&#39;d say a couple of GB is ok, though not ideal. More than 10-20 GB is
probably pushing it, but it might be doable - you&#39;d have to try it.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../git-how-to-clone-an-svn-repository-that-changed-layouts-with-git-maintaining-full-history/'>Git &#8211; How to clone an svn repository that changed layouts with git maintaining full history</a></li><li class="list-group-item"><a href='../git-moving-a-multi-gb-svn-repo-to-git/'>Git &#8211; Moving a multi-GB SVN repo to Git</a></li><li class="list-group-item"><a href='../git-converting-a-very-large-remote-subversion-repository-to-a-slimmed-down-git-repository/'>Git &#8211; Converting a very large remote subversion repository to a slimmed down Git repository</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>