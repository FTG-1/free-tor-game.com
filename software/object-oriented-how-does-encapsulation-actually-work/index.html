<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; How does encapsulation actually work &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070927 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070927" class="post-1070927 software type-software status-publish hentry category-software tag-class-design tag-encapsulation tag-interfaces tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; How does encapsulation actually work</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">class-design</span><span class="mr-2 badge badge-info">encapsulation</span><span class="mr-2 badge badge-warning">interfaces</span><span class="mr-2 badge badge-primary">object-oriented</span></p><div class="entry-content"><p>I made the following diagram to show a typical separation of concerns as typically taught &#8211;</p><p><a href="../../../i.stack.imgur.com/4w2V3.png" rel="noreferrer"><img src="../../../i.stack.imgur.com/4w2V3.png" alt="enter image description here"/></a></p><p>Here <code>ClassA</code> indirectly uses <code>ClassB</code> via the <code>ISomeInterface</code>, of course ensuring it doesn&#39;t know <code>ClassB</code> exists, only the methods within the interface, which <code>ClassB</code> implements. All the information I can find on this separation of concerns ends here, and nowhere can I find out how <code>classA</code> can actually use the interface without coupling itself to <code>ClassB</code>.</p><p>You can&#39;t of course instantiate nothing but an interface, an interface has no implementation or functionality itself. So how does <code>ClassA</code> use the interface?</p><p>There are only two ways currently that come to mind &#8211;</p><p>1) <code>ClassA</code> does the following:</p><pre><code>ISomeInterface obj = new ClassB();
</code></pre><p>Here we can make sure we&#39;re not calling any members of <code>ClassB</code> directly, only interface members. The problem though is that <code>ClassB</code> has leaked through to <code>ClassA</code> via the instantiation.</p><p>2) <code>ClassA</code> relies upon the interface only, delegating this responsibility of passing the <code>classB</code> object elsewhere, via having the following constructor:</p><pre><code>class ClassA {
        ISomeInterface obj;

        ClassA(ISomeInterface obj) {
            this.obj = obj;
        }
    }
</code></pre><p>This of course completely decouples <code>ClassA</code> from <code>ClassB</code>, however all it does is &#34;pass the buck&#34; elsewhere since <em>someone, somewhere</em>, must instantiate an implementation of ISomeInterface (such as <code>ClassB</code>) and pass it as an object to <code>ClassA</code>.</p><p>All the tutorials and explanations I can find leave out this last crucial detail. Who exactly is responsible for doing this last crucial thing? It has to happen somewhere. And is the thing that does this now coupling itself to both <code>ClassA</code> &amp; <code>ClassB</code>?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><hr/><h2>Coupling</h2><blockquote><p><code>ClassA</code> relies upon the interface only, delegating this responsibility of passing the <code>classB</code> object elsewhere</p></blockquote><p>This is the idea. If you are separating <code>ClassA</code> from <code>ClassB</code> by the use of an interface <code>ISomeInterface</code>...</p><blockquote><p>ensuring (<code>ClassA</code>) doesn&#39;t know <code>ClassB</code></p></blockquote><p>Then you do not want <code>ClassA</code> to instantiate <code>ClassB</code>. Instead it must recieve an object typed by the interface (for example, it can be received in the constructor).</p><p>How does this help encapsulation? You do not get encapsulation for free. However, given that <code>ClassA</code> will only use <code>ClassB</code> via its interface, you should define interfaces which are sufficient for that use. Ideally you would also remove any part of the interface that is not used. Then you will know exactly what <code>ClassB</code> needs to expose. <em>You still need to design a good interface.</em></p><blockquote><p>however all it does is &#34;pass the buck&#34; elsewhere since someone, somewhere, must instantiate an implementation of ISomeInterface (such as <code>ClassB</code>) and pass it as an object to <code>ClassA</code>.</p></blockquote><p>Yes.</p><blockquote><p>It has to happen somewhere. And is the thing that does this now coupling itself to both <code>ClassA</code> &amp; <code>ClassB</code>?</p></blockquote><p>Yes.</p><p>Coupling is unavoidable. You are not trying to make it zero. You are trying to keep it low. Think of it as a cost you have to pay... too much coupling means that maintenance is hard. However, maintenance will never be a zero effort task.</p><hr/><h2>Factories</h2><p><em>I will continue on the assumption that we do dependency injection on the constructor.</em></p><p>You want to have a <strong>single source of truth</strong> of how to get a <code>ClassA</code> object. That is, you do not want to call the constructor passing an object of <code>ClassB</code> every time. You want to encapsulate that and reuse it.</p><p>If in the future you need to replace <code>ClassB</code> by <code>ClassC</code>, then there will be a single place where to change that. If there is some logic that picks <code>ClassB</code> or <code>ClassC</code>, there is a single place where that logic will be. If the instances need to be pooled, you can do that there too.</p><p>Thus, you will have a piece of code that has as responsibility to give you an object of <code>ClassA</code> bound with the correct implementation of <code>ISomeInterface</code>. <em>And that is the only responsibility of that code.</em> We could refer to that piece of code as a factory.</p><p><strong>Note</strong>: Creating a factory for each class should not be a goal. You only need the ones you need.</p><hr/><p>Depending on what you are doing, it could make sense that in some places you want <code>ClassA</code> created with <code>ClassB</code> and in others you want <code>ClassA</code> created with <code>ClassC</code>. In fact, this could depend on external input.</p><p>For another example, let us say we have a video game, where there are some characters. Sometimes they are controlled by the local user, sometimes they are controlled by a player connected through the network, sometimes they are controlled by AI. In this case, we would have three valid implementations, and they could all co-exist.</p><p>For another example, it could be that we have a video game that can save progress to local storage, or to a cloud service that allows you to continue playing on a different machine. That is, we have two implementations to save progress, and which one we use depends on user input.</p><hr/><h2>Where to put factories?</h2><p>Yes, you can apply complex patterns to handle your factories. In fact, I&#39;m saying the factory is <em>a piece of code</em> to keep it vague. However, let me point this out: If you are making a library... unless your goal is to make a library dedicated to factory patterns, let the developer of the application decide what factory patterns to use, by not providing any.</p><p>Exactly where you want to put your factory code will depend on what kind of application you have. For simple console and desktop projects, you can do all the dependency injecting in <code>main</code>. If you are doing something more complex (a network server, for example), you might want some factory solution. Usually, you want to use it after deciding what code will handle input, and after the dependency injection is done, the code does not need to know what factory solution you used.</p><p>By factory solution I mean service locators, IoC containers… factory methods, abstract factories… all that stuff. Whatever patterns you pick. <em>If you pick a library that does it… guess what? It is a dependency! Muahahaha.</em> So, yeah, after the dependency injection is done, you do not want any code to be aware of it.</p><hr/><h2>Architecture</h2><p>Abstracting things away is good™. In fact, it happens naturally by the single responsibility principle. <em>By the way, I think you mean “single responsibility principle” instead of separation of concerns.</em></p><p>I believe that when they tell you that a layer can only interact with lower layers via an interface, they not abstract interface types, but an interface as in API.</p><hr/><p>However, we could be mixing all the layer talk with the concept of abstracting external systems…</p><p>The software engineer needs to make an executive decision about the scope of the project, which decides what is part of the system and what is external.</p><p>Draw a line. An architectural line. On the left of the line you code that deals with external systems. Which includes writing adapters which abstract the external system. That code must be interchangeable, allowing you to easily swap it in the future if needs be.</p><p><strong>Note</strong>: I am not suggesting to wrap every dependency in adapters. Only external systems. So, no, I&#39;m saying that you need to make an adapter for every library you use, nor the ridiculous idea of isolating from the runtime. While it is true that those would have their own reasons to change, you follow the single responsibility principle and that is enough. This is about external systems as in IO. <em>Also, I&#39;m saying that you decide what is external.</em></p><p>Therefore, you do not want the code on the right to depend on code on the left (which could have to change because of external reasons). However, the code on the left can depend on code on the right (which is under your control).</p><p>Thus, you will have the adapters (which are on the left) implement an interface (that exists on the right), and the rest of the code on the right of the architectural line will depend on the interface only…</p><p>However, somebody has to instantiate the adapter. Where does that code go? It goes to the left of the architectural line. Because, remember, the code to the right cannot depend on the code on the left. Thus the code that instantiates the adapter (which is to the left), must be to the left.</p><p>Now, surprise: the operating system is an external system. <code>main</code> is a method that handles an event from the operating system (namely the start of the program). And since the operating system is external, <code>main</code> goes on the left of the line, and thus it can instantiate the adapters, and it can call code on the right. Well, actually it would call the factory.</p><p>Similarly, if you have a form and event handlers the event handlers are on the left. Or if you have web server, the router is on the left. You want that code (<code>main</code>, event handlers, router) to call the factory, inject the dependencies, and let the execution flow to the right.</p><p>On the flip side. Your code on the right might want to call the external systems. Remember that this is possible via the interfaces. I want to point out that there is another way to do this. Since the flow of execution starts on the left, it is often possible to let the right return, then the left can execute more code.</p><hr/><p>What I’m describing here? The idea of the architectural line comes from Clean Code.</p><p>I am taking inspiration from the idea of “functional core, imperative shell”: pure functions can only call pure functions. However impure functions can call pure and impure functions (pure to the right, impure to the left).</p><p>Bonus chatter: You might be aware that <code>async</code> code has a tendency to propagate. Because <code>async</code> methods can call synchronous methods and <code>await</code> other <code>async</code> methods. However synchronous cannot await <code>async</code> methods. However, you can use the architectural line to keep it on the left (synchronous to the right, <code>async</code> to the left).</p><hr/><p>Why do I say left and right instead of talking of higher and lower layers? Because I would treat both the database and the user interface as external systems. However, classic tier architecture will say that the database is a lower layer and the UI is a higher layer.</p><p>Also, the communication between internal layers does not have to be held to the same standards. Providing a concrete facade or allowing a “higher” layer to instantiate types of the lower one is acceptable inside the system. <em>Although, sometimes you want to draw more lines.</em></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-when-to-use-interfaces-unit-testing-ioc/'>Object-oriented &#8211; When to use interfaces (unit testing, IoC?)</a></li><li class="list-group-item"><a href='../c-how-to-design-an-idisposable-that-unconditionally-needs-to-be-disposed/'>C# &#8211; How to design an IDisposable that unconditionally needs to be disposed</a></li><li class="list-group-item"><a href='../design-class-design-dilemma-encapsulation-vs-single-responsibility-separation-of-concerns/'>Design &#8211; Class design dilemma: Encapsulation vs Single Responsibility/Separation of Concerns</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>