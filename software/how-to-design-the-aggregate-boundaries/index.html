<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How to design the aggregate boundaries &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075759 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075759" class="post-1075759 software type-software status-publish hentry category-software tag-aggregate tag-domain-driven-design tag-entity"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How to design the aggregate boundaries</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">aggregate</span><span class="mr-2 badge badge-info">domain-driven-design</span><span class="mr-2 badge badge-warning">entity</span></p><div class="entry-content"><p>I would like to write an application something like ecommerce.</p><p>And you know that in similar applications products could have different properties and features. To simulate such an opportunity I&#39;ve created the following domain model entities:</p><p><strong>Category</strong> &#8211; this is something like &#34;electronics &gt; сomputers&#34; i.e types of products. Сategories contain a list of properties (List&lt; Property &gt;).</p><p><strong>Property</strong> &#8211; independent entity that contains the name, units of measure, data type. For example &#34;name&#34;, &#34;weight&#34;, &#34;screen size&#34;. The same property can have different products.</p><p><strong>Product</strong> &#8211;  just contains name and list of values relating to properties. Value is an object that contains just the value field and the field id of the property.</p><p>I originally decided to make the Category like single aggregate in this scheme because for example when I add new product I need to know all data related with current category including properties related to the current category (<em>category.AddNewProduct(product)</em>).<br /> But what should I do when I just need to add a new property that does not belong to any category. For example, I can not do this <em>category.AddNewProperty(property)</em> because it clearly says that we add the property to specific category.</p><p>Ok the next step I decided separate Property into a separate aggregate but then it will be a list with simple entities.</p><p>Of course I can create something like PropertyAggregate to keep inside list of properties and buisness rules but when I add a product, I need to have inside the category the entire list of properties belonging to this category to check the invariants. But I&#39;m also aware that keeping the links inside the aggregate on other aggregates is a bad practice.</p><p>What are the options to design this business case?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>In the DDD perspective, <code>Category</code>, <code>Product</code> and <code>Property</code> are entities: they all correspond to objects that have their own identity.</p><h3>Option 1:  your original design</h3><p>You made <code>Category</code> the root of a single aggregate.  On one side, this makes sense, because the aggregate shall ensure consistency when its objects are modified,  and <code>Product</code> must have the <code>Properties</code> of its <code>Category</code>:</p><p><a href="../../../i.stack.imgur.com/rpiZx.jpg" rel="noreferrer"><img src="../../../i.stack.imgur.com/rpiZx.jpg" alt="enter image description here"/></a></p><p>But on the other side, the single aggregate means that all its objects are related to a root that owns them, and all external references must be made via this aggregate root.  This implies that:</p><ul><li>one specific <code>Product</code> belongs to one and only one <code>Category</code>.  If the <code>Category</code> is deleted, so are its <code>Products</code>.</li><li>a specific <code>Property</code> belongs to one and only one <code>Category</code>.  Otherwise said, if &#34;TV screens&#34; and &#34;Computer monitors&#34; would be two categories, &#34;TV screens:size&#34; and &#34;Computer monitors:size&#34; would be two different properties.</li></ul><p>The second point doesn&#39;t correspond to your narrative: &#34;<em>But what should I do when I just need to add a new <code>Property</code> that does not belong to any category</em>&#34;.  And it&#39;s not clear if the same <code>Properties</code> can be used in different <code>Categories</code>.</p><h3>Option 2: Property outside the aggregate</h3><p>If a <code>Property</code> exists independently of the <code>Categories</code>, it must be outside the aggregate.  And the same if you want to share <code>Properties</code> between <code>Categories</code> (which makes sense for height, width, sizes, etc...). This seems definitively be the case.</p><p>The consequence is on the link between <code>Property</code> and things that belong to the aggregate: while you can navigate from the inner of the aggregate to <code>Property</code>,  you are no longer allowed to go directly from a <code>Property</code> to the corresponding values. This <a href="https://www.uml-diagrams.org/association.html#navigability" rel="noreferrer">navigability</a> restriction can be shown in an UML diagram:</p><p><a href="../../../i.stack.imgur.com/kV3bp.jpg" rel="noreferrer"><img src="../../../i.stack.imgur.com/kV3bp.jpg" alt="enter image description here"/></a></p><p>Note that this design doesn&#39;t prevent you to have a <code>List&lt;Property&gt;</code> in <code>Category</code>, with a reference semantic (e.g. java):  each reference in the list refers to a sharable <code>Property</code> object in a repository.</p><p>The only problem with this design is that you could change a <code>Property</code> or delete it:  as it&#39;s outside of the aggregate, the aggregate can&#39;t take care of the consistency of its invariants.  But this is not a problem.  It is the consequence of the DDD principles and the complexity of real world.  Here a quote from Eric Evans in his seminal book &#34;<em>Domain-Driven Design: Tackling Complexity in the Heart of Software</em>&#34;:</p><blockquote><p>Any rule that <strong>spans AGGREGATES</strong> will not be expected to be up-to-date
 at all times. Through event processing, batch processing, or other
 update mechanisms, other dependencies can be resolved within some
 specified time. But the invariants applied within an AGGREGATE will be
 enforced with the completion of each transaction.</p></blockquote><p>So yes, if you change a <code>Property</code>, you&#39;ll have to make sure that a service checks the Categories referring to it are updated as needed.</p><h3>Option 3: Category, Property and Product in different aggregates</h3><p>I just wonder if the assumption that a <code>Product</code> belongs to a single <code>Category</code> is founded:</p><ul><li>I frequently see online shops proposing one <code>Product</code> under several <code>Categories</code>.  For example, you&#39;d find  &#34;Laptop Brand X Model Y&#34; under the category &#34;Laptops&#34; and the category &#34;Computers&#34;, and a &#34;multifunction printer Z&#34; under category &#34;printer&#34;, &#34;scanner&#34; and &#34;fax&#34;.</li><li>Isn&#39;t it possible that someone creates a <code>Product</code> first, and only later assigns it to Categories and fill the values ?</li><li>If you want to split a category,  would you really delete its Products and then recreate them under the new categories ?</li></ul><p>It won&#39;t simplify the aggregates, and you would have even more rules that span aggregates.  But your system would be much more future proof.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../how-to-query-a-child-object-within-an-aggregate-root-on-demand/'>How to query a child object within an aggregate root on demand</a></li><li class="list-group-item"><a href='../architecture-balance-between-aggregate-boundaries-and-domain-consistency-in-ddd/'>Architecture &#8211; Balance between aggregate boundaries and domain consistency in DDD</a></li><li class="list-group-item"><a href='../c-domain-driven-design-navigation-properties-and-aggregate/'>C# &#8211; Domain Driven Design // Navigation Properties and Aggregate</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>