<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Ny practical use for the empty type in Common Lisp &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1086686 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1086686" class="post-1086686 software type-software status-publish hentry category-software tag-common-lisp tag-haskell tag-type-systems"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Ny practical use for the empty type in Common Lisp</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">common-lisp</span><span class="mr-2 badge badge-info">haskell</span><span class="mr-2 badge badge-warning">type-systems</span></p><div class="entry-content"><p>The Common Lisp spec states that <code>nil</code> is the name of the <em>empty type</em>, but I&#39;ve never found any situation in Common Lisp where I felt like the <em>empty type</em> was useful/necessary. Is it there just for completeness sake (and removing it wouldn&#39;t cause any harm to anyone)? Or is there really some practical use for the <em>empty type</em> in Common Lisp? If yes, then I would prefer an answer with code example.</p><p>For example, in Haskell the <em>empty type</em> can be used when binding foreign data structures, to make sure that no one tries to create values of that type without using the data structure&#39;s foreign interface (although in this case, the type is not really empty).</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h2>Type declarations and static analysis</h2><p>Since no value typed as <code>NIL</code> can exist, the use of the <code>NIL</code> type is mostly relevant for static analysis. <code>T</code> and <code>nil</code> respectively represent the top (⊤) and bottom (⊥) types and might be used when inferring the type of expressions.
Consider the following example:</p><pre class="lang-lisp prettyprint-override"><code>(defun the-thing () (length (1+ (read))))
</code></pre><ul><li>The type of <code>(read)</code> is <code>T</code>, because if reading succeeds, the returned value can be anything.</li><li>The type of <code>(1+ (read))</code> is necessarily <code>NUMBER</code>, because the returned value exists only if no error is signaled. And if this is the case, we know from the type analysis of <code>+</code> that the result is a number.</li><li>The type of <code>(length (1+ (read)))</code> is <code>NIL</code>, because <code>length</code> returns a value only for <em>sequences</em>. Giving a number is guaranteed to signal an error, and thus the possible values returned by the function is represented by the empty type (an empty set of values).</li></ul><p>This kind of analysis is not only theoretical, it actually happens with SBCL:</p><pre class="lang-lisp prettyprint-override"><code>* (defun the-thing () (length (1+ (read))))
; in: DEFUN THE-THING
;     (LENGTH (1+ (READ)))
; 
; caught WARNING:
;   Derived type of (+ (READ) 1) is
;     (VALUES NUMBER &amp;OPTIONAL),
;   conflicting with its asserted type
;     SEQUENCE.
;   See also:
;     The SBCL Manual, Node &#34;Handling of Types&#34;
; 
; compilation unit finished
;   caught 1 WARNING condition

THE-THING
</code></pre><p>Moreover, here we can see the derived type of <code>THE-THING</code>:</p><pre class="lang-lisp prettyprint-override"><code>* (describe #&#39;the-thing)

#&lt;FUNCTION THE-THING&gt;
  [compiled function]

Lambda-list: ()
Derived type: (FUNCTION NIL NIL)
Source form:
  (SB-INT:NAMED-LAMBDA THE-THING
      NIL
    (BLOCK THE-THING (LENGTH (1+ (READ)))))
</code></pre><p>The <code>NIL</code> type means: this functions will not return successfully.
For example, in SBCL, the <code>error</code> function has the following declared type:</p><pre class="lang-lisp prettyprint-override"><code>(FUNCTION (T &amp;REST T) NIL)
</code></pre><p>... because it never returns a value but signals a condition.
You can use <code>NIL</code> in function type declarations explicitely if you want.
By the way, please notice that SBCL only gives a <em>warning</em> and still compiles your code: you can call the function and it will trigger the dynamic checks that will lead you to the debugger, etc.</p><p><code>NIL</code> implies the <em>absence of &#34;normal&#34; termination</em>. If the body of your function is <code>(loop)</code>, the return type is also <code>NIL</code>. But sometimes you can return normally but you do not have any value to return (like <code>void</code> in C). 
That is why <code>(values &amp;optional)</code> is more appropriate as a type declaration when you return <em>no value successfully</em>. This is done by using the <code>(values)</code> expression in your code. The <code>&amp;optional</code> keyword in the type declaration is necessary because the type <code>(values)</code> would allow you to return more values (see comments).</p><h2>Is <code>nil</code> necessary?</h2><p>Some implementations might not care about <code>nil</code>. Since you wonder if we could remove it without causing any harm, maybe trying to remove the <code>nil</code> type from an implementation could be an nice experiment, to see how much does effectively break in practice.</p><h2>Foreign types</h2><p>Regarding foreign types, I doubt it can be used like in Haskell, while conforming to the spec, because:</p><ol><li>the <a href="http://clhs.lisp.se/Body/d_type.htm" rel="nofollow">behavior is undefined</a> if a value does not match the declared type, and</li><li>there is already a type for foreing values in CL (but maybe I did not understand exactly what you mean with foreign types and Haskell).</li></ol><p>This is purely speculative, but maybe a variable (or an array) of type <code>nil</code> allocated by a CL runtime could be handled to some foreign code (using implementation-specific means). This is not how it is done in <a href="https://github.com/cffi/cffi" rel="nofollow">CFFI</a>.</p><h2>The case of <code>nil</code> arrays</h2><p>I don&#39;t know why (maybe just because there is no check) some implementations like SBCL allow arrays of elements of type <code>nil</code>, defined as follows:</p><pre class="lang-lisp prettyprint-override"><code>(type-of (make-array 10 :element-type nil) )
=&gt; (SIMPLE-ARRAY NIL (10))
</code></pre><p>However, one can&#39;t access an element of such an array:</p><pre class="lang-lisp prettyprint-override"><code>(aref (make-array 10 :element-type nil) 5)
</code></pre><p>The following type error is caught: <em>&#34;The value 5 is not of type (MOD 4611686018427387901).&#34;</em> Moreover, the backtrace contains the following line, where the actual content of the array is seen containing random values:</p><pre class="lang-lisp prettyprint-override"><code>(AREF &#34;¿[¦^D^P^@^@^@×[&#34; 5)
</code></pre><p>Accessing uninitialized arrays has <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_mk_ar.htm" rel="nofollow">undefined consequences</a> (see comments).
Consequences are undefined even if the actual data is only referenced and not effectively used for its content, as in:</p><pre class="lang-lisp prettyprint-override"><code>(LENGTH (LIST (AREF (MAKE-ARRAY 1) 0)))
</code></pre><p>The example is taken from the <a href="http://www.lispworks.com/documentation/HyperSpec/Issues/iss355_w.htm" rel="nofollow">&#34;Issue UNINITIALIZED-ELEMENTS Writeup&#34;</a>.</p><p>I see no reason to allow the creation of arrays of type NIL in the first place, apart maybe from allocating (useless?) memory. As said above, maybe there is an implementation-specific, totally not portable way for some lisp to use such arrays, and pass them to foreign functions, but I doubt it.</p><p>Finally, in <a href="http://www.maclisp.info/pitmanual/array.html" rel="nofollow">Maclisp&#39;s manual</a> (note that Maclisp predates Common Lisp), it is said that NIL arrays can be used as arrays of type T but make the garbage collector behave as if no objects were referenced. 
However, here is what the manual says about them:</p><blockquote><p>Type NIL arrays are discouraged even for those who think they know what they are doing.</p></blockquote></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-type-casting-variables-in-php-what-is-the-practical-reason-for-doing-this/'>Php &#8211; Type casting variables in PHP, what is the practical reason for doing this</a></li><li class="list-group-item"><a href='../ny-particular-reason-for-the-use-of-lists-over-queues-in-functional-programming-languages/'>Ny particular reason for the use of lists over queues in functional programming languages</a></li><li class="list-group-item"><a href='../whats-the-tradeoff-for-type-inference/'>What&#8217;s the tradeoff for type inference</a></li><li class="list-group-item"><a href='../java-using-a-strong-type-system-in-the-real-world-say-for-large-scale-web-apps/'>Java &#8211; Using a &#8220;strong&#8221; type system in the real world, say, for large-scale web-apps</a></li><li class="list-group-item"><a href='../practical-use-for-dependent-types/'>Practical use for dependent types</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>