<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; What kind of members should be used in a GetHashCode() implementation &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082984 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082984" class="post-1082984 software type-software status-publish hentry category-software tag-c tag-hashing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; What kind of members should be used in a GetHashCode() implementation</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">hashing</span></p><div class="entry-content"><p>We&#39;re building some Roslyn analyzers concerning <code>GetHashCode()</code>, including an analyzer that implements it for you in a given class.</p><p>While researching the subject we&#39;ve found that there are many considerations to take into account, mainly on what kind of members should be avoided in a <code>GetHashCode()</code> implementation.</p><p>The main kind of member to avoid are mutable members (to avoid hashcode changes when used in a collection).</p><blockquote><p>In general, for mutable reference types, you should override <code>GetHashCode</code> only if:</p><ul><li>You can compute the hash code from fields that are not mutable</li></ul></blockquote><p><a href="https://msdn.microsoft.com/en-us/library/system.object.gethashcode(v=vs.110).aspx" rel="nofollow">[Source]</a></p><p>Now the question that remains: what kind of members are we talking about then? The member has to be immutable but then again it should also be (ideally) different for each instance otherwise you&#39;ll just end up with the same hashcode for every object.</p><p>This leads me to conclude that the only acceptable members for a <code>GetHashCode()</code> implementation are <em>readonly immutable structs</em> and <em>readonly immutable classes</em> Note: not <code>const</code>. Likewise no <code>static</code> fields since they would be the same across instances anyway.</p><p>The way this would be implemented in reality would be by using a</p><ul><li>Field: <code>readonly T myField</code></li><li>Property: <code>T myProp { get; }</code></li></ul><p>Since it would be very not feasible to detect if a class is immutable, we should probably eliminate that entirely aside from <code>string</code> perhaps.</p><p>This leaves the list of applicable members for a <code>GetHashCode()</code> implementation to:</p><ul><li>Readonly fields</li><li>And getter-only properties</li><li>That are immutable structs</li><li>And aren&#39;t <code>static</code></li><li>And aren&#39;t interfaces</li><li>+ <code>string</code></li></ul><p>Does that seem correct or have I made a mistake in the thought process somewhere? It seems like we&#39;re suddenly left with a lot less fields than people typically use. I realize that there is a pragmatic aspect to this that just says &#34;add all the fields and let the dev figure it out&#34; but I try to avoid introducing hidden bugs in the analyzers.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Readonly fields</p></blockquote><p>This goes without saying.</p><blockquote><p>And getter-only properties</p></blockquote><p>Yes, as long as by &#34;getter-only properties&#34; we strictly mean <code>type prop { get; }</code></p><blockquote><p>That are immutable structs</p></blockquote><p>Yes, in the sense that in C# primitives are also implemented as immutable structs.</p><blockquote><p>And aren&#39;t static</p></blockquote><p>This goes without saying.</p><blockquote><p>And aren&#39;t interfaces</p></blockquote><p>This goes without saying too, but do keep in mind that you can always involve the identity hashcode of an interface if you need to.</p><blockquote><ul><li>string</li></ul></blockquote><p>Again, goes without saying.</p><p>The fact that you are wondering so hard about how to implement <code>GetHashCode()</code> may be indicative of confusion about when to implement <code>GetHashCode()</code> and when not to.  There are two types of objects:</p><ul><li>Objects with value semantics</li><li>Objects with reference (&#34;object&#34;) semantics.</li></ul><p>Objects with value semantics are used for storing values.  They should always be immutable and should always implement <code>GetHashCode()</code> taking into consideration every single one of their members.</p><p>Objects with reference semantics contain logic, and usually some state.  They will usually <em>not</em> be immutable, (though it is possible in rare circumstances,) but one thing that is certain about them is that they will never be used as values, therefore they never need to override the default <code>GetHashCode()</code> implementation of <code>object</code>, which returns the identity hashcode of the object.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-why-and-when-should-i-make-a-class-static-what-is-the-purpose-of-static-keyword-on-classes/'>C# &#8211; Why and when should I make a class &#8216;static&#8217;? What is the purpose of &#8216;static&#8217; keyword on classes</a></li><li class="list-group-item"><a href='../c-design-many-properties-complex-constructor-and-equality/'>C# Design, many properties, complex constructor and equality</a></li><li class="list-group-item"><a href='../c-di-and-hypothetical-readonly-setters-in-c/'>C# &#8211; DI and hypothetical readonly setters in C#</a></li><li class="list-group-item"><a href='../c-is-it-a-good-idea-to-use-strings-in-a-struct-as-values-to-static-properties/'>C# &#8211; Is it a good idea to use strings in a struct as values to static properties</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>