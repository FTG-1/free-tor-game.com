<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; Use cases and usage patterns of futures vs callbacks &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075395 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075395" class="post-1075395 software type-software status-publish hentry category-software tag-async tag-asynchronous-programming tag-c tag-javascript"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; Use cases and usage patterns of futures vs callbacks</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">async</span><span class="mr-2 badge badge-info">asynchronous-programming</span><span class="mr-2 badge badge-warning">c</span><span class="mr-2 badge badge-primary">javascript</span></p><div class="entry-content"><p>I&#39;ve become interested in futures lately, mostly due to their inclusion in standard C++ &#8211; but I see there is an active debate over futures vs. callbacks in many programming areas, such as Node.js.</p><p>I&#39;d like to ask is if there are any well-known patterns/use-cases where futures provide a clear advantage (in terms of readability and ease of implementation) to callbacks?</p><p>We all know the main downsides associated with callbacks: indirection in terms of reading the code, and the potentially deeply nested and confusing lambdas in languages like Javascript.</p><p>The advantage of using futures is they eliminate the code indirection and let you write code in a &#34;synchronous&#34; style, but provide you with a handler that lets you check on the status of some background operation.  In that sense, I don&#39;t think it would be too subjective/controversial to claim that futures are a better syntactic fit with how the human mind tends to think (do this, do that, do this while waiting for that, etc).</p><p>However, when I actually <em>use</em> futures in practice, I often run into the following issue:</p><p>A typical use case for futures is where you manage many async operations via an array of future objects, like a <code>vector&lt;future&gt; futures</code> (using C++ syntax).  I think a key insight is that futures require that you <em>actively</em> check each async operation to see if it&#39;s done, whereas with callbacks you <em>passively</em> wait for each event to complete.  But since, in the general case, you have no way of knowing which event will complete first, you may lose out on some parallelism if you&#39;re iterating over an array of futures and <code>future[10]</code> finishes 5 seconds before <code>future[0]</code>, but you&#39;re sitting there waiting for <code>future[0]</code> to complete.</p><p>We can mitigate this with a &#34;wait_for&#34; type of operation &#8211; instead of waiting on each future, we can wait for a certain short interval, and then proceed to continue iterating.  But this is basically like busy waiting, consuming extra CPU resources.  With callbacks, you wouldn&#39;t need to do any of this because callback code is invoked passively by some background event reactor.  Basically, by iterating over an array of futures in application code, you&#39;re sort of &#34;re-implementing&#34; a poll event reactor at a higher level.</p><p>One straightforward use case for futures I&#39;ve found is any situation where you have one or more async calls, and you can interleave some CPU cycles between calls.  Suppose you have to call an HTTP web service twice, but the result of the first call gives you the opportunity to start processing immediately without the need to wait for the second call to complete.  Futures make this easy, because you can just say:</p><pre><code>future result1 = some_remote_call();
object data = result1.get(); // wait for result1 to complete

future result2 = another_remote_call();

// ... do some processing here while we&#39;re still waiting on result2 ... //
</code></pre><p>So that&#39;s definitely a nice use case, but the more common case of waiting for N events to occur seems better suited for callbacks, despite the code-indirection we suffer using callbacks.</p><p>So, what are some well-known usage patterns/use-cases where futures provide a clear advantage (in terms of code readability and ease of implementation) over callbacks?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>What you need to understand is that the C++ standard library quite possibly has the worst implementation of futures conceivable by man.  What C++ does is little more than a weak wrapper around a semaphore.  Most future implementations encourage use of callback lambdas extensively, to chain several futures together asynchronously using <code>then</code>, and allow you to easily create a single future that is based on a collection of other futures.  They have none of the issues you are raising here.</p><p>Look at <a href="http://documentup.com/kriskowal/q/" rel="nofollow">Q</a> for one of the best implementations, to see how futures were really designed to be used.  If you search around, there are people bringing those ideas into C++.  It&#39;s not terribly difficult to implement yourself.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../design-whats-the-best-practice-for-async-apis-that-return-futures-on-scala/'>Design &#8211; What&#8217;s the best practice for async APIs that return futures on Scala</a></li><li class="list-group-item"><a href='../javascript-what-determines-which-javascript-functions-are-blocking-vs-non-blocking/'>Javascript &#8211; What determines which Javascript functions are blocking vs non-blocking</a></li><li class="list-group-item"><a href='../is-there-really-a-fundamental-difference-between-callbacks-and-promises/'>Is there really a fundamental difference between callbacks and Promises</a></li><li class="list-group-item"><a href='../why-dont-programming-languages-automatically-manage-the-synchronous-asynchronous-problem/'>Why don&#8217;t programming languages automatically manage the synchronous/asynchronous problem</a></li><li class="list-group-item"><a href='../c-is-it-good-approach-to-await-async-tasks-in-object-destructor/'>C++ &#8211; Is it good approach to await async tasks in object destructor</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>