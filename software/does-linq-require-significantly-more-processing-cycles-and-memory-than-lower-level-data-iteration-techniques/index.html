<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Does LINQ require significantly more processing cycles and memory than lower-level data iteration techniques &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075252 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075252" class="post-1075252 software type-software status-publish hentry category-software tag-algorithms tag-linq tag-net tag-performance"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Does LINQ require significantly more processing cycles and memory than lower-level data iteration techniques</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">linq</span><span class="mr-2 badge badge-warning">net</span><span class="mr-2 badge badge-primary">performance</span></p><div class="entry-content"><h2>Background</h2><p>I am recently in the process of enduring grueling tech interviews for positions that use the .NET stack, <a href="https://softwareengineering.stackexchange.com/questions/144188/is-it-just-me-or-is-this-a-baffling-tech-interview-question">some of which include silly questions like this one</a>, and some questions that are more valid.  I recently came across an issue that may be valid but I want to check with the community here to be sure.</p><p>When asked by an interviewer how I would count the frequency of words in a text document and rank the results, I answered that I would</p><ol><li>Use a stream object put the text file in memory as a string.</li><li>Split the string into an array on spaces while ignoring punctuation.</li><li>Use LINQ against the array to <code>.GroupBy()</code> and <code>.Count()</code>, then <code>OrderBy()</code> said count.</li></ol><p>I got this answer wrong for two reasons:</p><ol><li>Streaming an entire text file into memory could be disasterous.  What if it was an entire encyclopedia?  Instead I should stream one block at a time and begin building a hash table.</li><li>LINQ is too expensive and requires too many processing cycles.  I should have built a hash table instead and, for each iteration, only added a word to the hash table if it didn&#39;t otherwise exist and then increment it&#39;s count.</li></ol><p>The first reason seems, well, reasonable.  But the second gives me more pause.  I thought that one of the selling points of LINQ is that it simply abstracts away lower-level operations like hash tables but that, under the veil, it is still the same implementation.</p><h2>Question</h2><p>Aside from a few additional processing cycles to call any abstracted methods, does LINQ require <em>significantly</em> more processing cycles to accomplish a given data iteration task than a lower-level task (such as building a hash table) would?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;d say the main weakness of this answer is less its use of Linq and more the specific operators chosen. <code>GroupBy</code> takes each element and projects it to a key and a value which go into a lookup. In other words, every word will add something to the lookup.</p><p>The naive implementation <code>.GroupBy(e =&gt; e)</code> will store a copy of every word in the source material, making the final lookup nearly as large as the original source material. Even if we project out the value with <code>.GroupBy(e =&gt; e, e =&gt; null)</code> we&#39;re creating a large lookup of small values.</p><p>What we would want is an operator that preserves only the needed information, which is one copy of each word and the count of that word so far. For that, we can use <code>Aggregate</code>:</p><pre><code>words.Aggregate(new Dictionary&lt;string, int&gt;(), (counts, word) =&gt; 
{
    int currentCount;
    counts.TryGetValue(word, currentCount);
    counts[word] = currentCount + 1;
    return counts;
} 
</code></pre><p>From here, there are several ways we could attempt to make this faster:</p><ol><li>Instead of creating many strings while splitting, we could pass around structs that reference the original string and the segment that contains the word, and only copy the segment out when it turns out to be a unique key</li><li>Use Parallel Linq to <a href="http://msdn.microsoft.com/en-us/library/dd460697.aspx">aggregate across several cores then combine the results</a>. This is trivial compared to the leg work required for doing this by hand.</li></ol></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../is-the-entity-framework-appropriate-when-all-you-do-is-insert-records-in-bulk/'>Is the Entity Framework appropriate when all you do is insert records in bulk</a></li><li class="list-group-item"><a href='../javascript-why-are-native-es6-promises-slower-and-more-memory-intensive-than-bluebird/'>Javascript &#8211; Why are native ES6 promises slower and more memory-intensive than bluebird</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>