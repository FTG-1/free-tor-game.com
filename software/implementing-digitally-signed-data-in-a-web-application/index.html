<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Implementing Digitally signed data in a Web Application &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1077314 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1077314" class="post-1077314 software type-software status-publish hentry category-software tag-browser tag-certificate tag-security tag-web-applications"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Implementing Digitally signed data in a Web Application</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">browser</span><span class="mr-2 badge badge-info">certificate</span><span class="mr-2 badge badge-warning">Security</span><span class="mr-2 badge badge-primary">web-applications</span></p><div class="entry-content"><p>I understand PKI well from a conceptual point of view &#8211; i.e. private keys/public keys &#8211; the math behind them, use of hash &amp; encryption to sign a certificate, Digital Signing of Transactions or Documents etc. I have also worked on projects where openssl C libraries were used with certs for securing communication and authentication. I am also extremely familiar with openssl command line tools.</p><p>However, I have very little experience with webbased PKI projects &amp; hence I am trying to design and code a personal project for this.</p><h2>The requirements</h2><p>(This is a learning project &#8211; This is never going to be used in a bank)</p><p>This is the website for a bank. All Internet Banking users are allowed use any signing certificate issued by a few known CAs (verisign, Thawte, entrust etc). The Bank is not responsible for procuring certificates for the user. The user logs into the bank site with his userid/password etc. He has access to most parts of his account. However, when the user wants to do a transaction &#8211; like transferring money to different account &#8211; the bank wants him to sign the transaction with a certificate.</p><h2>The design</h2><p>When user choses &#34;Transfer&#34; option &#8211; the website throws up a form where there are 3 entries &#8211; &#34;Transfer To&#34; account, the Amount of the transaction and a way for chosing a cert for doing the digital signing &amp; do the signing.</p><p>I concatenate the &#34;Transfer To&#34; Account no &amp; the amount plus a nonce and this is the string which will be signed and sent to the backend.</p><p>I have searched a lot but haven&#39;t been able to figure out how to achieve<br /> &#8211; letting the user chose a cert<br /> &#8211; do the signing.</p><p>I know how the user can add certs to his personal truststore on Windows. But how would I ask the browser to show him certs to chose from?</p><p>How does the signing get done &#8211; I really don&#39;t want to write crypto code in Javascript!!! So is the alternative having an ActiveX or a Java Applet? Is there a better way? Is there a way to ask the browser to use the cert and do the signing?</p><p>I have not decided on a platform/framework/language for now &#8211; so this question is rather generic.</p><p>I have searched a lot for this kind of info without luck &#8211; all I get is tutorials on digital signing, tutorials on how to enable PKI in Apache etc.</p><p>If someone feels my whole approach is wrong &amp; there is a better way to do digital signing in a web-app &#8211; feel free to suggest those alternatives also.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I could be wrong about this, but as far as I know without resorting to implementing crypto in JavaScript or using some manner of plugin you cannot do exactly what you are attempting.</p><p>There is something close that is unpopular, but fairly well supported: <strong>Client Side Certificates</strong></p><p>The general idea is that the client has a certificate in their keychain and that certificate is examined when they request a secured resource as part of the authorization sequence.  After that point the communication proceeds over normal everyday SSL.</p><p>In your case if you were to have a web service that was behind SSL and a form that posts the transfer, transferTo and nonce  and the service was configured appropriately to request client certificates the service would respond to the initial request with a request for credentials and the distinguished names of issuers it will accept.  If the browser has more than one client certificate from that list it should prompt the user to select.</p><p>The rest of the conversation is just handled like any other SSL as I understand it, but you should then have access to the client certificate as part of the request object from the server end of things.</p><p>This is not exactly what you were asking for, but to my knowledge this is the closest you can get without doing something non-standard.  The communication is secure because of the SSL, the user has proven they have a copy of the certificate and on the server end you can use the certificate to check that the user matches who they claim to be as an additional authentication factor.  The message is not literally signed with the key, but the SSL communication channel the message traveled over was verified with the client key.</p><p>A stack overflow that discusses this further (see first answer &amp; links):</p><p><a href="https://stackoverflow.com/questions/1193013/ssl-client-cert-verification-optimisation">https://stackoverflow.com/questions/1193013/ssl-client-cert-verification-optimisation</a></p><p>Examples of how you might set it up if you are in Microsoft land:</p><p><a href="http://woloski.com/2012/08/04/securing-aspnet-webapi-with-clientcerts/" rel="nofollow noreferrer">http://woloski.com/2012/08/04/securing-aspnet-webapi-with-clientcerts/</a></p><p><a href="http://support.microsoft.com/kb/315588" rel="nofollow noreferrer">http://support.microsoft.com/kb/315588</a> (older versions)</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../storing-sort-code-account-number-on-website-security/'>Storing sort code / account number on website. Security</a></li><li class="list-group-item"><a href='../best-practices-for-web-application-authentication-security-any-platform/'>Best practices for web application Authentication/Security (Any Platform)</a></li><li class="list-group-item"><a href='../using-facebook-to-authenticate-how-to-link-to-user-record-in-the-app-email/'>Using Facebook to authenticate, how to link to user record in the app? Email</a></li><li class="list-group-item"><a href='../https-site-perform-ajax-calls-to-native-http-desktop-aplication/'>HTTPS site perform ajax calls to native http desktop aplication</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>