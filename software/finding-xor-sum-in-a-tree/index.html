<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Finding xor sum in a tree &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1080099 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1080099" class="post-1080099 software type-software status-publish hentry category-software tag-algorithms tag-trees"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Finding xor sum in a tree</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">trees</span></p><div class="entry-content"><p>I was trying to solve <a href="https://www.hackerearth.com/tracks/pledge-2015-medium/xor-in-tree-1/" rel="nofollow">this problem on hackerearth</a> where you have a tree with values on each node and you have to answer queries that ask what is the xor sum between two nodes. Also, there are updates that you have to make(the value of a node can change). I solved the easy part (dfs and lca) and for each node I saved the xor sum of the values of nodes on the path from node 1 to that node (including that node).</p><p>However, there&#39;s a part of the &#34;editorial&#34; for this problem I can&#39;t understand.</p><blockquote><p>Consider the tree is rooted at node 1. Let F(i) be the XOR sum of all<br /> value associated with nodes in the path from root 1 to node i. Let<br /> LCA(u, v) be the lowest common ancestor of node u and node v. Let Q(u,<br /> v) be the XOR sum of all value associated with nodes in the single<br /> path from node u to node v. So Q(u, v) is answer for each query of<br /> type 2.</p><p>We have: Q(u, v) = F(u) XOR F(v) XOR A[LCA(u, v)] (why?) where A[i]<br /> denoting value associated with node i.</p></blockquote><p>I don&#39;t understand where they got this formula:</p><blockquote><p>Q(u, v) = F(u) XOR F(v) XOR A[LCA(u, v)]</p></blockquote><p>What is the thought process behind this formula?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p><strong>The key to deriving that formula is seeing how the various paths overlap and remembering that any number XOR itself equals 0.</strong> In particular, Q(x, y) XOR Q(x, y) will also equal 0.</p><h3>The Quick Derivation</h3><p>F(u) is the path from the root node to u. F(v) is the path from the root node to v. Because any number XOR itself equals 0, F(u) XOR F(v) will &#34;cancel out&#34; all the nodes above the lowest common ancestor of u and v, LCA(u, v). So F(u) XOR F(v) = Q(LCA(u, v), u) XOR Q(LCA(u, v), v). This happens to be the XOR sum of all nodes on the unique path from u to v, except for LCA(u, v) itself, since it&#39;s currently counted twice. So if we simply count it a third time, then we get the sum of all the nodes in Q(u, v). Thus Q(u, v) = F(u) XOR F(v) XOR LCA(u, v).</p><p>I suspect this &#34;proof&#34; leaves out too many details for you or contains a few steps you&#39;re not already convinced of, so here&#39;s a much longer version:</p><h3>The Thorough Derivation</h3><p>We&#39;re assuming that our graph is a valid tree, and there is a unique single path between u and v. This ensures u and v have a single &#34;lowest common ancestor&#34;, LCA(u, v), which I will refer to as a. I will call the root node r. Keep in mind that a may be the same node as u, v, a, or even all three. The argument I&#39;m about to show should still work even in those degenerate cases.</p><p>So there are unique paths (possibly of length zero) between these four nodes, like this:</p><h2><a href="../../../i.stack.imgur.com/Pbc9W.png" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/Pbc9W.png" alt="enter image description here"/></a></h2><p>Following the &#34;editorial&#34;, let <code>Q(x, y)</code> denote the XOR sum of the nodes on the unique path from <code>x</code> to <code>y</code>.</p><p>We&#39;re interested in <code>Q(u, v)</code>. Clearly, the unique path from <code>u</code> to <code>v</code> passes through <code>a</code>. However, it would be wrong to say that <code>Q(u, v) = Q(u, a) XOR Q(a, v)</code> because that would count the value of <code>a</code> twice. Fortunately, because XOR&#39;ing a value by itself results in zero, counting <code>a</code> three times is the same as counting it only once. So the correct statement is:</p><pre><code>Q(u, v) = Q(u, a) XOR Q(a, v) XOR A[a]
</code></pre><p>Next, <code>F(i)</code> is defined as <code>Q(r, i)</code>. So we can follow the same logic as above and say:</p><pre><code>F(u) = Q(r, u) = Q(r, a) XOR Q(a, u) XOR A[a]
F(v) = Q(r, v) = Q(r, a) XOR Q(a, v) XOR A[a]
</code></pre><p>Now, what is <code>F(u) XOR F(v)</code>? Because the XOR operation is commutative and associative, we can safely rearrange a series of XORs like we would a series of +s, which lets us do this:</p><pre><code>F(u) XOR F(v) = (Q(r, a) XOR Q(a, u) XOR A[a]) XOR (Q(r, a) XOR Q(a, v) XOR A[a])
              = (Q(r, a) XOR Q(r, a)) XOR (Q(a, u) XOR Q(a, v)) XOR (A[a] XOR A[a])
              = 0 XOR (Q(a, u) XOR Q(a, v)) XOR 0
              = Q(a, u) XOR Q(a, v)
</code></pre><p>More intuitively: Whenever you XOR the XOR sums of two overlapping paths, the parts that overlap simply disappear, and we&#39;re left only with the XOR sums of the non-overlapping parts of the paths.</p><p>Finally, recall that <code>Q(u, v) = Q(u, a) XOR Q(a, v) XOR A[a]</code>. We now know that <code>Q(a, u) XOR Q(a, v)</code> is equal to <code>F(u) XOR F(v)</code>, which means:</p><pre><code>Q(u, v) = Q(u, a) XOR Q(a, v) XOR A[a]
        = F(u) XOR F(v) XOR A[a]
</code></pre><p>And since I defined <code>a</code> as <code>LCA(u, v)</code>, we&#39;re done.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../does-it-matter-the-direction-of-a-huffmans-tree-child-node/'>Does it matter the direction of a Huffman&#8217;s tree child node</a></li><li class="list-group-item"><a href='../how-to-discriminate-from-two-nodes-with-identical-frequencies-in-a-huffmans-tree/'>How to discriminate from two nodes with identical frequencies in a Huffman&#8217;s tree</a></li><li class="list-group-item"><a href='../is-a-tree-with-nodes-that-have-reference-to-parent-still-a-tree/'>Is a tree with nodes that have reference to parent still a tree</a></li><li class="list-group-item"><a href='../data-structures-and-algorithms-for-a-directed-rooted-tree-with-inherited-properties/'>Data structures and algorithms for a directed rooted tree with inherited properties</a></li><li class="list-group-item"><a href='../does-a-tree-node-have-an-ancestor/'>Does a tree node have an ancestor</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>