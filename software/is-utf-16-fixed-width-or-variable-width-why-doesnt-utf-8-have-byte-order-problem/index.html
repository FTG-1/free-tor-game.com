<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Is UTF-16 fixed-width or variable-width?  Why doesn&#8217;t UTF-8 have byte-order problem &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069058 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069058" class="post-1069058 software type-software status-publish hentry category-software tag-character-encoding tag-unicode tag-utf-8"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Is UTF-16 fixed-width or variable-width?  Why doesn&#8217;t UTF-8 have byte-order problem</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">character encoding</span><span class="mr-2 badge badge-info">unicode</span><span class="mr-2 badge badge-warning">utf-8</span></p><div class="entry-content"><ol><li><p>Is UTF-16 fixed-width or variable-width? I got different results<br /> from different sources:</p><p>From <a href="http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF">http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF</a>:</p><blockquote><p>UTF-16 stores Unicode characters in sixteen-bit chunks.</p></blockquote><p>From <a href="http://en.wikipedia.org/wiki/UTF-16/UCS-2">http://en.wikipedia.org/wiki/UTF-16/UCS-2</a>:</p><blockquote><p>UTF-16 (16-bit Unicode Transformation Format) is a character<br /> encoding<br /> for Unicode capable of encoding 1,112,064[1] numbers (called code<br /> points) in the Unicode code space from 0 to 0x10FFFF. It produces<br /> a<br /> variable-length result of either one or two 16-bit code units per<br /> code<br /> point.</p></blockquote></li><li><p>From the first source</p><blockquote><p>UTF-8 also has the advantage that the unit of encoding is the<br /> byte, so<br /> there are no byte-ordering issues.</p></blockquote><p>Why doesn&#39;t UTF-8 have byte-order problem? It is variable-width, and<br /> one character may contain more than one byte, so I think byte-order<br /> can still be a problem?</p></li></ol><p>Thanks and regards!</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>(1) What does byte sequence mean, an arrary of char in C? Is UTF-16 a byte sequence, or what is it then? (2) Why does a byte sequence have nothing to do with variable length?</p></blockquote><p>You seem to be misunderstanding what endian issues are. Here&#39;s a brief summary.</p><p>A 32-bit integer takes up 4 bytes. Now, we know the logical ordering of these bytes. If you have a 32-bit integer, you can get the high byte of this with the following code:</p><pre><code>uint32_t value = 0x8100FF32;
uint8_t highByte = (uint8_t)((value &gt;&gt; 24) &amp; 0xFF); //Now contains 0x81
</code></pre><p>That&#39;s all well and good. Where the problem begins is how various hardware stores and retrieves integers from memory.</p><p>In Big Endian order, a 4 byte piece of memory that you read as a 32-bit integer will be read with the first byte being the high byte:</p><pre><code>[0][1][2][3]
</code></pre><p>In Little Endian order, a 4 byte piece of memory that you read as a 32-bit integer will be read with the first byte being the <strong>low</strong> byte:</p><pre><code>[3][2][1][0]
</code></pre><p>If you have a pointer to a pointer to a 32-bit value, you can do this:</p><pre><code>uint32_t value = 0x8100FF32;
uint32_t *pValue = &amp;value;
uint8_t *pHighByte = (uint8_t*)pValue;
uint8_t highByte = pHighByte[0]; //Now contains... ?
</code></pre><p>According to C/C++, the result of this is undefined. It could be 0x81. Or it could be 0x32. Technically, it could return anything, but for real systems, it will return one or the other.</p><p>If you have a pointer to a memory address, you can read that address as a 32-bit value, a 16-bit value, or an 8-bit value. On a big endian machine, the pointer points to the high byte; on a little endian machine, the pointer points to the low byte.</p><p>Note that this is all about reading and writing to/from memory. It has <em>nothing</em> to do with the internal C/C++ code. The first version of the code, the one that C/C++ doesn&#39;t declare as undefined, will <em>always</em> work to get the high byte.</p><p>The issue is when you start reading byte streams. Such as from a file.</p><p>16-bit values have the same issues as 32-bit ones; they just have 2 bytes instead of 4. Therefore, a file could contain 16-bit values stored in big endian or little endian order.</p><p>UTF-16 is defined as a sequence of <em>16-bit values</em>. Effectively, it is a <code>uint16_t[]</code>. Each individual code unit is a 16-bit value. Therefore, in order to properly load UTF-16, you must know what the endian-ness of the data is.</p><p>UTF-8 is defined as a sequence of <em>8-bit values</em>. It is a <code>uint8_t[]</code>. Each individual code unit is 8-bits in size: a single byte.</p><p>Now, both UTF-16 and UTF-8 allow for multiple code units (16-bit or 8-bit values) to combine together to form a Unicode codepoint (a &#34;character&#34;, but that&#39;s <strong>not</strong> the correct term; it is a simplification). The <em>order</em> of these code units that form a codepoint is dictated by the UTF-16 and UTF-8 encodings.</p><p>When processing UTF-16, you read a 16-bit value, doing whatever endian conversion is needed. Then, you detect if it is a surrogate pair; if it is, then you read another 16-bit value, combine the two, and from that, you get the Unicode codepoint value.</p><p>When processing UTF-8, you read an 8-bit value. No endian conversion is possible, since there is only one byte. If the first byte denotes a multi-byte sequence, then you read some number of bytes, as dictated by the multi-byte sequence. Each individual byte is a byte and therefore has no endian conversion. The <em>order</em> of these bytes in the sequence, just as the order of surrogate pairs in UTF-16, is defined by UTF-8.</p><p>So there can be no endian issues with UTF-8.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../should-utf-16-be-considered-harmful/'>Should UTF-16 be considered harmful</a></li><li class="list-group-item"><a href='../should-utf-8-csv-files-contain-a-bom-byte-order-mark/'>Should UTF-8 CSV files contain a BOM (byte order mark)</a></li><li class="list-group-item"><a href='../how-to-align-on-both-word-size-and-cache-lines-in-x86/'>How to align on both word size and cache lines in x86</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>