<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; Does unit testing lead to premature generalization (specifically in the context of C++) &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087141 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087141" class="post-1087141 software type-software status-publish hentry category-software tag-c tag-generalization tag-tdd tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; Does unit testing lead to premature generalization (specifically in the context of C++)</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">generalization</span><span class="mr-2 badge badge-warning">tdd</span><span class="mr-2 badge badge-primary">unit testing</span></p><div class="entry-content"><h3>Preliminary notes</h3><p>I&#39;ll not go into the distinction of the different kinds of test there are, there are <a href="https://stackoverflow.com/questions/437897/what-are-unit-testing-and-integration-testing-and-what-other-types-of-testing-s">already</a> a few <a href="https://stackoverflow.com/questions/520064/what-is-unit-test-integration-test-smoke-test-regression-test">questions</a> on these sites regarding that.</p><p>I&#39;ll take what&#39;s there and that says: <em>unit testing in the sense of &#34;testing the smallest isolatable unit of an application&#34;</em> from which this question actually derives</p><h3>The isolation problem</h3><p>What is <em>the smallest isolatable unit</em> of a program. Well, as I see it, it (highly?) depends on what language you are coding in.</p><p><a href="http://rads.stackoverflow.com/amzn/click/0131177052" rel="nofollow noreferrer">Micheal Feathers talks about</a> the concept of a <em>seam</em>: [WEwLC, p31]</p><blockquote><p>A seam is a place where you can alter behavior in your program without editing in that place.</p></blockquote><p>And without going into the details, I understand a seam &#8212; in the context of unit testing &#8212; to be a place in a program where your &#34;test&#34; can interface with your &#34;unit&#34;.</p><h3>Examples</h3><p>Unit test &#8212; especially in C++ &#8212; require from the code under test to add <em>more seams</em> that would be strictly called for for a given problem.</p><p>Example:</p><ul><li>Adding a virtual interface where non-virtual implementation would have been sufficient</li><li>Splitting &#8212; generalizing(?) &#8212; a (smallish) class further &#34;just&#34; to facilitate adding a test.</li><li>Splitting a single-executable project into seemingly &#34;independent&#34; libs, &#34;just&#34; to facilitate compiling them independently for the tests.</li></ul><h3>The question</h3><p>I&#39;ll try a few versions that hopefully ask about the same point:</p><ul><li>Is the way that Unit Tests require one to structure an application&#39;s code &#34;only&#34; beneficial for the unit tests or is it actually beneficial to the applications structure.</li><li>Is the code generalization that is needed to make it unit-testable useful for anything <em>but</em> the unit tests?</li><li>Does adding unit tests force one to generalize unnecessarily?</li><li>Is the shape unit tests force on code &#34;always&#34; also a good shape for the code in general as seen from the problem domain?</li></ul><p>I remember a rule of thumb that said don&#39;t generalize until you need to / until there&#39;s a second place that uses the code. With Unit Tests, there&#39;s <em>always</em> a second place that uses the code &#8212; namely the unit test. So is this reason enough to generalize?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Unit test -- especially in C++ -- require from the code under test to add more seams that would be strictly called for for a given problem.</p></blockquote><p>Only if you don&#39;t consider testing an integral part of problem solving. For any nontrivial problem, it ought to be, not only in the software world.</p><p>In the hardware world, this has been learnt long ago - in the hard way. The manufacturers of various equipment have learnt through centuries from countless falling bridges, exploding cars, smoking CPUs etc. etc. what we are learning now in the software world. All of them build &#34;extra seams&#34; into their products in order to make them testable. Most new cars nowadays feature diagnostic ports for the repairmen to get data about what&#39;s going on inside the engine. A significant portion of the transistors on every CPU serve diagnostic purposes. In the hardware world, every bit of &#34;extra&#34; stuff costs, and when a product is manufactured by the millions, these costs surely add up to large sums of money. Still, the manufacturers are willing to spend all this money for testability. Probably they have figured (or learnt the hard way) that the risk of their product failing in the hands (or under the bums) of end users, and the ensuing loss of reputation, lawsuits, bad PR etc. etc. etc. is way higher than the cost of designing and making their product testable from the start.</p><p>Back to the software world, C++ is indeed more difficult to unit test than later languages featuring dynamic classloading, reflection etc. Still, most of the issues can be at least mitigated. In the one C++ project where I used unit tests so far, we didn&#39;t run the tests as often as we would in e.g. a Java project - but still they were part of our CI build, and we found them useful.</p><blockquote><p>Is the way that Unit Tests require one to structure an application&#39;s code &#34;only&#34; beneficial for the unit tests or is it actually beneficial to the applications structure?</p></blockquote><p>In my experience a testable design is beneficial overall, not &#34;only&#34; for the unit tests themselves. These benefits come on different levels:</p><ul><li>Making your design testable enforces you to chunk your application into small, more or less independent parts which can only influence each other in limited and well defined ways - this is very important for the long term stability and maintainability of your program. Without this, the code tends to deteriorate into spaghetti code where any change made in any part of the codebase may cause unexpected effects in seemingly unrelated, distinct parts of the program. Which is, needless to say, is every programmer&#39;s nightmare.</li><li>Writing the tests themselves in TDD fashion actually exercises your APIs, classes and methods, and serves as a very effective test to detect whether your design makes sense - if writing tests against and interface feels awkward or difficult, you get valuable early feedback when it is still easy to shape the API. In other words, this defends you from publishing your APIs prematurely.</li><li>The pattern of development enforced by TDD helps you focus on the concrete task(s) to do, and keeps you on target, minimizing the chances of you wandering off solving other problems than the one you are supposed to, adding unnecessary extra features and complexity, etc.</li><li>The fast feedback of unit tests allows you to be bold in refactoring the code, enabling you to constantly adapt and evolve the design over the lifetime of the code, thus effectively preventing code entropy.</li></ul><blockquote><p>I remember a rule of thumb that said don&#39;t generalize until you need to / until there&#39;s a second place that uses the code. With Unit Tests, there&#39;s always a second place that uses the code -- namely the unit test. So is this reason enough to generalize?</p></blockquote><p>If you can prove that your software does precisely what it&#39;s supposed to do - and prove it in a fast, repeatable, cheap and deterministic enough way to satisfy your customers - without the &#34;extra&#34; generalization or seams forced by unit tests, go for it (and let us know how you do it, because I am sure a lot of people on this forum would be as interested as me :-)</p><p>Btw I assume by &#34;generalization&#34; you mean things like introducing an interface (abstract class) and polymorphism instead of a single concrete class - if not, please clarify.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-writing-the-minimum-code-to-pass-a-unit-test-without-cheating/'>Unit-testing &#8211; Writing the minimum code to pass a unit test &#8211; without cheating!</a></li><li class="list-group-item"><a href='../c-does-adding-unit-tests-make-sense-for-well-known-legacy-code/'>C++ &#8211; Does adding unit tests make sense for well-known legacy code</a></li><li class="list-group-item"><a href='../c-unit-testing-c-what-to-test/'>C++ &#8211; Unit testing C++: What to test</a></li><li class="list-group-item"><a href='../unit-testing-is-refactoring-for-the-purpose-of-unit-testing-a-code-smell/'>Unit-testing &#8211; Is refactoring for the purpose of unit testing a code smell</a></li><li class="list-group-item"><a href='../unit-testing-black-box-unit-testing/'>Unit-testing &#8211;  black box unit testing</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>