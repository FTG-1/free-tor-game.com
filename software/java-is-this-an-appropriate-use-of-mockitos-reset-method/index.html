<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Is this an appropriate use of Mockito&#8217;s reset method &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1062974 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1062974" class="post-1062974 software type-software status-publish hentry category-software tag-java tag-mocking"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Is this an appropriate use of Mockito&#8217;s reset method</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">java</span><span class="mr-2 badge badge-info">mocking</span></p><div class="entry-content"><p>I have a private method in my test class that constructs a commonly used <code>Bar</code> object. The <code>Bar</code> constructor calls <code>someMethod()</code> method in my mocked object:</p><pre><code>private @Mock Foo mockedObject; // My mocked object
...

private Bar getBar() {
  Bar result = new Bar(mockedObject); // this calls mockedObject.someMethod()
}
</code></pre><p>In some of my test methods I want to check <code>someMethod</code> was also invoked by that particular test. Something like the following:</p><pre><code>@Test
public void someTest() {
  Bar bar = getBar();

  // do some things

  verify(mockedObject).someMethod(); // &lt;--- will fail
}
</code></pre><p>This fails, because the mocked object had <code>someMethod</code> invoked twice. I don&#39;t want my test methods to care about the side effects of my <code>getBar()</code> method, so would it be reasonable to reset my mock object at the end of <code>getBar()</code>?</p><pre><code>private Bar getBar() {
  Bar result = new Bar(mockedObject); // this calls mockedObject.someMethod()
  reset(mockedObject); // &lt;-- is this OK?
}
</code></pre><p>I ask, because <a href="http://docs.mockito.googlecode.com/hg/org/mockito/Mockito.html#17">the documentation</a> suggests resetting mock objects is generally indicative of bad tests. However, this feels OK to me.</p><p><strong>Alternative</strong></p><p>The alternative choice seems to be calling:</p><pre><code>verify(mockedObject, times(2)).someMethod();
</code></pre><p>which in my opinion forces each test to know about the expectations of <code>getBar()</code>, for no gain.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I believe this is one of the cases where using <code>reset()</code> is ok. The test you are writing is testing that &#34;some things&#34; triggers a single call to <code>someMethod()</code>. Writing the <code>verify()</code> statement with any different number of invocations can lead to confusion.</p><ul><li><code>atLeastOnce()</code> allows for false positives, which is a bad thing as you want your tests to always be correct.</li><li><code>times(2)</code> prevents the false positive, but makes it seem like you are expecting two invocations rather than saying &#34;i know the constructor adds one&#34;. Further more, if something changes in the constructor to add an extra call, the test now has a chance for a false positive. And removing the call would cause the test to fail because the test is now wrong instead of what is being tested is wrong.</li></ul><p>By using <code>reset()</code> in the helper method, you avoid both of these issues. However, you need to be careful that it will also reset any stubbing you have done, so be warned. The major reason <code>reset()</code> is discouraged is to prevent</p><pre><code>bar = mock(Bar.class);
//do stuff
verify(bar).someMethod();
reset(bar);
//do other stuff
verify(bar).someMethod2();
</code></pre><p>This is not what the OP is trying to do. The OP, I&#39;m assuming, has a test that verifies the invocation in the constructor. For this test, the reset allows for isolating this single action and it&#39;s effect. This one of the few cases with <code>reset()</code> can be helpful as. The other options that don&#39;t use it all have cons. The fact that the OP made this post shows that he is thinking about the situation and not just blindly utilizing the reset method.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-how-to-use-powermock-mockito-easymock-to-use-a-mocked-object-for-dependency-injection/'>Unit-testing &#8211; How to use PowerMock / Mockito / EasyMock to use a mocked object for dependency injection</a></li><li class="list-group-item"><a href='../c-do-large-test-methods-indicate-a-code-smell/'>C# &#8211; Do large test methods indicate a code smell</a></li><li class="list-group-item"><a href='../unit-testing-the-most-appropriate-testing-method-in-this-scenario/'>Unit-testing &#8211;  the most appropriate testing method in this scenario</a></li><li class="list-group-item"><a href='../unit-testing-how-to-not-test-implementation-when-method-returns-void/'>Unit-testing &#8211; How to not test implementation when method returns void</a></li><li class="list-group-item"><a href='../how-to-handle-test-with-initialising-functions-that-call-mocked-functions/'>How to handle test with initialising functions that call mocked functions</a></li><li class="list-group-item"><a href='../java-is-it-really-a-bad-practice-to-mock-a-pojo-value-object-if-you-dont-care-about-what-it-contains/'>Java &#8211; Is it really a bad practice to mock a POJO (value object) if you don&#8217;t care about what it contains</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>