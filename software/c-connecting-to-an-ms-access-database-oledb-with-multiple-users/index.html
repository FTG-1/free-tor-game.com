<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Connecting to an MS Access database (OleDB) with multiple users &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079276 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079276" class="post-1079276 software type-software status-publish hentry category-software tag-c tag-database tag-microsoft-access"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Connecting to an MS Access database (OleDB) with multiple users</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">database</span><span class="mr-2 badge badge-warning">microsoft access</span></p><div class="entry-content"><p>I&#39;m writing C# applications that store their data in MS Access databases, (I&#39;d rather use a different type of database but currently have no other option). The applications are in use by multiple people at a time and so when there are multiple connection attempts (or someone mistakenly opens a table), some of them fail to connect.</p><p>In order to get around this I&#39;ve written a couple of methods that reattempt a connection/disconnection using Thread.Sleep(n) inside a while loop (I realise the disconnection reattempts probably aren&#39;t necessary but have left it in just in case).</p><p>Is there a better way of accomplishing this? I was reading this thread on &#39;<a href="https://stackoverflow.com/questions/8815895/why-is-thread-sleep-so-harmful">Why is thread sleep so harmful</a>&#39; and I thought maybe in the case it would be alright. I&#39;d rather have the application look like its frozen for a few seconds than pop up an error message for the end user, which would cause confusion and my inbox to be inundated by users requesting support. Am I just looking at this completely wrong?</p><p><a href="https://codereview.stackexchange.com/questions/140073/connecting-to-an-ms-access-database-oledb-with-multiple-users">x-posted from code review SE</a>, @mdfst13 advised &#39;You might get a better answer to your primary question from Programming.SE, as one way to address this would be to add an intermediate service to talk to the database.&#39;</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The solution that I was suggesting is introducing a <a href="https://en.wikipedia.org/wiki/Service-oriented_architecture" rel="nofollow">service</a> that talks to your database.  Your application would then talk to the service.  The service would maintain a permanent connection (or connections if it has multiple threads or instances).</p><p>The advantage of this is that instead of retrying the connection, the service can queue requests.  It can only process a fixed number at a time, but it can continually process them.  This gives it a higher throughput than a system where you are waiting for a connection to be available.  For one thing, it eliminates the need to connect or disconnect.  More importantly, it won&#39;t be sleeping while waiting for the connection to become available.</p><p>Another advantage is that you can process the request queue in order.  In your application, bad luck could result in an application exhausting its retries.  If another application grabs the available connection just before your application wakes up, it can run out its attempts even though a connection was available.  The service always answers requests and you can process the oldest one first.  That gives a more predictable behavior.</p><p>The first downside of the service is that for a single client, it is more overhead.  It has to do all the same work of querying the database while also communicating with the client application.</p><p>The second downside is that you have to run it somewhere.  Since there is contention for the database, it is apparently a shared resource.  Perhaps it could run there.  Or maybe not.</p><p>A third downside is that it is more programming work.  You have to write the intermediate service.  Most of the queries can be based on what the application currently has, but then you have to write a service that processes requests and modify the application to call the service rather than the database.</p><p>While the list of downsides is longer, I think that the upsides are often stronger.  Higher throughput and more predictable behavior are both useful.  The downsides are all addressable.  Apparently you have a programmer to do the work (you).  Hopefully you can find somewhere to run the service.  And the increased overhead on the easy case is likely more than offset by the improved behavior in more difficult cases.  Most people won&#39;t notice an additional second of overhead so long as it returns in less than eight seconds total.  But waiting through multiple connection attempts can take you over the eight second threshold where people start getting frustrated.</p><p>A side advantage is that this decouples your application from the database.  So if you change your database, you don&#39;t always have to redeploy the application.  You only need to update the client application if the service interface changes.</p><p>I&#39;m thinking of a service composed of a web application.  So your client application would pass parameters which the service would convert into an Access query.  The service would package the results and send them back to the application.  While waiting for the next request from the application, the service could process other requests.  WSDL-based services are designed for this kind of thing.</p><p>Note that I have limited experience with C# and Microsoft Access, so I may be missing subtleties related to those two aspects.  I&#39;m more familiar with using this pattern with a Perl or PHP frontend talking to a C++ or Java service.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/deploying-microsoft-access-databases-with-our-application/'>Deploying Microsoft-Access databases with our application</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-application-connecting-to-database-server/'>C# &#8211; Application connecting to database server</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/database-use-client-to-access-database-or-server-to-access-database/'>Database &#8211; Use client to access database or server to access database</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-two-libraries-connecting-to-the-database-leading-to-code-smell/'>C# &#8211; Two libraries connecting to the database, leading to code smell</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/database-downside-to-using-access-as-a-database/'>Database &#8211;  downside to using Access as a database</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-managing-database-access-for-microservices/'>C# &#8211; Managing Database Access for MicroServices</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>