<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; How to avoid double data validation in an application with web interface &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073232 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073232" class="post-1073232 software type-software status-publish hentry category-software tag-asp-net-mvc tag-c tag-validation"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; How to avoid double data validation in an application with web interface</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asp.net-mvc</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">validation</span></p><div class="entry-content"><p>I am learning software design by building a CRUD web application (ASP.NET MVC with Entity Framework). I split it into two projects: first is Core library, that contains business logic, second is Web GUI. I got an idea, that separated Core library can be used elsewhere (for example desktop application) or GUI can be completely changed later if needed.</p><p>Business logic is stored in &#34;managers&#34; which operate with database entities and provide results using data transfer objects, because I do not want to expose db entities outside the Core. Web GUI accepts user input and uses managers to do the job. It also defines view model objects, which are basically copycat from data transfer objects, but enhanced with data annotation attributes.</p><p><strong>Problem</strong></p><p>Web project performs server side validation on view model objects because input from user should be verified. Core project performs same validation again on data transfer objects, because it knows nothing about GUI layer above it. Question is how can I avoid duplicated data validation, because sometimes it requires queries to database and in general adds overhead and duplicated code. <strong>What are the best practices in my case?</strong> Or the whole idea of separating solution into two projects is wrong?</p><p>Posts I&#39;ve read so far discuss validation in normal 3 layered solutions, where validations are slightly different in each layer (client (javascript), business and data layer) and such duplicated validation is not an issue (both are business).</p><p><strong>Solutions I came up to</strong></p><ol><li>Let GUI to perform validation and ignore any in Core.</li><li>Let managers to perform validation and catch raised exceptions in GUI. I&#39;ve read that this is bad practice<sup>[citation-needed]</sup>.</li><li>Move validation inside the data transfer objects with private &#34;already validated&#34; flag. Provide managers with ValidateDto method which triggers validation on given DTO. Validation results in dictionary of error messages with property names as keys, sets flag, but if already set does nothing. Also mechanism is needed to unset the flag if DTO was changed.</li></ol><p><strong>Edit</strong></p><p>I think I need to clarify: Core is class library, Web is normal ASP.NET MVC application with views, controllers, etc.</p><p><strong>Edit 2</strong></p><p>My question looks like a duplicate of <a href="https://softwareengineering.stackexchange.com/questions/81062/data-input-validation-where-how-much">Data input validation &#8211; Where? How much? [closed]</a> and I disagree. This post discuss different validation scopes on different levels within an application (Client side javascript, business layer, data layer validation). Each level covers different validation scopes, but they tend to intersect. While I seek an answer how to remove duplicated validation within single level (business) when it is separated into two projects. Also linked post does not have accepted answer and most voted answer is basically telling to move core validation into single place. Which is ultimately correct but is not an answer to my issue.</p><p>All answers so far suggest to put validation into Core class library. So question now is how should I return information about invalid input errors.</p><ol><li><p>Will it be special methods in Core &#34;API&#34; which should be called every time before data are provided to Core. This API will return detailed error information which can be provided to user. This requires user of Core library (programmer) to know about such special behavior (or a lot of coding otherwise, to decide if validation was called by user before or not).</p></li><li><p>Will it be specially defined exception which will be thrown by Core if input is invalid. This exception will contain detailed errors information.</p></li></ol><p><strong>Solution</strong></p><p>Thank you all for answers and comments! I ended up with removing all server side validation from Web project and validating only inside Core project. I also created InvalidModelException as user Machado suggested and used Exception.Data property to store all model errors in form of key/value pairs, where key was name of invalid property and value was error code previously defined in Core as enum. Inside Web project I am catching this InvalidModelException exception and once caught I am filling ModelState with model errors to provide better feedback to user. I am storing all user friendly error messages in resource .resx file in Web project. Based on property name and error code from InvalidModelException I am generating ErrorMessageName string to pull out friendly error message from resource file.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The core doesn&#39;t know where the data comes from, right ? So, since all <a href="https://xkcd.com/327/" rel="nofollow noreferrer">data inputs must be sanitized</a>, I&#39;d say that&#39;s it&#39;s a must for the CORE to validate the inputs.</p><p>That being said, you&#39;d have to create an API where you expect to receive bad input and return something meaningful for the caller, and not just throwing weird and cryptic exceptions everywhere. &#34;Garbage in, garbage out&#34; is just a bad API design.</p><p>One approach I&#39;ve used in the past with a few MVC5 applications was to create a &#34;BusinessException&#34;, which contained some key information for the caller to understand that they&#39;ve been using the API wrong. One of the components of the BusinessException was a &#34;user friendly error message&#34;, that could be directly shown to a user either in a Forms app or a Web app (the core never knew where it was running), along with some other important fields such as &#34;FaultyProperty&#34;, &#34;TechnicalException&#34; and so on.</p><p>That way you can make your MVC app a thin layer doing basic validation (very basic) before dispatching the heavy load to the Core, and keep a single idiomatic way to handle errors by catching the &#34;BusinessException&#34; when needed and reacting accordingly.</p><p>This way you get to keep the <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle" rel="nofollow noreferrer">single responsibility principle</a> and <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" rel="nofollow noreferrer">DRY</a> in place while still holding your validations and keeping code easy to read.</p><p>And by giving details of the error back to the caller by filling specific fields/properties in the BusinessException, the GUI layer can highlight whatever it needs to in order to provide a nice user experience.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-validation-and-data-persistence-in-a-domain-model/'>Architecture &#8211; Validation and data persistence in a domain model</a></li><li class="list-group-item"><a href='../design-where-should-the-not-empty-field-validation-code-be-written-on-a-3-layer-application/'>Design &#8211; Where should the &#8220;not empty field&#8221; validation code be written on a 3-layer application</a></li><li class="list-group-item"><a href='../object-oriented-oop-behavior-data-but-what-about-validation-behaviors/'>Object-oriented &#8211; OOP: Behavior + Data, but what about &#8216;validation&#8217; behaviors</a></li><li class="list-group-item"><a href='../c-overall-view-validation-with-a-datagrid-and-keeping-to-mvvm/'>C# &#8211; Overall view validation with a datagrid and keeping to MVVM</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>