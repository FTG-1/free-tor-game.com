<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; &#8220;Immutable&#8221; interfaces &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087716 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087716" class="post-1087716 software type-software status-publish hentry category-software tag-design tag-immutability tag-interfaces tag-naming tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; &#8220;Immutable&#8221; interfaces</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">immutability</span><span class="mr-2 badge badge-warning">interfaces</span><span class="mr-2 badge badge-primary">naming</span><span class="mr-2 badge badge-danger">object-oriented</span></p><div class="entry-content"><p>I am confused about the notion of immutability. Consider the following structure of a simplistic calculator:</p><p><img src="../../../i.stack.imgur.com/uKV21.jpg" alt="Class diagram"/></p><p>Here are the interfaces:</p><pre><code>interface IOperationalInterface {
    int Sum(int a, int b);
}

interface IAuditInterface {
    int SumInvocations();
}
</code></pre><p><code>IOperationalInterface.Sum</code> should compute the sum of two integers and <code>IAuditInterface.SumInvocations</code> should return the total number of received <code>Sum</code> calls.</p><p>Here is a trivial implementation:</p><pre><code>class CalculatorImpl : IOperationalInterface, IAuditInterface {
    private int invocations = 0;

    public int Sum(int a, int b) {
        invocations++;
        return a + b;
    }

    public int SumInvocations() {
        return invocations;
    }
}
</code></pre><p>Is <code>CalculatorImpl</code> immutable? Obviously not, because its state changes with each invocation of the <code>Sum</code> method. Is the <code>Sum</code> operation pure? According to <a href="http://en.wikipedia.org/wiki/Pure_function" rel="nofollow noreferrer">Wikipedia</a> it is not, since it changes the state of a mutable object, and that side-effect is observable through the <code>IAuditInterface</code>. Obviously the <code>SumInvocations</code> operation is also not pure, since it may return different results.</p><p>In summary, <code>CalculatorImpl</code> is mutable and all of its methods are impure.</p><p>However, from the viewpoint of <code>CalculatorClient</code>, who talks to it only through the <code>IOperationalInterface</code>, it appears to be immutable and the <code>Sum</code> operation appears to be pure in the sense that it could not observe any side effects <em>through that interface</em>.</p><p>On the other hand, from the perspective of <code>AuditClient</code>, it is completely different: it is obvious that the object implementing the <code>AuditInterface</code> is mutable and its <code>SumInvocations</code> operation is impure, and <em>this follows directly from the specification of the <code>IAuditInterface</code></em>.</p><p>So, it is possible to partition an interface/specification of a mutable class such that some parts of it will appear mutable and some not. In this case, considering only the <code>Sum</code> operation and leaving out the requirement that the invocations should be counted, we get something that does not have any side-effects.</p><p>Now, on implementing the <code>CalculatorClient</code> one can take into account the fact that the object behind the interface <em>appears</em> to be immutable. At least one could not tell the difference.</p><p>So my question is: does it make sense to talk about &#34;immutability&#34; of interfaces or is it a bad idea? How else can I communicate the fact that there will be no observable side-effects through that interface? And if it&#39;s bad, what could go wrong?</p><p><strong>UPDATE</strong></p><p>Thanks for your answers/comments! I see now that there is no way to say that the <code>IOperationalInterface</code> is pure; the conditions of purity are much too strong to apply in this case. However the question remains whether there is a weaker notion (maybe &#34;immutability&#34;?) which is applicable.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>However, from the viewpoint of CalculatorClient, who talks to it only through the IOperationalInterface, it appears to be immutable and the Sum operation appears to be pure in the sense that it could not observe any side effects <em>through that interface</em>.</p></blockquote><p>Whatever you can observe through the interface is irrelevant to the concept of purity. If <code>Sum</code> logged results to a file, it would still be impure even though you wouldn&#39;t be able to observe any changes through the interface.</p><p>Purity is a very strong condition. If you say that something is pure, I&#39;ll take you at your word and assume nothing bad will happen if I run it from multiple threads, cache the results and only call it once for any given set of inputs, or that I can call it 1,000,000 times without exhausting the OS&#39;s file handles. Those assumptions can backfire when using <code>CalculatorImpl</code>.</p><p>There&#39;s nothing wrong with partitioning the interfaces the way you have, but you should be precise. The specification you want for <code>IOperationalInterface</code> is probably closer to: &#34;The return value of these methods must depend only on their arguments, but their execution may have side effects.&#34; You can be more specific about the side effects and say that the methods must not perform any kind of I/O. But I wouldn&#39;t say that it&#39;s pure, because you&#39;re very clearly not using it that way.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../what-are-the-consequences-of-immutable-classes-with-references-to-mutable-classes/'>What are the consequences of immutable classes with references to mutable classes</a></li><li class="list-group-item"><a href='../c-do-not-declare-interfaces-for-immutable-objects/'>C# &#8211; Do not declare interfaces for immutable objects</a></li><li class="list-group-item"><a href='../c-delegates-are-immutable-but-why-does-that-matter/'>C# Delegates are immutable &#8211; but why does that matter</a></li><li class="list-group-item"><a href='../java-why-doesnt-java-8-include-immutable-collections/'>Java &#8211; Why doesn&#8217;t Java 8 include immutable collections</a></li><li class="list-group-item"><a href='../design-good-reason-to-make-pure-functions-non-public/'>Design &#8211;  good reason to make pure functions non-public</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>