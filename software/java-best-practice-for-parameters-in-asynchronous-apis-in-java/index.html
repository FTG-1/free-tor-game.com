<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Best practice for parameters in asynchronous APIs in Java &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1086095 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1086095" class="post-1086095 software type-software status-publish hentry category-software tag-asynchronous-programming tag-java"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Best practice for parameters in asynchronous APIs in Java</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asynchronous-programming</span><span class="mr-2 badge badge-info">java</span></p><div class="entry-content"><p>Is there a best practice for using Guava&#39;s <code>ListenableFuture</code> in parameters in API calls? Compare these two versions of an interface that internally does a compare-and-set (I&#39;m using Guava&#39;s <code>ListenableFuture</code>):</p><pre><code>interface MyDao {
    ListenableFuture&lt;Data&gt; getData(String id);
    ListenableFuture&lt;Boolean&gt; updateData(ListenableFuture&lt;Data&gt; data, int newFieldValue);
}
</code></pre><p></p><pre><code>interface MyDao {
    ListenableFuture&lt;Data&gt; getData(String id);
    ListenableFuture&lt;Boolean&gt; updateData(Data data, int newFieldValue);
}
</code></pre><p>The first looks a bit messy, and the implementation will likely involve a <code>Futures.transform</code> of its own, but you could also argue that it&#39;s an asynchronous API, so taking futures as parameters might make sense. Where it gets nice is that it tidies up the business logic when using the interface so it reads like synchronous code:</p><pre><code>ListenableFuture&lt;Data&gt; data = dao.getData(&#34;123&#34;);
ListenableFuture&lt;Boolean&gt; success = dao.updateData(data, 10);
</code></pre><p></p><p>Compare that to</p><pre><code>ListenableFuture&lt;Data&gt; data = dao.getData(&#34;123&#34;);
ListenableFuture&lt;Boolean&gt; success = Futures.transform(data, (Data d) -&gt; dao.updateData(d, 10));
</code></pre><p>And that&#39;s with a lambda. It&#39;s hideous in Java 7.</p><p>The obvious drawback is the interface looks inconsistent. Why is <code>data</code> a future, but <code>newFieldValue</code> isn&#39;t? Should <code>id</code> be a future, too? Along those lines, it makes a trivial call incredibly complicatedâ€”almost like Java wrapper objects before autoboxing.</p><p>It also doesn&#39;t do anything to clean up hideous stack traces when futures fail; they still cascade through every <code>transform</code>.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I think having a <code>ListenableFuture</code> in an API signature method doesn&#39;t make it inconsistent.</p><p>It&#39;s only there to declare <strong>explicity</strong> to the user an asynchronous computation while <strong>hiding</strong> the boilerplate thread logic. <em>Like an <code>Optional</code> would declare <strong>explicity</strong> to the user a possibility of missing data while <strong>hiding</strong> the boilerplate &#34;if not null&#34; logic.</em></p><p>These 2 links explain a bit more my thoughts: <a href="http://fr.slideshare.net/mariofusco/monadic-java?next_slideshow=1" rel="nofollow">Monadic Java</a> and <a href="https://github.com/google/guava/wiki/UsingAndAvoidingNullExplained#optional" rel="nofollow">Use of optional</a></p><p>However, if you think any user of your API potentially want to call <code>updateData</code> but have only an instance of <code>Data</code> you could consider adding the corresponding method to your API.</p><pre><code>public interface MyDao {
    ListenableFuture&lt;Boolean&gt; updateData(ListenableFuture&lt;Data&gt; data, int newFieldValue);
    ListenableFuture&lt;Data&gt; getData(String id);
    default ListenableFuture&lt;Boolean&gt; updateData(Data data, int newFieldValue) {
        //TODO: wrap data in a ListenableFuture and call updateData
    }
}
</code></pre></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/java-asynchronous-java/'>Java &#8211; Asynchronous Java</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/java-8-good-practice-to-pass-streams-around-in-apis-for-lazy-operations/'>Java 8: Good practice to pass Streams around in APIs for lazy operations</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-using-and-designing-asynchronous-apis-with-naturally-synchronous-parts/'>C++ &#8211; Using and designing asynchronous APIs with naturally synchronous parts</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>