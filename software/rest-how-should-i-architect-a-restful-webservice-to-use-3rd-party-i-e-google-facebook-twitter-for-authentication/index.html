<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; How should I architect a RESTful webservice to use 3rd party (i.e. Google, Facebook, Twitter) for authentication &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070002 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070002" class="post-1070002 software type-software status-publish hentry category-software tag-authentication tag-oauth tag-openid tag-rest tag-web-services"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; How should I architect a RESTful webservice to use 3rd party (i.e. Google, Facebook, Twitter) for authentication</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">authentication</span><span class="mr-2 badge badge-info">oauth</span><span class="mr-2 badge badge-warning">openid</span><span class="mr-2 badge badge-primary">rest</span><span class="mr-2 badge badge-danger">web services</span></p><div class="entry-content"><p>For my job we have a nice RESTful webservice we&#39;ve built out that we use to drive a couple websites we have.  Basically the webservice lets you create and work with support tickets, and the website is responsible for the front end.  Any webservice requests use an auth header which we use to validate the user and their password for each call.</p><p>This year we&#39;re looking to expand our login options so that users on the website can log in via Google, Twitter, and Facebook (possibly others).  However I&#39;m having a lot of trouble figure out how to architect this so the webservice can use the 3rd party authentication providers to ensure the users is who they say they are.  Is there any best practices out there for how to do this?</p><p>Currently we&#39;re thinking of having the website handle authenticating the users themselves, and then use a new setSessionId call that registers their current session with the webservice back end.  Each additional request to the webservice will pass along that sessionId and will validate it.  These seems okay, but I have that feeling in the back of my head that I&#39;m not thinking this through and all my forum browsing and reading oauth and openid specs is just confusing me more.  Any tips for how to tackle this?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>It sounds like there are two goals:</p><ol><li>Easy for end-users to authenticate with their existing social accounts</li><li>Easy for developers using your webservice</li></ol><p>Authorizing people to use resources on your site makes OAuth2 a preferred mechanism due to the popularity and availability of client libraries.</p><h3>1. Easy for end-users to authenticate with their existing social accounts</h3><p>The end-user visits a site that uses your API and chooses to login.  They are sent to your OAuth login page.  Your login page shows a normal username and password prompt for accounts  managed on your site and a set of social auth buttons where they can click to login via a site like Facebook.  When the user chooses Facebook you redirect them to Facebook to approve the choice (starting the facebook auth flow).  When the end-user completes the login at Facebook they are redirected back to your site.</p><p>When the user is redirected back to your site from Facebook you save that user&#39;s information into a user record in your database and then generate a new session for that user. You immediately redirect the end-user to their original downstream site with the oauth access_token, completing the original oauth flow.</p><h3>2. Easy for developers using your webservice</h3><p>If you are the provider of authorization then you should create a simple interface for developers to depend upon which does not change every time you add a new upstream auth provider which doesn&#39;t implement oauth perfectly.  This is why I believe you should implement an OAuth2 provider site and that site should be a consumer of the social auth sites.</p><p>To the developer using your nice rest API, they will not be aware of the Facebook interaction unless you choose to give them a hint through the session capture post (for example).</p><p><strong>TL;DR</strong></p><p>Make consumers of your APIs like you by implementing OAuth2 and hiding social auth complexities.  You can, during your oauth flow for your downstream sites, trigger an additional oauth flow with facebook.</p><p>Image because picture == words * 1000:</p><p><img src="../../../i.stack.imgur.com/hTo8f.png" alt="enter image description here"/></p><p>Can we call this oauth2-piggy-back?</p><h3>Step by step flow</h3><ol><li>End user visits site that uses your API</li><li>End user is sent to your site to authorize or signup (oauth2)</li><li>End user picks social auth, clicks facebook login button</li><li>Your site sets a cookie or sets the <code>state</code> in the facebook oauth to know where the user came from</li><li>End user redirected to Facebook and accepts connection at facebook site</li><li>End user redirected to your site to complete facebook auth process</li><li>You lookup or create the user in your database</li><li>You create a new session on your server</li><li>You redirect the user back to their original site with your session token</li></ol></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-how-should-an-api-use-http-basic-authentication/'>Rest &#8211; How should an API use http basic authentication</a></li><li class="list-group-item"><a href='../mvc-what-openid-connect-flow-is-right-for-me/'>Mvc &#8211; What OpenID Connect flow is right for me</a></li><li class="list-group-item"><a href='../rest-oauth2-ropc-vs-basic-auth-for-public-rest-apis/'>Rest &#8211; OAuth2 ROPC vs Basic Auth for public REST APIs</a></li><li class="list-group-item"><a href='../web-development-have-a-client-side-only-web-application-keep-oauth-tokens/'>Web-development &#8211;  have a client-side-only web application keep OAuth tokens</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>