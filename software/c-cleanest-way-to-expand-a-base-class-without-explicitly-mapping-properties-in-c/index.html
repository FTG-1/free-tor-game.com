<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Cleanest way to expand a base class without explicitly mapping properties in C# &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074020 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074020" class="post-1074020 software type-software status-publish hentry category-software tag-c tag-inheritance tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Cleanest way to expand a base class without explicitly mapping properties in C#</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">inheritance</span><span class="mr-2 badge badge-warning">object-oriented</span></p><div class="entry-content"><p>Lets assume I have following base class:</p><pre><code>public class Base 
{
    public int Id {get; set;}
    public string SomeText {get; set;}
    public string SomeOtherText {get; set;}

    public static Base BuildFromOtherAssembly(ClassFromAssemblyA source)
    {
        Id = source.Id;
        SomeText = source.SomeText;
        SomeOtherText = source.SomeOtherText
    }
}

public class Derived : Base 
{
    public DataFromAssemblyB DataFromAssemblyB {get; set;}

    public Derived(DataFromAssemblyB dataFromAssemblyB)
    {
        DataFromAssemblyB = dataFromAssemblyB;
    }
}
</code></pre><p>The base class gets built and returned from a Assembly that references AssemblyA, to AssemblyB, which does not know anything about AssemblyA.</p><p>AssemblyB now wants to add it&#39;s own data to the Base class, and wants to make sure the return type indicates that the additional data is present.</p><p>Basically, I want to make sure on a compiler level that DataFromAssemblyB is present.</p><p>I know that composition would work well in this scenario, but the problem is that logically DataFromAssemblyB belongs to Base.</p><p>To give a more real world example, imagine this scenario:</p><pre><code>public class ShoppingCart 
{
    public int Id {get; set;}
    public string OwnerName {get; set;}
    public decimal Value {get; set;}

    public static Base BuildFromDataModel(ShoppingCartDatabaseModel source)
    {
        Id = source.Id;
        OwnerName = source.OwnerName;
        Value = source.Value
    }
}

public class ShoppingCartWithContents : ShoppingCart 
{
    public ShoppingCartContent Content {get; set;}

    public ShoppingCartWithContents (ShoppingCartContent content)
    {
        Content = content;
    }
}
</code></pre><p>I hope this explains it. The reason I have this problem is because ShoppingCart comes from the database layer, while ShoppingCartContent comes from the caching layer, and a intermediary layer is joining the data together.</p><p>I want strong typing so it&#39;s always clear to the developer whether they are dealing with a ShoppingCart that has contents loaded, or a ShoppingCart that does not.</p><p>I want to avoid mapping all properties around by hand, as that could introduce bugs should a developer decide to add a property to ShoppingCart, but forget to map that property in ShoppingCartWithContents.</p><p>Please let me know what the best practice in such a situation is.</p><p><strong>Update</strong>:</p><p>I created a few different variations I came up with on Github, would love to get some feedback and thoughts.</p><p><a href="https://gist.github.com/Bio2hazard/71c58c97a60a1d1b794f" rel="nofollow">Composition? Inheritance? Gist</a></p><p>The premise is the same &#8211; we create a shopping cart object from a mock database model, and then try to add content data to it.</p><p>To test various capabilities, I thought it would be nice if the <code>ShoppingCart</code> has a <code>.AddContents(content)</code> method that allows to cleanly create a <code>ShoppingCartWithContents</code>.</p><p>As a additional functionality test as a stand in for Business Logic, I added a <code>GetFriendlyString</code> method which should still be accessible once items have been added.<br /> In some samples I overrode <code>GetFriendlyString</code> to have a extra &#34;With Items&#34; to show that the base functionality can be extended.</p><p>I tried to summarize my feelings on the various approaches at the top.</p><p><strong>Update 2:</strong></p><p>I wanted to give a bit more information on the circumstances, as that may influence what the best way is.</p><p>This is a web api project, with EF as a ORM. My business objects like <code>ShoppingCart</code> are hand-mapped from EF&#39;s Db Models to only pick the properties relevant for the business task. Thus, my business logic is not constrained by the ORM or Data Layer ( in fact, the assembly that contains <code>ShoppingCart</code> does not even reference EF ).</p><p>Updates and creates are handled through their own business models, for example if a shopping cart needs to be updated, there would be a <code>ShoppingCartUpdate</code> class that has validation rules and only knows how to map it&#39;s changes to the database model.</p><p>Some data is cached in Redis, and some situations call for creating business objects from both EF and Redis. In the shopping cart example for instance, some business logic may only need to know if a user has a shopping cart or not, but other business logic that has to sum up the price relies on that extra information being available.</p><p>I want to avoid using bools like <code>HasDataLoaded</code>, and I also want to avoid nullable types as that inevitably leads to repeating nullchecks and if statements all over the codebase.</p><p>Worse yet, if a dev forgets a if / null check it could potentially try to ship out a empty order or something stupid like that.</p><p>That&#39;s why I thought it would be a better approach to enforce the presence or absence of data using unique classes &#8211; a checkout method would only take a <code>ShoppingCartWithContents</code> parameter, thus ensuring that the content has been loaded.</p><p>I hope that makes sense.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Looking at your gists, it seems like regular old inheritance will do the trick, especially if you want to be able to process an instance of ShoppingCartWithContents in a method that only cares about the properties of ShoppingCart.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-inheritance-using-non-abstract-base-class/'>Object-oriented &#8211; Inheritance using non-abstract base class</a></li><li class="list-group-item"><a href='../c-adding-base-class-inherited-functionality-to-classes-that-you-dont-control/'>C# &#8211; Adding base-class (inherited) functionality to classes that you don&#8217;t control</a></li><li class="list-group-item"><a href='../c-best-way-of-validating-class-properties/'>C# &#8211; Best way of validating Class properties</a></li><li class="list-group-item"><a href='../c-force-derived-class-to-implement-static-method-c/'>C# &#8211; Force Derived Class to Implement Static Method C#</a></li><li class="list-group-item"><a href='../object-oriented-business-logic-outside-shared-orm-models/'>Object-oriented &#8211; Business logic outside shared ORM models</a></li><li class="list-group-item"><a href='../c-calculating-the-total-price-of-items-in-a-shopping-cart/'>C# &#8211; Calculating the total price of items in a shopping cart</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>