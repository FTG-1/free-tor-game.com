<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Is it a good idea to share repositories across microservices in Spring Boot Application &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073089 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073089" class="post-1073089 software type-software status-publish hentry category-software tag-clean-code tag-microservices tag-project-structure tag-repository-pattern tag-spring-boot"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Is it a good idea to share repositories across microservices in Spring Boot Application</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">clean code</span><span class="mr-2 badge badge-info">microservices</span><span class="mr-2 badge badge-warning">project-structure</span><span class="mr-2 badge badge-primary">repository-pattern</span><span class="mr-2 badge badge-danger">spring-boot</span></p><div class="entry-content"><p>We are migrating a desktop application into web based Spring Boot micro services application with a client imposed mandate of using their existing MySQL database, so all micro services share a common database.</p><p>Since its a SQL database we chose Spring JPA (Hibernate).</p><p>During project setup, our architecture team generated entities via Hibernate Tools into a &#34;db-commons&#34; project and also added Spring JPA repositories to this shared library citing reusable code.</p><p>Although shared entities sound harmless to me, I vehemently opposed idea of having shared repositories, as &#8211;</p><ol><li>It violates S of SOLID. A micro service should only see &amp; operate on data it owns.</li><li>Developers under pressure would directly user these repositories in other services to modify data owned by other micro services.</li><li>It leads to duplicate code and possibly missed validations.</li><li>It could lead to concurrency &amp; data issues at scale.</li></ol><p>Are my concerns wrong ?</p><p>If right, did I miss any possible negative impacts (present/ future) ?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>I vehemently opposed</p></blockquote><p>Vehemence makes others stop listening and, at the same time, it limits our perception of the problems, hence their solutions too.</p><p>To my experience, we become vehement at defending or opposing ideas we don&#39;t fully understand.</p><blockquote><p>Although shared entities sound harmless to me, I opposed the
idea of having shared repositories</p></blockquote><p>Microservices architectures are anything but a trivial thing. Splitting the persistence is among the hardest thing to do. This is something easier to say than done and thus why so many &#34;gurus&#34; write about &#34;how things should be&#34; but none say exactly &#34;how to do it&#34;.</p><p>When we read about the subject on the internet, we have to recall that we don&#39;t know what led the author to reach that conclusion. Or we do, but we don&#39;t share the exactly the problematics.</p><p>Making decisions upon someone else opinion only leads to mediocre decision-making, so don&#39;t be dogmatic. <strong>Don&#39;t defend vehemently opinions of strangers</strong>. Be pragmatic. Put everything you know about the subject into the context of the project, do some proof of concept and choose what works for you. Start with the simplest solution and evolve it as the needs arise.</p><ol><li><em>It violates S of SOLID. A microservice should only see &amp; operate on data it owns.</em></li></ol><p><strong>One data source per service is, theoretically, the best scenario but it&#39;s not a rule written in stone</strong>. It&#39;s not like Martin Fowler will appear and eat our soul if we don&#39;t. We segregate data sources when we find a good reason for it.</p><p>This kind of architectures has been promoted by companies with large monolithic systems which maintenance became so hard and expensive that made them less competitive in the market. These companies needed a way to articulate different SDLC so they could reduce the time-to-market, parallelize developments, deploy new features and take&#39;em off any time, etc. At some point they found that a single database was limiting their capacity to make this possible, so they decided to split data sources too. Those were decisions driven by the strategic needs and these were driven by business goals<sup>2</sup>.</p><p>Any architectural decision must be driven by business needs which are addressed to meet the goals of the company. Some of these goals are self-evident, others are not.</p><ol start="2"><li><p><em>Developers under pressure would directly user these repositories in other services to modify data owned by other microservices.</em></p><p>Not necessarily, we can isolate repositories in several libraries and choose only those we deem necessary for each service.</p><p>In turn, we can make services connect to the data source with different profiles, each of which with different ACLs. Many of the database support RBAC. Take advantage of it.</p></li><li><p><em>It leads to duplicate code and possibly missed validations</em></p><p>It leads to code-reuse and that&#39;s good. The libraries don&#39;t have to provide us with concrete data models if they were &#34;abstracted&#34; properly. Sometimes, the only we need is an interface to implement or an abstract class to adapt. The code-reuse in repositories is not the data model, is the logic around persistence. Regarding the missing code, if that code worth reuse, it will be encapsulated in the libraries alongside with the repositories.</p></li><li><p><em>It could lead to concurrency &amp; data issues at scale.</em></p><p>Or not. Premature optimization is the seed of evil. Don&#39;t oversize the system until you have reasons for it.</p><p>The concurrency could be problematic if several services overload the data source so that the rest of the system suffers the consequences. That&#39;s a good argument for us to segregate the data source, but we have to wait until this becomes true. As for the race-condition over the data, it also happens in high decoupled MS architectures where it&#39;s even harder to deal with.</p></li></ol><blockquote><p>Are my concerns wrong?</p></blockquote><p>You are theoretically right, however, you are not being practical enough. You are not paid to implement state-of-the-art architectures, you are paid to solve problems with whatever you have at hand.</p><blockquote><p>did I miss any possible negative impacts (present/ future)?</p></blockquote><p>Yes, but they only matter if they matter.</p><p>Shared libs mean that in order to take advantage of code-reuse, other services must be implemented with the same programming language. That&#39;s quite contrary to the MS philosophy<sup>1</sup>. But it&#39;s not necessarily bad if all your developers only know that programming language.</p><p>Code-reuse also couples SDLCs since changes in the common source code might penalize the delivery strategy, hence the time-to-market. But it helps to find what services could be tightly related to each other. A signal that they could become a single service in the future.</p><p><strong>Reality vs perception</strong></p><p>Reality is all about perception. You can provide the &#34;perception&#34; of having different data sources when there&#39;s only one &#34;real&#34;. Make it real when there&#39;s a real reason to make it.</p><hr/><p><sup>1 - MS architecture is all about freedom of implementation and resilience</sup></p><p><sup>2 - Companies have goals and they set strategies (what to do) and we are asked to make them possible. Our job is the tactical one (how to do it).</sup></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-ways-to-share-dto-across-microservices/'>Architecture &#8211; Ways to share DTO across microservices</a></li><li class="list-group-item"><a href='../java-spring-boot-rest-java-microservice-why-use-maven-submodules/'>Java &#8211; Spring Boot REST Java Microservice: Why Use Maven Submodules</a></li><li class="list-group-item"><a href='../mvc-is-it-okay-to-have-one-service-with-two-different-repositories-in-spring-boot-mvc/'>Mvc &#8211; Is it okay to have one Service with two different Repositories in Spring Boot MVC</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>