<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Should a standard factory always generate a new instance &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1084483 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1084483" class="post-1084483 software type-software status-publish hentry category-software tag-design-patterns tag-factory-method tag-java"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Should a standard factory always generate a new instance</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span><span class="mr-2 badge badge-info">factory-method</span><span class="mr-2 badge badge-warning">java</span></p><div class="entry-content"><p>According to my understanding on <em>factory-method</em>, <em>factory</em> should always return a <code>new</code> instance, meaning no cache, So in essence, every time when the factory method is called, there should always be a <code>new</code> instance returned, otherwise, it would not be a factory method pattern. For instance, the following code is not a factory:</p><pre><code>public class UserManagementActionListenerFactory extends AbstractListenerFactory {
    private static final String ENABLE_USER = &#34;enableUser&#34;;
    private static final String DISABLE_USER = &#34;disableUser&#34;;
    private static final String DELETE_USER = &#34;deleteUser&#34;;
    private static final String CONVERT_USER = &#34;convertUser&#34;;
    private Map&lt;String,ActionListener&gt; mapper;
    public ActionListenerMapping() {
        mapper = registerListeners();
    }
    private Map&lt;String, ActionListener&gt; registerListeners() {
        Map&lt;String,ActionListener&gt; actionListenerMap = new HashMap&lt;&gt;();
        actionListenerMap.put(ENABLE_USER, new EnableActionListener());
        actionListenerMap.put(DISABLE_USER, new DisableActionListener());
        actionListenerMap.put(DELETE_USER, new DeleteActionListener());
        actionListenerMap.put(CONVERT_USER, new ConvertUserActionListener());
        return actionListenerMap;
    }
    @Override
    ActionListener getActionListener(String s) {
        return mapper.get(s);
    }
}
</code></pre><p>The <code>UserManagementActionListenerFactory</code> is used in a <em>bean</em> called <code>UserManagementBean</code>:</p><pre><code>public class UserManagementBean {
    AbstractActionListenerFactory factory;
    @PostConstruct
    public init() {
        factory = new UserManagementActionListenerFactory();
    }
    //... irelevant code
    public void handleActionEvent(ActionEvent e) {
        String componentId = e.getComponent().getId();
        factory.getActionListener(componentId).processAction(e);
    }
}
</code></pre><p>As this <code>ActionListenerMapper</code> initialized all the concrete subclasses of <code>ActionListener</code> when being constructed, then every time the <code>getActionListener(s)</code> is called, it always returns a cached <em>ActionListener</em> instance. <strong>Please tell here if my understanding is wrong</strong></p><p>However, in first <em>item</em> of the book <em>Effective Java</em>:</p><blockquote><p><strong>A second advantage of static factory methods is that, unlike constructors, they are not required to create a new new object each time they&#39;re invoked.</strong></p></blockquote><p>Moreover, <em>Effective Java</em> also told:</p><blockquote><p>Note that a static factory method is not the same as the <em>Factory Method</em> pattern from <em>Design Patterns</em> [Gamma95]</p></blockquote><p><strong>Question: Usually should a factory method always return a <code>new instance</code> instance?</strong></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>While the other answers properly address most of the concerns regarding the usage of a factory and the factory pattern in general, I would only like to add that your class is <strong>not necessarily a factory</strong>. That is, not until you can <strong>reason properly about why it is a factory</strong>.</p><p>A factory is not a factory because the class name ends in <code>-Factory</code>, obviously. By all means, your question and the answers already cover issues regarding the expected behavior of a factory, but just making a class that provides access to something (cached or not cached) does not make it a factory.</p><p>Based on your code (without any more context), I cannot see why a class/interface method, which receives a string and returns action listeners, would be considered a factory. I don&#39;t see any difference between your class and an identical class named <code>ActionListenerRepository</code> with a <code>getActionListenerByID(string)</code> instead of <code>getActionListener(string)</code> (or even the same). Besides, callers of the method (apparently, from your code) don&#39;t really know how, when or why the returned instances were created/added.</p><p>Patterns are good, knowing how to utilize them properly even more so, but you must not skip <strong>semantics</strong>.</p><p>So, what you should clarify is: <strong>Why is this a factory to you and your object model</strong>?</p><h1>Edit</h1><p>After the question has been edited to include a specific use-case, and after the exchange in the comments, an update is made to the answer.</p><p>Let&#39;s try to look at it from the code reviewer&#39;s perspective. Coding is all about <strong>meaning</strong> and <strong>semantics</strong>. When we write high-level code, think of it as giving instructions to someone (i.e. not to the computer). When we refer to a factory, a <strong>factory</strong> comes to mind. A factory produces things, it does not, usually, store things. It produces them. So when a reviewer sees a factory that is, in fact, a storage place, instead, the boundary is crossed between intended and expected meaning. Mixing up the two violates the principle of least astonishment, which is &#34;jargon&#34; for not getting what you expected.</p><p>What the &#34;client&#34; expects is not all that important, because it is just as easy for the client to get something from the factory and cache it themselves. But think about it in the intuitive sense. Would you request something from a factory each time you need to use it?</p><p>In short, the primary reason your factory is not a factory is that you are <strong>neither building it as such</strong>, <strong>nor using it as such</strong>. The expected usage of a factory is to:</p><ul><li><p>Request a thing <strong>every now and then</strong> (as in &#34;not every time&#34;).</p></li><li><p>Expect something new <strong>most of the time</strong>.</p></li><li><p>Keep the returned object for further use.</p></li></ul><p>Your class is used in a totally opposite way. It requests the factory&#39;s result <strong>at every use</strong>, expects the same object anyway, because who would like to get different action listeners upon each request, and does not keep them stored inside the client class.</p><h1>Last, but not least</h1><p>Because you also mentioned <strong>caching</strong>, factories are not paired with caching in the way you seem to think they are. Factories don&#39;t typically cache objects for <strong>multiple returns</strong>. Factories cache new instances for <strong>immediate returns</strong>. This means that, while the user of an application is doing other things, a factory can spawn a couple of tasks/threads that construct new instances, so that the next time a request is made, the new instance is <strong>at the ready</strong>, hence immediately returned, and, of course, (potentially forever) forgotten by the factory (unless you are doing instance counting, etc. for whatever reason).</p><p>So, caching, in the context of a factory, has a more useful meaning as having pre-constructed objects to hand out immediately, not as handing out the same objects each time. When you pass an instance reference to someone, you immediately forfeit &#34;total&#34; ownership. Now someone else can play with <strong>your</strong> object, so, I am asking you, as a factory: &#34;Are these objects <strong>yours</strong> after you give them away?&#34;</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-object-oriented-class-design/'>Java &#8211; Object-Oriented Class Design</a></li><li class="list-group-item"><a href='../mvc-factory-pattern-to-prevent-multiple-instances-for-same-object-instance-that-is-equal-good-design/'>Mvc &#8211;  factory pattern to prevent multiple instances for same object (instance that is Equal) good design</a></li><li class="list-group-item"><a href='../use-a-factory-class-instead-of-direct-object-construction/'>Use a factory class instead of direct object construction</a></li><li class="list-group-item"><a href='../object-oriented-is-it-an-anti-pattern-if-a-class-property-creates-and-returns-a-new-instance-of-a-class/'>Object-oriented &#8211; Is it an anti-pattern if a class property creates and returns a new instance of a class</a></li><li class="list-group-item"><a href='../c-strategy-vs-factory-design-pattern/'>C# &#8211; Strategy vs Factory design pattern</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>