<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; OOP: Behavior + Data, but what about &#8216;validation&#8217; behaviors &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1072559 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1072559" class="post-1072559 software type-software status-publish hentry category-software tag-object-oriented tag-validation"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; OOP: Behavior + Data, but what about &#8216;validation&#8217; behaviors</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">object-oriented</span><span class="mr-2 badge badge-info">validation</span></p><div class="entry-content"><p>EDIT: Thanks for all the great answers! In reading these responses I realized that I&#39;m approaching this from the wrong angle so I wrote a new question <a href="https://softwareengineering.stackexchange.com/questions/258355/do-objects-with-validation-logic-in-their-domain-really-represent-their-real-wor">here</a>.</p><p>I had this discussion with my superior about whether validation rules should be in the domain model or not (specifically, in the property accessors) and I tend to lean towards putting them just about anywhere else but there. In my opinion, put them in the UI and in the brokers/persistence layer.</p><p>The argument in favor of putting it in the domain is to &#39;protect the data&#39; because data is king and long after the application code has been replaced the data will still be there. And also because &#34;object oriented programming is about coupling data and behavior&#34;.</p><p>So take, for example, an object that represents a scheduled item with a StartTime and EndTime and a validation rule that says the StartTime must be before the EndTime (and the EndTime must be after the StartTime). Then while programming this you repeatedly run into issues as you realize things like:</p><ul><li><p>Shoot, I forgot StartDate/EndDate could be equal too and my code errors on half the data it tries to load from the database</p></li><li><p>Ok so apparently the StartDate has to be set before the EndDate or my EndDate validation fails. Seems odd that I can&#39;t set properties like these in any order but ok.</p></li><li><p>Or&#8230; I could add more code to check if the StartDate is null and allow the EndDate to be set to anything so long as StartDate hasn&#39;t been set yet. Ok I&#39;ll do that.</p></li><li><p>But wait, unless I force the user to use a constructor with 10 parameters I can&#39;t absolutely ensure that there won&#39;t be any uninitialized properties because my validation logic will never get hit if they don&#39;t call the properties in the first place!</p></li><li><p>Poop, I tried forcing the consumer to use ridiculously verbose constructors but now I&#39;m having serialization headaches. The DataContractSerializer that WCF uses totally ignores my constructor. I&#39;m sure there&#39;s a way around this though, I&#39;ll figure it out.</p></li><li><p>Except now I want to use Sql Sessions and by default it uses an XmlSerializer that requires a parameterless constructor.</p></li><li><p>Uh oh, bad data has been imported into the database without going through my perfectly crafted domain model. Now my domain model prevents me from displaying this invalid data to the user so I have to correct it all myself. It would be great if I could jut allow them to correct it, but my domain model doesn&#39;t know how to do anything but crash when it reads invalid data.</p></li></ul><p>So here&#39;s what I&#39;m trying to figure out: are &#39;validation rules&#39; really &#39;behaviors&#39;? Technically they are, but in regard to the idea that &#34;object oriented programming is data + behavior&#34;, does this really apply to validation?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Programming isn&#39;t an exact science (at least not yet), so you have a lot of leeway which you should use to apply common sense and do the <em>sensible</em> thing.</p><h3>Every object is responsible for itself</h3><p>There is a concept more fundamental than object-oriented programming, and this is <em>encapsulation</em>. Encapsulation could be paraphrased as “every conceptual unit is responsible for itself”, where conceptual units can be of any scale (such as libraries, classes, methods, or even simple code blocks). Encapsulation is achieved by separating inner workings and implementation details from a public interface. It is really important to carefully choose what is part of the public interface, and what should be internal.</p><p><sup>That part about methods and blocks also being eligible for encapsulation may be confusing, and I don&#39;t cover it in the rest of the post. It ends up meaning “declare variables in the narrowest possible scope, and don&#39;t use global variables”. This is <em>not</em> hypothetical. I have seen people return values from functions via global variables, and it was not pretty.</sup></p><h3>You shouldn&#39;t be able to reach invalid states</h3><p>Object oriented programming is one popular strategy to make data responsible for themselves, by combining behaviour with these data. One crucially important responsibility is maintaining data consistency. That means a properly encapsulated object cannot be brought into an invalid state via the public interface, or conversely: everything that can be done via the public interface is valid. There are a number of steps to maintain consistency:</p><ul><li>Don&#39;t allow inconsistent objects to be created in the first place. If necessary, use the builder pattern to describe temporarily inconsistent objects.</li><li>Don&#39;t allow data to be mutated in a way that makes them inconsistent.<ul><li>Suggestion: Don&#39;t allow data to be mutated, at all.</li></ul></li><li>Use static typing to prove consistency properties.</li><li>Use run-time validation to ensure consistency properties you cannot prove via the type system.</li></ul><p>Static typing may seem like a no-brainer, but it&#39;s really important. When you declare fields or properties of an object, these usually have a specific type. If a certain field must contain a string, you can&#39;t put an integer there instead. The compiler then proves that your program is consistent with this requirement. However, all type systems are inherently limited, and cannot prove all properties of your program. E.g. in many languages <code>null</code> is a value of any reference type, and the type system often can&#39;t prove that a given variable, field, or return value will always be non-<code>null</code>. Furthermore, most type system lack means to statically describe types such as “a list with at least two elements” or “a floating-point number larger than or equal to zero”.</p><p>Such requirements should be described as far as possible using static typing; anything else has to be worked around via run-time validation. This validation is still the responsibility of any conceptual unit that wants to remain consistent.</p><h3>Relaxing validation in trusted environments</h3><p>In some cases, a component is only expected to be used from another trusted component (in C++ parlance: a friend). Then, <em>defensive programming</em> suggests that each conceptual unit should still be fully encapsulated. In practice, encapsulation is often relaxed for individual components and validation is skipped for “trused” data. If done so completely, this means that you only validate at the borders of your system. That system can still be encapsulated if and only if these privileged conceptual units are <em>only</em> reachable via a validation layer. In mainstream OOP languages this is done by making anything that doesn&#39;t have validation private or package-private, depending on where the validation border is.</p><h3>Encapsulation vs. your scenario</h3><p>Now we have learned a bit about maintaining consistency. How can we apply it to the scenario you outlined in your question? The basis is some object with two fields <code>StartDate</code> and <code>EndDate</code> with the constraint <code>StartDate &lt;= EndDate</code>.</p><ul><li><blockquote><p>Shoot, I forgot StartDate/EndDate could be equal too and my code errors on half the data it tries to load from the database</p></blockquote><p>This is great!</p><ol><li>You were enforcing encapsulation.</li><li>You tested your code, which caught a mistake in your validation code. Thank God you tested it before using the code on a production database!</li></ol></li><li><blockquote><p>Ok so apparently the StartDate has to be set before the EndDate or my EndDate validation fails. Seems odd that I can&#39;t set properties like these in any order but ok.</p></blockquote><p>This sounds like a problem with your validation code and not with validation in general. How could this problem be fixed? If <code>StartDate == null</code> is an illegal state, don&#39;t allow the object to get into that state. Think about using the builder pattern, proper validation in the constructor, and proper validation in the <code>StartDate</code> setter to enforce it&#39;s non-null. You could also disallow changing <code>StartDate</code> or <code>EndDate</code> once the object has been created.</p></li><li><blockquote><p>But wait, unless I force the user to use a constructor with 10 parameters I can&#39;t absolutely ensure that there won&#39;t be any uninitialized properties because my validation logic will never get hit if they don&#39;t call the properties in the first place!</p></blockquote><ul><li>If your constructor has too many parameters, your object may be violating the Single Responsibility Principle. Otherwise, look into the builder pattern.</li><li>The constructor should always return an instance which is in a valid state. There is no excuse for doing otherwise.</li></ul></li><li><blockquote><p>Poop, I tried forcing the consumer to use ridiculously verbose constructors but now I&#39;m having serialization headaches. The DataContractSerializer that WCF uses totally ignores my constructor. I&#39;m sure there&#39;s a way around this though, I&#39;ll figure it out.</p></blockquote><p>I am not familiar with the <code>DataContractSerializer</code>, but serializers generally bypass encapsulation. A solution is not serializing the object itself, but instead a dumb record that represents permanent state (memento pattern).</p></li><li><blockquote><p>Uh oh, bad data has been imported into the database without going through my perfectly crafted domain model. Now my domain model prevents me from displaying this invalid data to the user so I have to correct it all myself. It would be great if I could jut allow them to correct it, but my domain model doesn&#39;t know how to do anything but crash when it reads invalid data.</p></blockquote><p>The database is responsible itself for maintaining its data consistency (where “consistency” is meant in a slightly broader sense than in ACID). I previously talked about relaxing validation in a trusted context. It seems that here validation was relaxed without making sure that the database could only be reached through a validation layer, and therefore an unencapsulated system was created. The invalid data should have never been stored in the DB, and the user should have never been able to enter invalid data in the first place.</p><p>Anyway, isn&#39;t it great that you run tests with invalid data?</p></li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../validating-objects-with-xsds-is-re-serializing-redundant-or-negligible/'>Validating Objects With XSDs: Is Re-Serializing Redundant or Negligible</a></li><li class="list-group-item"><a href='../c-why-is-an-anemic-domain-model-considered-bad-in-c-oop-but-very-important-in-f-fp/'>C# &#8211; Why is an anemic domain model considered bad in C#/OOP, but very important in F#/FP</a></li><li class="list-group-item"><a href='../architecture-validation-and-data-persistence-in-a-domain-model/'>Architecture &#8211; Validation and data persistence in a domain model</a></li><li class="list-group-item"><a href='../java-data-validation-separated-class-or-not/'>Java &#8211; Data validation: separated class or not</a></li><li class="list-group-item"><a href='../c-how-to-avoid-double-data-validation-in-an-application-with-web-interface/'>C# &#8211; How to avoid double data validation in an application with web interface</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>