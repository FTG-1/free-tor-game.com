<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; When and how should I use exceptions &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1065963 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1065963" class="post-1065963 software type-software status-publish hentry category-software tag-exceptions tag-python"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; When and how should I use exceptions</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">exceptions</span><span class="mr-2 badge badge-info">python</span></p><div class="entry-content"><h1>The Setting</h1><p>I often have trouble determining when and how to use exceptions. Let&#39;s consider a simple example: suppose I am scraping a webpage, say &#34;<a href="http://www.abevigoda.com/">http://www.abevigoda.com/</a>&#34;, to determine if Abe Vigoda is still alive. To do this, all we need to do is download the page and look for times that the phrase &#34;Abe Vigoda&#34; appears. We return the first appearance, since that includes Abe&#39;s status. Conceptually, it will look like this:</p><pre><code>def get_abe_status(url):
    # download the page
    page = download_page(url)

    # get all mentions of Abe Vigoda
    hits = page.find_all_mentions(&#34;Abe Vigoda&#34;)

    # parse the first hit for his status
    status = parse_abe_status(hits[0])

    # he&#39;s either alive or dead
    return status == &#34;alive&#34;
</code></pre><p>Where <code>parse_abe_status(s)</code> takes a string of the form &#34;Abe Vigoda is <em>something</em>&#34; and returns the &#34;<em>something</em>&#34; part.</p><p>Before you argue that there are much better and more robust ways of scraping this page for Abe&#39;s status, remember that this is just a simple and contrived example used to highlight a common situation I&#39;m in.</p><p>Now, where can this code encounter problems? Among other errors, some &#34;expected&#34; ones are:</p><ul><li><code>download_page</code> might not be able to download the page, and throws an <code>IOError</code>.</li><li>The URL might not point to the right page, or the page is downloaded incorrectly, and so there are no hits. <code>hits</code> is the empty list, then.</li><li>The web page has been altered, possibly making our assumptions about the page wrong. Maybe we expect 4 mentions of Abe Vigoda, but now we find 5.</li><li>For some reasons, <code>hits[0]</code> might not be a string of the form &#34;Abe Vigoda is <em>something</em>&#34;, and so it cannot be correctly parsed.</li></ul><p>The first case isn&#39;t really a problem for me: an <code>IOError</code> is thrown and can be handled by the caller of my function. So let&#39;s consider the other cases and how I might handle them. But first, let&#39;s assume that we implement <code>parse_abe_status</code> in the stupidest way possible:</p><pre><code>def parse_abe_status(s):
    return s[13:]
</code></pre><p>Namely, it doesn&#39;t do any error checking. Now, on to the options:</p><h2>Option 1: Return <code>None</code></h2><p>I can tell the caller that something went wrong by returning <code>None</code>:</p><pre><code>def get_abe_status(url):
    # download the page
    page = download_page(url)

    # get all mentions of Abe Vigoda
    hits = page.find_all_mentions(&#34;Abe Vigoda&#34;)

    if not hits:
        return None

    # parse the first hit for his status
    status = parse_abe_status(hits[0])

    # he&#39;s either alive or dead
    return status == &#34;alive&#34;
</code></pre><p>If the caller receives <code>None</code> from my function, he should assume that there were no mentions of Abe Vigoda, and so <em>something</em> went wrong. But this is pretty vague, right? And it doesn&#39;t help the case where <code>hits[0]</code> isn&#39;t what we thought it was.</p><p>On the other hand, we can put in some exceptions:</p><h2>Option 2: Using Exceptions</h2><p>If <code>hits</code> is empty, an <code>IndexError</code> will be thrown when we attempt <code>hits[0]</code>. But the caller shouldn&#39;t be expected to handle an <code>IndexError</code> thrown by my function, since he has no idea where that <code>IndexError</code> came from; it could have been thrown by <code>find_all_mentions</code>, for all he knows. So we&#39;ll create a custom exception class to handle this:</p><pre><code>class NotFoundError(Exception):
    &#34;&#34;&#34;Throw this when something can&#39;t be found on a page.&#34;&#34;&#34;

def get_abe_status(url):
    # download the page
    page = download_page(url)

    # get all mentions of Abe Vigoda
    hits = page.find_all_mentions(&#34;Abe Vigoda&#34;)

    try:
        hits[0]
    except IndexError:
        raise NotFoundError(&#34;No mentions found.&#34;)

    # parse the first hit for his status
    status = parse_abe_status(hits[0])

    # he&#39;s either alive or dead
    return status == &#34;alive&#34;
</code></pre><p>Now what if the page has changed and there are an unexpected number of hits? This isn&#39;t catastrophic, as the code may still work, but a caller might want to be <em>extra</em> careful, or he might want to log a warning. So I&#39;ll throw a warning:</p><pre><code>class NotFoundError(Exception):
    &#34;&#34;&#34;Throw this when something can&#39;t be found on a page.&#34;&#34;&#34;

def get_abe_status(url):
    # download the page
    page = download_page(url)

    # get all mentions of Abe Vigoda
    hits = page.find_all_mentions(&#34;Abe Vigoda&#34;)

    try:
        hits[0]
    except IndexError:
        raise NotFoundError(&#34;No mentions found.&#34;)

    # say we expect four hits...
    if len(hits) != 4:
        raise Warning(&#34;An unexpected number of hits.&#34;)
        logger.warning(&#34;An unexpected number of hits.&#34;)

    # parse the first hit for his status
    status = parse_abe_status(hits[0])

    # he&#39;s either alive or dead
    return status == &#34;alive&#34;
</code></pre><p>Lastly, we might find that <code>status</code> isn&#39;t either alive or dead. Maybe, for some odd reason, today it turned out to be <code>comatose</code>. Then I don&#39;t want to return <code>False</code>, as that implies that Abe is dead. What should I do here? Throw an exception, probably. But what kind? Should I create a custom exception class?</p><pre><code>class NotFoundError(Exception):
    &#34;&#34;&#34;Throw this when something can&#39;t be found on a page.&#34;&#34;&#34;

def get_abe_status(url):
    # download the page
    page = download_page(url)

    # get all mentions of Abe Vigoda
    hits = page.find_all_mentions(&#34;Abe Vigoda&#34;)

    try:
        hits[0]
    except IndexError:
        raise NotFoundError(&#34;No mentions found.&#34;)

    # say we expect four hits...
    if len(hits) != 4:
        raise Warning(&#34;An unexpected number of hits.&#34;)
        logger.warning(&#34;An unexpected number of hits.&#34;)

    # parse the first hit for his status
    status = parse_abe_status(hits[0])

    if status not in [&#39;alive&#39;, &#39;dead&#39;]:
        raise SomeTypeOfError(&#34;Status is an unexpected value.&#34;)

    # he&#39;s either alive or dead
    return status == &#34;alive&#34;
</code></pre><h2>Option 3: Somewhere in between</h2><p>I think that the second method, with exceptions, is preferable, but I&#39;m not sure if I&#39;m using exceptions correctly within it. I&#39;m curious to see how more experienced programmers would handle this.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The recommendation in Python is to use exceptions to indicate failure. This is true even if you expect failure on a regular basis.</p><p>Look at it from the perspective of the caller of your code:</p><pre><code>my_status = get_abe_status(my_url)
</code></pre><p>What if we return None? If the caller doesn&#39;t specifically handle the case that get_abe_status failed, it will simply try to continue on with my_stats being None. That may produce a difficult to diagnose bug later on. Even if you do check for None, this code has no clue why get_abe_status() failed.</p><p>But what if we raise an exception? If the caller doesn&#39;t specifically handle the case, the exception will propagate upward eventually hitting the default exception handler. That may not be the what you want, but its better then introducing a subtle bug elsewhere in the program. Additionally, the exception gives information about what went wrong which is lost in the first version.</p><p>From the caller&#39;s perspective, its simply more convenient to get an exception than a return value. And that&#39;s the python style, to use exceptions to indicate failure conditions not return values.</p><p>Some will take a different perspective and argue that you should only use exceptions for cases you never really expect to happen. They argue that normally running running could should not raise any exceptions. One reason that is given for this is that exceptions are grossly inefficient, but that&#39;s not actually true for Python.</p><p>A couple of points on your code:</p><pre><code>try:
    hits[0]
except IndexError:
    raise NotFoundError(&#34;No mentions found.&#34;)
</code></pre><p>That&#39;s a really confusing way to check for an empty list. Don&#39;t induce an exception just to check something. Use an if.</p><pre><code># say we expect four hits...
if len(hits) != 4:
    raise Warning(&#34;An unexpected number of hits.&#34;)
    logger.warning(&#34;An unexpected number of hits.&#34;)
</code></pre><p>You do realize that the logger.warning line will never run right?</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../when-to-use-assertions-and-when-to-use-exceptions/'>When to use assertions and when to use exceptions</a></li><li class="list-group-item"><a href='../checked-vs-unchecked-vs-no-exception-a-best-practice-of-contrary-beliefs/'>Checked vs Unchecked vs No Exception&#8230; A best practice of contrary beliefs</a></li><li class="list-group-item"><a href='../c-why-are-exception-specifications-bad/'>C++ &#8211; Why are exception specifications bad</a></li><li class="list-group-item"><a href='../using-a-try-finally-without-catch-vs-enum-state-validation/'>Using a try-finally (without catch) vs enum-state validation</a></li><li class="list-group-item"><a href='../c-exception-hierarchy-and-use-of-what-message-for-parsing-strings/'>C++ &#8211; Exception Hierarchy and Use of What Message for Parsing Strings</a></li><li class="list-group-item"><a href='../c-augment-a-thrown-exception-with-some-contextual-information/'>C++ &#8211; Augment a thrown exception with some contextual information</a></li><li class="list-group-item"><a href='../python-are-exceptions-for-flow-control-best-practice-in-python/'>Python &#8211; Are exceptions for flow control best practice in Python</a></li><li class="list-group-item"><a href='../c-mapping-exceptions-to-error-response/'>C# &#8211; Mapping exceptions to error response</a></li><li class="list-group-item"><a href='../c-exceptions-error-codes-and-discriminated-unions/'>C# &#8211; Exceptions, error codes and discriminated unions</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>