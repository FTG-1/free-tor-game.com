<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; Relations between entities in DDD &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1081138 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1081138" class="post-1081138 software type-software status-publish hentry category-software tag-domain-driven-design tag-object-oriented tag-php"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; Relations between entities in DDD</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">domain-driven-design</span><span class="mr-2 badge badge-info">object-oriented</span><span class="mr-2 badge badge-warning">PHP</span></p><div class="entry-content"><p>I am a beginner on DDD, working around small, simple domains in order to get my head on all the principles of design.</p><p>I have this simple domain: institutions (<code>Institution</code>) and their available WiFi spots (<code>Place</code>) are kept in the database. No place can exist without an institution. Institution has manager user &#8211; assignee (<code>User</code>), which has the right to add new places, reallocate or delete existing ones.</p><p><a href="https://github.com/andrius-kulbis/ddd-playground" rel="nofollow">Code can be found here</a>. The validation on value objects is left behind for now.</p><p>This is influenced by <a href="http://verraes.net/2013/12/related-entities-vs-child-entities/" rel="nofollow">Mathias Verraes on child entities</a>.</p><p>Is it a correct DDD design? or at least close to it?</p><p>While being a data-centric programmer, I still wonder how would I list all the places for all the Institutions, if the rule of thumb is accessing aggregates through the aggregate root?</p><p>Is the idea of generating <code>Uuid</code> inside of the entity itself (<code>Place::create</code>) good?</p><p>Should an idea, that only assignee (<code>User</code>) can add/remove places be expressed on the domain itself or should it be the responsibility of client? In this case it would be wise if the assignee would know about his managed institution (<code>institutionId</code> in <code>User</code>?).</p><p>Isn&#39;t the <code>Institution::placeById</code> breaking any principles of DDD? Maybe it is the responsibility of the repository?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Is it a correct DDD design? or at least close to it?</p></blockquote><p>It seems ok, though I find the naming &#34;places&#34; as WiFi spots a bit confusing.</p><blockquote><p>While being a data-centric programmer, I still wonder how would I list all the places for all the Institutions, if the rule of thumb is accessing aggregates through the aggregate root?</p></blockquote><p>You have to go thru the aggregate root to get its list of places, e.g. <code>getPlaces()</code>.  You may use the returned places for the duration of the current transaction or inquiry, and, in the next transaction or inquiry, start over from the aggregate root to reach the tasks.</p><blockquote><p>Is the idea of generating Uuid inside of the entity itself (Place::create) good?</p></blockquote><p>Not especially.  While a UUID is appropriate for aggregate roots, it is not really appropriate for child aggregates (i.e. not roots).</p><p>As you can see in the example you&#39;re citing, the child aggregates use a simple counter mechanism for their id&#39;s instead of a UUID.  This counter is per-aggregate root, which is to say that one aggregate root&#39;s child id entries are allowed to overlap with another aggregate root&#39;s child id&#39;s.</p><p>In essence, this demands that for long term capture, a must client (also) captures the aggregate root id, and, the implementation doesn&#39;t have to generate UUID&#39;s for the various child entities.</p><blockquote><p>Should an idea, that only assignee (User) can add/remove places be expressed on the domain itself or should it be the responsibility of client?</p></blockquote><p>No, generally speaking business logic like this should be validated in the domain itself and not left (solely) to the client.</p><blockquote><p>Isn&#39;t the Institution::placeById breaking any principles of DDD? Maybe it is the responsibility of the repository?</p></blockquote><p>The responsibility of the repository is to provide persistence for the domain model.  So, there is some responsibility there regarding storing of places of institutions.  However, ideally, the client speaks with the domain and not the domain&#39;s repository directly as its repository is implementation detail private to the domain.</p><p>Repositories tend to be fairly primitive and the idea is that we try to layer things. The domain provides a business layer that is a wrapper around the more primitive persistence layer.</p><p>Each layer should provide the next programmer (its client) with a coherent, usable, safe, and complete abstraction.  When we do this, coupling is reduced, and maintainability is enhanced.  Using a layered design, it is a negative indication when a client reaches around our abstraction and touches underlying implementation (lower layers) directly -- this indicates the abstraction is incomplete, and, the client is inappropriately using knowledge of the implementation details of the layer providing the abstraction.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-applying-ddd-to-a-simple-app-with-a-configuration-twist/'>Php &#8211; Applying DDD to a simple app with a configuration twist</a></li><li class="list-group-item"><a href='../domain-driven-design-with-eventual-consistency/'>Domain driven design with eventual consistency</a></li><li class="list-group-item"><a href='../php-persisting-large-complex-entities-with-the-command-pattern-am-i-doing-it-right/'>Php &#8211; Persisting Large/Complex Entities with the Command Pattern &#8212; Am I doing it right</a></li><li class="list-group-item"><a href='../in-ddd-how-to-persist-an-aggregate-containing-polymorphism/'>In DDD, how to persist an aggregate containing polymorphism</a></li><li class="list-group-item"><a href='../applying-ddd-is-having-multiple-aggregates-representing-the-same-concept-from-a-different-view-a-good-idea/'>Applying DDD, is having multiple aggregates representing the same concept from a different view a good idea</a></li><li class="list-group-item"><a href='../sqlalchethe-and-ddd-its-own-pattern/'>SQLAlchethe and DDD: It&#8217;s own pattern</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>