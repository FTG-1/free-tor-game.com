<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Does a constructor that validates its arguments violate SRP &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066405 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066405" class="post-1066405 software type-software status-publish hentry category-software tag-c tag-single-responsibility"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Does a constructor that validates its arguments violate SRP</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">single-responsibility</span></p><div class="entry-content"><p>I am trying to adhere to the Single Responsibility Principle (SRP) as much as possible and got used to a certain pattern (for the SRP on methods) heavily relying on delegates. I&#39;d like to know if this approach is sound or if there are any severe issues with it.</p><p>For example, to check input to a constructor, I could introduce the following method (the <code>Stream</code> input is random, could be anything)</p><pre><code>private void CheckInput(Stream stream)
{
    if(stream == null)
    {
        throw new ArgumentNullException();
    }

    if(!stream.CanWrite)
    {
        throw new ArgumentException();
    }
}
</code></pre><p>This method (arguably) does more than one thing</p><ul><li>Check the inputs</li><li>Throw different exceptions</li></ul><p>To adhere to the SRP I therefore changed the logic to</p><pre><code>private void CheckInput(Stream stream, 
                        params (Predicate&lt;Stream&gt; predicate, Action action)[] inputCheckers)
{
    foreach(var inputChecker in inputCheckers)
    {
        if(inputChecker.predicate(stream))
        {
            inputChecker.action();
        }
    }
}
</code></pre><p>Which supposedly only does one thing (does it?): Check the input. For the actual checking of the inputs and throwing of the exceptions I have introduced methods like</p><pre><code>bool StreamIsNull(Stream s)
{
    return s == null;
}

bool StreamIsReadonly(Stream s)
{
    return !s.CanWrite;
}

void Throw&lt;TException&gt;() where TException : Exception, new()
{
    throw new TException();
}
</code></pre><p>and can call <code>CheckInput</code> like</p><pre><code>CheckInput(stream,
    (this.StreamIsNull, this.Throw&lt;ArgumentNullException&gt;),
    (this.StreamIsReadonly, this.Throw&lt;ArgumentException&gt;))
</code></pre><p>Is this any better than the first option at all, or do I introduce unneccesary complexity? Is there any way I can still improve this pattern, if it&#39;s viable at all?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p><strong>SRP is perhaps the most misunderstood software principle.</strong></p><p>A software application is built from modules, which are built from modules, which are built from...</p><p>At the bottom, a single function such as <code>CheckInput</code> will only contain a tiny bit of logic, but as you go upward, each successive module encapsulates more and more logic <em>and this is normal</em>.</p><p>SRP is not about doing a single <em>atomic</em> action. It&#39;s about having a single responsibility, even if that responsibility requires multiple actions... and ultimately it&#39;s about <em>maintenance</em> and <em>testability</em>:</p><ul><li>it promotes encapsulation (avoiding God Objects),</li><li>it promotes separation of concerns (avoiding rippling changes through the whole codebase),</li><li>it helps testability by narrowing the scope of responsibilities.</li></ul><hr/><p>The fact that <code>CheckInput</code> is implemented with two checks and raise two different exceptions is <strong>irrelevant</strong> to some extent.</p><p><code>CheckInput</code> has a narrow responsibility: ensuring that the input complies with the requirements. Yes, there are multiple requirements, but this does not mean there are multiple responsibilities. Yes, you could split the checks, but how would that help? At some point the checks must be listed in some way.</p><p>Let&#39;s compare:</p><pre><code>Constructor(Stream stream) {
    CheckInput(stream);
    // ...
}
</code></pre><p>versus:</p><pre><code>Constructor(Stream stream) {
    CheckInput(stream,
        (this.StreamIsNull, this.Throw&lt;ArgumentNullException&gt;),
        (this.StreamIsReadonly, this.Throw&lt;ArgumentException&gt;));
    // ...
}
</code></pre><p>Now, <code>CheckInput</code> does less... but its caller does more!</p><p>You have shifted the list of requirements from <code>CheckInput</code>, where they are encapsulated, to <code>Constructor</code> where they are visible.</p><p>Is it a good change? It depends:</p><ul><li>If <code>CheckInput</code> is only called there: it&#39;s debatable, on the one hand it makes the requirements visible, on the other hand it clutters the code;</li><li>If <code>CheckInput</code> is called multiple times <em>with the same requirements</em>, then it violates DRY and you have an encapsulation issue.</li></ul><hr/><p>It&#39;s important to realize that a single responsibility may imply a <em>lot</em> of work. The &#34;brain&#34; of a self-driving car has a single responsibility:</p><blockquote><p>Driving the car to its destination.</p></blockquote><p>It is a single responsibility, but requires coordinating a ton of sensors and actors, taking lots of decision, and even has possibly conflicting requirements<sup>1</sup>...</p><p>... however, it&#39;s all encapsulated. So the client doesn&#39;t care.</p><p><sup>1</sup> <em>safety of the passengers, safety of others, respect of regulations, ...</em></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/c-the-most-elegant-way-to-write-a-try-method-in-c-7/'>C# &#8211;  the most elegant way to write a &#8220;Try&#8221; method in C# 7</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-why-is-it-bad-to-use-exceptions-for-handling-this-type-of-validation-it-seems-like-it-makes-the-code-so-much-cleaner/'>C# &#8211; Why is it bad to use exceptions for handling this type of validation? It seems like it makes the code so much cleaner</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/does-logging-inside-a-class-violate-the-srp/'>Does logging inside a class violate the SRP</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>