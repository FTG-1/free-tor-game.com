<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; Whether to embed linked resources in REST API &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075240 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075240" class="post-1075240 software type-software status-publish hentry category-software tag-json tag-rest tag-web-api"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; Whether to embed linked resources in REST API</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">json</span><span class="mr-2 badge badge-info">rest</span><span class="mr-2 badge badge-warning">web-api</span></p><div class="entry-content"><p>I am building a REST API where clients can query user-sent messages, like this:</p><pre><code>GET http://example.com/api/v1/messages?from=0&amp;to=100
</code></pre><p>Response:</p><pre><code>[
    {
        &#34;id&#34;: 12345,
        &#34;text&#34;: &#34;Hello, world!&#34;
    },
    {
        &#34;id&#34;: 12346,
        &#34;text&#34;: &#34;Testing, testing&#34;
    },
    ...
]
</code></pre><p>Now, I need to include the name of the user who sent the message. I can think of 4 ways to store this information, but I can&#39;t decide which is best:</p><p><strong>Option 1:</strong></p><pre><code>[
    {
        &#34;id&#34;: 12345,
        &#34;sender_id&#34;: 16,
        &#34;text&#34;: &#34;Hello, world!&#34;
    }
]
</code></pre><p>This method is the most efficient for large scale &#8211; if the client queries the API many times, they can cache a map of user ID to name and reuse that. However, for one-off queries, it doubles the amount of API calls that the client would have to perform (once for the message list, and another to find the name for a given user ID).</p><p><strong>Option 2:</strong></p><pre><code>[
    {
        &#34;id&#34;: 12345,
        &#34;sender_name&#34;: &#34;John Smith&#34;,
        &#34;text&#34;: &#34;Hello, world!&#34;
    }
]
</code></pre><p>This method is simplest for client consumption, but if the API ever needs to be changed to include the sender ID (e.g. for linking from message to user), I would need to have two &#34;sender&#34; fields in the message object, <code>sender_id</code> and <code>sender_name</code>, which is essentially a worse version of option 3.</p><p><strong>Option 3:</strong></p><pre><code>[
    {
        &#34;id&#34;: 12345,
        &#34;sender&#34;: {
            &#34;id&#34;: 16,
            &#34;name&#34;: &#34;John Smith&#34;
        },
        &#34;text&#34;: &#34;Hello, world!&#34;
    }
]
</code></pre><p>This approach embeds the sender object into each message, which makes it future-proof and only requires a single API call per query. However, it adds a lot of redundant information if there are many messages and few users (for example, querying all the messages sent by a single user).</p><p><strong>Option 4:</strong></p><pre><code>{
    &#34;users&#34;: [
        {
            &#34;id&#34;: 16,
            &#34;name&#34;: &#34;John Smith&#34;
        },
        ...
    ],
    &#34;messages&#34;: [
        {
            &#34;id&#34;: 12345,
            &#34;sender_id&#34;: 16,
            &#34;text&#34;: &#34;Hello, world!&#34;
        }
    ]
}
</code></pre><p>This solves the redundancy problem with #3, but it adds a lot of complexity to the structure of the response object.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You should probably go for option 1, but made more RESTful.  It may also make sense to provide something like option 3/4.  There&#39;s nothing forcing you to pick only one.</p><p>However, what you should do is replace ids with <em>links</em>.  Instead of having a &#34;sender_id&#34;, you should just have a URI <em>pointing</em> at that user resource.  Notice how this means I don&#39;t need to know what URI to append the &#34;sender_id&#34; to or how to format it.  Unfortunately, JSON does not have a type for links.  You will want to look at <a href="http://sookocheff.com/post/api/on-choosing-a-hypermedia-format/" rel="nofollow">hypermedia formats embedded in JSON</a>, e.g. HAL or JSON-LD.</p><p>Now you are right that if I want to fetch the record, I need to make two requests.  The good news though, is those requests will be cached by the <em>normal</em> mechanisms of HTTP.  A content delivery network can even cache resources across users reducing load on your servers and latency for the users.  Of course, I&#39;m not precluded from having a resource that returns all the users or the data for all the users given a list of user URIs so that I can batch requests.  You could consider <a href="http://www.odata.org/" rel="nofollow">OData</a> as a organized means of providing such query capabilities, but you can certainly do something simpler.  For example, when returning the messages, you could also add a link to, say, &#34;recent contacts&#34; that has the expanded data for all the users in the current list of messages.  Notice how I say provide a link and not add a <code>messages/users/</code> resource.  You may well add such a resource, but I shouldn&#39;t need to know your URI structure to find it.  This makes it easier for me and allows you to change your URIs in the future without breaking consumers.</p><p>Sometimes there will be transactional guarantees you&#39;ll want to enforce.  For example, in the above, I could get the messages, then request the recent contacts, and that list may differ from the list of sender URIs I have in the messages due to a race condition.  In cases where it is important to guarantee that kind of atomicity, you should embed the resources.  Some of the hypermedia formats I referenced above provide a mechanism for that.  Usually, these situations will naturally correspond to a new resource.  Remember, you do <em>not</em> need a 1-1 correspondence between resources and &#34;entities&#34; or whatever.  In fact, such a 1-1 correspondence probably means you are doing something wrong.  Overall, though, you should try to minimize points that need such transactional guarantees.  In the above example, it would be unnecessary, since even if a sender was missing from that list of &#34;recent contacts&#34;, I could just request their information individually.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-query-language-for-json/'>Java &#8211; Query language for JSON</a></li><li class="list-group-item"><a href='../database-faster-using-rest-api-or-querying-a-database-directly/'>Database &#8211;  faster? Using REST API or querying a database directly</a></li><li class="list-group-item"><a href='../consuming-external-apis-within-the-microservice-architecture/'>Consuming external APIs within the microservice architecture</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>