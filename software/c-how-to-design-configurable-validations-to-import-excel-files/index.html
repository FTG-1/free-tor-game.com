<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; How to design configurable validations to import Excel files &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087721 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087721" class="post-1087721 software type-software status-publish hentry category-software tag-c tag-design-patterns tag-multithreading"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; How to design configurable validations to import Excel files</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">multithreading</span></p><div class="entry-content"><p>I have a requirement where I need to validate excel file before importing into application. Excel file will have around 15-20 defined columns. And we are having around 200-250 rules to validate the excel file.</p><p>Right now, one windows service is there, which is scanning the directories to process this excel files. windows service can process multiple files using multi threads. But single file will be validated row by row only. Currently validations has been written in single class using methods.</p><p>It is working fine so far but now we are getting requirement changes in rules and validations and I want to make rules and validation configurable and more manageable.</p><p>Examples of Rules:</p><ol><li>There should not be a Empty Values.</li><li>Check Max and Min Length</li><li>Date formats</li><li>If value present in one column, other related columns value should be empty.</li></ol><p>My questions are:</p><ol><li>How to Make Rules and Validation Configurable? I&#39;ve checked Enterprise Library Validation Block. Which could be used using XML configuration. But I feel it will not be maintainable going ahead.</li><li>How to make Rules and Validation Turn On and Off on the fly without changing and code and compilation? I want to achieve design somewhat like SonarQube Rules and Validation.</li><li>Right now, using multi threading multiple files are being processed. Is it Ok to process single file records parallel as well? I don&#39;t think it will increase the performance as all thread being used for processing multiple files.</li><li>Any design pattern for such kind of problem? I think Rules Pattern along with Pipeline kind of design could be used.</li></ol></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The &#34;pattern&#34; you are asking for is called <a href="https://en.wikipedia.org/wiki/Domain-specific_language" rel="nofollow noreferrer">Domain Specific Language (DSL)</a>. Designing your own &#34;language&#34; for this type of problem, and an interpreter, can be simpler than it looks at a first glance.</p><p>Your rule language might be just a list of textual commands, stored in an excel sheet as well, where each row represents one rule, and the sheet has some columns like <code>Active</code>, <code>Range</code>, <code>Rule type</code>, <code>Parameters</code>.</p><ul><li><code>Active</code> is simply a column to control if the rule is turned on or off</li><li><code>Range</code> should describe to which part of the input file the rule shall apply. Invent a description for the ranges you need to support, like a specific column, a specific set of rows, all cells in the table, all cells in the table except a header row, whatever you need for your use case</li><li><code>RuleType</code> needs to contain a keyword for the type of rule like <code>NotEmpty</code>, <code>MaxLength</code>, <code>MinLength</code>, <code>DateFormat</code>, <code>IsEmptyIfOtherColumnIsNotEmpty</code></li><li><code>Parameters</code> contains the additional parameters like the allowed min/max length, or a format string for the date, or the depending column names.</li></ul><p>If you try this out, you might be astonished how far this can get you. I implemented something similar very successfully at least two times, once for a processing language, and once for a validation language.</p><p>Since this should basically answer your questions 1,2 and 4, one additional word about 3: don&#39;t prematurely optimize with no need and no measurement. Sure you can try this, but why? Your program will still have to read each Excel file sequentially, and it will to log the outcome of the validation somewhere. These are I/O bound processes which cannot be parallelized. So processing of multiple rows in parallel might only bring you benefit if the rule processing itself will be the bottleneck and turns out to be much slower than the I/O, and if you have unused CPU cores available. So measure this first, and then think about this optimization, not the other way round.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-how-many-threads-should-access-the-file-system-at-the-same-time/'>Java &#8211; How many threads should access the file system at the same time</a></li><li class="list-group-item"><a href='../c-best-way-of-validating-class-properties/'>C# &#8211; Best way of validating Class properties</a></li><li class="list-group-item"><a href='../a-good-design-pattern-for-generating-an-excel-xlsx-file-in-code/'>A good design pattern for generating an Excel (xlsx) file in code</a></li><li class="list-group-item"><a href='../c-sql-query-or-c-net-code-for-csv-files-import/'>C# &#8211; SQL query or C# .net code for csv files import</a></li><li class="list-group-item"><a href='../c-multi-level-validation-in-c/'>C# &#8211; Multi-level validation in C#</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>