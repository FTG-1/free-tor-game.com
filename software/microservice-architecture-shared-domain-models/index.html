<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Microservice architecture shared domain models &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068532 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068532" class="post-1068532 software type-software status-publish hentry category-software tag-microservices tag-spring"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Microservice architecture shared domain models</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">microservices</span><span class="mr-2 badge badge-info">spring</span></p><div class="entry-content"><p>Lets assume that we have a Spring Boot application that uses microservices architecture. Each of the services has its own domain models, but each service must reference a User domain object. What would be the best approach on how to solve this issue? Would it be better for each service to just have a userId and then, when needed, ask user service for user details, or would it be better to have a shared domain library for all microservices?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>If you did go for microservices to benefit from scalability, loose coupling, and easy independent modification of each service, the you should stick to it to the maximum possible extent.</p><p><strong>Overall architecture</strong></p><p>I think that the best approach would be:</p><ul><li>have a microservice for general user information management;</li><li>keep microservice specific user information (e.g. profiles, authorizations, preferences) in each microservice (using the referene of the general id)</li></ul><p>Additional reading:</p><ul><li><a href="https://blog.andyet.com/2015/05/12/micro-services-user-info-and-auth/" rel="noreferrer">This article</a> describes very well this kind of architecture and rationale, with the specific case of authorizations.</li><li><a href="http://nordicapis.com/how-to-control-user-identity-within-microservices/" rel="noreferrer">This article</a> describes challenges and solution for user identity management, to avoid all the services to access to the same repository.</li><li><a href="https://medium.facilelogin.com/securing-microservices-with-oauth-2-0-jwt-and-xacml-d03770a9a838#.3rs9klh2i" rel="noreferrer">This article</a> describes ho to use JWT to pass the identity of the user between the services (noting that some basic information can be provided in the id token, which avoids having to query the user service one more after the login, at least for very basic information).</li></ul><p><strong>Code sharing</strong></p><p>Now if you agree on the solution above, we have a user microservice (encapsulating domain model for user) and all other services are consumers of the same microservice. The question is then to know if you want:</p><ul><li>either each microservice to reinvent the consumer code, following the dogma of strong separation for allowing flexible and distinct release cycles,</li><li>or to share the consumer code as part of the library, considering that this fundamental information is an extension  of the <a href="http://microservices.io/patterns/microservice-chassis.html" rel="noreferrer">&#34;chassis&#34; infrastructure pattern</a>.</li></ul><p>I will not take a clear cut position on that, as there are opinatered opinion wars on this code sharing topic, and I don&#39;t think that I&#39;m in a position to take an objective position.  Here is already some additional reading:</p><ul><li><a href="http://www.simplicityitself.io/our team/2015/01/12/sharing-code-between-microservices.html" rel="noreferrer">This article</a> thinks there is no best solution, and it all depends on your objectives</li><li><a href="http://www.grahamlea.com/2016/04/shared-libraries-in-microservices-bad-advice/" rel="noreferrer">This article</a> position is that code sharing is bad only if it creates a strong coupling, and code sharing can bring some synergies</li><li><a href="https://www.nginx.com/blog/microservices-at-netflix-architectural-best-practices/" rel="noreferrer">This article</a> (of people who implemented microservices at scale) insist on the necessity to have separate builds, and the potential decommission issues of older code. Having a shared library for <strong>consuming</strong> with solid version management does not prevent these good practices.</li></ul><p>My own opinion on that is that you SHOULD NOT SHARE code between the user-provider and the user-consumers, in order to avoid a tight coupling. However you COULD SHARE the user-consumption code between consumers if you have a strong version management in place.  This approach would have some advantages:</p><ul><li>Different user-consuming microservices could be build with different versions of the shared user-consumption code (as long as the versions are compatible with the independent user-provider).  Same flexibility that reinventing the wheel but higher productivity.</li><li>You could change your user-provider service independently without impact on the consumers.</li><li>If a bug is found on consumption side, you could correct it once and deploy all the consumers as best suits (thanks to version management).  THis could even lead to a higher quality of service.</li><li>If for a reason you are obliged to update the user-provider API, you could deploy the updated user-consumption more quiclkly.  It you keep old and new provider service active during the transition, this sharing possibility could allow to decommission more rapidly the older version of the consumer-provider.</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/architecture-shared-domain-model-between-different-microservices/'>Architecture &#8211; Shared domain model between different microservices</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/java-is-it-a-good-idea-to-use-a-spring-mvc-as-an-frontend-of-a-microservice-architecture/'>Java &#8211; Is it a good idea to use a Spring MVC as an Frontend of a Microservice Architecture</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/java-microservices-architecture-separating-backend-and-front-end/'>Java &#8211; Microservices Architecture separating backend and front end</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/architecture-shared-database-into-micros-services-architecture/'>Architecture &#8211; Shared database into micros services architecture</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/python-how-to-create-a-python-microservice-on-aws-that-both-accepts-rest-connections-and-processes-sqs-messages/'>Python &#8211; How to create a Python microservice on AWS that both accepts REST connections and processes SQS messages</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/architecture-data-replication-in-microservices/'>Architecture &#8211; Data replication in microservices</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>