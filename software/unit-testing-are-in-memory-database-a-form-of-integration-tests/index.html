<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Unit-testing &#8211; Are in-memory database a form of integration tests &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1085675 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1085675" class="post-1085675 software type-software status-publish hentry category-software tag-efcore tag-integration-tests tag-mocking tag-unit-testing tag-xunit"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Unit-testing &#8211; Are in-memory database a form of integration tests</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">efcore</span><span class="mr-2 badge badge-info">integration-tests</span><span class="mr-2 badge badge-warning">mocking</span><span class="mr-2 badge badge-primary">unit testing</span><span class="mr-2 badge badge-danger">xunit</span></p><div class="entry-content"><p>I have looked through most of the answers given regarding using in-memory database for unit test, but I could not find one that was clear to me.</p><p>I am writing some unit tests to cover some of our codebase. The codebase is written in ASP.NET Core and EF Core. I am using xUnit and Moq.</p><p>I have read and understood the concept of unit test vs integration tests.</p><p>As I understand, writing unit tests means testing a code in isolation from other dependencies and to achieve this, we can mock those dependencies so we can test the code only.</p><p>However, I found that it is a bit more work setting up mock of dependencies that I need especially if these dependencies are repository dependencies.</p><p>When I tried using an in-memory database, all I need to do was setup the in-memory database, seed the database, create a test fixture and it works. And in subsequent test, all I have to do is create the dependencies and it works just fine.</p><p>To mock the repository, I have to setup a mock and return value. And then there is the complexity of mocking an async repository as explained here: <a href="https://stackoverflow.com/questions/40476233/how-to-mock-an-async-repository-with-entity-framework-core">How to mock an async repository with Entity Framework Core</a>. For each test, I have to mock the repository that is needed which means more work.</p><p>With all these in mind, would it be better if I just ditch mocking and use in-memory database? Also, would this not be seen as integration testing though it&#39;s an in-memory database.</p><p>I created two different tests using the in-memory database and mocking..<br /> &#8211; The in-memory database tests understandably took more time, but the difference is usually about 1sec longer than the tests using mocks.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>IMHO you are asking the wrong question. It does not matter if what you create is called a unit test by some people, or an integration test by others. What matters is here,</p><ul><li><p>is this test <strong>useful</strong> for your case (so will it help you to avoid certain defects, and will it suffciently reduce the area in code where the root cause of a certain defect may be)?</p></li><li><p>is it <strong>fast enough</strong>, even when you are going to run several tests of this kind? (1sec longer does not sound much, but when the original test required 0.001 seconds, and the new one requires 1.001 seconds, running 5000 tests of this kind will make a notable difference)</p></li><li><p>is it <strong>maintainable</strong>? Ideally more maintainable than alternative approaches? This depends heavily on the tooling and how good an &#34;in-memory DB&#34; is supported.</p></li></ul><p>If you can answer all of these questions honestly with &#34;yes&#34;, then go ahead.</p><p>Recommended: <a href="http://www.agitar.com/downloads/TheWayOfTestivus.pdf" rel="noreferrer">The Way of Testivus</a> - which tells you, for example, to follow less dogma (which is a good recommendation not just for testing).</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-need-unit-tests-for-testing-repository-methods/'>Unit-testing &#8211;  need unit tests for testing repository methods</a></li><li class="list-group-item"><a href='../unit-testing-are-integration-tests-meant-to-be-redundant/'>Unit-testing &#8211; Are Integration Tests Meant to be Redundant</a></li><li class="list-group-item"><a href='../unit-testing-are-database-integration-tests-bad/'>Unit-testing &#8211; Are (database) integration tests bad</a></li><li class="list-group-item"><a href='../c-unit-test-a-crud-controller-mvc/'>C# &#8211; Unit Test a CRUD Controller MVC</a></li><li class="list-group-item"><a href='../unit-testing-how-exactly-should-unit-tests-be-written-without-mocking-extensively/'>Unit-testing &#8211; How exactly should unit tests be written without mocking extensively</a></li><li class="list-group-item"><a href='../c-how-to-differentiate-unit-tests-from-integration-tests/'>C# &#8211; How to Differentiate Unit Tests from Integration Tests</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>