<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; How does &#8220;Composition Root&#8221; DI apply to Domain Driven Design &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1084158 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1084158" class="post-1084158 software type-software status-publish hentry category-software tag-dependency-injection tag-design tag-domain-driven-design tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; How does &#8220;Composition Root&#8221; DI apply to Domain Driven Design</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">dependency-injection</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">domain-driven-design</span><span class="mr-2 badge badge-primary">object-oriented</span></p><div class="entry-content"><p>I&#39;m confused about applying the &#34;Composition Root&#34; (CR) to create aggregates in DDD. Seemann (2012) defines CR as a &#34;(preferably) unique location &#8230; where modules are composed&#34;. He argues for  composing object graphs inside CR, near the application&#39;s entry point, and  warns against the temptation to  compose &#34;classes a little at a time to create small subsystems&#34;.</p><p>An aggregate in DDD appears like such a subsystem &#8212; a (sub) graph with entities and value objects. Evans (2004) and other DDD texts (Vernon 2013, Ghosh 2017) recommend constructing aggregates inside factories,  located in the domain layer, &#34;near&#34; the aggregate (eg a factory method on the aggregate root) or as standalone services. This seems to contradict<br /> the CR approach.</p><p>The question is whether and how the CR and Factory approaches should be combined in DDD.  For instance,</p><ul><li>A CR is put inside the domain layer, rather than at the app&#39;s entry. Possibly, the factories are pooled to this  single location<br /> <br /> OR</li><li>The benefits of CR (eg, the &#34;ability to intercept subsystems to modify their behavior&#34;; Seemann) are irrelevant to  DDD.</li><li>CR DI does not apply to creation of  aggregates but works at a higher granularity level (eg injection of services). Then CR methods use   factories to construct aggregates, to place them on the object graph.</li></ul><p><em>References</em><br /> M. Seemann, 2012, &#34;Dependency Injection in .NET&#34;<br /> E. Evans, 2004, &#34;Domain-Driven Design&#34; <br /> V. Vernon, 2013, &#34;Implementing Domain-Driven Design&#34; <br /> D. Ghosh, 2017, &#34;Functional and Reactive Domain Modeling&#34;</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Typically, the composition root is about satisfying the dependencies of various modules that make up a process/application.</p><p>When Evans described DDD in the blue book, he was working in the context of a three tier architecture.  You can think of the tiers as being modules - an application module, which knows about the interface(s) of the domain module but not the implementations, and a domain module that knows the interface of the persistence module, but not its implementation.</p><p>Because the coupling between modules is interface, rather than implementation, we can replace one module with another that implements the same interface, and it should all &#34;just work&#34;.</p><p>The role of the composition root is the selection of implementations, and the wiring together of the dependency graph.  So the composition root knows enough about the specific implementations to instantiate them, passing the appropriate implementation of each.</p><p>In architectures where constructor injection is favored, this might look like</p><pre><code>PersistenceAPI persistence = new PersistenceModule(...)
DomainAPI domain = new DomainModule(persistence, ...)
Application app = new Application(domain, ...)

app.run()
</code></pre><p>Broadly, the modules describe their dependencies -- capabilities that they need but don&#39;t implement for themselves, and the composition root does the work of introducing capability consumers with capability producers.</p><p>An important thing to notice here; the pattern is deferring the binding of the consumer to a specific capability provider -- instead of forcing a choice when we build a module, we delay that choice until we build the root (or, with some additional work/assistance from DI frameworks, we can defer the choice until run time).</p><p>So for DDD, the answer is relatively simple: you use the composition root approach in those parts of your solution where you derive business value from deferring the binding of a consumer to a specific implementation.</p><p>Example: one way of persisting domain state is by writing data into an RDMBS, possibly with the help of an ORM.  Another way would be to serialize that state into a document written to a document store.  That might be a raw serialization of the object, or it might instead be in the form of a message/memento which is less coupled to a specific in memory representation.</p><p>Most of the app shouldn&#39;t need to care which of these choices that you make; so there can be business value in creating a seam that allows you to change this decision.</p><p>The composition root pattern gives you an element where the single responsibility is stitching these seams together into a working application.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../domain-services-vs-factories-vs-aggregate-roots/'>Domain Services vs. Factories vs. Aggregate Roots</a></li><li class="list-group-item"><a href='../design-domain-driven-design-designing-aggregate-roots/'>Design &#8211; Domain Driven Design &#8211; designing Aggregate Roots</a></li><li class="list-group-item"><a href='../ddd-architecture-in-a-mvc-web-application/'>DDD Architecture in a MVC web application</a></li><li class="list-group-item"><a href='../object-oriented-ddd-is-it-correct-for-a-root-aggregate-to-hold-a-reference-to-another-root-aggregate/'>Object-oriented &#8211; DDD: is it correct for a root aggregate to hold a reference to another root aggregate</a></li><li class="list-group-item"><a href='../can-clients-call-methods-on-entities-other-than-the-aggregate-root/'>Can clients call methods on entities other than the aggregate root</a></li><li class="list-group-item"><a href='../aggregate-relationships-in-domain-driven-design/'>Aggregate relationships in Domain Driven Design</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>