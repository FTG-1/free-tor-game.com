<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; How to simulate a &#8220;negative&#8221; type system &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1077851 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1077851" class="post-1077851 software type-software status-publish hentry category-software tag-java tag-programming-languages"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; How to simulate a &#8220;negative&#8221; type system</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">java</span><span class="mr-2 badge badge-info">programming-languages</span></p><div class="entry-content"><p>In my experience, all languages I know have a sort of &#34;positive&#34; type system. What I mean by &#34;positive type system&#34; is that when you are writing the source code, you always specify what types your function/objects accept, like:</p><pre><code>function f(SomeType argument) { ... }
</code></pre><p>But I have never seen something like:</p><pre><code>function f(AbstractType&lt;Not ConcreteTypeFoo&gt; argument) { ... }
</code></pre><p>I think it would be very useful in scenarios where you need to specify the behavior for some families of types without the need to write a lot of boilerplate code to implement some type exclusion logic.</p><p>By reading <a href="../../../en.wikipedia.org/wiki/Type_system.html" rel="nofollow noreferrer">this wikipedia article</a> abou type systems, I can see that maybe gradual type systems would be some sort of equivalent to this, but not exactly the same thing. I don`t think Union Types solve the same class of problem and saying that when you specify a type you are excluding other types is not the same thing as well.</p><pre><code>// addition type system: argument can only be of type SomeType
function foo (SomeType argument) { ... }

// union types: argument can only be of type SomeType or FooType
function foo (SomeType | FooType argument) { ... }

// intersection types: argument must conform to both SomeType and FooType
function foo (SomeType &amp; FooType argument) { ... }

// exclusion type: argument can be ANYTHING except ConcreteTypeFoo
function foo (AbstractType&lt;Not ConcreteTypeFoo&gt; argument) { ... }
</code></pre><p>An example scenario about where this would be useful:</p><pre><code>interface Transaction() { ... }

class TransactionTypeA implements Transaction { ... }

class TransactionTypeB imnplements Transaction { ... }

class TransactionTypeC implements Transaction { ... }

interface TransactionRule() {
    boolean validate(Transaction t);
}

class RuleA implements TransactionRule {
    boolean validate(Transaction&lt;Not TransactionTypeA&gt; t) { ... }
    boolean validate(TransactionTypeA t) { ... }
}

class RuleB implements TransactionRule {
    boolean validate(Transaction&lt;Not TransactionTypeB&gt; t) { ... }
    boolean validate(TransactionTypeB t) { ... }
}

class RuleC implements TransactionRule {
    boolean validate(Transaction&lt;Not TransactionTypeC&gt; t) { ... }
    boolean validate(TransactionTypeC t) { ... }
}
</code></pre><p>The <em><strong>equivalent code without an exclusion type system</strong></em> would be like this:</p><pre><code>interface Transaction() { ... }

class TransactionTypeA implements Transaction { ... }

class TransactionTypeB imnplements Transaction { ... }

class TransactionTypeC implements Transaction { ... }

interface TransactionRule() {
    boolean validate(Transaction t);
}

interface ValidationStrategy() {
    boolean validate(Transaction t);
}

interface ValidationStrategyFactory {
    ValidationStrategy create(Transaction t);
}

class RuleA implements TransactionRule {
    RuleAValidationStratetyFactory strategyFactory;

    constructor(RuleAValidationStratetyFactory f) {
        strategyFactory = f;
    }

    boolean validate(Transaction t) {
        ValidationStrategy s = strategyFactory.create(t);
        return s.validate();
    }
}

class RuleAValidationStratetyFactory implements ValidationStrategyFactory {
    ValidationStrategy create(Transaction t) {
        if (t.type == TransactionTypeA) {
            return new RuleATransactionTypeAValidationStrategy();
        } else {
            return new RuleATransactionTypeBAndCValidationStrategy();
        }
    }
}

class RuleATransactionTypeAValidationStrategy implements ValidationStrategy {
    boolean validate(Transaction t) { ... }
}

class RuleATransactionTypeBAndCValidationStrategy implements ValidationStrategy {
    boolean validate(Transaction t) { ... }
}

class RuleB implements TransactionRule {
    RuleBValidationStratetyFactory strategyFactory;

    constructor(RuleBValidationStratetyFactory f) {
        strategyFactory = f;
    }

    boolean validate(Transaction t) {
        ValidationStrategy s = strategyFactory.create(t);
        return s.validate();
    }
}

class RuleBValidationStratetyFactory implements ValidationStrategyFactory {
    ValidationStrategy create(Transaction t) {
        if (t.type == TransactionTypeA) {
            return new RuleBTransactionTypeBValidationStrategy();
        } else {
            return new RuleBTransactionTypeAAndCValidationStrategy();
        }
    }
}

class RuleBTransactionTypeBValidationStrategy implements ValidationStrategy {
    boolean validate(Transaction t) { ... }
}

class RuleBTransactionTypeAAndCValidationStrategy implements ValidationStrategy {
    boolean validate(Transaction t) { ... }
}

class RuleC implements TransactionRule {
    RuleCValidationStratetyFactory strategyFactory;

    constructor(RuleCValidationStratetyFactory f) {
        strategyFactory = f;
    }

    boolean validate(Transaction t) {
        ValidationStrategy s = strategyFactory.create(t);
        return s.validate();
    }
}

class RuleCValidationStratetyFactory implements ValidationStrategyFactory {
    ValidationStrategy create(Transaction t) {
        if (t.type == TransactionTypeA) {
            return new RuleCTransactionTypeCValidationStrategy();
        } else {
            return new RuleCTransactionTypeAAndBValidationStrategy();
        }
    }
}

class RuleCTransactionTypeCValidationStrategy implements ValidationStrategy {
    boolean validate(Transaction t) { ... }
}

class RuleCTransactionTypeAAndBValidationStrategy implements ValidationStrategy {
    boolean validate(Transaction t) { ... }
}
</code></pre><p>So, the question is: How can I simulate such scenario in a language like Java? It would be also helpful to get some background information of how this is solved in other programming languages.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m not a logician, type theoretician, or programming language theorist, so my intuition may be wrong here, but I don&#39;t think it actually takes <em>that much</em> to be able to do this.</p><p>People have twisted Java&#39;s type system into quite some amazing shapes, for example. I would not at all be surprised to find out that what you want can be encoded in Java or similar languages.</p><p>I am also pretty sure that this is commonly used in C++ template metaprogramming. But I am not a C++ programmer either.</p><p>Such a type can be pretty easily encoded in Scala. One trick is to use implicits. It is illegal to have ambiguities during implicit resolution, so all you need to do is to write two implicits that become ambiguous IFF two types are equal. And that&#39;s really easy to do: you define one implicit for <code>[A, B]</code> and one for <code>[A, A]</code>. If the types are different, then only the first implicit is applicable and everything is peachy. If the types are equal, both implicits are applicable, and compilation fails with an ambiguous implicits error.</p><p><a href="https://stackoverflow.com/a/6929051/2988">Here&#39;s what that looks like</a>:</p><pre class="lang-scala prettyprint-override"><code>sealed class =!=[A, B]

trait LowerPriorityImplicits {
  /** do not call explicitly! */
  implicit def equal[A]: =!=[A, A] = sys.error(&#34;should not be called&#34;)
}

object =!= extends LowerPriorityImplicits {
  /** do not call explicitly! */
  implicit def nequal[A, B]: =!=[A, B] = new =!=[A, B]
}
</code></pre><p>This defines a type constructor named <code>=!=</code> with two type parameters <code>A</code> and <code>B</code>, which will lead to a compile error if you try to summon it with the same type. (Note that there is already a type constructor named <code>=:=</code> in the standard library which checks for equality.)</p><p>You could use it like this:</p><pre class="lang-scala prettyprint-override"><code>case class Foo[A, B](a: A, b: B)(implicit e: A =!= B)
</code></pre><p>This defines a type constructor <code>Foo</code> with two type parameters <code>A</code> and <code>B</code> which can only be instantiated when <code>A</code> and <code>B</code> are not equal:</p><pre class="lang-scala prettyprint-override"><code>Foo(1f, 1.0)
Foo(&#34;&#34;, 1.0)
Foo(&#34;&#34;, 1)
Foo(&#34;Fish&#34;, Some(&#34;Fish&#34;))

// doesn&#39;t compile
Foo(1f, 1f)
// ambiguous implicit values:
//   both method equal in trait LowerPriorityImplicits of type [A]A =!= A
//   and method nequal in object =!= of type [A, B]A =!= B
//   match expected type Float =!= Float

Foo(&#34;&#34;, &#34;&#34;)
// ambiguous implicit values:
//   both method equal in trait LowerPriorityImplicits of type [A]A =!= A
//   and method nequal in object =!= of type [A, B]A =!= B
//   match expected type String =!= String
</code></pre><p>But you can also use it this way:</p><pre class="lang-scala prettyprint-override"><code>case class NotInt[A](a: A)(implicit e: A =!= Int)

NotInt(&#34;&#34;)
NotInt(true)
NotInt(42f)

NotInt(42)
// ambiguous implicit values:
//   both method equal in trait LowerPriorityImplicits of type [A]A =!= A
//   and method nequal in object =!= of type [A, B]A =!= B
//   match expected type Int =!= Int
</code></pre><p>TypeScript can express powerful type constraints, since its type system tries to cover all the strange runtime tricks ECMAScript programmers pull. In particular, <a href="https://typescriptlang.org/docs/handbook/advanced-types.html#conditional-types" rel="noreferrer"><em>conditional types</em></a> are very powerful, but there&#39;s also <em>type guards</em>, <em>mapped types</em>, <em>distributive conditional types</em>, and more. The TypeScript standard library actually already contains a utility type called <a href="https://typescriptlang.org/docs/handbook/utility-types.html#excludetype-excludedunion" rel="noreferrer"><code>Exclude&lt;Type, ExcludedUnion&gt;</code></a> which gets you halfway to your goal.</p><p><code>Exclude</code> allows you to create a new type by excluding a union of types from another type. Then, you can create another type which is the intersection of the exclude type and the parameter type. If the parameter type is one of the excluded types, then this intersection will be empty [<a href="https://stackoverflow.com/a/49262929/2988">Code inspired by an answer to <em>Is there a type in TypeScript for anything except functions?</em></a>]:</p><pre class="lang-typescript prettyprint-override"><code>type NotA&lt;A, T&gt; = Exclude&lt;T, A&gt;

function noNumber&lt;T&gt;(notN: T &amp; NotA&lt;number, T&gt;) { return notN; }

noNumber(&#34;Hello&#34;);

noNumber(2);
// Argument of type &#39;number&#39; is not assignable to parameter of type &#39;never&#39;.
</code></pre></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-explanation-of-the-definition-of-interface-inheritance-as-described-in-gof-book/'>Java &#8211; Explanation of the definition of interface inheritance as described in GoF book</a></li><li class="list-group-item"><a href='../java-return-values-for-crud-methods/'>Java &#8211; Return values for CRUD methods</a></li><li class="list-group-item"><a href='../java-why-would-a-type-be-coupled-with-its-builder/'>Java &#8211; Why would a type be coupled with its builder</a></li><li class="list-group-item"><a href='../java-best-place-to-convert-one-object-to-another-object/'>Java &#8211; Best place to convert one object to another object</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>