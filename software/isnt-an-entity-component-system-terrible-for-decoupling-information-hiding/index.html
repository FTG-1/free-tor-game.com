<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Isn&#8217;t an Entity-Component System terrible for decoupling/information hiding &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1067591 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1067591" class="post-1067591 software type-software status-publish hentry category-software tag-design-patterns tag-entity-component-system tag-reactive"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Isn&#8217;t an Entity-Component System terrible for decoupling/information hiding</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span><span class="mr-2 badge badge-info">entity-component-system</span><span class="mr-2 badge badge-warning">reactive</span></p><div class="entry-content"><p>The title is intentionally hyperbolic and it may just be my inexperience with the pattern but here&#39;s my reasoning:</p><p>The &#34;usual&#34; or arguably straightforward way of implementing entities is by implementing them as objects and subclassing common behaviour. This leads to the classic problem of &#34;is an <code>EvilTree</code> a subclass of <code>Tree</code> or <code>Enemy</code>?&#34;. If we allow multiple inheritance, the diamond problem arises. We could instead pull the combined functionality of <code>Tree</code> and <code>Enemy</code> further up the hierarchy which leads to God classes, or we can intentionally leave out behaviour in our <code>Tree</code> and <code>Entity</code> classes (making them interfaces in the extreme case) so that the <code>EvilTree</code> can implement that itself &#8211; which leads to code duplication if we ever have a <code>SomewhatEvilTree</code>.</p><p>Entity-Component Systems try to solve this problem by dividing the <code>Tree</code> and <code>Enemy</code> object into different components &#8211; say <code>Position</code>, <code>Health</code> and <code>AI</code> &#8211; and implement systems, such as an <code>AISystem</code> that changes an Entitiy&#39;s position according to AI decisions. So far so good but what if <code>EvilTree</code> can pick up a powerup and deal damage? First we need a <code>CollisionSystem</code> and a <code>DamageSystem</code> (we probably already have these). The <code>CollisionSystem</code> needs to communicate with the <code>DamageSystem</code>: Every time two things collide the <code>CollisionSystem</code> sends a message to the <code>DamageSystem</code> so it can subtract health. Damage is also influenced by powerups so we need to store that somewhere. Do we create a new <code>PowerupComponent</code> that we attach to entities? But then the <code>DamageSystem</code> needs to know about something it would rather know nothing about &#8211; after all, there are also things that deal damage that can&#39;t pick up powerups (e.g. a <code>Spike</code>). Do we allow the <code>PowerupSystem</code> to modify a <code>StatComponent</code> that is also used for damage calculations similar to <a href="https://gamedev.stackexchange.com/questions/13916/doing-powerups-in-a-component-based-system/13941#13941">this answer</a>? But now two systems access the same data. As our game becomes more complex it would become an intangible dependency graph where components are shared among many systems. At that point we can just use global static variables and get rid of all the boilerplate.</p><p>Is there an effective way to solve this? One idea I had was to let components have certain functions, e.g. give the <code>StatComponent</code> <code>attack()</code> which just returns an integer by default but can be composed when a powerup happens:</p><pre><code>attack = getAttack compose powerupBy(20) compose powerdownBy(40)
</code></pre><p>This doesn&#39;t solve the problem that <code>attack</code> must be saved in a component accessed by multiple systems but at least I could type the functions properly if I have a language that supports it sufficiently:</p><pre><code>// In StatComponent
type Strength = PrePowerup | PostPowerup
type Damage = Int
type PrePowerup = Int
type PostPowerup = Int
attack: Strength = getAttack //default value, can be changed by systems
getAttack: PrePowerup

// these functions can be defined in other components or in PowerupSystems
powerupBy: Strength -&gt; PostPowerup
powerdownBy: Strength -&gt; PostPowerup
subtractArmor: Strength -&gt; Damage

// in DamageSystem
dealDamage: Damage -&gt; () = attack compose subtractArmor compose hurtSomeEntity
</code></pre><p>This way I at least guarantee correct ordering of the various functions added by systems. Either way, it seems I&#39;m rapidly approaching functional reactive programming here so I ask myself whether I shouldn&#39;t have used that from the beginning instead (I&#39;ve only just looked into FRP, so I may be wrong here). I see that ECS is an improvement over complex class hierarchies but I&#39;m not convinced it&#39;s ideal.</p><p>Is there a solution around this? Is there a functionality/pattern I&#39;m missing to decouple ECS more cleanly? Is FRP just strictly better suited for this problem? Are these problems just arising out of inherent complexity of what I&#39;m trying to program; i.e. would FRP have similar issues?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>ECS completely ruins data hiding. This is a trade-off of the pattern.</p><p>ECS is <em>excellent</em> at decoupling. A good ECS lets a move system declare that it works on any entity that has a velocity and a position component, without having to care about what entity types exist, or which other systems access these components. This is at least equivalent in decoupling power to having game objects implement certain interfaces.</p><p>Two systems accessing the same components is a feature, not a problem. It is fully expected, and it doesn&#39;t couple systems in any way. It&#39;s true that systems will have an implicit dependency graph, but those dependencies are inherent in the modeled world. To say that the damage system should not have the implicit dependency on the powerup system is to claim that powerups do not affect damage, and that is probably wrong. However, while the dependency exists, the systems aren&#39;t <em>coupled</em> - you can remove the powerup system from the game without affecting the damage system, because the communication happened through the stat component and was completely implicit.</p><p>Resolving these dependencies and ordering systems can be done in a single central location, similar to how dependency resolution in a DI system works. Yes, a complex game will have a complex graph of systems, but this complexity is inherent, and at least it is contained.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-entity-component-system-coupling/'>Object-oriented &#8211; Entity Component System Coupling</a></li><li class="list-group-item"><a href='../design-how-to-allow-for-custom-rules-in-a-entity-component-system-designed-game-engine/'>Design &#8211; How to allow for custom Rules in a Entity Component System designed game engine</a></li><li class="list-group-item"><a href='../object-oriented-oop-ecs-vs-pure-ecs/'>Object-oriented &#8211; OOP ECS vs Pure ECS</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>