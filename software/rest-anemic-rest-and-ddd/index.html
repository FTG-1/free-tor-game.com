<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; Anemic REST and DDD &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075521 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075521" class="post-1075521 software type-software status-publish hentry category-software tag-domain-driven-design tag-rest"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; Anemic REST and DDD</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">domain-driven-design</span><span class="mr-2 badge badge-info">rest</span></p><div class="entry-content"><p>Assume following domain model:</p><p>An [Order] consists of a number of properties, as well as a list of [OrderLine]s.<br /> For our purpose, an order is fairly crud-like with very little business logic.</p><p>Consider the following user story: a user retrieves an order. He then deletes one order line and adds 2 more. Finally, he saves the order.</p><p>How would this be implemented in REST? I see a few options but each with certain drawbacks:</p><ol><li><p>Coarse-grained approach:<br /> The save action will result in a PUT request (PUT /orders/3) containing the entire order including order lines. The drawback is that it&#39;s hard to figure out what has changed (i.e. which order lines should be added / updated / deleted?).<br /> I can see this turning into a mess real quickly when later it turns out there is specific business logic when adding an order line. It basically boils down to replacing one order with another and keeping our fingers crossed that everything is valid, unless we decide to re-implement business rules client-side.</p></li><li><p>Fine-grained approach:<br /> The delete order line action will result in a DELETE request (DELETE /orders/3/lines/5). The add order line action will result in a POST request (POST /orders/3/lines). This implies the app now needs to keep track of a lot of changes, and execute the changes in the correct order when the user decides to save.<br /> Another drawback is that when a new order is created, it would first have to be saved before order lines can be added.</p></li></ol><p>Since rest deals with documents I&#39;m not sure how those would translate into operations executed on a domain model, given that documents are anemic and domain models are not.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Since rest deals with documents I&#39;m not sure how those would translate into operations executed on a domain model, given that documents are anemic and domain models are not.</p></blockquote><p>The main thing to keep in mind is the <em>point</em> of a web api is to adapt your domain for the web; which is to say, to provide the illusion that your resources are really just entries in a document store.</p><p>In a sense, a consumer should be able to drive your API using a web aware document editor.</p><h1>Coarse grained approach</h1><blockquote><p>The save action will result in a PUT request (PUT /orders/3) containing the entire order including order lines. The drawback is that it&#39;s hard to figure out what has changed (i.e. which order lines should be added / updated / deleted?).</p></blockquote><p>This is a perfectly reasonable approach to take - you tell the API how you want the resource to look, and the API has to figure out how to get there.</p><p>Since shopping carts don&#39;t typically call for collaboration among multiple editors, you might get by building a new data model for the resource from the snapshot you have been given, then overwriting the existing model.</p><p>If you, for whatever reason, instead need to discover finer grain command messages from the diff; yeah, that can be awkward.  In a case like this one, it&#39;s not too bad -- you can detect change easily enough, and any valid change is likely drawn from a small vocabulary.</p><p>It&#39;s also worth noting that you don&#39;t need to support PUT on any arbitrary representation of the resource, but can instead pick and choose a representation that makes sense (and, hopefully, one where it is easy to identify the correct changes).</p><h1>Fine grained approach</h1><blockquote><p>The delete order line action will result in a DELETE request (DELETE /orders/3/lines/5).</p></blockquote><p>Any URI you want to use is fine as far as REST is concerned; but conceptually it might be better to think in terms of removing the entity by id, rather than by position in the list.</p><blockquote><p>The add order line action will result in a POST request</p></blockquote><p>Could also be done as a PUT.</p><blockquote><p>This implies the app now needs to keep track of a lot of changes, and execute the changes in the correct order when the user decides to save.</p></blockquote><p>Yes; I believe you run into a similar situation with an occasionally connected client.  Command messages get queued up until the target system becomes available.</p><p>Another approach to consider would be to manipulate the <em>history</em> of the resource, rather than the resource itself.  Effectively, the history becomes an append only collection of changes.</p><blockquote><p>I&#39;m just wondering how I can avoid duplicating business rules on the client.  For example, if an order line cannot be deleted under certain circumstances, nothing prevents the client from doing so.</p></blockquote><p>There are a couple of answers here, based on the idea that you signal that information in the representations.</p><p>One answer is that you simply annotate that the order line should not be deleted.  The business rules that decide whether an order line can be deleted live on the server, the client just sees that the flag has been set.</p><p>You can communicate that information out of band to the clients.</p><p>In the fine grained approach, the usual answer is that you use hypermedia controls.  Rather than clients sending a message to a pre-determined endpoint, the client is expected to look in the representation and &#34;follow a link&#34;.  So you can communicate the fact that an order item can&#39;t be deleted by removing the delete item link from the representation.</p><p>In a course grained approach, I suppose you could try distinguishing the modifiable parts of the resource from the rest, and providing editable representations of only the parts that the client is allowed to edit.  There&#39;s liable to be some confusion there.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-conceptual-mismatch-between-ddd-application-services-and-rest-api/'>Rest &#8211; Conceptual mismatch between DDD Application Services and REST API</a></li><li class="list-group-item"><a href='../ddd-domain-models-and-business-logic/'>DDD Domain Models and Business Logic</a></li><li class="list-group-item"><a href='../find-the-ddd-aggregate-root/'>Find the DDD Aggregate Root</a></li><li class="list-group-item"><a href='../java-rest-api-check-if-action-is-allowed-for-entity/'>Java &#8211; REST Api &#8211; Check if Action is allowed for entity</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>