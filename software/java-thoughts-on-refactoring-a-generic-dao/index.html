<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Thoughts on refactoring a generic DAO &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079979 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079979" class="post-1079979 software type-software status-publish hentry category-software tag-architecture tag-dao tag-java tag-refactoring tag-reinventing-the-wheel"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Thoughts on refactoring a generic DAO</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">dao</span><span class="mr-2 badge badge-warning">java</span><span class="mr-2 badge badge-primary">refactoring</span><span class="mr-2 badge badge-danger">reinventing-the-wheel</span></p><div class="entry-content"><p>I have designed a generic DAO in Java and am having confusion about whether to refactor it to different design or not.</p><p><strong>PS</strong> Don&#39;t say to use already existing 3rd person framework. I know there are some present but I am learning Java and design patterns so I need all the practice I can get.</p><p>If there&#39;s any confusion then please ask and I&#39;ll clarify.</p><p><strong>The current Architecture</strong></p><hr/><p><strong>DAOFactory.java</strong></p><ul><li>Contains the <code>abstract</code> methods for creation of <code>DAODelete</code>, <code>DAOUpdate</code> and 2 other interfaces to be implemented by concrete implementation classes</li><li><code>public</code> Class method for creating the concrete Factories for producing the concrete implementaton of the interfaces mentioned before.</li></ul><p><strong>DAORead.java</strong></p><pre><code>public abstract &lt;T&gt; T getPojoForPrimarKey(Connection con,
        TableName tableName, String primaryKey) throws SQLException;
</code></pre><p>Similarly in my other interfaces I have generic methods.</p><ul><li>Here <code>Connection</code> is passed by the service layer and closed there for transaction management.</li><li><code>TableName</code> is a enum that I am using to have a switch case in  lower layer of DAO for calling Table Specific functions. Also using an enum is helping me in type checking.</li></ul><p><strong>OracleRead.java</strong></p><pre><code>@Override
    public &lt;T&gt; T getPojoForPrimarKey(Connection con, TableName tableName,
            String primaryKey) throws SQLException {
        T currentPojo = null;
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            String queryString = OracleSpecifics.queryString(tableName,
                    primaryKey, QueryType.READ);
            ps = con.prepareStatement(queryString);
            rs = ps.executeQuery();
            if (rs.next()) {
                currentPojo = OracleSpecifics.getPojoFromResultSet(tableName, rs);
            }
        } finally {
            DAOFactory.closeAll(ps, rs);
        }
        return currentPojo;
    }
</code></pre><p>This is how I have implemented the <code>deleteFrom</code> function from the interface in concrete class.</p><p>Here <code>OracleSpecifics</code> is the lower layer of DAO that I was talking about. It basically contains <code>switch</code> cases to check for specific Table.</p><p><strong>OracleSpecifics.java</strong></p><pre><code>// These functions call table-specific functions
    @SuppressWarnings(&#34;unchecked&#34;)
    static &lt;T&gt; T getPojoFromResultSet(TableName tableName, ResultSet rs)
            throws SQLException {

        switch (tableName) {
        case ASEEM_MASTER:
        case ASEEM_MASTER_TEMP:
            return (T) SpecAseemMaster.getPojo(rs);
        case AUTHENTICATE_TABLE:
            return (T) SpecAseemRole.getPojo(rs);
        default:
            return null;
        }
    }
</code></pre><p>Here <code>SpecAseemMaster</code> and <code>SpecAseemRole</code> are Table Specific (specifically schema specific) layer producing the required fields</p><p><strong>SpecAseemRole.java</strong></p><pre><code>public static AuthenticationDetails getPojo(ResultSet rs)
            throws SQLException {
        AuthenticationDetails cur = new AuthenticationDetails();
        cur.setUserName(rs.getString(1));
        cur.setPassWord(rs.getString(2));
        cur.setRole(rs.getString(3));
        return cur;
    }
</code></pre><hr/><p><strong>In service layer</strong></p><p>The type by which the DAO&#39;s method is called is the Pojo representing the schema&#39;s data fields. e.g.</p><pre><code>myFactory.getDAORead().&lt;AuthenticationDetails&gt; getPojoForPrimarKey(con, CUR_TABLE, primaryKey);
</code></pre><p>Here <code>AuthenticationDetails</code> is my Pojo aka DTO for communicating between my Controller and service layer (in Model).</p><hr/><p><strong>Please Note</strong> that I am giving just a overview in the simplest way. There are 4 interfaces in the abstract DAOs containing total of 8 <code>abstract</code> methods implemented by 4 concrete classes. All these generic classes depend on a lower layer in DAO for getting specific queries, <code>PreparedStatement</code>s etc. which further calls functions in auxiliary utility class&#39;s functions depending on the <code>tableName</code> passed down this hierarchy. The bottom layer is schema-specific.</p><p><strong>My Confusion about refactoring</strong></p><ul><li>I am satisfied with the upper layers of DAO but I think that at the the lower level specifically at the <code>OracleSpecific</code> the things which should have strong coupling has weak coupling. e.g. there are different methods for getting <code>PreparedStatement</code> for insert and update. Each of these in turn have <code>switch</code> case for calling the functions in lower utility class.</li><li><strong>Although</strong> the <code>schema-specific</code> methods are tied together in different utility classes the method call themselves in <code>OracleSpecifics.java</code> do not have any coupling.</li><li>I am thinking whether I should change the enum <code>TableName</code> to contain a <em>specific state</em>. The state I am thinking for the schema-specific lowest level utility classes.</li><li><p>These <code>specific states</code> contained in enums can be used to change the state of DAO and the DAO can then call the specific functions based on an interface implemented by all such states. Thus depending on the state the behavior can change automatically.</p></li><li><p>Is this design decision correct or would it be meaningless?</p></li><li>Any other thing that I might have overlooked?</li><li>Any thoughts about the design itself?</li><li>Would I lose type safety introduced by generics due to this change?</li></ul></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The first question you need to answer is whether you intend to create a truly generic data access framework, or if you want it tailored to the particular project you&#39;re working on.</p><p>A generic framework has the benefit of being portable and fairly loosely coupled to the underlying DB + schema, but at the cost of pushing schema level information further up in the framework.  The more generic you make the framework, the more of this knowledge you push up.</p><p>A tailored framework alleviates the higher levels of the application from worrying about the schema or DB details, but at the cost of cost of being less re-usable in other environments.  As a corollary, the more specific you make the framework, the less easy it is to extend elsewhere.</p><p>If you&#39;re not sure on which of those to pick, the generic framework makes sense if you suspect there will be changes at the DB layer or the schema.  Likewise, if those are pretty well locked down then the tailored framework is the better approach.  Ultimately, you&#39;re optimizing the system to more easily handle where you think the change will occur.</p><hr/><p>As to whether or not you should refactor - the answer is <strong><em>No</em></strong> unless you&#39;re encountering a specific problem.</p><p>Worrying about the degree of coupling is nice, I suppose, but doesn&#39;t necessarily address a specific problem that you may be seeing.  Refactoring based upon presumed issues within coupling is actually more likely to create a problem for you than just leaving it alone.</p><p>Likewise with expressing the state.  If the current mechanism of an <code>enum</code> is sufficient and doesn&#39;t present an apparent problem then don&#39;t change what you&#39;ve got.</p><hr/><p>Overall, it sounds like you&#39;ve designed a reasonably robust data access method for the domain you&#39;re working worth.  Your question doesn&#39;t list any specific issues that are holding back your development, so I&#39;d call it good and move to the next stage of development.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-should-i-unit-test-the-subclasses-or-the-abstract-parent-class/'>Java &#8211; Should I unit test the subclasses or the abstract parent class</a></li><li class="list-group-item"><a href='../java-designing-generic-type-inheritance-hierarchy/'>Java &#8211; Designing generic type inheritance hierarchy</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>