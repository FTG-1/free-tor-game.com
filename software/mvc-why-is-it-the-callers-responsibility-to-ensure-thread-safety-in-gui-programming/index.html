<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Mvc &#8211; Why is it the caller&#8217;s responsibility to ensure thread safety in GUI programming &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1071575 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1071575" class="post-1071575 software type-software status-publish hentry category-software tag-multithreading tag-mvc tag-user-interface"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Mvc &#8211; Why is it the caller&#8217;s responsibility to ensure thread safety in GUI programming</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">multithreading</span><span class="mr-2 badge badge-info">mvc</span><span class="mr-2 badge badge-warning">user interface</span></p><div class="entry-content"><p>I have seen, in many places, that it is <a href="https://stackoverflow.com/a/16328185/1768232">canonical wisdom</a><sup>1</sup> that it is the responsibility of the caller to ensure you are on the UI thread when updating UI components (specifically, in Java Swing, that you are on the <a href="https://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html" rel="nofollow noreferrer">Event Dispatch Thread</a>).</p><p>Why is this so? The Event Dispatch Thread is a concern of the <strong>view</strong> in MVC / MVP / MVVM; to handle it anywhere but the view creates a <strong>tight coupling</strong> between the view&#39;s implementation, and the threading model of that view&#39;s implementation.</p><p>Specifically, let&#39;s say I have an MVC architected application that uses Swing. If the caller is responsible for updating components on the Event Dispatch Thread, then if I try to swap out my Swing View implementation for a JavaFX implementation, I must <em>change all the Presenter / Controller code to use the JavaFX Application thread instead</em>.</p><p>So, I suppose I have two questions:</p><ol><li>Why is it the caller&#39;s responsibility to ensure UI component thread safety? Where is the flaw in my reasoning above?</li><li>How can I design my application to have loose coupling of these thread safety concerns, yet still be appropriately thread-safe?</li></ol><hr/><p>Let me add some MCVE Java code to illustratrate what I mean by &#34;caller responsible&#34; (there are some other good practices here that I&#39;m not doing but I&#39;m trying on purpose to be as minimal as possible):</p><p>Caller being responsible:</p><pre class="lang-java prettyprint-override"><code>public class Presenter {
  private final View;

  void updateViewWithNewData(final Data data) {
    EventQueue.invokeLater(new Runnable() {
      public void run() {
        view.setData(data);
      }
    });
  }
}
</code></pre><pre class="lang-java prettyprint-override"><code>public class View {
  void setData(Data data) {
    component.setText(data.getMessage());
  }
}
</code></pre><p>View being responsible:</p><pre class="lang-java prettyprint-override"><code>public class Presenter {
  private final View;

  void updateViewWithNewData(final Data data) {
    view.setData(data);
  }
}
</code></pre><pre class="lang-java prettyprint-override"><code>public class View {
  void setData(Data data) {
    EventQueue.invokeLater(new Runnable() {
      public void run() {
        component.setText(data.getMessage());
      }
    });
  }
}
</code></pre><hr/><p><sub>1: The author of that post has the highest tag score in Swing on Stack Overflow. He says this all over the place and I have also seen it being the caller&#39;s responsibility in other places, too.</sub></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Toward the end of his <a href="https://weblogs.java.net/blog/kgh/archive/2004/10/multithreaded_t.html">failed dream essay</a>, Graham Hamilton (a major Java architect) mentions if developers &#34;are to preserve the equivalence
with an event queue model, they will need to follow various
non-obvious rules,&#34; and having a visible and explicit event queue model &#34;seems to help people to more reliably follow the model and thus construct GUI programs that work reliably.&#34;</p><p>In other words, if you try to put a multithreaded facade on top of an event queue model, the abstraction will occasionally leak in non-obvious ways that are extremely difficult to debug.  It seems like it will work on paper, but ends up falling apart in production.</p><p>Adding small wrappers around single components probably isn&#39;t going to be problematic, like to update a progress bar from a worker thread.  If you try to do something more complex that requires multiple locks, it starts getting really difficult to reason about how the multithreaded layer and the event queue layer interact.</p><p>Note that these kinds of issues are universal to all GUI toolkits.  Presuming an event dispatch model in your presenter/controller isn&#39;t tightly coupling you to only one specific GUI toolkit&#39;s concurrency model, it&#39;s coupling you to <em>all of them</em>.  The event queueing interface shouldn&#39;t be that hard to abstract.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../mvc-decoupling-ui-code/'>Mvc &#8211; Decoupling UI code</a></li><li class="list-group-item"><a href='../unit-testing-testing-thread-safety/'>Unit-testing &#8211; Testing thread safety</a></li><li class="list-group-item"><a href='../object-oriented-is-the-singleton-pattern-prone-to-thread-safety-problems/'>Object-oriented &#8211; Is the singleton pattern prone to thread safety problems</a></li><li class="list-group-item"><a href='../thread-safe-gui-programming/'>Thread safe GUI programming</a></li><li class="list-group-item"><a href='../java-testing-concurrency-thread-safety/'>Java &#8211; Testing concurrency/thread-safety</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>