<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; How to fix a project with basically no structure &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1081143 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1081143" class="post-1081143 software type-software status-publish hentry category-software tag-c tag-maintenance tag-project-management tag-visual-basic-6"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; How to fix a project with basically no structure</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">maintenance</span><span class="mr-2 badge badge-warning">project-management</span><span class="mr-2 badge badge-primary">visual-basic-6</span></p><div class="entry-content"><p>I&#39;ve been working on a software project mostly solo for over 5 years. It was a mess to begin with (I am the third or fourth developer to be working on it), and although it&#39;s less of a mess now it is still incredibly disorganized. The rate of progress in getting it under control is glacial and I&#39;m starting to feel despondent over the state that it&#39;s in. How do I really start fixing it?</p><p>Project specifics: It is a sales program written almost entirely in Visual Basic Classic (VB6) with a MySQL back end and a reporting engine written in C#. The C# reporting module is a joy to work on, it was only just written in the past couple years and before that all reports were done in Crystal Reports 9 (yes, we still have some reports that rely on it).</p><p>The actual program itself, however, is a complete disaster. There are not quite 90k LOC total, and about 10k lines of comments (mostly not documentation, but old code that&#39;s been commented out). 158 form files, and 80 module files. I have no idea how many of those are actually used, because some features of the program are simply deprecated and (uh, sometimes) noted as such without having the associated code removed from the program. I would guess that only 50% of the code is in actual productive use.</p><p>I am afraid of touching a lot of the code just because I am not sure if I&#39;m breaking something that one obscure client relies on, it&#39;s happened on more occasions than I can count. It&#39;s like there are landmines strewn throughout the code.</p><p>There is not really any structure to the project. It is not object oriented except in the few places I have had the patience to reform so far. If you need to get data on a form, you instantiate a database object, declare your query right there in the function, execute it and do what you will with the dataset.</p><p>When I began working on the project there was no source control in use. I tried to encourage the other people I was working on to use it, but I was the new guy and my attempts to get people to use subversion all but failed. The company&#39;s lead developer finally caught a mercurial bug in the last couple years and he&#39;s made sure that all developers do use source control on all projects now, so at least that&#39;s some progress.</p><p>I think if I was able to work on reforming the project full time I would be able to make decent progress and maybe even have an estimate for how long it would take me to fully makeover the project, but it is in active use and I am constantly being asked to put out fires, fix bugs, add features, etc. etc.</p><p>So how do I start to really fix this project? Try to tool VB6 with another language? Try and rewrite the program in my spare time? Or is this completely hopeless?</p><p><strong>Update</strong></p><p>After this post I went back to the project with renewed zeal, but fell back into hopelessness within a few months after seeing such a slow rate of progress. I then repeated this cycle 2 or 3 more times over the next year or so.</p><p>I have since moved on to a different job. Although after so many years of vb6, and only peripheral experience with other technologies the search was difficult and I faced many rejections along the way (around a dozen interviews over the course of a year). My advice to others in this situation is to consider leaving for this factor alone. Consider the damage you can do to your career by staying in a dead end position such as this.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Now that it&#39;s in source control, you can get rid of the commented out code.</p><p>I started here in a similar situation (80KLOC VB6 app with no source control, no real structure, almost everything done in event handlers).</p><p>In about 2 years on and off I&#39;ve gotten more than half converted to C# (usually when significant new features are required).  All new C# code has unit test coverage.  It definitely takes way more time to convert to C# though.  If you&#39;re not adding significant new modules, I wouldn&#39;t go down that route.</p><p>One thing I did was create a rudimentary data access layer that auto-generated itself from the database.  That at least caught problems where a table column name changed and I didn&#39;t find all the places in the code.  Also, I&#39;ve slowly moved the business logic into modules, out of the form event handlers.</p><p>I, however, had the advantage that the application was only internal.  Since I only had one site to deploy to, I could take some bigger risks than you could.  If I made a mistake, it wasn&#39;t usually a big deal to fix it.  Sounds like you don&#39;t have that luxury.</p><p>I really think your best bet is to take the following approach:</p><ol><li>Learn every bit in excruciating detail.  This makes it less likely you&#39;ll break something inadvertently.</li><li>Refactor mercilessly to improve separation and structure, but don&#39;t try to shoehorn a new methodology like object-oriented programming in there, since VB6 just sucks at it.</li><li>Treat it as a learning experience.  How would you know a different way is better if you&#39;d never seen the inferior way?</li><li>Don&#39;t bother rewriting in a new language/framework/platform unless you have a major module to write.  Even then, consider carefully.</li></ol><p>Remember, the goal of the program is to be a product that makes your company money.  It doesn&#39;t have to be a flawless work of art (and I&#39;m a perfectionist so it&#39;s <em>really</em> hard for me to admit that).  Sometimes it&#39;s better to embrace pragmatism.</p><p>There are supposedly a lot of COBOL programmers out there maintaining massive amounts of legacy code.  I doubt they&#39;re all madly working away at rewriting it in some new language.  :)</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../how-to-stay-productive-when-dealing-with-extremely-badly-written-code/'>How to stay productive when dealing with extremely badly written code</a></li><li class="list-group-item"><a href='../how-to-track-your-progress-in-a-project/'>How to track your progress in a project</a></li><li class="list-group-item"><a href='../how-to-handle-projects-in-which-the-project-manager-is-the-same-as-the-client/'>How to handle projects in which the project manager is the same as the client</a></li><li class="list-group-item"><a href='../how-to-document-a-project-which-is-already-developed/'>How to document a project which is already developed</a></li><li class="list-group-item"><a href='../what-was-the-design-pattern-of-vb-before-net/'>What was the design pattern of VB (before .NET)</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>