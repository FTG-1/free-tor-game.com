<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211;  a recommended pattern for REST endpoints planning for foresighted changes &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1063679 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1063679" class="post-1063679 software type-software status-publish hentry category-software tag-design tag-design-patterns tag-rest tag-services tag-web-services"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211;  a recommended pattern for REST endpoints planning for foresighted changes</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">rest</span><span class="mr-2 badge badge-primary">services</span><span class="mr-2 badge badge-danger">web services</span></p><div class="entry-content"><p>Trying to design an API for external applications with foresight for change isn&#39;t easy, but a little thought up front can make life easier later on. I&#39;m trying to establish a scheme that will support future changes while remaining backward compatible by leaving prior version handlers in place.</p><p>The primary concern on this article is to what pattern should be followed for all defined endpoints for a given product/company.</p><h2>Base Scheme</h2><p>Given a base URL template of <code>https://rest.product.com/</code> I have devised that all services reside under <code>/api</code> along with <code>/auth</code> and other non-rest based endpoints such as <code>/doc</code>. Therefore I can establish the base endpoints as follows:</p><pre><code>https://rest.product.com/api/...
https://rest.product.com/auth/login
https://rest.product.com/auth/logout
https://rest.product.com/doc/...
</code></pre><h2>Service Endpoints</h2><p>Now for the endpoints themselves. Concern about <code>POST</code>,<code>GET</code>,<code>DELETE</code> is not the primary objective of this article and is the concern on those actions themselves.</p><p>Endpoints can be broken down into namespaces and actions. Each action must also present itself in a way to support fundamental changes in return type or required parameters.</p><p>Taking a hypothetical chat service where registered users can send messages we may have the following endpoints:</p><pre><code>https://rest.product.com/api/messages/list/{user}
https://rest.product.com/api/messages/send
</code></pre><p>Now to add version support for future API changes which may be breaking. We could either add the version signature after <code>/api/</code> or after <code>/messages/</code>. Given the <code>send</code> endpoint we could then have the following for v1.</p><pre><code>https://rest.product.com/api/v1/messages/send
https://rest.product.com/api/messages/v1/send
</code></pre><p>So my first question is, what is a recommended place for the version identifier?</p><h2>Managing Controller Code</h2><p>So now we have established we need to support prior versions we need to thus somehow handle code for each of the new versions which may deprecate over time. Assuming we are writing endpoints in Java we could manage this through packages.</p><pre><code>package com.product.messages.v1;
public interface MessageController {
    void send();
    Message[] list();
}
</code></pre><p>This has the advantage that all code has been separated through namespaces where any breaking change would mean that a new copy of the service endpoints. The detriment of this is that all code needs to be copied and bug fixes wished to be applied to new and prior versions needs to be applied/tested for each copy.</p><p>Another approach is to create handlers for each endpoint.</p><pre><code>package com.product.messages;
public class MessageServiceImpl {
    public void send(String version) {
        getMessageSender(version).send();
    }
    // Assume we have a List of senders in order of newest to oldest.
    private MessageSender getMessageSender(String version) {
        for (MessageSender s : senders) {
            if (s.supportsVersion(version)) {
                return s;
            }
        }
    }
}
</code></pre><p>This now isolates versioning to each endpoint itself and makes bug fixes back port compatible by in most cases only needing to be applied once, but it does mean that we need to do a fair bit more work to each individual endpoint to support this.</p><p>So there&#39;s my second question &#34;What&#39;s the best way to design REST service code to support prior versions.&#34;</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>So there&#39;s my second question &#34;What&#39;s the best way to design REST service code to support prior versions.&#34;</p></blockquote><p>A very carefully designed, and orthogonal API will probably never need to be changed in backward incompatible ways, so really the best way is not to have future versions.</p><p>Of course, you probably won&#39;t really get that the first try; So:</p><ul><li>Version your API, just as you are planning (and it&#39;s the API that is versioned, not individual methods within), and make lots of noise about it.  Make sure that your partners know that the API can change, and that their applications should check to see if they are using the latest version; and advise users to upgrade when a newer one is available.  Supporting two old versions is tough, supporting five is untenable.</li><li>Resist the urge to update the API version with every &#34;release&#34;.  The new features can usually be rolled into the current version without breaking existing clients; they&#39;re new features.  The last thing you want is for clients to <em>ignore</em> the version number, since it&#39;s mostly backwards compatible anyway.  Only update the API version when you absolutely cannot move forward without breaking the existing API.</li><li>When the time comes to create a new version, the very first client should be the backwards-compatible implementation of the previous version.  The &#34;maintenance API&#34; should itself be implemented on the current API.  This way you aren&#39;t on the hook for mantaining several full implementations; only the current version, and several &#34;shells&#34; for the old versions.  Running a regression test for the now deprecated API against the backwards comaptible client is a good way to test out both the new API and the compatibility layer.</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-public-api-facade-with-micro-services/'>Rest &#8211; Public API Facade with Micro Services</a></li><li class="list-group-item"><a href='../rest-a-good-design-pattern-to-implement-rest-services-on-mobile/'>Rest &#8211;  a good design pattern to implement REST services on mobile</a></li><li class="list-group-item"><a href='../rest-oauth2-ropc-vs-basic-auth-for-public-rest-apis/'>Rest &#8211; OAuth2 ROPC vs Basic Auth for public REST APIs</a></li><li class="list-group-item"><a href='../rest-how-to-structure-files-for-api-versioning/'>Rest &#8211; How to structure files for API versioning</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>