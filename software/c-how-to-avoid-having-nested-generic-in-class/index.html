<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; How to avoid having nested generic in class &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073481 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073481" class="post-1073481 software type-software status-publish hentry category-software tag-c tag-class-design tag-inheritance"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; How to avoid having nested generic in class</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">class-design</span><span class="mr-2 badge badge-warning">inheritance</span></p><div class="entry-content"><p>I&#39;m working on a side project, and I turned on all rules for code analysis in Visual Studio, and I got the warning notice:</p><blockquote><p>Warning   CA1006  Consider a design where &#39;<code>Vote&lt;T&gt;.CalculateWinner(List&lt;Vote&lt;T&gt;&gt;)</code>&#39; doesn&#39;t nest generic type &#39;<code>List&lt;Vote&lt;T&gt;&gt;</code>&#39;</p></blockquote><p>And it really does point out a sore spot in my design. I have an abstract base class <code>Vote&lt;T&gt;</code> that contains a list of the options for running an election on type <code>T</code>.</p><p>Here is what I want to exist:</p><p>There are three types of objects, <code>PolicyCategory</code>, <code>Policy</code> and <code>Funding</code>. A <code>PolicyCategory</code> contains a list of votes on the policies within it, and a vote on a <code>Policy</code> must also contain a list of votes on a <code>Funding</code> object. The election procedure (happens to be STV) is then run on the votes in the category, and then on the votes on the winning policy. The procedure is the same for both types of votes.</p><p>What I have now is <code>PolicyVote : Vote&lt;Policy&gt;</code> and <code>FundingVote : Vote&lt;Funding&gt;</code>, the core election logic is in <code>Vote&lt;T&gt;</code>, and I have methods that cast <code>List&lt;PolicyVote&gt;</code> to <code>List&lt;Vote&lt;Policy&gt;&gt;</code>, and then call <code>Vote&lt;T&gt;.CalculateWinner()</code>.</p><p>This is clearly pretty horrible as I&#39;m hacking around the lack of contravariance in C#.</p><p>How can this be made better?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I would consider using an interface for Vote instead of generics.</p><p>That way if you had something like:</p><pre><code>interface IVote {
    // your interface requirements
}
</code></pre><p>And then on your class definitions implement the <code>IVote</code> interface:</p><pre><code>class PolicyVote : IVote {
    // class def
}

class FundingVote : IVote { 
    // class def
}

//etc. 
</code></pre><p>You could then avoid casting to <code>Vote&lt;T&gt;</code> and use <code>IVote</code> as a type instead and any class that implements <code>IVote</code> will be recognised by the compiler as type safe :</p><pre><code>public static int CalculateWinner(List&lt;IVote&gt; votes) {
    // your calc logic
}

//You can now pass any object that implements `IVote` to the method
//assuming policyVotes and fundingVotes are type List&lt;IVote&gt;
CalculateWinner(policyVotes); // this will work
CalculateWinner(fundingVotes); // so will this 
</code></pre></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../design-method-that-loads-data-from-one-of-two-file-formats/'>Design: Method that loads data from one of two file formats</a></li><li class="list-group-item"><a href='../rest-api-wrapper-class-design-for-lite-object-responses/'>REST API wrapper &#8211; class design for &#8216;lite&#8217; object responses</a></li><li class="list-group-item"><a href='../c-a-good-design-for-a-method-that-can-return-several-logically-different-results/'>C# &#8211;  a good design for a method that can return several logically different results</a></li><li class="list-group-item"><a href='../object-oriented-design-patterns-for-creating-objects-that-have-a-list-of-objects-that-also-have-a-list-of-objects/'>Object-oriented &#8211; Design patterns for creating objects that have a list of objects that also have a list of objects</a></li><li class="list-group-item"><a href='../java-designing-generic-type-inheritance-hierarchy/'>Java &#8211; Designing generic type inheritance hierarchy</a></li><li class="list-group-item"><a href='../c-proper-design-to-avoid-the-use-of-dynamic_cast/'>C++ &#8211; Proper design to avoid the use of dynamic_cast</a></li><li class="list-group-item"><a href='../c-should-i-avoid-nested-generic-collections/'>C# &#8211; Should I avoid nested generic collections</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>