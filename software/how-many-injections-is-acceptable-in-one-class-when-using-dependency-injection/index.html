<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How many injections is acceptable in one class when using dependency injection &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073670 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073670" class="post-1073670 software type-software status-publish hentry category-software tag-dependency-injection"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How many injections is acceptable in one class when using dependency injection</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">dependency-injection</span></p><div class="entry-content"><p>I&#39;m using Unity in C# for dependency injection, but the question should be applicable for any language and framework that is using dependency injection.</p><p>I&#39;m trying to follow the SOLID-principle and therefore I got a lot of abstractions. But now I&#39;m wondering if there&#39;s a best practice for how many injections one class should inject?</p><p>For example, I have a repository with 9 injections. Will this be hard to read for another developer?</p><p>The injections have the following responsibilities:</p><ul><li>IDbContextFactory &#8211; creating the context for the database.</li><li>IMapper &#8211; Mapping from entities to domain models.</li><li>IClock &#8211; Abstracts DateTime.Now to help with unit tests.</li><li>IPerformanceFactory &#8211; measures the execution time for specific methods.</li><li>ILog &#8211; Log4net for logging.</li><li>ICollectionWrapperFactory &#8211; Creates collections (that extends IEnumerable).</li><li>IQueryFilterFactory &#8211; Generates queries based on input that will query db.</li><li>IIdentityHelper &#8211; Retrieves the logged in user.</li><li>IFaultFactory &#8211; Create different FaultExceptions (I use WCF).</li></ul><p>I&#39;m not really dissapointed with how I delegated the responsibilities, but I&#39;m starting to get worried for the readability.</p><p>So, my questions:</p><p><strong>Is there a limit for how many injections a class should have? And if so, how to avoid it?</strong></p><p><strong>Does many injections limit readability, or does it actually improve it?</strong></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Too much dependencies may indicate that the class itself is doing too much. In order to determine if it&#39;s doing too much:</p><ul><li><p>Look at the class itself. Would it make sense to split it in two, three, four? Does it make sense as a whole?</p></li><li><p>Look at the types of dependencies. Which ones are domain-specific, and which ones are “global”? For instance, I wouldn&#39;t consider <code>ILog</code> at the same level as <code>IQueryFilterFactory</code>: the first one would be available in most business classes anyway if they are using logging. On the other hand, if you find a lot of domain-specific dependencies, this may indicate that the class is doing too much.</p></li><li><p>Look at the dependencies which can be replaced by values.</p><blockquote><p>IClock - Abstracts DateTime.Now to help with unit tests.</p></blockquote></li></ul><p>This could easily be replaced by <code>DateTime.Now</code> being passed directly to the methods which require to know the current time.</p><p>By looking at the actual dependencies, I don&#39;t see anything which would be indicative of bad things happening:</p><ul><li><p><strong>IDbContextFactory - creating the context for the database.</strong></p><p>OK, we are probably inside a business layer where classes interact with data access layer. Looks fine.</p></li><li><p><strong>IMapper - Mapping from entities to domain models.</strong></p><p>It&#39;s difficult to tell anything without the overall picture. It might be that the architecture is wrong and the mapping should be done directly by the data access layer, or it may be that the architecture is perfectly fine. In all cases, it makes sense to have this dependency here.</p><p>Another choice would be to split the class in two: one dealing with mapping, the other one dealing with the actual business logic. This would create a de facto layer which will separate further the BL from the DAL. If mappings are complex, it could be a good idea. In most cases, though, it would just add useless complexity.</p></li><li><p><strong>IClock - Abstracts DateTime.Now to help with unit tests.</strong></p><p>It is probably not very useful to have a separate interface (and class) just to get the current time. I would simply pass the <code>DateTime.Now</code> to the methods which require the current time.</p><p>A separate class may make sense if there is some other information, like the timezones, or the date ranges, etc.</p></li><li><p><strong>IPerformanceFactory - measures the execution time for specific methods.</strong></p><p>See the next point.</p></li><li><p><strong>ILog - Log4net for logging.</strong></p><p>Such transcendent functionality should belong to the framework, and the actual libraries should be interchangeable and configurable at runtime (for instance through app.config in .NET).</p><p>Unfortunately, this is not (yet) the case, which let you either pick a library and stick with it, or create an abstraction layer to be able to swap the libraries later if needed. If your intention is specifically to be independent of the choice of the library, go for it. If you&#39;re pretty sure that you&#39;ll continue using the library for years, don&#39;t add an abstraction.</p><p>If the library is too complex to use, a facade pattern makes sense.</p></li><li><p><strong>ICollectionWrapperFactory - Creates collections (that extends IEnumerable).</strong></p><p>I would assume that this creates very specific data structures which are used by the domain logic. It looks like a utility class. Instead, use one class per data structure with relevant constructors. If the initialization logic is slightly complicated to fit in a constructor, use static factory methods. If the logic is even more complex, use factory or a builder pattern.</p></li><li><p><strong>IQueryFilterFactory - Generates queries based on input that will query db.</strong></p><p>Why isn&#39;t that in the data access layer? Why is there a <code>Filter</code> in the name?</p></li><li><p><strong>IIdentityHelper - Retrieves the logged in user.</strong></p><p>I&#39;m not sure why is there a <code>Helper</code> suffix. In all cases, other suffixes won&#39;t be particularly explicit either (<code>IIdentityManager</code>?)</p><p>Anyway, it makes perfect sense to have this dependency here.</p></li><li><p><strong>IFaultFactory - Create different FaultExceptions (I use WCF).</strong></p><p>Is the logic so complex that it requires to use a factory pattern? Why is Dependency Injection used for that? Would you swap the creation of exceptions between production code and tests? Why?</p><p>I would try to refactor that into simple <code>throw new FaultException(...)</code>. If some global information should be added to all the exceptions before propagating them to the client, WCF probably has a mechanism where you catch an unhandled exception and can change it and re-throw it to the client.</p></li></ul><blockquote><p>Is there a limit for how many injections a class should have? And if so, how to avoid it?</p></blockquote><p>Measuring the quality by numbers is usually as bad as being paid by lines of code you write per month.  You may have a high number of dependencies in a well-designed class, as you can have a crappy class using few dependencies.</p><blockquote><p>Does many injections limit readability, or does it actually improve it?</p></blockquote><p>Lots of dependencies make the logic more difficult to follow. If the logic is difficult to follow, the class is probably doing too much and should be split.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../acceptable-placement-of-the-composition-root-using-dependency-injection-di-and-inversion-of-control-ioc-containers/'>Acceptable placement of the composition root using dependency injection (DI) and inversion of control (IoC) containers</a></li><li class="list-group-item"><a href='../c-dependency-injection-where-to-store-dependencies-used-by-only-one-method/'>C# &#8211; Dependency Injection: where to store dependencies used by only one method</a></li><li class="list-group-item"><a href='../c-the-right-way-to-implement-di-in-net/'>C# &#8211;  the &#8220;right&#8221; way to implement DI in .NET</a></li><li class="list-group-item"><a href='../handling-disposables-with-dependency-injection/'>Handling disposables with dependency injection</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>