<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Is this method pure &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1071390 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1071390" class="post-1071390 software type-software status-publish hentry category-software tag-c tag-pure-function"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Is this method pure</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">pure-function</span></p><div class="entry-content"><p>I have the following extension method:</p><pre><code>    public static IEnumerable&lt;T&gt; Apply&lt;T&gt;(
        [NotNull] this IEnumerable&lt;T&gt; source,
        [NotNull] Action&lt;T&gt; action)
        where T : class
    {
        source.CheckArgumentNull(&#34;source&#34;);
        action.CheckArgumentNull(&#34;action&#34;);
        return source.ApplyIterator(action);
    }

    private static IEnumerable&lt;T&gt; ApplyIterator&lt;T&gt;(this IEnumerable&lt;T&gt; source, Action&lt;T&gt; action)
        where T : class
    {
        foreach (var item in source)
        {
            action(item);
            yield return item;
        }
    }
</code></pre><p>It just applies an action to each item of the sequence before returning it.</p><p>I was wondering if I should apply the <a href="http://www.jetbrains.com/resharper/webhelp/Reference__Code_Annotation_Attributes.html#PureAttribute"><code>Pure</code> attribute (from Resharper annotations)</a> to this method, and I can see arguments for and against it.</p><p><strong>Pros:</strong></p><ul><li>strictly speaking, it <em>is</em> pure; just calling it on a sequence doesn&#39;t alter the sequence (it returns a new sequence) or make any observable state change</li><li>calling it without using the result is clearly a mistake, since it has no effect unless the sequence is enumerated, so I&#39;d like Resharper to warn me if I do that.</li></ul><p><strong>Cons:</strong></p><ul><li>even though the <code>Apply</code> method itself is pure, enumerating the resulting sequence <em>will</em> make observable state changes (which is the point of the method). For instance, <code>items.Apply(i =&gt; i.Count++)</code> will change the values of the items every time it&#39;s enumerated. So applying the Pure attribute is probably misleading&#8230;</li></ul><p>What do you think? Should I apply the attribute or not?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>No it is not pure, because it has side effect. Concretely it is calling <code>action</code> on each item. Also, it is not threadsafe.</p><p>The major property of pure functions is that it can be called any number of times and it never does anything else than return same value. Which is not your case. Also, being pure means you don&#39;t use anything else than the input parameters. This means it can be called from any thread at any time and not cause any unexpected behavior. Again, that is not case of your function.</p><p>Also, you might be mistaken on one thing: function purity is not question of pros or cons. Even single doubt, that it can have side effect, is enough to make it not pure.</p><p><a href="https://softwareengineering.stackexchange.com/a/243225/31260">Eric Lippert</a> raises a good point. I&#39;m going to use <a href="http://msdn.microsoft.com/en-us/library/dd264808(v=vs.110).aspx" rel="nofollow noreferrer">http://msdn.microsoft.com/en-us/library/dd264808(v=vs.110).aspx</a> as part of my counter-argument. Especially line</p><blockquote><p>A pure method is allowed to modify objects that have been created after entry into the pure method.</p></blockquote><p>Lets say we create method like this:</p><pre><code>int Count&lt;T&gt;(IEnumerable&lt;T&gt; e)
{
    var enumerator = e.GetEnumerator();
    int count = 0;
    while (enumerator.MoveNext()) count ++;
    return count;
}
</code></pre><p>First, this assumes that <code>GetEnumerator</code> is pure too (I can&#39;t really find any source on that). If it is, then according to above rule, we can annotate this method with [Pure], because it only modifies instance that was created within the body itself. After that we can compose this and the <code>ApplyIterator</code>, which should result in pure function, right?</p><pre><code>Count(ApplyIterator(source, action));
</code></pre><p>No. This composition is not pure, even when both <code>Count</code> and <code>ApplyIterator</code> are pure. But I might be building this argument on wrong premise. I think that the idea that instances created within the method are exempt from the purity rule is either wrong or at least not specific enough.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/c-how-to-make-creating-viewmodels-at-runtime-less-painful/'>C# &#8211; How to make creating viewmodels at runtime less painful</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/javascript-compute-if-a-function-is-pure/'>Javascript &#8211; Compute if a function is pure</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-when-to-use-pure-on-a-constructor/'>C# &#8211; When to use [Pure] on a constructor</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-does-catching-throwing-exceptions-render-an-otherwise-pure-method-impure/'>C# &#8211; Does catching/throwing exceptions render an otherwise pure method impure</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/pure-functional-vs-tell-dont-ask/'>Pure functional vs tell, don&#8217;t ask</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/is-a-memoized-pure-function-itself-considered-pure/'>Is a memoized pure function itself considered pure</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>