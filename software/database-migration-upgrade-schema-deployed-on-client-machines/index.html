<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Database migration: upgrade schema deployed on client machines &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1083936 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1083936" class="post-1083936 software type-software status-publish hentry category-software tag-database tag-database-development tag-migration tag-software-updates tag-versioning"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Database migration: upgrade schema deployed on client machines</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database</span><span class="mr-2 badge badge-info">database-development</span><span class="mr-2 badge badge-warning">migration</span><span class="mr-2 badge badge-primary">software-updates</span><span class="mr-2 badge badge-danger">versioning</span></p><div class="entry-content"><p>I&#39;m working on an application, which when deployed is installed locally on client machines, and uses a local database server.  Stupidly, I didn&#39;t plan for schema changes &#8212; and now it needs to change.</p><p>Perusing lots of SO and Programmers questions, and googling, I&#39;ve found a few strategies:</p><ul><li><strong>many SQL files.</strong> One for each version.  When upgrading, use version number to decide which SQL file(s) to execute</li><li><strong>one SQL file.</strong> No <code>drop</code>-statements, tables created with `create table if not exists  &#8212; so when upgrading or installing the first time, simply run this file.  Everything already in the db will be fine, all new tables etc. will be created</li><li><strong>blow away, then rebuild db.</strong><ol><li>make a copy of all the data</li><li>drop the entire schema</li><li>load in the new schema</li><li>reload the data</li></ol></li><li><strong>auto-generated diff file.</strong> Seems to be mistrusted by some; tool for generating such a file costs money (??)</li></ul><p>I&#39;m looking for advice to help decide between these strategies.</p><p>An additional note:  the data is upwards-compatible (if that&#39;s the right term):  none of the schema changes involve dropping tables or columns, or changing FK/PK relationships.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I would personally do it the following way:</p><ol><li>The applications released to your clients must have <strong>clear version numbers</strong>, for example &#34;1.2&#34;, &#34;1.4&#34; etc, which is <strong>easy to be quickly determined on the client machine</strong> (registry/configuration file/table).</li><li><strong>The database schema for every single version is known and constant</strong> on every client machine.</li><li>When you roll-out a newer version of your application <strong>you just implement the necessary upgrade the the latest public version</strong> (upgrade from previous minor version), for example from 1.2 to 1.4, 1.4 to 1.6 etc. In your script you perform all necessary updates: adding new columns, keys, tables, references etc.</li><li>You installer should bundle all update scripts:<ul><li>When your customer runs the <strong>installer</strong> it first <strong>checks for the installed version</strong>.</li><li>Depending upon the determined version <strong>all scripts are applied sequentially</strong> until the database is updated to the latest version.</li></ul></li><li>If your release cycle is short and you often release new versions, you might think of impelementing a <strong>cummulative updating scripts from one major version to another</strong>, so that you can diminish the number of scripts applied. You still first update the client DB to the next major version using single scripts and then quickly upgrade from major version to major version using this cummulative update scripts.</li></ol><p><em>The main advantage here is that you don&#39;t have to support many scenarios for update: you just make diff against the latest public version and maintain this part of your update.</em></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-handling-database-schema-changes-when-pushing-new-versions/'>Database &#8211; Handling database schema changes when pushing new versions</a></li><li class="list-group-item"><a href='../how-to-maintain-a-sql-schema-upgrade-that-goes-out-to-our-users-on-a-regular-basis/'>How to maintain a SQL schema upgrade that goes out to our users on a regular basis</a></li><li class="list-group-item"><a href='../using-sql-server-change-data-capture-with-a-frequently-changing-schema/'>Using Sql Server Change Data Capture with a frequently changing schema</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>