<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; Are exceptions for flow control best practice in Python &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066928 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066928" class="post-1066928 software type-software status-publish hentry category-software tag-exceptions tag-programming-practices tag-python"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; Are exceptions for flow control best practice in Python</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">exceptions</span><span class="mr-2 badge badge-info">programming practices</span><span class="mr-2 badge badge-warning">python</span></p><div class="entry-content"><p>I&#39;m reading &#34;Learning Python&#34; and have come across the following:</p><blockquote><p>User-defined exceptions can also signal nonerror conditions. For<br /> instance, a search routine can be coded to raise an exception when a<br /> match is found instead of returning a status flag for the caller to<br /> interpret. In the following, the try/except/else exception handler<br /> does the work of an if/else return-value tester:</p></blockquote><pre><code>class Found(Exception): pass

def searcher():
    if ...success...:
        raise Found()            # Raise exceptions instead of returning flags
    else:
        return
</code></pre><blockquote><p>Because Python is dynamically typed and polymorphic to the core,<br /> exceptions, rather than sentinel return values, are the generally<br /> preferred way to signal such conditions.</p></blockquote><p>I&#39;ve seen this sort of thing discussed multiple times on various forums, and<br /> references to Python using StopIteration to end loops, but I can&#39;t find much<br /> in the official style guides (PEP 8 has one offhand reference to exceptions<br /> for flow control) or statements from developers. Is there anything official<br /> that states this is best practice for Python?</p><p>This (<a href="https://softwareengineering.stackexchange.com/questions/189222/are-exceptions-as-control-flow-considered-a-serious-antipattern-if-so-why">Are exceptions as control flow considered a serious antipattern? If so, Why?</a>) also has several commenters state that this style is Pythonic. What is this based on?</p><p>TIA</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The general consensus “don&#39;t use exceptions!” mostly comes from other languages and even there is sometimes outdated.</p><ul><li><p>In C++, <a href="https://stackoverflow.com/questions/13835817/are-exceptions-in-c-really-slow"><em>throwing</em> an exception is very costly</a> due to “stack unwinding”. Every local variable declaration is like a <code>with</code> statement in Python, and the object in that variable may run destructors. These destructors are executed when an exception is thrown, but also when returning from a function. This “RAII idiom” is an integral language feature and is super important to write robust, correct code – so RAII versus cheap exceptions was a tradeoff that C++ decided towards RAII.</p></li><li><p>In early C++, a lot of code was not written in an exception-safe manner: unless you actually use RAII, it is easy to leak memory and other resources. So throwing exceptions would render that code incorrect. This is no longer reasonable since even the C++ standard library uses exceptions: you can&#39;t pretend exceptions don&#39;t exist. However, exceptions are still an issue when combining C code with C++.</p></li><li><p>In Java, every exception has an associated stack trace. The stack trace is very valuable when debugging errors, but is wasted effort when the exception is never printed, e.g. because it was only used for control flow.</p></li></ul><p>So in those languages exceptions are “too expensive” to be used as control flow. In Python this is less of an issue and exceptions are a lot cheaper. Additionally, the Python language already suffers from some overhead that makes the cost of exceptions unnoticeable compared to other control flow constructs: e.g. checking if a dict entry exists with an explicit membership test <code>if key in the_dict: ...</code> is generally exactly as fast as simply accessing the entry <code>the_dict[key]; ...</code> and checking if you get a KeyError. Some integral language features (e.g. generators) are designed in terms of exceptions.</p><p>So while there is no technical reason to specifically avoid exceptions in Python, there is still the question whether you should use them instead of return values. The design-level problems with exceptions are:</p><ul><li><p>they are not at all obvious. You can&#39;t easily look at a function and see which exceptions it may throw, so you don&#39;t always know what to catch. The return value tends to be more well-defined.</p></li><li><p>exceptions are non-local control flow which complicates your code. When you throw an exception, you don&#39;t know where the control flow will resume. For errors that can&#39;t be immediately handled this is probably a good idea, when notifying your caller of a condition this is entirely unnecessary.</p></li></ul><p>Python culture is generally slanted in favour of exceptions, but it&#39;s easy to go overboard. Imagine a <code>list_contains(the_list, item)</code> function that checks whether the list contains an item equal to that item. If the result is communicated via exceptions that is absolutely annoying, because we have to call it like this:</p><pre><code>try:
  list_contains(invited_guests, person_at_door)
except Found:
  print(&#34;Oh, hello {}!&#34;.format(person_at_door))
except NotFound:
  print(&#34;Who are you?&#34;)
</code></pre><p>Returning a bool would be much clearer:</p><pre><code>if list_contains(invited_guests, person_at_door):
  print(&#34;Oh, hello {}!&#34;.format(person_at_door))
else:
  print(&#34;Who are you?&#34;)
</code></pre><p>If the function is already supposed to return a value, then returning a special value for special conditions is rather error-prone, because people will forget to check this value (that&#39;s probably the cause of 1/3 of the problems in C). An exception is usually more correct.</p><p>A good example is a <code>pos = find_string(haystack, needle)</code> function that searches for the first occurrence of the <code>needle</code> string in the `haystack string, and returns the start position. But what if they haystack-string does not contain the needle-string?</p><p>The solution by C and mimicked by Python is to return a special value. In C this is a null pointer, in Python this is <code>-1</code>. This will lead to surprising results when the position is used as a string index without checking, especially as <code>-1</code> is a valid index in Python. In C, your NULL pointer will at least give you a segfault.</p><p>In PHP, a special value of a different type is returned: the boolean <code>FALSE</code> instead of an integer. As it turns out this isn&#39;t actually any better due to the implicit conversion rules of the language (but note that in Python as well booleans can be used as ints!). Functions that do not return a consistent type are generally considered very confusing.</p><p>A more robust variant would have been to throw an exception when the string can&#39;t be found, which makes sure that during normal control flow it is impossible to accidentally use the special value in place of an ordinary value:</p><pre><code> try:
   pos = find_string(haystack, needle)
   do_something_with(pos)
 except NotFound:
   ...
</code></pre><p>Alternatively, always returning a type that can&#39;t be used directly but must first be unwrapped can be used, e.g. a result-bool tuple where the boolean indicates whether an exception occurred or if the result is usable. Then:</p><pre><code>pos, ok = find_string(haystack, needle)
if not ok:
  ...
do_something_with(pos)
</code></pre><p>This forces you to handle problems immediately, but it gets annoying very quickly. It also prevents you from chaining function easily. Every function call now needs three lines of code. Golang is a language that thinks this nuisance is worth the safety.</p><p>So to summarize, exceptions are not entirely without problems and can definitively be overused, especially when they replace a “normal” return value. But when used to signal special conditions (not necessarily just errors), then exceptions can help you to develop APIs that are clean, intuitive, easy to use, and difficult to misuse.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-exceptions-error-codes-and-discriminated-unions/'>C# &#8211; Exceptions, error codes and discriminated unions</a></li><li class="list-group-item"><a href='../c-why-is-it-bad-to-use-exceptions-for-handling-this-type-of-validation-it-seems-like-it-makes-the-code-so-much-cleaner/'>C# &#8211; Why is it bad to use exceptions for handling this type of validation? It seems like it makes the code so much cleaner</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>