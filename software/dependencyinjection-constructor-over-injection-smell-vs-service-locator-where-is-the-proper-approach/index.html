<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>DependencyInjection &#8211; Constructor over-injection smell vs service locator &#8211; where is the proper approach &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1083484 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1083484" class="post-1083484 software type-software status-publish hentry category-software tag-code-smell tag-dependency-injection tag-inversion-of-control tag-ioc-containers tag-service-locator"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">DependencyInjection &#8211; Constructor over-injection smell vs service locator &#8211; where is the proper approach</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">code smell</span><span class="mr-2 badge badge-info">dependency-injection</span><span class="mr-2 badge badge-warning">inversion-of-control</span><span class="mr-2 badge badge-primary">ioc-containers</span><span class="mr-2 badge badge-danger">service-locator</span></p><div class="entry-content"><p>I am trying to improve my MVC projects and I read a few articles about DI, IoC containers, Constructor Injection and Service locators. I wanted to go with Ninject to help with the dependencies, but got puzzled with some of the stuff I read.</p><p>The most controversial would be the widely discussed one here <a href="http://jeffreypalermo.com/blog/constructor-over-injection-anti-pattern/" rel="nofollow noreferrer">http://jeffreypalermo.com/blog/constructor-over-injection-anti-pattern</a> (both parts).</p><p>And then some responses to it, like <a href="http://blog.ploeh.dk/2010/01/20/RebuttalConstructorover-injectionanti-pattern/" rel="nofollow noreferrer">Mark Seemann&#39;s response</a>, and a <a href="http://blog.ploeh.dk/2010/01/20/EnablingDIforLazyComponents/" rel="nofollow noreferrer">follow up</a></p><p>Jeffrey expreses my fears and addresses them in an incorrect manner &#8211; however, I am not sure what to do in my case.</p><p>For example, lets look at an MVC controller. It serves as a communication layer between an MCV App and a WebAPI. I&#39;m a bit concenrned about the number of dependencies I would have when doing Constructor Injection.</p><pre><code>public class OcrController : ConnectorControllerBase, IOcrController
{
    private readonly ILogger logger;
    private readonly IConnectorConfigurator config;
    private readonly HttpClient client;
    private readonly IOcrConnector connector;

    public OcrController(
            ILogger logger, 
            IConnectorConfigurator config, 
            HttpClient client, 
            IOcrConnector connector) 
    {
        this.logger = logger;
        this.config = config;
        this.client = client;
        this.connector = connector;
    }
}
</code></pre><p>While the IOcrConnector and HttpClient are clear depenendencies that I have no issues with, I am concerned about the other two. Depending on an action , it require an IConfiguration to read something from the config and similarily a Logger might be needed in some cases.</p><p>Same would be true for many of my classes &#8211; one or two actual dependencies, and the logger and config and maybe something else in the future.</p><p>At the moment I am using a simple and poor ServiceLocator, where instead of passing the ILogger and IConfig to constructor, I create them when needed:</p><pre><code>protected ILogger Logger =&gt; this.logger 
    ?? (this.logger = ComponentFactory.GetLogger(this.GetType()));

protected IConnectorConfigurator Config =&gt; this.config 
    ?? (this.config = ComponentFactory.GetConfig());
</code></pre><p>The &#39;Factory&#39; is very simple, because it simply returns my ILogger wrapper like below:</p><pre><code>public static ILogger GetLogger(Type type)
{
    return new Log4NetLogger(type);
}
</code></pre><p>This factory lives in a separate assembly, so it seems to me it decouples the concrete ILogger from the actual projects sufficiently&#8230;?</p><p>I do not intend to be exchanging the ILogger or IConfig (which is now just a wrapper for built-in ConfigurationManager) at runtime or whatever, but when/if the need arises, I would just change the type returned from the GetLogger(Type type); method.</p><p>So, please let me know if that kind of mix of proper DI and ServiceLocator makes sense?<br /> Other alternative I think of would maybe be passing an IComponentFactory into the constructor (instead of having a globally accessed static?) But that is still a service locator, only placed elsewhere&#8230;</p><p>Please let me know what you think</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>In your linked example the blogger is arguing that the code should be refactored because the dependency &#39;is passed down the chain&#39; rather than being used directly.</p><p>Its a &#39;Hobo parameter&#39; code smell rather than anything to do with DI. He could fix it by injecting into Order instead of OrderProcessor</p><p>In your example your controller will presumably directly used ILogger? So its not the same issue.</p><p>Moveover MVC controllers will always require many service classes to be injected as they must necessarily be designed in a procedural way.</p><p>Consider that a Method call on your controller which takes an Order parameter must construct that object from the pure value data in the request via binding.</p><p>Because the Order input parameter is created by this pipeline you must inject the dependency into the controller or the binder.</p><p>Either way the pipeline must act as the dependency setup for the call in exactly the way the blogger objects to, because the Order object must be created from the incoming data rather than be passed in by reference</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-di-and-hypothetical-readonly-setters-in-c/'>C# &#8211; DI and hypothetical readonly setters in C#</a></li><li class="list-group-item"><a href='../c-ioc-as-service-locator/'>C# &#8211; IoC as service locator</a></li><li class="list-group-item"><a href='../c-ambient-dependency-injection-through-static-service-locator/'>C# &#8211; Ambient dependency injection through static service locator</a></li><li class="list-group-item"><a href='../service-locator-vs-dependency-injection/'>Service locator vs Dependency Injection</a></li><li class="list-group-item"><a href='../whats-the-difference-between-using-dependency-injection-with-a-container-and-using-a-service-locator/'>What&#8217;s the difference between using dependency injection with a container and using a service locator</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>