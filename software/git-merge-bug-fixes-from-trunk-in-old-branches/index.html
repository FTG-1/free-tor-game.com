<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Git &#8211; Merge bug fixes from trunk in old branches &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1086007 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1086007" class="post-1086007 software type-software status-publish hentry category-software tag-branching tag-git tag-svn"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Git &#8211; Merge bug fixes from trunk in old branches</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">branching</span><span class="mr-2 badge badge-info">git</span><span class="mr-2 badge badge-warning">svn</span></p><div class="entry-content"><p>We are now in the process of switching from svn to git (after a year spent on convincing people, yay!) in my company.</p><p>So far, this is all for the better but there is one little thing that we currently have in our workflow that I can&#39;t find a good equivalent too.</p><p>Currently, all our developers work in master. Once every quarter, we branch master into X.x branch, which will later on become our latest release. This means that our svn repo looks like this:</p><ul><li>trunk</li><li>branches<ul><li>3.8</li><li>4.1</li><li>4.2</li><li>&#8230;</li></ul></li></ul><p>We don&#39;t really use tags.</p><p><strong>Once in a while, there is an urgent bug fix that is discovered.</strong></p><p>The current way for us to do it is:</p><ul><li>Fix it in master</li><li>SVN merge the relevant range of commits back into the relevant branches (Maybe our latest release, maybe more).</li></ul><p>We are in the space industry, so our branches are long lived and the customer upgrade process is rather long, which is why we have worked like that so far.</p><p><strong>Now, how would be a good equivalent in git?</strong></p><p>So far, I have tried to fix the bug in a branch spawned from master, and then merge this branch back in master and in 4.3 (for example).<br /> Thing is, the hotfix branch contains the master history, and all the commits between master and 4.3 get merged as well, which we don&#39;t  want to.</p><p>Things I could think of so far:</p><ul><li>I have looked at the very successful <strong><a href="http://nvie.com/posts/a-successful-git-branching-model/" rel="nofollow">Git Workflow method</a></strong>, and their solution is to <strong>fix the bug in the release branch and merge it back</strong> instead of the other way around. This could work in our case, but would be rather cumbersome because it would require us to already know the oldest branch we want to fix the bug in before actually fixing the bug.</li><li>Another solution is to <strong>fix in master, and then cherry pick the commits</strong> (as we do for the svn merge today). The annoying thing here is that in this case we lose history of what has been merged back where, since cherry picks look like new commits and we lose the relationship.</li></ul><p>So what is the &#34;good&#34; way to do it? Should we fix commits in history, or cherry pick and manually keep track of what has been merged, or even something else?</p><p>If have little production experience with git, so I am sure I may have missed something.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The Git Flow assumes you only have a single supported release, with the <code>master</code> branch always pointing to the latest release. Since you support multiple releases simultaneously, you cannot copy that workflow 1:1. Nvie&#39;s Git Flow is a very good example of a branching strategy, but you must adapt it to your needs. Most importantly, you will have multiple active release branches.</p><p>When you identify a bug, you will have to do some testing to determine all affected versions. It is not sufficient to write the fix first, then merge it back into the release branches as a hotfix. Usually, you&#39;ll end up with some continuous range of affected versions. Very old versions might not contain the bug, newer versions might have gotten that bug fixed accidentally. You will need to verify the bug on each version so that you can verify it is actually gone after the fix. If you can express the bug as an automated testcase, it&#39;s pretty straightforward to find the problematic commit via <code>git bisect</code>, or to run the test for each release:</p><pre class="lang-bash prettyprint-override"><code>for release in 3.8 4.1 4.2
do
  git checkout $release
  if ./testcase &gt;release-$release.log
  then echo &#34;$release ok&#34;
  else echo &#34;$release AFFECTED&#34;
  fi
done
</code></pre><p>Now, you used to write the fix on <code>trunk</code>/<code>master</code>. This is problematic because the buggy part may have changed between versions, so a patch will not usually apply to an older version. In particular, code in <code>master</code> might depend on any features available in master, which might not have been present in older versions. It therefore makes a lot of sense that a Git commit references its whole history, not just the change set. When merging back, it will pull in all the history it depends on.</p><p>Using <code>cherry-pick</code> or <code>rebase</code> ignores this history, and records a new commit with the same changeset, but a different history. As pointed out, this will not work if your codebase has diverged.</p><p>The “correct” solution is to write the fix as a hotfix on the oldest affected release. Then, you merge oldest release into the second-oldest release. Usually, a newer release would contain all commits of an older release, so this is OK. If things have changed, you now have a chance to manually resolve the merge conflict. Then you continue merging each release into the next-younger release until you are done. This maintains proper history and avoids a lot of unnecessary work, while only requiring effort that has to be expended anyway. In particular, this incremental merging gets you closer to the current development state in small steps.</p><p>As a diagram:</p><pre><code>| o normal commit |
| x hotfix        |
| ⇘ merging       |

3.8 --o-----------------x
       \                 ⇘
4.1     o--o--o-----------x&#39;
               \           ⇘
4.2             o--o--o-----x&#39;&#39;
                       \     ⇘
develop                 o--o--x&#39;&#39;&#39;--o--o
</code></pre></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../git-fixing-a-bug-affecting-two-branches/'>Git: Fixing a bug affecting two branches</a></li><li class="list-group-item"><a href='../git-rebasing-and-keeping-current-to-a-remote-branch-accepted-practices/'>Git: rebasing and keeping current to a remote branch &#8211; accepted practices</a></li><li class="list-group-item"><a href='../maintaining-svn-history-for-a-file-when-merge-is-done-from-the-dev-branch-to-trunk/'>Maintaining SVN history for a file when merge is done from the dev branch to trunk</a></li><li class="list-group-item"><a href='../git-how-does-one-name-branches-that-are-bug-fixes-for-a-release-branch-in-git-flow/'>Git &#8211; How does one name branches that are bug fixes for a release branch in git-flow</a></li><li class="list-group-item"><a href='../git-should-release-branches-ever-be-merged-to-master/'>Git &#8211; Should release branches ever be merged to master</a></li><li class="list-group-item"><a href='../is-it-better-to-merge-often-or-only-after-completion-do-a-big-merge-of-feature-branches/'>Is it better to merge &#8220;often&#8221; or only after completion do a big merge of feature branches</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>