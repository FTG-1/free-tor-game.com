<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Are Persistence-Ignorant objects able to implement lazy loading &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074715 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074715" class="post-1074715 software type-software status-publish hentry category-software tag-design-patterns tag-domain-driven-design tag-domain-model tag-persistence"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Are Persistence-Ignorant objects able to implement lazy loading</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span><span class="mr-2 badge badge-info">domain-driven-design</span><span class="mr-2 badge badge-warning">domain-model</span><span class="mr-2 badge badge-primary">persistence</span></p><div class="entry-content"><p><em>Persistence Ignorance</em> is an application of single responsibility principle, which in practice means that Domain Objects (<strong>DO</strong>) shouldn&#39;t contain code related to persistence, instead they should only contain domain logic.</p><p>a) I assume this means that the code which contacts lower layers ( ie persistence layers ) lives outside of the domain model in other classes ( <strong>OC</strong> ) of a business logic layer?</p><p>b) If my assumption under <em>a)</em> is correct, then <strong>DO</strong>, say <code>Customer</code>, never contains methods such as <code>GetCustomers</code> or <code>GetCustomerByID</code>?</p><p>c) If my assumptions under <em>a)</em> and <em>b)</em> are correct, and assuming <code>Customer</code> domain object uses lazy loading for some of its properties, then at some point <code>Customer</code>&#39;s  internal logic must contact <strong>OC</strong>, which in turn retrieves deffered data. But if <code>Customer</code> needs to contact <strong>OC</strong> to receive deffered data, then we can&#39;t really claim that Domain Objects don&#39;t contain logic related to persistence?!</p><p>Thank you</p><p><strong>REPLYING TO jkohlhepp</strong></p><p>1) I assume <code>OrderProvider</code> and <code>CustomerProvider</code> classes are contained within business logic layer?</p><p>2) I gather from your reply that  my assumptions under <em>b)</em> are correct?</p><p>3)</p><blockquote><p>&#8230; I would check to see if some private orders field was populated or<br /> if it was null. If it is null &#8230;</p></blockquote><p>But  as far as I can tell, as soon as domain code needs to check whether private <code>order</code> field was populated, and if it isn&#39;t,contacting OrderProvider, we are already violating <strong>PI</strong> principle?!</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I believe you are correct in your assumptions A and B around persistence ignorance.</p><p>How you would best accomplish lazy loading of database objects is greatly dependent on your particular problem and implementation.  However, I will attempt a generic answer to how to do lazy loading while still maintaining separation of concerns between persistence and domain logic classes.</p><p>I tend to implement persistence ignorance using the following classes:</p><ul><li>Domain classes - e.g. Customer</li><li>Provider / repository classes - e.g. CustomerProvider</li><li>Generic database querying classes - e.g. DatabaseQuery</li></ul><p>The DatabaseQuery class would be responsible for using the database driver to query the database and assemble the resulting data into a generic result set such as a DataTable.  The CustomerProvider would be responsible for using the DatabaseQuery class to execute SQL against the database and use the results of that SQL to assemble Customer instances.  Customer would be &#34;pure&#34; domain object that contained data and logic related to customers.</p><p>As for whether the provider classes should be in the business tier or the data tier, I don&#39;t have a strong opinion.  I can see a case for both.  The important part is that you separate the responsibilities across classes.</p><p>So now let&#39;s discuss lazy loading.  Let&#39;s say I wanted Customer to have a collection of Orders, but I don&#39;t want to pull Orders out of the database unless the consumer tries to access them.  I would create a property on Customer called Orders.  In the getter of that property, I would check to see if some private orders field was populated or if it was null.  If it is null, load the orders from the database using an OrderProvider.  Otherwise, just return the collection that was already loaded.</p><p>In my opinion, the need for Customer to contact OrderProvider does <em>not</em> violate PI.  Customer still doesn&#39;t know <em>how</em> it gets orders.  It just knows that it gets them from OrderProvider.  There might be other reasons to decouple Customer from OrderProvider, but I don&#39;t think PI is a problem here.</p><p>This assumes that you are doing persistence ignorance manually.  If you are a using an ORM framework such as Entity Framework or Hibernate, then those frameworks generally have features for supporting lazy loading automagically.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../do-we-achieve-100-persistence-ignorance-solution-if-were-not-using-orms-poco-objects-to-model-the-domain/'>Do we achieve 100% Persistence Ignorance solution if we&#8217;re not using ORM&#8217;s POCO objects to model the Domain</a></li><li class="list-group-item"><a href='../architecture-where-to-validate-domain-model-rules-that-depend-on-database-content/'>Architecture &#8211; Where to validate domain model rules that depend on database content</a></li><li class="list-group-item"><a href='../how-accurate-is-business-logic-should-be-in-a-service-not-in-a-model/'>How accurate is &#8220;Business logic should be in a service, not in a model&#8221;</a></li><li class="list-group-item"><a href='../where-should-business-logic-go-in-a-layered-architecture/'>Where should business logic go in a layered architecture</a></li><li class="list-group-item"><a href='../mvc-encapsulation-for-complex-queries/'>Mvc &#8211; Encapsulation for complex queries</a></li><li class="list-group-item"><a href='../architecture-should-i-use-a-layer-between-service-and-repository-for-a-clean-architecture-spring/'>Architecture &#8211; Should I use a layer between service and repository for a clean architecture &#8211; Spring</a></li><li class="list-group-item"><a href='../ddd-infrastructure-layer-implement-servicepersistence-or-just-persistence/'>DDD infrastructure layer: implement service+persistence or just persistence</a></li><li class="list-group-item"><a href='../is-domain-persistence-model-isolation-usually-this-awkward/'>Is domain/persistence model isolation usually this awkward</a></li><li class="list-group-item"><a href='../which-layer-do-ddd-repositories-belong-to/'>Which layer do DDD Repositories belong to</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>