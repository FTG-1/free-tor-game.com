<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Fully Stable, In-Place Unique Algorithm in O(n) &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087028 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087028" class="post-1087028 software type-software status-publish hentry category-software tag-algorithms tag-sorting"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Fully Stable, In-Place Unique Algorithm in O(n)</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">sorting</span></p><div class="entry-content"><p>Is there an algorithm that, given a sorted array, <em>swaps</em> all the <em>first</em> unique elements to the beginning of the array and the duplicates to the end, while remaining stable for <em>both</em> the unique subarray and the duplicate subarray, and that runs in <code>O(n)</code> swaps (and preferably one pass)? It should return the length of the unique portion of the array.</p><p>Contrived example input/result (Using python because it&#39;s easy to read):</p><pre><code>&gt;&gt;&gt; A = [1, 1, 2, 2, 3, 3, 4, 4, 5, 5]   # already sorted
&gt;&gt;&gt; r = Unique(A)
&gt;&gt;&gt; r
5
&gt;&gt;&gt; A
[1, 2, 3, 4, 5, 1, 2, 3, 4, 5]
&gt;&gt;&gt; A[:r] # the sorted portion
[1, 2, 3, 4, 5]
&gt;&gt;&gt; A[r:] # the duplicates portion
[1, 2, 3, 4, 5]
</code></pre><p>Stability means that even if two or more keys compare equal, the ordering of the keys in the result persists. E.g. if <code>A[i] == A[j] == A[k] and i &lt; j &lt; k</code> in the original array, all of those properties hold in the whole array after running the Unique algorithm. (Even though <code>A[i]</code> might be in the unique subarray and both <code>A[j]</code> &amp; <code>A[k]</code> are in the duplicates subarray.)</p><p>My failed attempt is a one-pass that tracks the current unique element while iterating through the array. The next unique element is swapped with the element after the end of the current unique subarray:</p><pre><code>def Unique1(A):
    if len(A) &lt;= 1:
        return 0
    i = 0
    for j in range(1, len(A)):
        if A[i] &lt; A[j]:
            i += 1
            if i &lt; j:
                A[i], A[j] = A[j], A[i]
    return i + 1
</code></pre><p>It swaps the first unique elements of a sorted array to the beginning of the array, runs in one pass (so is <code>O(n)</code>), and is stable for the unique subarray, <strong>but</strong> this does not satisfy the requirements because it scrambles the duplicates subarray:</p><pre><code>&gt;&gt;&gt; A = [1, 1, 2, 2, 3, 3, 4, 4, 5, 5]
&gt;&gt;&gt; r = Unique1(A)
&gt;&gt;&gt; A[r:]          # duplicates part
[3, 2, 4, 1, 5]    # not sorted
</code></pre><p>While the changes the algorithm makes to the unique subarray is somewhat obvious, I can&#39;t &#34;see&#34; what&#39;s happening to the duplicates subarray, but I have a feeling that it could be reversed if we knew or stored more information about the duplicates.</p><p>Note, just re-sorting the duplicates subarray is a non-starter because 1: it&#39;s <code>O(n log n)</code> not <code>O(n)</code> and 2: it breaks the stability.</p><p>I can also think of another algorithm that swaps newly found unique items all the way down to the next position. While it would satisfy the other conditions, it would have <code>O(n^2)</code> swaps.</p><p>Is such a unique algorithm possible? And if not, why not?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m not sure, but I think you need to drop the &#34;preferably one-pass&#34; from your description.  You can do it in three passes by using the following algorithm:</p><ul><li>Take a pass over the array, counting the number of unique items as <code>unique_count</code></li><li>Allocate a new temporary array with size <code>len(A) - unique_count</code></li><li>Take a second pass over the array, shifting each first instance of an item to the front of the array while copying the second instance to the first free space in the temporary array</li><li>Take a pass over the temporary array, copying each item to its final position in the input array</li></ul><p>This is still O(n), albeit with somewhat higher constant factor per item than your original implementation.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-and-net-why-different-sorting-algorithms-are-used-by-default/'>Java and .NET: Why different sorting algorithms are used by default</a></li><li class="list-group-item"><a href='../how-to-this-deterministic-linear-time-selection-algorithm-be-linear/'>How to this deterministic linear time selection algorithm be linear</a></li><li class="list-group-item"><a href='../sort-an-array-in-a-specific-order-not-ascending-descending/'>Sort an array in a specific order &#8211; not ascending/descending</a></li><li class="list-group-item"><a href='../algorithm-to-merge-two-sorted-arrays-with-minimum-number-of-comparisons/'>Algorithm to merge two sorted arrays with minimum number of comparisons</a></li><li class="list-group-item"><a href='../efficient-algorithm-to-merge-n-successive-sorted-arrays-in-place/'>Efficient algorithm to merge n successive sorted arrays in place</a></li><li class="list-group-item"><a href='../how-does-krs-qsort-work/'>How does K&#038;R&#8217;s qsort work</a></li><li class="list-group-item"><a href='../loop-invariant-of-selection-sort/'>Loop invariant of Selection Sort</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>