<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; Should I encrypt mobile number and otp when sending to backend &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1083346 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1083346" class="post-1083346 software type-software status-publish hentry category-software tag-api tag-authentication tag-encryption tag-rest tag-security"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; Should I encrypt mobile number and otp when sending to backend</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api</span><span class="mr-2 badge badge-info">authentication</span><span class="mr-2 badge badge-warning">encryption</span><span class="mr-2 badge badge-primary">rest</span><span class="mr-2 badge badge-danger">Security</span></p><div class="entry-content"><p>I have a login page, where user logs in via his mobile number, He gets an OTP send via backend server, once he enters a One-Time Passcode (OTP), we hit an API like this:</p><pre><code>https://backend.com/api/login?mobile=9123123123&amp;otp=1234
</code></pre><p>My question is this good enough from security point of view or should I encrypt both mobile number and OTP via some algorithm and send those like following:</p><pre><code>https://backend.com/api/login?authToken=jshfkasfasfbmsabvj&amp;authKey=amsfgjkashfkashjfjasgfkjahsfkj
</code></pre><p>where <code>authToken</code> is encrypted mobile number and <code>authKey</code> is encrypted OTP.</p><p>What are good practices regarding this, what are good encryption algo, which can be used here?</p><hr/><p>Few suggestions came to use https, which indeed I am using but missed to have in the question somehow. What my concern is someone can figure out the API, and start hitting with different combination of OTPs for mobile number and gain the access of a account.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>What my concern is someone can figure out the API, and start hitting
 with different combination of OTPs for mobile number and gain the
 access to an account</p></blockquote><p>This is a frequent question related to the security of web applications. Once our APIs are public, they are exposed to all sort of malice.</p><p>Besides the <a href="https://en.m.wikipedia.org/wiki/HTTPS" rel="nofollow noreferrer">https</a>, which should be mandatory, here some measures you should consider too.</p><h3>Thresholds</h3><p>Setting a max number of request per second and source (<em>remote address</em>).
Let&#39;s say <em>X</em> Req/s per IP address.</p><p>Thresholds are commonly implemented in the API Gateway or in the Authentication server.  Many API Managers provide control of thresholds out of the box.</p><p>The point is, the number of possible combinations of <em>phone/otp</em> and their respective permutations will be usually greater than the threshold, what reduce the possibilities of hitting a valid tuple or at least, it make it harder.</p><p>We can set endpoints with different thresholds. Usually, endpoints related to the security will have lower values than those related to the business.</p><p>Hitting the threshold causes ban. The ban last as long as you want (1, 5, 10 min, ...). If you like blacklists this is the right place to add one.</p><p>Study cases:</p><ul><li><a href="https://www.owasp.org/index.php/Denial_of_Service_Cheat_Sheet" rel="nofollow noreferrer">DDoS Cheat Sheet</a></li><li><a href="https://www.owasp.org/index.php/REST_Security_Cheat_Sheet" rel="nofollow noreferrer">REST Security Cheat Sheet</a></li><li><a href="https://www.owasp.org/index.php/IoT_Security_Guidance" rel="nofollow noreferrer">IoT Security</a></li></ul><h3>Opacity</h3><p>We often think that we should provide as many info as possible to the user when errors happen. That&#39;s ok when we speak about business rules, but it&#39;s not when we speak about security.</p><p>If the login process fails, a simple <em>Invalid credentials</em> should be enough.  Don&#39;t tell to whoever is on the other side of the wire the causes of the error.</p><p>Making your security opaque to the externals reduces the attack surface.</p><h3>Authentication tokens</h3><p>I would encourage you to don&#39;t reinvent the wheel, overall with security. <a href="https://jwt.io/" rel="nofollow noreferrer">JWT</a>.</p><p>It&#39;s a plus if you can force the expiration at will from the backend.</p><p>Study cases:</p><ul><li><a href="https://www.owasp.org/index.php/Authentication_Cheat_Sheet" rel="nofollow noreferrer">Authentication Cheat Sheet</a></li></ul><h3>Traceability</h3><p><a href="https://en.m.wikipedia.org/wiki/HTTPS" rel="nofollow noreferrer">Https</a> connections are encrypted. However,  the query strings can be traced in log files once the message has been decrypted. So, doesn&#39;t matter if the query string values were encrypted twice. I would suggest sending POST request for authentication processes. Do it for any other request that may transport sensitive data.</p><h3>Certificate validation</h3><p>As prevention to <a href="https://en.m.wikipedia.org/wiki/Man-in-the-middle_attack" rel="nofollow noreferrer">MITM</a>, checking if the server certificate matches the server&#39;s domain is a plus.</p><h3>Awareness</h3><p>Security is serious business.  Keep yourself up-to-date and well documented. Here a good place to start working. <a href="https://www.owasp.org/index.php/Category:OWASP_Project" rel="nofollow noreferrer">OWASP - Categories</a>.</p><p>Here some interesting projects:</p><ul><li><a href="http://www.owasp.org/index.php/OWASP_Secure_Coding_Practices_-_Quick_Reference_Guide" rel="nofollow noreferrer">Secure coding practices</a></li><li><a href="http://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series" rel="nofollow noreferrer">Cheat Sheet Series</a></li><li><a href="http://www.owasp.org/index.php/Web_Application_Security_Testing_Cheat_Sheet" rel="nofollow noreferrer">Web Applications Security Testing cheat sheet</a></li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-how-should-an-api-use-http-basic-authentication/'>Rest &#8211; How should an API use http basic authentication</a></li><li class="list-group-item"><a href='../c-i-need-advice-developing-a-sensitive-data-transfer-storage-encryption-system/'>C# &#8211; I need advice developing a sensitive data transfer/storage/encryption system</a></li><li class="list-group-item"><a href='../options-for-client-side-encryption-of-local-web-databases/'>Options for client-side encryption of local web databases</a></li><li class="list-group-item"><a href='../how-does-facebook-manage-to-allow-a-user-unlimited-sessions/'>How does Facebook manage to allow a user unlimited sessions</a></li><li class="list-group-item"><a href='../rest-api-security-stored-token-vs-jwt-vs-oauth/'>REST API security Stored token vs JWT vs OAuth</a></li><li class="list-group-item"><a href='../rest-prevent-abuse-to-rest-api-endpoint/'>Rest &#8211; Prevent abuse to REST API endpoint</a></li><li class="list-group-item"><a href='../rest-api-authentication-cookie-vs-web-storage/'>REST API Authentication: Cookie vs Web Storage</a></li><li class="list-group-item"><a href='../offline-login-procedure-in-pwa/'>Offline-Login Procedure in PWA</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>