<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Entity Framework and static entity instances &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1084445 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1084445" class="post-1084445 software type-software status-publish hentry category-software tag-c tag-entity-framework tag-net tag-orm"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Entity Framework and static entity instances</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">entity-framework</span><span class="mr-2 badge badge-warning">net</span><span class="mr-2 badge badge-primary">orm</span></p><div class="entry-content"><p>I&#39;m always having the problem on how to properly design having <code>static</code> entity instances and it being attached to Entity Framework&#39;s <code>Dbcontext</code>. For example, we have the following:</p><pre><code>using Microsoft.EntityFrameworkCore;
using System;
using System.Linq;
using Xunit;

namespace ClassLibrary1
{
    public class PersonType
    {
        public static readonly PersonType Student = new PersonType(1, &#34;Student&#34;);
        public static readonly PersonType Teacher = new PersonType(2, &#34;Teacher&#34;);
        public PersonType(int personTypeId, string description)
        {
            PersonTypeId = personTypeId;
            Description = description;
        }
        public int PersonTypeId { get; set; }
        public string Description { get; set; }
    }
    public class MyContext : DbContext
    {
        public DbSet&lt;PersonType&gt; PersonTypes { get; set; }
        public MyContext(DbContextOptions&lt;MyContext&gt; options) : base(options) { }
        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            modelBuilder.Entity&lt;PersonType&gt;(builder =&gt;
            {
                builder.HasData(
                    PersonType.Student,
                    PersonType.Teacher);
            });
        }
    }
    public class Tests
    {
        [Fact]
        public void This_test_fails()
        {
            var options = new DbContextOptionsBuilder&lt;MyContext&gt;()
                .UseInMemoryDatabase(Guid.NewGuid().ToString())
                .Options;

            using (var ctx = new MyContext(options))
                ctx.Database.EnsureCreated();

            using (var ctx = new MyContext(options))
            {
                //call Attach to pass
                //ctx.Attach(PersonType.Student);

                Assert.Equal(
                    PersonType.Student,
                    ctx.PersonTypes.First(p =&gt; p.Description == &#34;Student&#34;));
            }
        }
    }
}
</code></pre><p>The reason I need the static entity classes is for functions with logic based on <code>PersonType</code> (e.g. <code>if(personType == PersonType.Student)</code>. To make this work, I need to call <code>DbContext.Attach</code> (which is easy to forget to call) so the context&#39;s <code>PersonType</code> will be equal to its corresponding static instance.</p><p>Is calling <code>Attach</code> the only way to solve this? Or is there something wrong with my design choices?</p><p>I&#39;m primarily using EF Core but I believe this scenario is also present to EF6.</p><p>There is <a href="https://github.com/aspnet/EntityFrameworkCore/issues/12206" rel="nofollow noreferrer">this open feature request issue in EF Core</a> which would solve this problem but it seems not many people encounter this scenario so I&#39;m thinking there&#39;s a different way to design this.</p><p>EDIT: There is a <code>PersonType</code>s table in the database which is related to other tables.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The current implementation requires that you recompile the application if you later want to add teaching assistants. So that you might as well use Enums if you do not want to store the person types in the database.</p><p>Personally I would create a person type table in the database.</p><p>Secondly I would revisit the decision that you actually need to know, outside of the person class that is, which person type a person is. You should tell an instance of a class to do an action, not check what person type a person is and then decide what to do with the person.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-entity-framework-limitation/'>C# &#8211; Entity Framework limitation</a></li><li class="list-group-item"><a href='../c-should-you-reuse-an-entity-framework-edmx-between-multiple-solutions/'>C# &#8211; Should you reuse an Entity Framework EDMX between multiple solutions</a></li><li class="list-group-item"><a href='../c-updating-sub-properties-via-entity-framework/'>C# &#8211; Updating sub-properties via Entity Framework</a></li><li class="list-group-item"><a href='../avoiding-repository-pattern-implementing-onion-architecture-with-dbcontext-only/'>Avoiding Repository pattern &#8211; implementing Onion Architecture with DbContext only</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>