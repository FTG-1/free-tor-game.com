<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; OpenGL and global state &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087130 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087130" class="post-1087130 software type-software status-publish hentry category-software tag-design tag-globals tag-graphics tag-opengl"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; OpenGL and global state</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">globals</span><span class="mr-2 badge badge-warning">graphics</span><span class="mr-2 badge badge-primary">opengl</span></p><div class="entry-content"><p>It is generally understood in software engineering that global state is bad. However, OpenGL has been designed very much embracing the concept of global state. many of the things you modify will affect everything in your program (active shading program, uniforms, active buffer, glDepthTest&#8230;)</p><p>Because of this, I ended up developing a philosophy of &#34;do not fight the global state, embrace it&#34;. When I design OpenGL programs, I do so assuming that each function and object must set the state immediately prior to being rendered, and that nothing can be assumed prior to issuing a render command. if you want a specific depth test, set it, if you want a specific shading program, set it, if you want a given uniform value, set it. Obviously this is mostly a heuristic as setting everything every time on any function would be a horrible design.</p><p>I however find myself working with some developers that are fully against global state (for good reasons). Their design revolves around defining a small set of objects as singletons and then passing values down as parameters as much as possible. The end result is that sometimes there&#39;s 5 or more function calls between the intention (e.g &#34;rendering&#34;) and the action (e.g calling glDrawArrays).</p><p>For example sometimes it seems, that the best place to me, in terms of easiness, clarity and refactorability, to perform an action, would violate this principle of avoiding global state by calling a function of a global object to change the value of a variable. Rather than trying to pass that variable down, which has lead to some discussions about the best design.</p><p>The question is, is it a good idea to folow the general heuristic and avoid global state as much as possible when working with OpenGL, or is this an exception to the rule and due to its design it can be considered that embracing the global state may be better in this one instance?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>OpenGL didn&#39;t &#39;embrace&#39; global state so much as it was one of few sensible solutions to a technical problem. It&#39;s expensive to communicate with a video card. Flipping bits in video memory is considerably more expensive than flipping bits in ordinary memory. As an example it&#39;s so significant that later versions of OpenGL got rid of immediate mode, because setting up buffers (i.e. retained mode), then rendering from those buffers was so dramatically more efficient it was worth the more complicated setup. It would be impractical to &#34;pass&#34; the entire configuration of the rendering system on every frame because of how much communication would have to take place.</p><p>In contrast, in many web server situations, it&#39;s not uncommon to pass around a massively complex data structure, encompassing the entire state of the request and whatnot, because all you&#39;re really actually passing is an 8 byte pointer.</p><p>So, the problem with global state is it can be hard to know who&#39;s modifying it and when, and so it can be tricky to reason what it&#39;s state is. So, the thing to do is to setup your application to only modify that state in well defined ways, with well defined processes, so it is easy to reason what is happening.</p><p>Just compare the rendering state with e.g. a database driven application. In many respects, the database is a big global state. However, the interface to that DB, and often the DB itself, enforces when and how it is modified, and enforces what the data looks like inside it.</p><p>One simple way you can implement something similar is to have an interface which keeps track within your application what the state of the renderer is. You know you need the renderer setup a particular way, so you can consult your interface which would know, without needing to ask the graphics card. Likewise, it can also make the decision what has to change to get the renderer into the right state in the most efficient manner.</p><p>Building 3d graphics engines is an enormously complicated and broad subject, so I can&#39;t give precise pointers or code samples. But the basic gist is you need to come up with a way to sensibly merge the global state of the 3d card with a limited scope programming model on the CPU side, rather than having your application use all global variables.</p><p>In your specific example, when you say the other devs are defining several singletons and passing them around I get highly suspicious, but without seeing more of what&#39;s going on I can&#39;t really comment on that in more detail.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-use-a-global-variable-a-singleton-or-something-else/'>Php &#8211; Use a global variable, a singleton, or something else</a></li><li class="list-group-item"><a href='../how-to-avoid-global-state-without-large-function-signatures/'>How to avoid global state without large function signatures</a></li><li class="list-group-item"><a href='../are-file-scope-static-variables-in-c-as-bad-as-extern-global-variables/'>Are file-scope `static` variables in C as bad as `extern` global variables</a></li><li class="list-group-item"><a href='../design-is-opengl-just-badly-designed/'>Design &#8211; Is OpenGL just badly designed</a></li><li class="list-group-item"><a href='../parametrize-methods-vs-global-variables/'>Parametrize methods vs global variables</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>