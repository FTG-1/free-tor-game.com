<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Spring Batch + Web Scraping &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1083475 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1083475" class="post-1083475 software type-software status-publish hentry category-software tag-application-design tag-spring"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Spring Batch + Web Scraping</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">application-design</span><span class="mr-2 badge badge-info">spring</span></p><div class="entry-content"><p>I need to develop a batch processing that will be executed every day. These are the steps:</p><ol><li>Read each line of a database table that contains a URL (SQLite)</li><li>Extract some data, say <code>User</code>s, from that website by scraping it. Each website may contain 1..n users.</li><li>Persist each <code>User</code> in a local NoSQL database.</li><li>Send each <code>User</code>(one by one) through third-party REST API.</li></ol><p>I&#39;m going to implement this process using Spring Batch and I have thought this design:</p><ul><li>Item Reader: Read each URL of SQLite database using JdbcCursorItemReader.</li><li>Item Processor: Scrap and deserialize users from website. <code>(Url -&gt; List&lt;User&gt;)</code></li><li>Item Writer: for each <code>User</code>, persist it in database and send it through REST API.</li></ul><p>Is this approach right? Should I change any step? I have never worked with Spring Batch so I&#39;m willing to change the technology if needed. I need some advice before start developing since I need this process to be very robust.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This is generally a good application for Spring Batch, and you seem to understand the logical separation of Reader, Processor and Writer fairly well.</p><p>There are certain things that you should consider and think about when it comes to an application like this.  Spring Batch gives you the concept of chunking where rather than read/process/write each record one at a time you could read in several items as a chunk, process them as a single transaction, and write them as a single transaction.  Something that isn&#39;t clear to me based on your question is what your domain model will look like in your application to where this is possible.  It sounds as if there is a one to many relationship from URL to Users.  You would likely read in a single URL and build a collection of User objects that are ready to be processed and written out as a single transaction.</p><p>The second thing I would consider in your design and generally a good practice to get into when designing software is to document what your system constraints are.</p><ul><li>Are there alternative means to retrieve required data about a User apart from screen scraping?  If not document the constraints that exist.</li><li>What software system or component requires the User data to be provided by your software (REST API).  Does this third party software have the ability to take a batch file for input as opposed to REST API?  Are there other potential interfaces that might be more reliable?</li></ul><p>Also good to document Risks:</p><ul><li>Screen scraping presents tight coupling between the web design and application and your batch job</li></ul><p>In light of this information I would design like such:</p><h2>Reader</h2><ul><li>Retrieve the URL from database</li><li>Screen scrape for user data</li><li>Create a <code>List&lt;User&gt;</code> objects for the Processor step</li></ul><h2>Processor</h2><ul><li>Integration of data from multiple Readers if applicable?</li><li>Special processing rules or calculation of derived data?</li><li>Preparation of User object for Writers</li></ul><h2>Writer</h2><ul><li>One unique writer for persisting to your database</li><li>Second unique writer for POST to REST API</li></ul><p>Each chunk will be composed of users in a single URL.  Each chunk in process should be transacted so that in the event of an exception or failure, any persisted changes can be rolled back.  In the event of an exception, is it possible to define custom rollback behavior for the REST API?</p><p>Your final considerations should be the supportability and maintainability of the batch job.  You might want to consider Spring Batch Admin for this.  Any time where your business process depends on URL resources for internal or external network, screen scraping, and the availability and proper functioning of a REST API I would consider this sufficiently high risk.  There are many potential points of failure in this job so not only are Transactions and good exception handling a must, you will also want the ability to administer this easily and with minimal manual intervention.</p><p>Spring Batch Admin maintains a database of historical jobs as well as currently running jobs and paused and failed jobs.  You can configure a Spring Batch job managed with Spring Batch Admin to pick up where the failed job left off.  Perhaps your job got through 350 URL&#39;s of 400 to scan.  No need to clean up and start over if you can restart the failed job instance, it will pick up at record 351 and try again.  You may even be able to have it wait a few minutes and try several times before sending notifications out.</p><p>I hope this gives you things to consider.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/java-programmatically-extending-hibernate-table-entity-definitions-in-spring-how/'>Java &#8211; Programmatically extending Hibernate table/entity definitions in Spring, how</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/java-synchronisation-with-offline-system/'>Java &#8211; Synchronisation with offline system</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/rest-is-not-appropriate-for-business-applications-because-of-necessary-to-distribute-business-logic-accross-layers-rest-alternative-required/'>REST is not appropriate for business applications because of necessary to distribute business logic accross layers. REST alternative required!</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/api-gateway-rest-event-driven-microservices/'>API Gateway (REST) + Event-Driven Microservices</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/design-organizing-maven-modules-and-spring-profiles/'>Design &#8211; Organizing maven modules and spring profiles</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>