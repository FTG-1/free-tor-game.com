<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Javascript &#8211; Storing page-specific javascript on an AJAX driven site &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1086460 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1086460" class="post-1086460 software type-software status-publish hentry category-software tag-javascript tag-mvc"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Javascript &#8211; Storing page-specific javascript on an AJAX driven site</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">javascript</span><span class="mr-2 badge badge-info">mvc</span></p><div class="entry-content"><p>I have a general question about the placement of javascript code in a AJAX-driven web application. At a previous job, we tended to throw everything in one monolithic file. When maintaining that file became too difficult, we split it up into multiple smaller files and &#34;glued&#34; them back together with a php &#34;loader&#34; (pretty much just a bunch of include statements)</p><p>Since all of my pages are dynamically loaded through AJAX, I cannot simply have different files called separately per page.</p><p>The obvious disadvantage to this method is that all of your javascript is loaded by the end user, even if it is not required on first page load. (Which compounds the problem, the more pages you have)</p><p>To get around this, I started putting page-specific javascript on the template page itself, in a <code>&lt;script&gt;</code> tag at the bottom, which works as intended. Only the javascript I want is loaded.</p><p>However, I am unsure of whether this practice is taboo, or if there are better strategies for loading my javascript. I get the feeling that mixing my template with my scripted code is a recipe for disaster..</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Short answer: One monolithic file with a far-future expires header.</p><p>Long answer: It depends. If you&#39;re Gmail and have over 1 megabyte of javascript in your application, then you&#39;re going to want to split that up to reduce load and improve user experience. For the rest of us though, the best solution I&#39;ve found is to load your main library (such as jQuery) from a third-party CDN (like Google). Then split up your one monolithic file into two: <code>lib.js</code> and <code>app.js</code>. Lib should contain any third-party libraries, and app your site-specific code. The general idea being that you&#39;re very rarely going to be updating libraries or adding new ones, so that file will rarely ever have to be cache invalidated and re-downloaded by your users.</p><p>Use a technique such as the one described on this site to move almost all on-page <code>&lt;script&gt;</code> tags without a <code>src</code> attribute to an external file:</p><p><a href="http://paulirish.com/2009/markup-based-unobtrusive-comprehensive-dom-ready-execution/" rel="nofollow">http://paulirish.com/2009/markup-based-unobtrusive-comprehensive-dom-ready-execution/</a></p><p>So what you should be left with are <code>&lt;script&gt;</code> tags with a <code>src</code>, and the only inline ones remaining should be because you need to pass data from your backend code to javascript (and want to avoid an AJAX request on page load that will block rendering). Say the namespace of my project is <code>Foo</code>, then that one inline tag will look like:</p><pre><code>&lt;script type=&#34;text/javascript&#34;&gt;
    Foo.Context = {{ js_context|safe }};
&lt;/script&gt;
</code></pre><p><code>js_context</code> is a variable I passed to my template from my backend, and is already a JSON object. The squiggly brackets and <code>|safe</code> are just from the front-end template engine I happen to be using (in this case, Django&#39;s built-in templates). Now my page-specific code, living in <code>app.js</code>, can look at the contents of <code>Foo.Context</code> after <code>document.ready</code> fires for any variables it needs while avoiding an initial AJAX request.</p><p>As usual for your static files, you should be serving them with far-future expires headers:</p><p><code>Cache-Control: public, max-age=31536000</code></p><p>When you update your scripts, your build step should either rename the concatenated and minified file or add a GET query parameter to the end of the <code>&lt;script&gt;</code> <code>src</code>, like so:</p><p><code>app.12345.js</code> or <code>app.js?v=12345</code></p><p>That way your users will request the new file, breaking the cache. As a caveat, please be aware that old versions of some reverse-proxies (such as Squid) don&#39;t play nicely with GET parameters on static files, so the latter of those two options wouldn&#39;t work. But I have never run into that issue yet, so your milage may vary.</p><p>When you do get to the Gmail level of script sizes, you can start looking at using a library like LABjs or RequireJS, to dynamically only load the pieces of <code>app.js</code> that you need for particular pages or functionality.</p><p>Last but not least, I hope your <code>&lt;script&gt;</code> tags are at the bottom of your page, right before the closing <code>&lt;/body&gt;</code>. This prevents the browser from showing a blank white page while your scripts are downloaded, parsed, and executed. The only exception to this rule are libraries that absolutely must be in the <code>&lt;head&gt;</code> to function, such as Modernizr.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../javascript-are-javascript-mvc-frameworks-only-for-single-page-apps/'>Javascript &#8211; Are JavaScript MVC Frameworks only for &#8216;single-page&#8217; apps</a></li><li class="list-group-item"><a href='../javascript-should-i-implement-backbone-js-into-the-asp-net-webforms-applications/'>Javascript &#8211; Should I implement BackBone.js into the ASP.NET WebForms applications</a></li><li class="list-group-item"><a href='../javascript-is-it-still-relevant-to-keep-script-tags-in-the-footer/'>Javascript &#8211; Is it still relevant to keep script tags in the footer</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>