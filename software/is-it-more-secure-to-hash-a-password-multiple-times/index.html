<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Is it more secure to hash a password multiple times &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064745 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064745" class="post-1064745 software type-software status-publish hentry category-software tag-hashing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Is it more secure to hash a password multiple times</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">hashing</span></p><div class="entry-content"><p>I&#39;ve read a few times that when storing passwords, it&#39;s good practice to &#39;double hash&#39; the strings (eg. with md5 then sha1, both with salts, obviously).</p><p>I guess the first question is, &#34;is this actually correct?&#34; If not, then please, dismiss the rest of this question ðŸ™‚</p><p>The reason I ask is that on the face of it, I would say that this makes sense. However, when I think about it, every time a hash is rehashed (possibly with something added to it) all I can see is that there is a reduction in the upper bound on the final &#39;uniqueness&#39;&#8230; that bound being related to the initial input.</p><p>Let me put it another way: we have x number of strings that, when hashed, are reduced to y possible strings. That is to say, there are collisions in the first set. Now coming from the second set to the third, is it not possible for the same thing to occur (ie. collisions in the set of all possible &#39;y&#39; strings that result in the same hash in the third set)?</p><p>In my head, all I see is a &#39;funnel&#39; for each hash function call, &#39;funneling&#39; an infinite set of possibilities into a finite set and so on, but obviously each call is working on the finite set before it, giving us a set no larger than the input.</p><p>Maybe an example will explain my ramblings?<br /> Take &#39;hash_function_a&#39; that will give &#39;a&#39; and &#39;b&#39; the hash &#39;1&#39;, and will give &#39;c&#39; and &#39;d&#39; the hash &#39;2&#39;. Using this function to store passwords, even if the password is &#39;a&#39;, I could use the password &#39;b&#39;.</p><p>Take &#39;hash_function_b&#39; that will give &#39;1&#39; and &#39;2&#39; the hash &#39;3&#39;. If I were to use <em>it</em> as a &#39;secondary hash&#39; after &#39;hash_function_a&#39; then even if the password is &#39;a&#39; I could use &#39;b&#39;, &#39;c&#39; or &#39;d&#39;.</p><p>On top of all of that, I get that salts should be used, but they don&#39;t really change the fact that each time we are mapping &#39;x&#39; inputs to &#39;less than x&#39; outputs. I don&#39;t think.</p><p>Can someone please explain to me what it is that I am missing here?</p><p>Thanks!</p><p>EDIT: for what it&#39;s worth, I don&#39;t do this myself, I use bcrypt. And I&#39;m not really concerned about whether or not it&#39;s useful for &#39;using up cycles&#39; for a &#39;hacker&#39;. I genuinely am just wondering whether or not the process reduces &#39;security&#39; from a hash collision stand point.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This is more suited on security.stackexchange but...</p><p>The problem with</p><pre><code>hash1(hash2(hash3(...hashn(pass+salt)+salt)+salt)...)+salt)
</code></pre><p>is that this is only as strong as the weakest hash function in the chain. For example if hashn (the innermost hash) gives a collision, the entire hash chain will give a collision (<em>irrespective of what other hashes are in the chain</em>).</p><p>A stronger chain would be</p><pre><code>hash1(hash2(hash3(...hashn(pass + salt) + pass + salt) + pass + salt)...) + pass + salt)
</code></pre><p>Here we avoid the early collision problem and we essentially generate a salt that depends on the password for the final hash.</p><p>And if one step in the chain collides it doesn&#39;t matter because in the next step the password is used again and should give a different result for different passwords.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../randomized-hash-function-with-no-collisions/'>Randomized Hash function with no collisions</a></li><li class="list-group-item"><a href='../java-complexity-of-arraylist-of-linkedhashset/'>Java &#8211; Complexity of ArrayList of LinkedHashSet</a></li><li class="list-group-item"><a href='../how-does-pearson-hashing-compare-with-other-non-cryptographic-hashing-algorithms/'>How does Pearson hashing compare with other non-cryptographic hashing algorithms</a></li><li class="list-group-item"><a href='../python-how-to-perform-consistent-hashing-on-any-python-object-that-works-with-hash/'>Python &#8211; How to perform consistent hashing on any Python object that works with hash()</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>