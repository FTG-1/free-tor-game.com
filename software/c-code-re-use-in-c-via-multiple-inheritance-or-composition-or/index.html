<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; Code re-use in C++, via multiple inheritance or composition? Or&#8230; &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1067635 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1067635" class="post-1067635 software type-software status-publish hentry category-software tag-c tag-inheritance tag-interfaces tag-multiple-inheritance"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; Code re-use in C++, via multiple inheritance or composition? Or&#8230;</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">inheritance</span><span class="mr-2 badge badge-warning">interfaces</span><span class="mr-2 badge badge-primary">multiple-inheritance</span></p><div class="entry-content"><p>I originally asked <a href="https://stackoverflow.com/questions/24457024/specialising-on-two-ancestor-class-in-c">this question</a> on StackOverflow, but I was directed here, and I think my problem is perhaps as much conceptual as technical, so here goes.</p><p>If you’re defining a hierarchy of abstract class in C++, and then creating concrete subclasses with implementations, you could end up with abstract classes something like this, say:</p><pre><code>  A
 / \
B1 B2
</code></pre><p>So the concrete classes then inherit like so:</p><pre><code>B1   B2        B1   B2
 |    |         |    |
C1   C2        D1   D2
</code></pre><p>And this is all fine and dandy when <code>Cn</code> and <code>Dn</code> are just implementing the interfaces of <code>Bn</code>, or where say <code>C1</code> and <code>C2</code> implement the <code>A</code> interface <em>differently</em>.</p><p>However, if I want to have some <em>shared</em> functionality in <code>C1</code> and <code>C2</code>, which comes from the <code>A</code> interface, where do I put it?</p><p>It can’t go in <code>A</code>, both because <code>A</code> is abstract and because <code>Dn</code> should <em>not</em> be inheriting it.</p><p>It seems like there’s a notional <code>A_for_C</code> implementation, but does this belong in another ancestor class? Or in a composed sibling class?</p><pre><code>   _____A_____                       _____A_____
  /     |     \                     /     |     \
B1   A_for_C  B2        vs        B1     B2     A_for_C
 |_____/ \____ |                   |      |
C1            C2                  C1     C2

                               (C1 and C2 then each have an A_for_C and delegate)
</code></pre><p>The first one seems conceptually accurate, but requires <code>virtual</code> inheritance, while the second requires delegation. So both impose a performance hit despite there not being any real ambiguity.</p><p>Reading around the web, <a href="https://isocpp.org/wiki/faq/objective-c#objective-c-and-inherit" rel="nofollow noreferrer">on this website</a> I find it said</p><blockquote><p>Some people believe that the purpose of inheritance is code reuse. In C++, this is wrong. Stated plainly, “inheritance is not for code reuse.”</p></blockquote><p>How then should the implementation be shared?</p><p><strong>Further thoughts</strong></p><p>I found some relevant discussion in these questions:</p><ul><li><a href="https://softwareengineering.stackexchange.com/questions/65179/where-does-this-concept-of-favor-composition-over-inheritance-come-from/65183#65183">Where does this concept of &#34;favor composition over inheritance&#34; come from?</a></li><li><a href="https://softwareengineering.stackexchange.com/questions/135524/interface-and-inheritance-best-of-both-worlds?rq=1">Interface and Inheritance: Best of both worlds?</a></li><li><a href="https://softwareengineering.stackexchange.com/questions/218458/is-there-any-real-reason-multiple-inheritance-is-hated?rq=1">Is there any &#34;real&#34; reason multiple inheritance is hated?</a></li></ul><p>I think utnapistim’s answer below is much pithier and to the point than these, and helped me mentally cut through a lot of what these other questions/answers discuss.</p><p>Inheritance is about agreeing to fulfil a contract. Multiple inheritance is fine if the subclass really does guarantee fulfilling the parent contracts.</p><p>Implementation, however, is only really the concern of the final object. Yes, it might be convenient to inherit the implementation sometimes, but that’s actually orthogonal to the interface, and there are various techniques for pulling in an implementation other than the default v-table-based approach, including:</p><ul><li><a href="http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern" rel="nofollow noreferrer">CRTP</a> as per unaptism’s answer</li><li><a href="https://softwareengineering.stackexchange.com/a/135530/138942">The template method pattern</a></li></ul><p>(Which are, I think, equivalent except that one is compile-time and one is run-time.)</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>There are two aspects to your question:</p><p>§1. What is c++ inheritance for (if not for code reuse)?</p><p>The simplest answer to give here is &#34;implementing a contract&#34; (also see <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle" rel="nofollow">Liskov substitution principle</a> and <a href="http://en.wikipedia.org/wiki/Facade_pattern" rel="nofollow">facade design pattern</a>).</p><blockquote><p>§2. How then should the implementation be shared?</p></blockquote><p>Consider:</p><ul><li>Encapsulation of an object, implementing common behavior to both branches (this is sometimes the best alternative to inheritance diamonds). Your <code>A_for_C</code> doesn&#39;t need to inherit from <code>A</code>.</li><li>Free functions (templated if your algorithm applies to multiple types).</li><li>Template classes (<a href="http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern" rel="nofollow">CRTP</a> may be an alternative to a diamond inheritance pattern).</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-abstract-class-inheritance-vs-interface/'>C# &#8211; Abstract class + Inheritance vs Interface</a></li><li class="list-group-item"><a href='../object-oriented-composition-over-inheritance-but/'>Object-oriented &#8211; Composition over inheritance but</a></li><li class="list-group-item"><a href='../why-do-you-reduce-multiple-inheritance-to-the-diamond-problem/'>Why do you reduce multiple inheritance to the diamond problem</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>