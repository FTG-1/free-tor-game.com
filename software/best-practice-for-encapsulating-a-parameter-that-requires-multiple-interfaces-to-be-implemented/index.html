<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Best practice for encapsulating a parameter that requires multiple interfaces to be implemented &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082732 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082732" class="post-1082732 software type-software status-publish hentry category-software tag-inheritance tag-interfaces"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Best practice for encapsulating a parameter that requires multiple interfaces to be implemented</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">inheritance</span><span class="mr-2 badge badge-info">interfaces</span></p><div class="entry-content"><p>I encounter this issue multiple times, but I&#39;m never sure how best to deal with it.</p><p>Basically, some methods I write require the implementing object to support multiple interfaces. The example I have in mind is that a table structure needs to be able to <code>IIterate</code> over its records and <code>IStreamable</code> its content, where</p><pre><code>IIterate = interface
  procedure First;
  procedure Next;
  property EOF: boolean;
end;

IStreamable = interface // outputs current record in table only
  function StreamOut: TArray&lt;byte&gt;;
  procedure StreamIn(const Input: TArray&lt;byte&gt;);
end;
</code></pre><p>Now I don&#39;t think I want to combine these interfaces, as it&#39;s rare for methods to require <code>IStreamable</code> and not every <code>IStreamable</code> class can <code>IIterate</code> (my use case has single-record structures too).</p><p>The method I am trying to write is</p><pre><code>CopyTable(InIterate: IIterate; InStreamable: IStreamable; OutIterate:IIterate; OutStreamable:IStreamable); 
</code></pre><p>Where the In and Out interfaces must be implemented by the same object. At the moment I&#39;m just asking for one of the interfaces and using a <code>Supports</code> call to get the second, though this doesn&#39;t give you any compile-time protection. The obvious alternative is to use the above structure and check that both interfaces have the same implementing class, but that looks ugly.</p><p><em>Is there a better way to work with this kind of problem and get some compile-time safety?</em></p><p>The implementing language is Delphi (XE2), though I think this is a fairly language agnostic question for languages that don&#39;t have multiple inheritance.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p><sup>First of all, <code>Iterate</code> is a lame name for that interface, it should be called <code>Iterator</code>, so I will be calling it <code>Iterator</code> in this answer, because I am allergic to bad naming.</sup></p><p>You say that you encounter this issue often, and I have to believe you, but I also ought to mention <em>my</em> experience, which is that I have rarely, if ever, encountered this need in the last couple of decades that I have been doing OOP.</p><p>Usually, when such a need appears to arise, it is an indication that some other aspect of the design needs refactoring.</p><p>The first suspect to examine is the <code>CopyTable()</code> function: why does it need both an <code>Iterator</code> and a <code>Streamable</code> for both the source and the destination table?  Why can&#39;t it just stream-out the source table to bytes and then stream-in the bytes into the destination table?  And why is it even called <code>CopyTable</code> when it is probably just <code>CopyStreamable()</code> or <code>CopyStreamableIterator()</code> at worse?</p><p>If there is nothing that can be done about the function, then the best approach in my opinion is to combine the two interfaces into one.  The name <code>CopyStreamableIterator()</code> which describes what the function does immediately tells you that you need a <code>StreamableIterator</code> interface which combines <code>Streamable</code> and <code>Iterator</code>.  There is nothing wrong with that, and you do not even have to make your <code>Table</code> class implement that new interface, you can simply implement a <code>StreamableIteratorDecorator</code> (see <em>decorator pattern</em>) which accepts a <code>Streamable</code> and an <code>Iterator</code> as constructor parameters and implements the <code>StreamableIterator</code> interface by delegating to them.  (Though you will probably just declare your <code>Table</code> class as implementing this interface to be done real quick, because your <code>Table</code> already implements these methods, so it is good to go.)</p><p><sub>Note: I am presuming that in Delphi, just as in Java and C#, a class may extend only one class but multiple interfaces, and that an interface may also extend multiple interfaces, but even if by any chance this is not true, this functionality can be emulated by aggregating interface implementations into classes and adding to classes and interfaces methods that return sub-interfaces.</sub></p><p><strong>Amendment</strong></p><p>Thinking about it a bit more, I am realizing that your problem may lie in that ill-named <code>IIterate</code> interface.  This interface is trying to cut corners, so it is built in such a way as to force manipulation of the internal state of the underlying (implementing) object.  This causes problems, because it is forcing you to have two separate interfaces, one for altering the internal state of your table to select a row, and another interface for reading/writing the currently selected row.</p><p>In a language like C# and Java your table would implement <code>IIterable&lt;IStreamable&gt;</code>, and <code>IIterable&lt;T&gt;</code> would have just one method, <code>newIterator() : IIterator&lt;T&gt;</code>.  In turn, <code>IIterator&lt;T&gt;</code> would be defined as follows:</p><pre><code>IIterator&lt;T&gt; = interface //javaesque
  function Next : T;
  property EOF: boolean;
end;
</code></pre><p>or as follows:</p><pre><code>IIterator&lt;T&gt; = interface //csharpesque
  function Current : T;
  function HasNext : boolean;
  procedure MoveNext;
end;
</code></pre><p>So, instead of selecting rows, your iteration would be <strong><em>yielding</em></strong> each row which can then be streamed.  So, you only need to pass an iterator (or better yet an iterable) to your <code>CopyTable()</code> function.</p><p>Adding rows to the target table can be easily accomplished by implementing a <code>IConsumer&lt;IStreamable&gt;</code> interface which simply appends the contents of the <code>IStreamable</code> as a new row at the end of the table.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-explanation-of-the-definition-of-interface-inheritance-as-described-in-gof-book/'>Java &#8211; Explanation of the definition of interface inheritance as described in GoF book</a></li><li class="list-group-item"><a href='../java-why-were-default-and-static-methods-added-to-interfaces-in-java-8-when-we-already-had-abstract-classes/'>Java &#8211; Why were default and static methods added to interfaces in Java 8 when we already had abstract classes</a></li><li class="list-group-item"><a href='../c-code-re-use-in-c-via-multiple-inheritance-or-composition-or/'>C++ &#8211; Code re-use in C++, via multiple inheritance or composition? Or&#8230;</a></li><li class="list-group-item"><a href='../c-should-we-inherit-from-base-class-and-implement-interface-in-this-scenarios/'>C# &#8211; Should we inherit from base class and implement interface in this scenarios</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>