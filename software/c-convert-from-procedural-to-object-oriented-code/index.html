<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Convert from Procedural to Object Oriented Code &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070476 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070476" class="post-1070476 software type-software status-publish hentry category-software tag-c tag-net tag-object-oriented tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Convert from Procedural to Object Oriented Code</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">net</span><span class="mr-2 badge badge-warning">object-oriented</span><span class="mr-2 badge badge-primary">unit testing</span></p><div class="entry-content"><p>I have been reading <a href="http://rads.stackoverflow.com/amzn/click/0131177052">Working Effectively with Legacy Code</a> and <a href="http://rads.stackoverflow.com/amzn/click/0132350882">Clean Code</a> with the goal of learning strategies on how to begin cleaning up the existing code-base of a large ASP.NET webforms application.</p><p>This system has been around since 2005 and since then has undergone a number of enhancements.  Originally the code was structured as follows (and is still largely structured this way):</p><ul><li>ASP.NET (aspx/ascx)</li><li>Code-behind (c#)</li><li>Business Logic Layer (c#)</li><li>Data Access Layer (c#)</li><li>Database (Oracle)</li></ul><p>The main issue is that the code is procedural masquerading as object-oriented.  It virtually violates all of the guidelines described in both books.</p><p>This is an example of a typical class in the Business Logic Layer:</p><pre><code>    public class AddressBO
{
    public TransferObject GetAddress(string addressID)
    {
        if (StringUtils.IsNull(addressID))
        {
            throw new ValidationException(&#34;Address ID must be entered&#34;);
        }

        AddressDAO addressDAO = new AddressDAO();
        return addressDAO.GetAddress(addressID);
    }

    public TransferObject Insert(TransferObject addressDetails)
    {
        if (StringUtils.IsNull(addressDetails.GetString(&#34;EVENT_ID&#34;)) ||
            StringUtils.IsNull(addressDetails.GetString(&#34;LOCALITY&#34;)) ||
            StringUtils.IsNull(addressDetails.GetString(&#34;ADDRESS_TARGET&#34;)) ||
            StringUtils.IsNull(addressDetails.GetString(&#34;ADDRESS_TYPE_CODE&#34;)) ||
            StringUtils.IsNull(addressDetails.GetString(&#34;CREATED_BY&#34;)))
        {
            throw new ValidationException(
                &#34;You must enter an Event ID, Locality, Address Target, Address Type Code and Created By.&#34;);
        }

        string addressID = Sequence.GetNextValue(&#34;ADDRESS_ID_SEQ&#34;);
        addressDetails.SetValue(&#34;ADDRESS_ID&#34;, addressID);

        string syncID = Sequence.GetNextValue(&#34;SYNC_ID_SEQ&#34;);
        addressDetails.SetValue(&#34;SYNC_ADDRESS_ID&#34;, syncID);

        TransferObject syncDetails = new TransferObject();

        Transaction transaction = new Transaction();

        try
        {
            AddressDAO addressDAO = new AddressDAO();
            addressDAO.Insert(addressDetails, transaction);

            // insert the record for the target
            TransferObject addressTargetDetails = new TransferObject();
            switch (addressDetails.GetString(&#34;ADDRESS_TARGET&#34;))
            {
                case &#34;PARTY_ADDRESSES&#34;:
                    {
                        addressTargetDetails.SetValue(&#34;ADDRESS_ID&#34;, addressID);
                        addressTargetDetails.SetValue(&#34;ADDRESS_TYPE_CODE&#34;,
                                                      addressDetails.GetString(&#34;ADDRESS_TYPE_CODE&#34;));
                        addressTargetDetails.SetValue(&#34;PARTY_ID&#34;, addressDetails.GetString(&#34;PARTY_ID&#34;));
                        addressTargetDetails.SetValue(&#34;EVENT_ID&#34;, addressDetails.GetString(&#34;EVENT_ID&#34;));
                        addressTargetDetails.SetValue(&#34;CREATED_BY&#34;, addressDetails.GetString(&#34;CREATED_BY&#34;));

                        addressDAO.InsertPartyAddress(addressTargetDetails, transaction);

                        break;
                    }
                case &#34;PARTY_CONTACT_ADDRESSES&#34;:
                    {
                        addressTargetDetails.SetValue(&#34;ADDRESS_ID&#34;, addressID);
                        addressTargetDetails.SetValue(&#34;ADDRESS_TYPE_CODE&#34;,
                                                      addressDetails.GetString(&#34;ADDRESS_TYPE_CODE&#34;));
                        addressTargetDetails.SetValue(&#34;PUBLIC_RELEASE_FLAG&#34;,
                                                      addressDetails.GetString(&#34;PUBLIC_RELEASE_FLAG&#34;));
                        addressTargetDetails.SetValue(&#34;CONTACT_ID&#34;, addressDetails.GetString(&#34;CONTACT_ID&#34;));
                        addressTargetDetails.SetValue(&#34;EVENT_ID&#34;, addressDetails.GetString(&#34;EVENT_ID&#34;));
                        addressTargetDetails.SetValue(&#34;CREATED_BY&#34;, addressDetails.GetString(&#34;CREATED_BY&#34;));

                        addressDAO.InsertContactAddress(addressTargetDetails, transaction);

                        break;
                    }

                &lt;&lt; many more cases here &gt;&gt;
                default:
                    {
                        break;
                    }
            }

            // synchronise
            SynchronisationBO synchronisationBO = new SynchronisationBO();
            syncDetails = synchronisationBO.Synchronise(&#34;I&#34;, transaction,
                                                        &#34;ADDRESSES&#34;, addressDetails.GetString(&#34;ADDRESS_TARGET&#34;),
                                                        addressDetails, addressTargetDetails);


            // commit
            transaction.Commit();
        }
        catch (Exception)
        {
            transaction.Rollback();
            throw;
        }

        return new TransferObject(&#34;ADDRESS_ID&#34;, addressID, &#34;SYNC_DETAILS&#34;, syncDetails);
    }


    &lt;&lt; many more methods are here &gt;&gt;

}
</code></pre><p>It has a lot of duplication, the class has a number of responsibilities, etc, etc &#8211; it is just generally &#39;un-clean&#39; code.</p><p>All of the code throughout the system is dependent on concrete implementations.</p><p>This is an example of a typical class in the Data Access Layer:</p><pre><code>    public class AddressDAO : GenericDAO
{
    public static readonly string BASE_SQL_ADDRESSES =
        &#34;SELECT &#34; +
        &#34;  a.address_id, &#34; +
        &#34;  a.event_id, &#34; +
        &#34;  a.flat_unit_type_code, &#34; +
        &#34;  fut.description as flat_unit_description, &#34; +
        &#34;  a.flat_unit_num, &#34; +
        &#34;  a.floor_level_code, &#34; +
        &#34;  fl.description as floor_level_description, &#34; +
        &#34;  a.floor_level_num, &#34; +
        &#34;  a.building_name, &#34; +
        &#34;  a.lot_number, &#34; +
        &#34;  a.street_number, &#34; +
        &#34;  a.street_name, &#34; +
        &#34;  a.street_type_code, &#34; +
        &#34;  st.description as street_type_description, &#34; +
        &#34;  a.street_suffix_code, &#34; +
        &#34;  ss.description as street_suffix_description, &#34; +
        &#34;  a.postal_delivery_type_code, &#34; +
        &#34;  pdt.description as postal_delivery_description, &#34; +
        &#34;  a.postal_delivery_num, &#34; +
        &#34;  a.locality, &#34; +
        &#34;  a.state_code, &#34; +
        &#34;  s.description as state_description, &#34; +
        &#34;  a.postcode, &#34; +
        &#34;  a.country, &#34; +
        &#34;  a.lock_num, &#34; +
        &#34;  a.created_by, &#34; +
        &#34;  TO_CHAR(a.created_datetime, &#39;&#34; + SQL_DATETIME_FORMAT + &#34;&#39;) as created_datetime, &#34; +
        &#34;  a.last_updated_by, &#34; +
        &#34;  TO_CHAR(a.last_updated_datetime, &#39;&#34; + SQL_DATETIME_FORMAT + &#34;&#39;) as last_updated_datetime, &#34; +
        &#34;  a.sync_address_id, &#34; +
        &#34;  a.lat,&#34; +
        &#34;  a.lon, &#34; +
        &#34;  a.validation_confidence, &#34; +
        &#34;  a.validation_quality, &#34; +
        &#34;  a.validation_status &#34; +
        &#34;FROM ADDRESSES a, FLAT_UNIT_TYPES fut, FLOOR_LEVELS fl, STREET_TYPES st, &#34; +
        &#34;     STREET_SUFFIXES ss, POSTAL_DELIVERY_TYPES pdt, STATES s &#34; +
        &#34;WHERE a.flat_unit_type_code = fut.flat_unit_type_code(+) &#34; +
        &#34;AND   a.floor_level_code = fl.floor_level_code(+) &#34; +
        &#34;AND   a.street_type_code = st.street_type_code(+) &#34; +
        &#34;AND   a.street_suffix_code = ss.street_suffix_code(+) &#34; +
        &#34;AND   a.postal_delivery_type_code = pdt.postal_delivery_type_code(+) &#34; +
        &#34;AND   a.state_code = s.state_code(+) &#34;;


    public TransferObject GetAddress(string addressID)
    {
        //Build the SELECT Statement
        StringBuilder selectStatement = new StringBuilder(BASE_SQL_ADDRESSES);

        //Add WHERE condition
        selectStatement.Append(&#34; AND a.address_id = :addressID&#34;);

        ArrayList parameters = new ArrayList{DBUtils.CreateOracleParameter(&#34;addressID&#34;, OracleDbType.Decimal, addressID)};

        // Execute the SELECT statement
        Query query = new Query();
        DataSet results = query.Execute(selectStatement.ToString(), parameters);

        // Check if 0 or more than one rows returned
        if (results.Tables[0].Rows.Count == 0)
        {
            throw new NoDataFoundException();
        }
        if (results.Tables[0].Rows.Count &gt; 1)
        {
            throw new TooManyRowsException();
        }

        // Return a TransferObject containing the values
        return new TransferObject(results);
    }


    public void Insert(TransferObject insertValues, Transaction transaction)
    {
        // Store Values
        string addressID = insertValues.GetString(&#34;ADDRESS_ID&#34;);
        string syncAddressID = insertValues.GetString(&#34;SYNC_ADDRESS_ID&#34;);
        string eventID = insertValues.GetString(&#34;EVENT_ID&#34;);
        string createdBy = insertValues.GetString(&#34;CREATED_BY&#34;);

        // postal delivery
        string postalDeliveryTypeCode = insertValues.GetString(&#34;POSTAL_DELIVERY_TYPE_CODE&#34;);
        string postalDeliveryNum = insertValues.GetString(&#34;POSTAL_DELIVERY_NUM&#34;);

        // unit/building
        string flatUnitTypeCode = insertValues.GetString(&#34;FLAT_UNIT_TYPE_CODE&#34;);
        string flatUnitNum = insertValues.GetString(&#34;FLAT_UNIT_NUM&#34;);
        string floorLevelCode = insertValues.GetString(&#34;FLOOR_LEVEL_CODE&#34;);
        string floorLevelNum = insertValues.GetString(&#34;FLOOR_LEVEL_NUM&#34;);
        string buildingName = insertValues.GetString(&#34;BUILDING_NAME&#34;);

        // street
        string lotNumber = insertValues.GetString(&#34;LOT_NUMBER&#34;);
        string streetNumber = insertValues.GetString(&#34;STREET_NUMBER&#34;);
        string streetName = insertValues.GetString(&#34;STREET_NAME&#34;);
        string streetTypeCode = insertValues.GetString(&#34;STREET_TYPE_CODE&#34;);
        string streetSuffixCode = insertValues.GetString(&#34;STREET_SUFFIX_CODE&#34;);

        // locality/state/postcode/country
        string locality = insertValues.GetString(&#34;LOCALITY&#34;);
        string stateCode = insertValues.GetString(&#34;STATE_CODE&#34;);
        string postcode = insertValues.GetString(&#34;POSTCODE&#34;);
        string country = insertValues.GetString(&#34;COUNTRY&#34;);

        // esms address
        string esmsAddress = insertValues.GetString(&#34;ESMS_ADDRESS&#34;);

        //address/GPS
        string lat = insertValues.GetString(&#34;LAT&#34;);
        string lon = insertValues.GetString(&#34;LON&#34;);
        string zoom = insertValues.GetString(&#34;ZOOM&#34;);

        //string validateDate = insertValues.GetString(&#34;VALIDATED_DATE&#34;);
        string validatedBy = insertValues.GetString(&#34;VALIDATED_BY&#34;);
        string confidence = insertValues.GetString(&#34;VALIDATION_CONFIDENCE&#34;);
        string status = insertValues.GetString(&#34;VALIDATION_STATUS&#34;);
        string quality = insertValues.GetString(&#34;VALIDATION_QUALITY&#34;);


        // the insert statement
        StringBuilder insertStatement = new StringBuilder(&#34;INSERT INTO ADDRESSES (&#34;);
        StringBuilder valuesStatement = new StringBuilder(&#34;VALUES (&#34;);

        ArrayList parameters = new ArrayList();

        // build the insert statement
        insertStatement.Append(&#34;ADDRESS_ID, EVENT_ID, CREATED_BY, CREATED_DATETIME, LOCK_NUM &#34;);
        valuesStatement.Append(&#34;:addressID, :eventID, :createdBy, SYSDATE, 1 &#34;);
        parameters.Add(DBUtils.CreateOracleParameter(&#34;addressID&#34;, OracleDbType.Decimal, addressID));
        parameters.Add(DBUtils.CreateOracleParameter(&#34;eventID&#34;, OracleDbType.Decimal, eventID));
        parameters.Add(DBUtils.CreateOracleParameter(&#34;createdBy&#34;, OracleDbType.Varchar2, createdBy));

        // build the insert statement
        if (!StringUtils.IsNull(syncAddressID))
        {
            insertStatement.Append(&#34;, SYNC_ADDRESS_ID&#34;);
            valuesStatement.Append(&#34;, :syncAddressID&#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;syncAddressID&#34;, OracleDbType.Decimal, syncAddressID));
        }

        if (!StringUtils.IsNull(postalDeliveryTypeCode))
        {
            insertStatement.Append(&#34;, POSTAL_DELIVERY_TYPE_CODE&#34;);
            valuesStatement.Append(&#34;, :postalDeliveryTypeCode &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;postalDeliveryTypeCode&#34;, OracleDbType.Varchar2, postalDeliveryTypeCode));
        }

        if (!StringUtils.IsNull(postalDeliveryNum))
        {
            insertStatement.Append(&#34;, POSTAL_DELIVERY_NUM&#34;);
            valuesStatement.Append(&#34;, :postalDeliveryNum &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;postalDeliveryNum&#34;, OracleDbType.Varchar2, postalDeliveryNum));
        }

        if (!StringUtils.IsNull(flatUnitTypeCode))
        {
            insertStatement.Append(&#34;, FLAT_UNIT_TYPE_CODE&#34;);
            valuesStatement.Append(&#34;, :flatUnitTypeCode &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;flatUnitTypeCode&#34;, OracleDbType.Varchar2, flatUnitTypeCode));
        }

        if (!StringUtils.IsNull(lat))
        {
            insertStatement.Append(&#34;, LAT&#34;);
            valuesStatement.Append(&#34;, :lat &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;lat&#34;, OracleDbType.Decimal, lat));
        }

        if (!StringUtils.IsNull(lon))
        {
            insertStatement.Append(&#34;, LON&#34;);
            valuesStatement.Append(&#34;, :lon &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;lon&#34;, OracleDbType.Decimal, lon));
        }

        if (!StringUtils.IsNull(zoom))
        {
            insertStatement.Append(&#34;, ZOOM&#34;);
            valuesStatement.Append(&#34;, :zoom &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;zoom&#34;, OracleDbType.Decimal, zoom));
        }

        if (!StringUtils.IsNull(flatUnitNum))
        {
            insertStatement.Append(&#34;, FLAT_UNIT_NUM&#34;);
            valuesStatement.Append(&#34;, :flatUnitNum &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;flatUnitNum&#34;, OracleDbType.Varchar2, flatUnitNum));
        }

        if (!StringUtils.IsNull(floorLevelCode))
        {
            insertStatement.Append(&#34;, FLOOR_LEVEL_CODE&#34;);
            valuesStatement.Append(&#34;, :floorLevelCode &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;floorLevelCode&#34;, OracleDbType.Varchar2, floorLevelCode));
        }

        if (!StringUtils.IsNull(floorLevelNum))
        {
            insertStatement.Append(&#34;, FLOOR_LEVEL_NUM&#34;);
            valuesStatement.Append(&#34;, :floorLevelNum &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;floorLevelNum&#34;, OracleDbType.Varchar2, floorLevelNum));
        }

        if (!StringUtils.IsNull(buildingName))
        {
            insertStatement.Append(&#34;, BUILDING_NAME&#34;);
            valuesStatement.Append(&#34;, :buildingName &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;buildingName&#34;, OracleDbType.Varchar2, buildingName));
        }

        if (!StringUtils.IsNull(lotNumber))
        {
            insertStatement.Append(&#34;, LOT_NUMBER&#34;);
            valuesStatement.Append(&#34;, :lotNumber &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;lotNumber&#34;, OracleDbType.Varchar2, lotNumber));
        }

        if (!StringUtils.IsNull(streetNumber))
        {
            insertStatement.Append(&#34;, STREET_NUMBER&#34;);
            valuesStatement.Append(&#34;, :streetNumber &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;streetNumber&#34;, OracleDbType.Varchar2, streetNumber));
        }

        if (!StringUtils.IsNull(streetName))
        {
            insertStatement.Append(&#34;, STREET_NAME&#34;);
            valuesStatement.Append(&#34;, :streetName &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;streetName&#34;, OracleDbType.Varchar2, streetName));
        }

        if (!StringUtils.IsNull(streetTypeCode))
        {
            insertStatement.Append(&#34;, STREET_TYPE_CODE&#34;);
            valuesStatement.Append(&#34;, :streetTypeCode &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;streetTypeCode&#34;, OracleDbType.Varchar2, streetTypeCode));
        }

        if (!StringUtils.IsNull(streetSuffixCode))
        {
            insertStatement.Append(&#34;, STREET_SUFFIX_CODE&#34;);
            valuesStatement.Append(&#34;, :streetSuffixCode &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;streetSuffixCode&#34;, OracleDbType.Varchar2, streetSuffixCode));
        }

        if (!StringUtils.IsNull(locality))
        {
            insertStatement.Append(&#34;, LOCALITY&#34;);
            valuesStatement.Append(&#34;, :locality&#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;locality&#34;, OracleDbType.Varchar2, locality));
        }

        if (!StringUtils.IsNull(stateCode))
        {
            insertStatement.Append(&#34;, STATE_CODE&#34;);
            valuesStatement.Append(&#34;, :stateCode&#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;stateCode&#34;, OracleDbType.Varchar2, stateCode));
        }

        if (!StringUtils.IsNull(postcode))
        {
            insertStatement.Append(&#34;, POSTCODE&#34;);
            valuesStatement.Append(&#34;, :postcode &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;postcode&#34;, OracleDbType.Varchar2, postcode));
        }

        if (!StringUtils.IsNull(country))
        {
            insertStatement.Append(&#34;, COUNTRY&#34;);
            valuesStatement.Append(&#34;, :country &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;country&#34;, OracleDbType.Varchar2, country));
        }

        if (!StringUtils.IsNull(esmsAddress))
        {
            insertStatement.Append(&#34;, ESMS_ADDRESS&#34;);
            valuesStatement.Append(&#34;, :esmsAddress &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;esmsAddress&#34;, OracleDbType.Varchar2, esmsAddress));
        }

        if (!StringUtils.IsNull(validatedBy))
        {
            insertStatement.Append(&#34;, VALIDATED_DATE&#34;);
            valuesStatement.Append(&#34;, SYSDATE &#34;);
            insertStatement.Append(&#34;, VALIDATED_BY&#34;);
            valuesStatement.Append(&#34;, :validatedBy &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;validatedBy&#34;, OracleDbType.Varchar2, validatedBy));
        }


        if (!StringUtils.IsNull(confidence))
        {
            insertStatement.Append(&#34;, VALIDATION_CONFIDENCE&#34;);
            valuesStatement.Append(&#34;, :confidence &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;confidence&#34;, OracleDbType.Decimal, confidence));
        }

        if (!StringUtils.IsNull(status))
        {
            insertStatement.Append(&#34;, VALIDATION_STATUS&#34;);
            valuesStatement.Append(&#34;, :status &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;status&#34;, OracleDbType.Varchar2, status));
        }

        if (!StringUtils.IsNull(quality))
        {
            insertStatement.Append(&#34;, VALIDATION_QUALITY&#34;);
            valuesStatement.Append(&#34;, :quality &#34;);
            parameters.Add(DBUtils.CreateOracleParameter(&#34;quality&#34;, OracleDbType.Decimal, quality));
        }

        // finish off the statement
        insertStatement.Append(&#34;) &#34;);
        valuesStatement.Append(&#34;)&#34;);

        // build the insert statement
        string sql = insertStatement + valuesStatement.ToString();

        // Execute the INSERT Statement
        Dml dmlDAO = new Dml();
        int rowsAffected = dmlDAO.Execute(sql, transaction, parameters);

        if (rowsAffected == 0)
        {
            throw new NoRowsAffectedException();
        }
    }

    &lt;&lt; many more methods go here &gt;&gt;
}
</code></pre><p>This system was developed by me and a small team back in 2005 after a 1 week .NET course.  Before than my experience was in client-server applications.  Over the past 5 years I&#39;ve come to recognise the benefits of automated unit testing, automated integration testing and automated acceptance testing (using Selenium or equivalent) but the current code-base seems impossible to introduce these concepts.</p><p>We are now starting to work on a major enhancement project with tight time-frames.  The team consists of 5 .NET developers &#8211; 2 developers with a few years of .NET experience and 3 others with little or no .NET experience.  None of the team (including myself) has experience in using .NET unit testing or mocking frameworks.</p><p>What strategy would you use to make this code cleaner, more object-oriented, testable and maintainable?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You mention two books in which one of the primary messages is &#34;The Boy Scout Rule&#34; i.e. clean up the code as you touch it. If you have a working system, a massive rewrite is counter-productive. Instead, as you add new functionality, make sure you improve the code as it stands.</p><ul><li>Write unit tests to cover the existing code that you need to change.</li><li>Refactor that code so it is more pliable for change (making sure your tests still pass).</li><li>Write tests for the new/revised functionality</li><li>Write code to make the new tests pass</li><li>Refactor as necessary.</li></ul><p>To dive further in, Feathers talks about testing the application at its seams: the logical points at which the units connect. You can take advantage of a seam to create a stub or a mock for a dependency so that you can write tests around the dependent object. Let&#39;s take your AddressBO as an example</p><pre><code>public class AddressBO
{
    public TransferObject GetAddress(string addressID)
    {
        if (StringUtils.IsNull(addressID))
        {
            throw new ValidationException(&#34;Address ID must be entered&#34;);
        }

        AddressDAO addressDAO = new AddressDAO();
        return addressDAO.GetAddress(addressID);
    }
}
</code></pre><p>There is an obvious seam between the AddressBO and the AddressDAO. Let&#39;s create an interface for the AddressDAO and allow the dependency to be injected into the AddressBO.</p><pre><code>public interface IAddressDAO
{
  TransferObject GetAddress(addressID);
  //add other interface methods here.
}

public class AddressDAO:GenericDAO, IAddressDAO
{
  public TransferObject GetAddress(string addressID)
  {
    ///implementation goes here
  }
}
</code></pre><p>Now you doctor up your AddressBO to allow for injection</p><pre><code>public class AddressBO
{
    private IAddressDAO _addressDAO;
    public AddressBO()
    {
      _addressDAO = new AddressDAO();
    }

    public AddressBO(IAddressDAO addressDAO)
    {
      _addressDAO = addressDAO;
    }

    public TransferObject GetAddress(string addressID)
    {
        if (StringUtils.IsNull(addressID))
        {
            throw new ValidationException(&#34;Address ID must be entered&#34;);
        }
        //call the injected AddressDAO
        return _addressDAO.GetAddress(addressID);
    }
}
</code></pre><p>Here we&#39;re using &#34;poor man&#39;s dependency injection.&#34; Our only goal is to break the seam and allow us to test the AddressBO. Now in our unit tests we can make a mock IAddressDAO and validate the interactions between the two objects.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-whats-the-benefit-of-object-oriented-programming-over-procedural-programming/'>Object-oriented &#8211; What&#8217;s the benefit of object-oriented programming over procedural programming</a></li><li class="list-group-item"><a href='../object-oriented-is-unit-testing-procedural-code-effective/'>Object-oriented &#8211; Is unit testing procedural code effective</a></li><li class="list-group-item"><a href='../object-oriented-convert-procedural-code-to-object-oriented/'>Object-oriented &#8211; Convert procedural code to object oriented</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>