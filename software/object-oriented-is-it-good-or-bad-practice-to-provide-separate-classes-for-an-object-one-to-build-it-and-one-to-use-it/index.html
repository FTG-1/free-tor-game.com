<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; Is it good or bad practice to provide separate classes for an object: one to build it, and one to use it &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076445 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076445" class="post-1076445 software type-software status-publish hentry category-software tag-c tag-class tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; Is it good or bad practice to provide separate classes for an object: one to build it, and one to use it</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">class</span><span class="mr-2 badge badge-warning">object-oriented</span></p><div class="entry-content"><p>Suppose I&#39;m writing some C++ code to visualize &#34;Foo&#34; objects. I have two ways of getting a &#34;Foo&#34;: computing it from data, or from taking the pieces of a precomputed &#34;Foo&#34; and building a new &#34;Foo&#34;.</p><p>Now, once a &#34;Foo&#34; is computed it&#39;s guaranteed to be good for visualization, but changing it may break this assumption. Therefore, I&#39;ve decided to represent &#34;Foos&#34; in my code by a <code>Foo</code> class that has no mutating methods: once it is constructed and initialized, it doesn&#39;t change.</p><p>But there&#39;s a second way to make a &#34;Foo&#34;: build it from a precomputed &#34;Foo&#34;&#39;s components. I&#39;ve come up with several methods of building a <code>Foo</code> from precomputed data:</p><h2>Method 1: Constructor/Static methods</h2><p>Perhaps the most obvious method would be to add a new constructor or a static method to <code>Foo</code>, call it<code>fromPrecomputed</code>, that would read the components of the precomputed Foo and make a new <code>Foo</code> object, checking that it is valid. To explain why I&#39;d like to shy away from this, I have to complicate my example: Let&#39;s say that one component of a &#34;Foo&#34; is a collection of &#34;Bars&#34;. Now, in terms of implementation, sometimes a &#34;Bar&#34; is represented as a <code>std::vector&lt;std::vector&lt;Bar&gt; &gt;</code>, sometimes as a <code>Bar array[][2]</code>, sometimes as a <code>std::vector&lt;std::pair&lt;Bar,Bar&gt; &gt;</code>, and so on&#8230; I could have the user reorganize their data into a standardized form and have a single constructor for this standard, but this might require the user to perform an extra copy. I don&#39;t want to provide a static method for each format: <code>readPrecomputedFormatA</code>, <code>readPrecomputedFormatB</code>, and so on: this clutters the API.</p><h2>Method 2: Make <code>Foo</code> mutable</h2><p>If I exposed the <code>addBar(Bar)</code> method of <code>Foo</code>, then I could allow the user to iterate over their collection of &#34;Bars&#34; in their own way. This, however, makes <code>Foo</code> mutable. So I could compute a <code>Foo</code> that makes sense for visualization, then use <code>addBar</code> to add a <code>Bar</code> that makes the <code>Foo</code> no longer a &#34;Foo&#34;. Not good.</p><h2>Method 3: Make a friend &#34;builder&#34; class</h2><p>I make a class called <code>FooBuilder</code> which has the <code>addBar(Bar)</code> method exposed. I make <code>FooBuilder</code> a friend of <code>Foo</code> and add a constructor to <code>Foo</code> that takes a <code>FooBuilder</code>. On calling this constructor, it checks to make sure that <code>FooBuilder</code> contains a valid &#34;Foo&#34; object, then swaps its empty representation of a Foo with what is inside the <code>FooBuilder</code>. Everybody is happy.</p><p>The only &#34;messiness&#34; about method #3 is that it requires a friendship, but it&#39;s worth it to maintain encapsulation I think. But this has got me thinking: is this an established pattern? Or is there another, <em>better</em> way of doing this that I don&#39;t know about?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>What you consider FooBuilder and Foo is actually part of a well-established <a href="http://en.wikipedia.org/wiki/Builder_pattern">Builder pattern</a>.  The other approach you mention with creating a Foo instance based on an existing instance is called a <a href="http://en.wikipedia.org/wiki/Prototype_pattern">Prototype pattern</a>.  Both of these are well-known object creation alternatives and several books (most notably <a href="http://rads.stackoverflow.com/amzn/click/B000SEIBB8">&#34;Design Patterns&#34;, aka GoF)</a> have been written describing them.  (not sure I&#39;m clear on your second mutable example, so comparing #1 to #3 here)</p><p>Each pattern obviously has its own advantages and drawbacks and only you can decide which one is better for your specific situation. For example, I would typically use builders when there&#39;s a lot of different ways of initializing Foo.  For example, right now I&#39;m working on a query builder class and many clients use it differently to build query objects. Different clients want different fields to be returned, some clients want only last 10 rows, some want sorting while others don&#39;t.  Builder is perfect as it can look something like this:</p><pre><code>qb = QueryBuilder()
query = qb.fields(&#34;name&#34;, &#34;address&#34;)
          .sort(&#34;zip&#34;, &#34;asc&#34;)
          .limit(10)
          .build()
</code></pre><p>So multiple setters, each returning instance of the builder itself so you can daisy-chain basically serve as a very flexible constructor.  Making one class a friend of another class has it&#39;s time and a place and potentially this could be one of those places.</p><p>Alternatively, you could define Foo as having one constructor that takes a rather complex set of params, or potentially you could define another class FooData, that FooBuilder could initialize and pass into Foo creation.  Then again, maybe Foo and FooBuilder being friends in this case isn&#39;t such a bad thing. Just keep in mind that when one class is a friend of another one, you are expanding encapsulation boundary, which could be just as bad as putting more and more code all within one class (i.e. more code knows about internals)</p><p>At the end of the day, you could be thinking and considering all these different options and it will all boil down to 60/40. If there&#39;s no clear winner, you can always let a coin pick the winner and just go with it.  Most likely either one of the design choices would work just fine and by going through the motions and seeing your code in action you will learn valuable lesson for future.  Sometimes when I have design decisions and can&#39;t decide between A and B, I could end up picking B and then if I ever come across a similar situation I would intentionally pick the other choice.  The work in either case gets done and I get the software to do what I want, but you get a ton of benefit of actually seeing your decisions in action and being able to compare the two <em>working</em> approaches, rather than just discussing and thinking about them.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-object-oriented-class-design/'>Java &#8211; Object-Oriented Class Design</a></li><li class="list-group-item"><a href='../c-unit-test-private-method-in-c-using-a-friend-class/'>C++ &#8211; Unit test private method in c++ using a friend class</a></li><li class="list-group-item"><a href='../c-design-for-encoder-decoder-classes-with-different-stored-types/'>C++ design for encoder/decoder classes with different stored types</a></li><li class="list-group-item"><a href='../object-oriented-how-wrong-is-it-to-talk-about-c-methods-versus-member-functions/'>Object-oriented &#8211; How wrong is it to talk about C++ &#8220;methods&#8221; (versus &#8220;member functions&#8221;)</a></li><li class="list-group-item"><a href='../object-oriented-using-static-to-create-an-immutable-object/'>Object-oriented &#8211; Using static to create an immutable object</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>