<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Optimal Database design for 3-way relationship &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075254 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075254" class="post-1075254 software type-software status-publish hentry category-software tag-database-design tag-relational-database"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Optimal Database design for 3-way relationship</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database-design</span><span class="mr-2 badge badge-info">relational-database</span></p><div class="entry-content"><p>All right, I know this sounds complicated, but all relationships are, lemme clarify. Well, I have three entities in my database which are tied to each other in a string of relationships, the app is for restaurants, and the tables are as follows:</p><pre><b>Customers</b>
Id
Name
Email
</pre><pre><b>Packages</b>
Id
Name
ImageUrl
Price
Description
Products (One package may have 1 to many products)
</pre><pre><b>Products</b>
Id
Name
ImageUrl
Price
Description
</pre><pre><b>Orders</b>
Id
CustomerId
Address
</pre><p>The one extra table mentioned is just for clarification, as customer can place an order. Here goes, now the relationships are defined as follows:</p><ul><li>Customer can place multiple orders, One order is only associated with one customer, one-to-many(this one is for clarification)</li><li>One package can contain multiple products, one product can belong to multiple packages(consider packages as deals in a restaurant, like deals have the same items/products that the restaurant already offers), many-to-many</li><li>One order can contain multiple products, One product may have multiple orders, many-to-many</li><li>One order can contain multiple packages, One package can have multiple orders, many-to-many</li></ul><p>The last three are the main we need to focus on, now the thing is how to design this in the database. Like for many-to-many we shall use referencing or relationship tables, like for e.g. in the case of packages and products a table could be created package_products and that is all fine coz we are ready to take that query cost to the new table in exchange for good methodology. And the same needs to be done for the orders and products table, a new table order_products catering to their many-to-many needs. Also, the same for the two entities, orders and packages, that is all fine. But now on the query side, we have to optimize this, like the solutions already exist, the one I mentioned, u may have something similar, what I want is something better.</p><p>If I want to for e.g. get the details of an order, which can have many packages and products at the same time, will have to query orders table, then the reference table for the orders and products to get single products, then will have to separately query the reference table for orders and packages to get the packages in it. Now that said, and fine at the moment, but if you have noticed by now, packages are made up of products, so basically orders are storing the info for a bunch of products some of whom were part of a deal/package and the other, well not. As we open up the packages in an order we basically wind up at the same product table, a kind of circle back motion. Questions:</p><ul><li>Is this technique bad even ? I began to think so</li><li>How do I avoid this if it is ?</li><li>How to eventually avoid the extra query cost as well, on the order package table and so on ?</li><li>Is the technique which puts an extra package ID in order_products table bad, if not what would that ternary relationship be called and is that even permissible ?</li></ul><p>Thank you in advance for reading and answering with the great virtue of patience.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Three points:</p><p>First, you need to use JOIN to good advantage, so as to retrieve the joined data that you want with one trip to the database, instead of repetitive trips to the database.  As James Anderson correctly pointed out, this is what relational databases are all about.</p><p>However, if you are just learning how to use a database in SQL, then using a database of your own design may take you down the wrong trail. The database needs to be designed well to exploit the full power of JOIN, and of two other relational operators, known as restrict and project in relational math.  The SQL buzzwords are WHERE, DISTINCT, and GROUP BY.</p><p>Second, the relationship between packages and products is your basic bill-of-materials case.  This case has been extensively studied in practice over the last forty years.  There&#39;s no need for you to reinvent the wheel.  However, if you add the possibility that packages can be composed of other packages, then the BOM problem becomes a recursive one.  SQL is not built for recursion, but there are workarounds.</p><p>If you come up to speed on the nested-set technique for designing containment hierarchies,  like BOM,  then you reduce what would have been a recursive query into a simple SQL query that the database server can decompose into a simple reiterative process for you.  Nested-set is not ultimately complicated, but there is a learning curve here.</p><p>Third, the relationship between order details and products or packages is not really a ternary relationship, in the way that term is usually used.  Each order detail references an order (the parent), and either a product or a package.  This either-or situation is your typical class-subclass (type-subtype) situation, rather than a true ternary relationship.   Unfortunately,  vanilla SQL is not good at inheritance.  You could use extensions to SQL peculiar to your DBMS, if it has them,  or you could use one of two techniques, called &#34;single table inheritance&#34;  or &#34;class table inheritance&#34;.  I like Fowler&#39;s treatment of this subject.</p><p>There&#39;s plenty to learn here.  You sound like a smart programmer, so you should be able to learn it fast.  Just don&#39;t assume you already know it.  Maybe you do, maybe you don&#39;t.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-schema-for-pricing-products-packages-promotions-qty-based-limited-time-offer/'>Database Schema for Pricing Products (packages, promotions, qty based, limited time offer&#8230;)</a></li><li class="list-group-item"><a href='../database-tracking-correct-order-details-in-commerce-database-when-modifying-products/'>Database &#8211; Tracking correct order details in commerce database when modifying &#8216;products&#8217;</a></li><li class="list-group-item"><a href='../how-to-represent-an-optional-to-optional-relationship-in-a-database/'>How to represent an optional-to-optional relationship in a database</a></li><li class="list-group-item"><a href='../database-design-for-inventory/'>Database Design for Inventory</a></li><li class="list-group-item"><a href='../database-is-it-ok-to-have-a-many-to-many-relationship-where-one-of-the-tables-involved-is-already-a-junction-table/'>Database &#8211; Is it OK to have a many-to-many relationship where one of the tables involved is already a junction table</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>