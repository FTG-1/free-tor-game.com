<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Pitfalls of Domain Driven Design with Entity Framework &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069074 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069074" class="post-1069074 software type-software status-publish hentry category-software tag-c tag-design-patterns tag-domain-driven-design tag-entity-framework tag-object-oriented-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Pitfalls of Domain Driven Design with Entity Framework</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">domain-driven-design</span><span class="mr-2 badge badge-primary">entity-framework</span><span class="mr-2 badge badge-danger">object-oriented-design</span></p><div class="entry-content"><p>A lot of tutorials on DDD I studied are mostly covering theory. They all have rudimentary code examples (Pluralsight and similar).</p><p>On the web there are also attempts by a few people to create tutorials covering DDD with EF.<br /> If you begin studying them just briefly &#8211; you quickly notice they differ a lot from one another. Some people recommend to keep the app minimal and <strong>to avoid introducing additional layers e.g. repository on top of EF</strong>, others are decidedly generating extra layers, often even violating SRP by injecting <code>DbContext</code> into Aggregate Roots.</p><p><em>I&#39;m terribly apologizing if I&#39;m asking an opinion-based question, but&#8230;</em></p><p>When it comes to practice &#8211; Entity Framework is one of the most powerful and widely-used ORMs. You will not find a comprehensive course covering DDD with it, unfortunately.</p><hr/><p>Important aspects:</p><ul><li><p>Entity Framework brings UoW &amp; Repository (<code>DbSet</code>) out of the box</p></li><li><p>with EF your models have <strong>navigation properties</strong></p></li><li><p>with EF all of the models are always <strong>available</strong> off <code>DbContext</code> (they are represented as a <code>DbSet</code>)</p></li></ul><p>Pitfalls:</p><ul><li><p>you <strong>cannot</strong> guarantee your child models are only affected via Aggregate Root &#8211; your models have navigation properties and it&#39;s possible to modify them and call <code>dbContext.SaveChanges()</code></p></li><li><p>with <code>DbContext</code> you can access your every model, thus <strong>circumventing</strong> Aggregate Root</p></li><li><p>you can restrict access to the root object&#39;s children via <code>ModelBuilder</code> in <code>OnModelCreating</code> method <strong>by marking them as fields</strong> &#8211; I still don&#39;t believe it&#39;s the right way to go about DDD plus it&#39;s hard to evaluate what kind of adventures this may lead to in future (<em>quite skeptical</em>)</p></li></ul><p>Conflicts:</p><ul><li><p><strong>without implementing</strong> another layer of repository which returns Aggregate we cannot even partly resolve the <em>abovementioned pitfalls</em></p></li><li><p><strong>by implementing</strong> an extra layer of repository we are ignoring the built-in features of EF (every <code>DbSet</code> is already a repo) and over-complicating the app</p></li></ul><hr/><h3>My conclusion:</h3><p>Please pardon my ignorance, but based on the above info &#8211; it&#39;s either Entity Framework <strong>isn&#39;t adequate</strong> for Domain-Driven Design or the Domain-Driven Design is an <strong>imperfect</strong> and <strong>obsolete</strong> approach.</p><p>I suspect each of the approaches has its merits, but I&#39;m completely lost now and don&#39;t have the slightest idea of how to reconcile EF with DDD.</p><hr/><p>If I&#39;m wrong &#8211; could anyone at least detail a simple set of instructions (or even provide decent code examples) of how to go about DDD with EF, please?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>DDD and EF have little to nothing to do with each other.</p><p>DDD is a modeling concept. It means to think about the Domain, the Business Requirements, and model those. Especially in the context of object-orientation it means to create a design which mirrors business functions and capabilities.</p><p>EF is a persistence technology. It is mainly concerned with data and database records.</p><p>These two are sharply divorced. A DDD design may use EF in some form under the hood, but the two should not interact in any other way.</p><p>Some interpretations of Domain-Driven Design do actually advocate data-modeling, and I think this is what your question is about. In this interpretation &#34;Entities&#34; and &#34;Value Objects&#34; are essentially function-less data holders only, and the design concerns itself with what properties these hold and what relation they have between each other. In this context DDD vs. EF may come up.</p><p>This interpretation however is flawed, and I would strongly recommend ignoring it altogether.</p><p><strong>In conclusion</strong>: DDD and EF are not mutually exclusive, they are actually irrelevant to each other, as long as you are doing proper object-modeling and not data-modeling. DDD objects should not in any shape or form be EF artifacts. DDD Entities should <strong>not</strong> be EF &#34;entities&#34; for example. Inside some business-relevant function, a DDD design might use EF with some related data-objects, but those should be always hidden under a business-relevant behavior-oriented interface.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../design-domain-driven-design-can-two-aggregates-have-the-same-root/'>Design &#8211; Domain driven design, can two aggregates have the same root</a></li><li class="list-group-item"><a href='../c-in-ddd-should-repositories-expose-an-entity-or-domain-objects/'>C# &#8211; in DDD, should repositories expose an entity or domain objects</a></li><li class="list-group-item"><a href='../c-entity-framework-and-avoiding-the-anemic-domain-model/'>C# &#8211; Entity Framework and avoiding the Anemic Domain Model</a></li><li class="list-group-item"><a href='../domain-driven-design-address-entity-value/'>Domain driven design &#8211; Address entity / value</a></li><li class="list-group-item"><a href='../domain-driven-design-updating-part-of-aggregate/'>Domain Driven Design &#8211; updating part of aggregate</a></li><li class="list-group-item"><a href='../c-domain-driven-design-navigation-properties-and-aggregate/'>C# &#8211; Domain Driven Design // Navigation Properties and Aggregate</a></li><li class="list-group-item"><a href='../domain-driven-design-updating-and-persisting-aggregates/'>Domain Driven Design &#8211; Updating and persisting aggregates</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>