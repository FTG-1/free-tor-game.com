<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Data Security Between Users in a Microservice Architecture &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082876 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082876" class="post-1082876 software type-software status-publish hentry category-software tag-microservices"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Data Security Between Users in a Microservice Architecture</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">microservices</span></p><div class="entry-content"><p>Our team has decided to move to a microservice approach for newly developed features. We&#39;ve decided to keep a database/datastore per service and to split the services along the business function they perform. As we move this direction we&#39;re creating the services as necessary. This means that not only have we created a new service for this new functionality but we may be creating a new service for functionality and data that already exist within the system (within the monolithic application that is being deconstructed).</p><p>After working on our first service we&#39;ve come up with an interesting dilemma. How do we secure data based on users&#39; relationships? This is <strong>not</strong> security based on authentication or authorization. We&#39;re currently using a token passed from our SSO provider to insure authentication and are developing JWTs to add authorization.</p><p><strong>Quick example</strong></p><p>I&#39;m going to describe a basic scenario:</p><p>Suppose we have a business object which is owned by a user (or group). A lot of microservice architecture examples use orders, etc. Say we have a user, U1, which has created an <code>order</code> object and we have another user which is a manager, M1, which oversees this user. Also, we have other users, U2, U3, and U4, which are part of group, G1. User U1 and manager M1 are not members of this group.</p><p>Here are some questions we would want answered:</p><ol><li>Manager, M1, logs in and should see his downline employee&#39;s <code>order</code> objects, but no other manager&#39;s downline information.</li><li>Members of G1 should be able to see each others <code>order</code> objects.</li></ol><p>Clarifying the scenario some:</p><p>The goal is to be able to have a user identified (the logged in user or given id) and filter any data within the service to what that user is permissible to see. i.e. A user may have the role &#34;orders&#34; and is able to utilize the service (orders_read, orders_write), but shouldn&#39;t have access to objects outside of his relationship to other users (can see his and those he manages). Even if there were a permission called &#34;orders_supervise&#34; the user inheriting this role needs to have context as to whom he is supervising. This is important when we&#39;re talking about scenarios involving data that is sensitive nature, a manager viewing their employee&#39;s salary or performance review.</p><p><strong>Monolithic Answer</strong></p><p>Assume that our monolithic application structure has defined groups of users and relationships between users. Without going in depth on the data structures, it could be assumed that there are linking tables for these structures. For groups a linking table would have a group identifier and a person identifier. For relationships the table could be between person identifiers that make up some type of relationship.</p><p><em>Another method of handling it, and this is the way it is done in one of our legacy applications, is to have a column on the person for each relationship. For U1 they would have M1&#39;s id in their <code>ManagerId</code> column.</em></p><p>Depending on the question above the monolithic application could use a query that joined across these tables. The query would produce a projection of data which was filtered via the join to either linking tables in order to answer the above questions. The database in the application contains all relevant data to answer these questions.</p><p>This approach is how we currently function. It produces results very quickly since the data is filtered at the database level. The relational database allows the normalized data to be updated in a quick fashion which would filter through to allow any changes to be reflected pretty quickly in the answers to the questions.</p><p><strong>Framing this in a microservice architecture</strong></p><p>When our team is looking at this scenario in a microservice architecture we&#39;re considering different business capabilities: relationship management, group membership, and orders (not to mention users or authentication, etc).</p><p>If we were to place these concerns into two services (or three) with the order information separated from the relationship or membership data how do we handle security based on these relationships?</p><p>Is this where we would be duplicating data between services and data stores? As in, should we be including group data within the orders microservice? This doesn&#39;t seem correct as it violates a separation of concerns. However, it does support having a reactive services where this one service isn&#39;t dependent on another.</p><p>Thinking of the solution where duplication of data is the way to go, this could get messy for this common data structure. If our system is dealing with business objects that are mainly subjected to security based on relationships between users and groups it would seem that almost every microservice would have this data by default.  How does this duplicated data get sync&#39;d? Aside from a technical solution (redis) is there a service design pattern we should be following?</p><p><strong>Additional Thoughts</strong></p><p>The question of how to perform data security based on relationships between users and groups seems to not be answered in a well defined manner in any pattern we&#39;ve researched. Topics such as authentication and authorization are fairly well covered. It seems that we can&#39;t be the first to ask this question. Are we framing the question wrong, coming at it from a bad perspective? Does a microservice architecture pattern already address this concern?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>There is no need to duplicate data, instead each service needs to have the proper data context.</p><p>Let&#39;s say one has users and orders. Each order at minimum is going to be tagged with a user Id that placed the order.  The order data context has no idea of the relationships of users or any addition information, only the User Id is needed.</p><p>The user service would know details about the user and the relations between other users.</p><p>So, one would have two services, user and order.  The user service would have a method like:</p><p><code>GetMyUsers(UserId)</code></p><p>This would return the list of users that user can &#34;see&#34;.</p><p>Then the order service has a method like:</p><p><code>GetOrders(List&lt;UserIds&gt;)</code></p><p>And Potentially...</p><pre><code>GetMyOrders(UserId)
</code></pre><p>One could have a 3rd service that could orchestrate the events if necessary, although in this case it may not be necessary since it seems sequential.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-api-gateway-security-for-microservice-architecture/'>Architecture &#8211; API Gateway security (for microservice architecture)</a></li><li class="list-group-item"><a href='../architecture-how-to-keep-relationship-integrity-with-microservice-architecture/'>Architecture &#8211; How to keep relationship integrity with Microservice Architecture</a></li><li class="list-group-item"><a href='../architecture-data-replication-in-microservices/'>Architecture &#8211; Data replication in microservices</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>