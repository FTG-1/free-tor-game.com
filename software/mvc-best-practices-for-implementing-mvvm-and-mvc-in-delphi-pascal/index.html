<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Mvc &#8211; Best practices for implementing MVVM and MVC in delphi Pascal &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068668 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068668" class="post-1068668 software type-software status-publish hentry category-software tag-delphi tag-design-patterns tag-mvc tag-mvvm tag-pascal"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Mvc &#8211; Best practices for implementing MVVM and MVC in delphi Pascal</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">delphi</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">mvc</span><span class="mr-2 badge badge-primary">mvvm</span><span class="mr-2 badge badge-danger">pascal</span></p><div class="entry-content"><p>I&#39;m a Delphi pascal programmer, I use the latest Embarcadero delphi XE, and I would like to take advantage of design patterns such as Model view controller and model view view-model.</p><p>However, there doesn&#39;t seem to be much on the web about the best practices for doing this in pascal. Most of the examples that I can find are in C# and some of the language features are not present in pascal, which means I may have to find ways to implement those features.</p><p>I&#39;m trying to adapt code from this article <a href="http://www.codeproject.com/Articles/364485/MVVM-Model-View-ViewModel-Patte" rel="noreferrer">here</a></p><p>I&#39;ll list the issues that I&#39;m facing</p><ul><li><strong>Nullable types</strong></li></ul><p>Pascal does not have nullable types as C# does so I have created my own.</p><pre><code>TNullable&lt;T&gt; = record
    strict private
      fHasValue : boolean;
      fValue : T;
      function GetValue:T;
      procedure SetValue(newValue : T);
    public
      property HasValue : boolean read fHasValue;
      property Value : T read GetValue write SetValue;
      procedure SetToNull;
    end;
</code></pre><p>in the implementation section</p><pre><code>function TNullable&lt;T&gt;.GetValue:T;
begin
    if fHasValue then
    begin
        Result := fValue;
    end
    else raise Exception.Create(&#39;Value Not Set&#39;);
end;

procedure TNullable&lt;T&gt;.SetValue(newValue : T);
begin
    fValue := newValue;
    fHasValue := true;
end;

procedure TNullable&lt;T&gt;.SetToNull;
begin
    fHasValue := false;
end;
</code></pre><ul><li><strong>Get/Set for properties</strong></li></ul><p>Now that I have a nullable type I can create nullable properties<br /> However it comes with some code smells</p><p>for example if i create</p><pre><code>    TFoo = class
      private
        function GetBar:TNullable&lt;Integer&gt;;
        procedure SetBar(x:TNullable&lt;Integer&gt;);
      public 
        property Bar : TNullable&lt;Integer&gt; read GetBar write SetBar;
</code></pre><p>in the implementation section</p><pre><code>function TFoo.GetBar:TNullable&lt;Integer&gt;;
begin
    if **valueExists** then
    begin
        Result.Value := **the value**
    end else
    begin
        Result.SetToNull;
    end;
end;

procedure TFoo.SetBar(x:TNullable&lt;Integer&gt;);
begin
    if X.hasValue then
    begin
        //Store/show value here
    end else
    begin
        //handle null assignment here
    end;
end;
</code></pre><p>This is fine but when it comes to use these properties I can&#39;t just use</p><p>myFoo.Bar.Value := 1;</p><p>I have to use</p><pre><code>var 
    myBar : TNullable&lt;Integer&gt;;
begin
    myBar.Value := 1;
    myFoo.Bar := myBar;
end;
</code></pre><p>Which is a bit messier. I suppose there may be nothing I can do about this.</p><ul><li><strong>Circular References</strong></li></ul><p>I like to separate classes into different units.</p><p>ie:<br /> <img src="../../../i.stack.imgur.com/XD75V.png" alt="structure"/></p><p>keeping the user interface separate from the control logic and the model and data logic layer.</p><p>I can have a situation where 2 classes can reference each other. While this is a situation that for the most part I would like to avoid, there are occasions where this is needed.</p><p>for example</p><pre><code>unit u_A;

interface

uses
  u_B
  ;

type 
  TA = class
    public
       Foo : TB;
  end;

implementation

end;
</code></pre><p>and another unit</p><pre><code>unit u_B;

interface

uses
  u_A
  ;

type 
  TB = class
    public
       Foo : TA;
  end;

implementation

end;
</code></pre><p>This code is broken because the two classes include each other and this can not be done in pascal. This is not such a problem in C#. Solutions that I can think of: 1. include both classes in the same unit, although this is a problem if I do not think this suits the design. 2. Create another parent interface for B and inherit B from that, then this gets around it. Although this is messy for such a simple task.</p><ul><li><strong>Static classes</strong></li></ul><p>There aren&#39;t any static classes in Delphi, these are useful for control classes.</p><ul><li><strong>Best Container classes to use in Delphi</strong></li></ul><p>I&#39;m currently using TList and TObjectList in Generics.Collections<br /> They were introduced in Delphi XE I hope these are the best to use since delphi 7 didn&#39;t seem to have any good options.</p><p>I&#39;m still thinking about event handlers and any issues that may arise there. Perhaps there are some other issues that I have not thought of yet.</p><p>Thanks for any advice.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You should look into Spring4D as it already contains nullable types (similar implementation as yours with a little extra operator overloading) and way more powerful collection types than those in the RTL. They are also interfaced based which is very handy because you don&#39;t have to worry about lifetime management especially when passing them around.</p><p>For cross referencing problems I am suggesting coding against interfaces and use these as reference in another implementation rather than 2 implementations knowing each other.</p><p>As for the MVVM part you might look into DSharp which has a first version of a Caliburn Micro port for Delphi. It is very early stage and hardly documented but you might get some ideas how to achieve MVVM in Delphi using loosely coupled GUI and business logic connected with data bindings. The Blaise Pascal magazine had two articles about it if you are more interested.</p><p>P.S. I guess you mean you are using XE6 as that is the latest version.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../functions-with-side-effects-in-delphi-pascal/'>Functions with side-effects in Delphi/Pascal</a></li><li class="list-group-item"><a href='../value-of-mvvm-in-a-line-of-business-application-and-a-rant-of-current-development-practices/'>Value of MVVM in a Line of Business Application (and a Rant of Current Development Practices)</a></li><li class="list-group-item"><a href='../are-the-repository-pattern-and-active-record-pattern-compatible/'>Are the Repository Pattern and Active Record pattern compatible</a></li><li class="list-group-item"><a href='../design-mvvm-best-practices-with-wpf-client-and-wcf-duplex-service/'>Design &#8211; MVVM best practices with WPF client and WCF duplex service</a></li><li class="list-group-item"><a href='../uncle-bobs-clean-architecture-dealing-with-anemic-interactors-tiering-and-front-end-mvvm/'>Uncle Bob&#8217;s Clean Architecture &#8211; Dealing with anemic interactors, tiering, and front-end MVVM</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>