<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Web-development &#8211; How to safely chain several API requests for a single user &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079651 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079651" class="post-1079651 software type-software status-publish hentry category-software tag-api-design tag-web-development"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Web-development &#8211; How to safely chain several API requests for a single user</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api-design</span><span class="mr-2 badge badge-info">web-development</span></p><div class="entry-content"><p>I am writing a web application with Python and Flask. At a high-level, the web service takes an ID, downloads a file from a third-party API based on that ID, reads and analyzes the data inside the file, and finally returns that analysis to the client.</p><p>Since this process takes a fair bit of time, I&#39;d like to have notifications to the client when (1) the file is being downloaded, (2) the file is being analyzed, and (3) the analyzed value has been returned. Since HTTP is based on a single request-response cycle architecture, I have decided to break each step into an API endpoint. The client-side JavaScript will handle chaining the AJAX requests and updating the client of the progress.</p><p>Here is the request-response workflow I have in mind:</p><ul><li>1a. The front-end makes a request with an ID to a &#34;download&#34; endpoint and then notifies the client that the file is being downloaded.</li><li>1b. The server downloads the file and responds to the front-end with the downloaded filename. When this is successful&#8230;</li><li>2a. The front-end makes a request with the filename from step 1 and some additional configuration values&#8211;set when the user initially clicks &#34;submit&#34;&#8211;to an &#34;analyze&#34; endpoint and then notifies the client that the file is being analyzed.</li><li>2b. The server analyzes the file based on the client&#39;s configuration and generates an output file with the analysis. The server then responds with the output filename.</li><li>3a. The front-end then makes a request to the &#34;output&#34; endpoint with the output filename from step 2 and notifies the client that the output file is being downloaded locally.</li><li>3b. The server simply returns the static file on request. The server then deletes the output file.</li></ul><p>Broadly, my question is: does this architecture work? More specifically:</p><ul><li>Is there a better way to show progress to the client? This seems like a lot of overhead for that functionality&#8211;on the other hand, it&#39;s nice to have cleaner API endpoints.</li><li>What happens when client A and client B request the same data back-to-back? Client B&#39;s server-side process might respond that the output file is ready right before client A&#39;s process delete the file. Is there a way to avoid this scenario?</li></ul><p>I realize this is a bit messy, but I am pretty new to back-end development and am very open to any suggestions.</p><p>Thanks in advance.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>There are several parts to your question I will attempt to answer them.</p><h1>Architecture</h1><p>As far as architecture goes I would suggest either a simple endpoint that returns the current status of a process or a web socket (if you only support modern browsers). Using a status endpoint the client can simply poll or listen to the socket for status updates. When the status changes to something the client is updated and responds accordingly.</p><p>This way you will only have endpoints for each task and a status endpoint. The server then can perform any task in any order or respond with an error if a request is made in the wrong order.</p><h1>Client Tracking</h1><p>Two things might help you with solving the client A vs client B.</p><p>It sounds to me like you need to track session variables. Keep each clients requests sand boxed from each other by salting the file names with a client specific id or session. This will also help in keeping your site secure. You don&#39;t want to allow arbitrary user content to be uploaded and shared with other clients unless you can sanitize it. For example if Client A were malicious and uploaded javascript and Client B were to download it to his browser the javascript will run in the context of your domain and could end up doing nasty things.</p><p>Also, it might help to not delete the file right away but to have a separate script clean up at set time intervals. See <a href="http://en.wikipedia.org/wiki/Cron" rel="nofollow noreferrer">Cron</a> or <a href="http://en.wikipedia.org/wiki/Windows_Task_Scheduler" rel="nofollow noreferrer">Task Schedular</a>.</p><p>I have used cron scripts that check a given file location for files older than a given time frame. That way I delete files well after they were needed.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-many-small-requests-vs-few-large-requests-api-design/'>Rest &#8211; Many small requests vs. few large requests (API Design)</a></li><li class="list-group-item"><a href='../web-development-how-to-use-own-rest-api-in-web-front-end/'>Web-development &#8211; How to use own REST API in web front end</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>