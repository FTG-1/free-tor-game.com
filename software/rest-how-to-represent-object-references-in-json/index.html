<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; How to represent object references in JSON &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1065163 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1065163" class="post-1065163 software type-software status-publish hentry category-software tag-api tag-design tag-json tag-rest tag-web-services"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; How to represent object references in JSON</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">json</span><span class="mr-2 badge badge-primary">rest</span><span class="mr-2 badge badge-danger">web services</span></p><div class="entry-content"><p>I am trying to figure out what&#39;s the best approach when dealing with object references in a JSON to be sent to my server for deserialization.</p><p>To clarify, what I mean is how to refer to data contained in the JSON body itself.</p><p>For the example let&#39;s use the following (incorrect) JSON body:</p><pre><code>{
  &#34;players&#34;: [
    { &#34;name&#34;: &#34;Player 1&#34; },
    { &#34;name&#34;: &#34;Player 2&#34; },
    { &#34;name&#34;: &#34;Player 3&#34; },
    { &#34;name&#34;: &#34;Player 4&#34; }
  ],
  &#34;teams&#34;: [
    {
      &#34;name&#34;: &#34;Team 1&#34;,
      &#34;players&#34;: [ player1, player2 ],
    },
    {
      &#34;name&#34;: &#34;Team 2&#34;,
      &#34;players&#34;: [ player3, player4 ],
    },
  ]
}
</code></pre><p>I need some means to refer to those <em>playerX</em>, which would represent the players sent in the <em>players</em> list (Player 1, Player 2, etc&#8230;), as you can imagine.</p><p>I can think of three different ways of doing this and none satisfy me:</p><p>The first way is to simply refer to the player as its position in the <em>players</em> list, this way no extra information is needed in the JSON body. For example, if we had <code>&#34;teams&#34;: [ [ 0, 1 ], [ 2, 3 ] ]</code> that would mean we have two teams, the first one composed by P1 and P2 and the second one by P3 and P4.</p><p>The other two ways would both use IDs (I would need to implement an ID system for my players, since so far I haven&#39;t been in the need of IDs). However, since the players don&#39;t exist in the system yet, their IDs are unknown. As I see, we can do two things:</p><p>We can explicitly send the player IDs to the server, but we would have to develop ways of preserving ID uniqueness. I would prefer if these were not handled by the user, to by honest, as well as autogenerated. The way we would represent the players in the <em>teams</em> list would look the same like the first choice in format, but instead of the positions, we would have the IDS:</p><pre><code>{
  &#34;players&#34;: [
    { &#34;id&#34;: 1, &#34;name&#34;: &#34;Player 1&#34; },
    { &#34;id&#34;: 2, &#34;name&#34;: &#34;Player 2&#34; },
    { &#34;id&#34;: 3, &#34;name&#34;: &#34;Player 3&#34; },
    { &#34;id&#34;: 4, &#34;name&#34;: &#34;Player 4&#34; }
  ],
  &#34;teams&#34;: [
      [ 1, 2 ], [ 3, 4 ] 
  ]
}
</code></pre><p>The second option is safer in terms of ID generation, but it requires two steps. First we send the player data to the server, then the user can ask the server for the players information and check their IDs. This way they create the teams safely because the ID was generated by the server.</p><p>Step 1. Send players.</p><pre><code>{
  &#34;players&#34;: [
    { &#34;name&#34;: &#34;Player 1&#34; },
    { &#34;name&#34;: &#34;Player 2&#34; },
    { &#34;name&#34;: &#34;Player 3&#34; },
    { &#34;name&#34;: &#34;Player 4&#34; }
  ]
}
</code></pre><p>Step 2. Query players. <code>GET /players</code></p><pre><code>{
  &#34;players&#34;: [
    { &#34;id&#34;: 11, &#34;name&#34;: &#34;Player 1&#34; },
    { &#34;id&#34;: 12, &#34;name&#34;: &#34;Player 2&#34; },
    { &#34;id&#34;: 13, &#34;name&#34;: &#34;Player 3&#34; },
    { &#34;id&#34;: 14, &#34;name&#34;: &#34;Player 4&#34; }
  ]
}
</code></pre><p>Step 3. Send teams.</p><pre><code>{
  &#34;teams&#34;: [
      [ 11, 12 ], [ 13, 14 ] 
  ]
}
</code></pre><p>So how is this usually dealt with? How do JSON API developers tackle this scenario?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>For inspiration, you may want to look into the way some of the json based api&#39;s (ex: <a href="http://jsonapi.org/" rel="noreferrer">json api</a>, <a href="http://stateless.co/hal_specification.html" rel="noreferrer">HAL</a>) handle embedding.</p><p>One simple answer is to track your data in a key value store.  For example</p><pre><code>{ &#34;/players/0&#34; : {...}
, &#34;/players/1&#34; : {...}
, &#34;/players/2&#34; : {...}
, &#34;/players/3&#34; : {...}
, &#34;/teams/0&#34; : {...}
, &#34;/teams/1&#34; : {...}
}
</code></pre><p>And then you describe the players assigned to your team using local references</p><pre><code>, &#34;/teams/0&#34; :
    { refs : 
        [ &#34;/players/0&#34;
        , &#34;/players/1&#34;
        ]
    }
</code></pre><p>As it happens, this scheme covers the case where you have identifiers too.  Or where you only have some identifiers</p><pre><code>, &#34;/teams/0&#34; :
    { refs : 
        [ &#34;/players/0&#34;
        , &#34;/players/2ad8cabe-2f93-11e6-ac61-9e71128cae77&#34;
        ]
    }
</code></pre><p>There are fancier versions of this idea (see the links).</p><p><em>That said</em>, I&#39;ve been down this road myself, and I really tied myself in knots until I concluded: if what you really have is a list of names, rather than a list of players, admit that to yourself, code it that way, and deal with it.  It&#39;s the more honest way of representing what&#39;s going on in the domain at that point in time.</p><p>In which case, the payload of your message should look very close to:</p><pre><code>{ &#34;Team 1&#34; : 
  [ &#34;Player 1&#34;
  , &#34;Player 2&#34;
  ]
, &#34;Team 2&#34; :
  [ &#34;Player 3&#34;
  , &#34;Player 4&#34;
  ]
}
</code></pre><p>If that makes you twitchy, remember: this isn&#39;t a description of your domain objects; it&#39;s a <em>message</em>.  The changes it makes to your domain are a side effect.  Jim Webber covers this in the introduction to <a href="https://yow.eventer.com/yow-2011-1004/domain-driven-design-for-restful-systems-by-jim-webber-1047" rel="noreferrer">this talk</a>.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-should-a-rest-interface-include-the-query-id-as-part-of-the-response/'>Rest &#8211; Should a REST interface include the query ID as part of the response</a></li><li class="list-group-item"><a href='../is-it-a-good-idea-for-an-api-to-return-only-ids-from-objects/'>Is it a good idea for an API to return only ids from objects</a></li><li class="list-group-item"><a href='../how-to-represent-a-set-in-json/'>How to represent a set in JSON</a></li><li class="list-group-item"><a href='../rest-is-it-a-good-practice-to-have-a-special-value-all-in-an-enum/'>Rest &#8211; Is it a good practice to have a special value &#8220;ALL&#8221; in an enum</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>