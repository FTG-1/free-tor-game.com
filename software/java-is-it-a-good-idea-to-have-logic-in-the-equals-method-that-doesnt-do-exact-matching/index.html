<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Is it a good idea to have logic in the equals method that doesn&#8217;t do exact matching &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066858 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066858" class="post-1066858 software type-software status-publish hentry category-software tag-java tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Is it a good idea to have logic in the equals method that doesn&#8217;t do exact matching</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">java</span><span class="mr-2 badge badge-info">object-oriented</span></p><div class="entry-content"><p>While assisting a student with a university project, we worked on a Java exercise provided by the university which defined a class for an address with the fields:</p><pre><code>number
street
city
zipcode
</code></pre><p>And it specified that the equals logic should return true if the number and zip code match.</p><p>I was once taught that the equals method should only be doing an exact comparison between the objects (after checking the pointer), which makes some sense to me, but contradicts with the task they were given.</p><p>I can see why you would want to override the logic so that you can use things like <code>list.contains()</code> with your partial matching but I&#39;m wondering if this is considered kosher, and if not why not?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h2>Defining Equality For Two Objects</h2><p>Equality can be arbitrarily defined for any two objects. There is no strict rule that forbids someone from defining any way they want. However, equality is often defined when it is meaningful for the domain rules of what is being implemented.</p><p>It is expected to follow the <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#equals-java.lang.Object-" rel="noreferrer">equivalence relation contract</a>:</p><blockquote><ul><li>It is <strong>reflexive</strong>: for any non-null reference value x, x.equals(x)
 should return true.</li><li>It is <strong>symmetric</strong>: for any non-null reference values
 x and y, x.equals(y) should return true if and only if y.equals(x)
 returns true.</li><li>It is <strong>transitive</strong>: for any non-null reference values x,
 y, and z, if x.equals(y) returns true and y.equals(z) returns true,
 then x.equals(z) should return true.</li><li>It is <strong>consistent</strong>: for any
 non-null reference values x and y, multiple invocations of x.equals(y)
 consistently return true or consistently return false, provided no
 information used in equals comparisons on the objects is modified.</li><li>For
 any non-null reference value x, x.equals(null) should return false.</li></ul></blockquote><p>In your example, perhaps there is no need to distinguish two addresses that have the same zipcode and number as being different. There are domains that are perfectly reasonable to expect the following code to work:</p><pre class="lang-java prettyprint-override"><code>Address a1 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;Street Name&#34;,&#34;City Name&#34;);
Address a2 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;Str33t N4me&#34;,&#34;C1ty N4me&#34;);
assert a1.equals(a2);
</code></pre><p>This can be useful, as you mentioned, for when you do not care about them being different objects - you only care about the values they hold. Perhaps zipcode + street number are enough for you to identify the correct address and the remaining information is &#34;extra&#34;, and you don&#39;t want that extra information to affect your equality logic.</p><p>This could be a perfectly good modeling for a software. Just make sure there is some documentation or unit tests to ensure this behavior and that the public API reflects this use.</p><hr/><h2>Do Not Forget About <code>hashCode()</code></h2><p>One additional detail relevant for implementation is the fact that many languages heavily use the concept of <strong>hash code</strong>. Those languages, java including, usually assume the following proposition:</p><blockquote><p>If x.equals(y) then x.hashCode() and y.hashCode() are the same.</p></blockquote><p>From the same link as before:</p><blockquote><p>Note that it is generally necessary to override the hashCode method whenever this method (equals) is overridden, so as to maintain the general contract for the hashCode method, which states that equal objects must have equal hash codes.</p></blockquote><p><em>Note that having the same hashCode does not mean that two objects are equal!</em></p><p>In that sense, when one implements equality, one should also implement a <code>hashCode()</code> that follow the property mentioned above. This <code>hashCode()</code> is used by data structures for efficiency and guaranteeing upper bounds on the complexity of their operations.</p><p>Coming up with a good hash code function is hard and an entire topic on itself. Ideally the hashCode of two different objects should be different or have an even distribution among instance occurrences.</p><p>But keep in mind that the following simple implementation still fulfills the equality property, even though it is not a &#34;good&#34; hash function:</p><pre class="lang-java prettyprint-override"><code>public int hashCode() {
    return 0;
}
</code></pre><p>A more common way of implementing hash code is to use the hash codes of the fields that define your equality and make a binary operation on them. In your example, zipcode and street number. It is often done like:</p><pre class="lang-java prettyprint-override"><code>public int hashCode() {
    return this.zipCode.hashCode() ^ this.streetNumber.hashCode();
}
</code></pre><hr/><h2>When Ambiguous, Choose Clarity</h2><p>Here is where I make a distinction about what one should expect regarding equality. Different people have different expectations regarding equality and if you are looking to follow the <a href="https://wiki.c2.com/?PrincipleOfLeastAstonishment" rel="noreferrer">Principle of Least Astonishment</a> you can consider other options to better describe your design.</p><p>Which of those should be considered equal?</p><pre class="lang-java prettyprint-override"><code>Address a1 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;Street Name&#34;,&#34;City Name&#34;);
Address a2 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;Str33t N4me&#34;,&#34;C1ty N4me&#34;);
assert a1.equals(a2); // Are typos the same address?
</code></pre><pre class="lang-java prettyprint-override"><code>Address a1 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;John Street&#34;,&#34;SpringField&#34;);
Address a2 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;John St.&#34;,&#34;SpringField&#34;);
assert a1.equals(a2); // Are abbreviations the same address?
</code></pre><pre class="lang-java prettyprint-override"><code>Vector3 v1 = new Vector3(1.0f, 1.0f, 1.0f);
Vector3 v2 = new Vector3(1.0f, 1.0f, 1.0f);
assert v1.equals(v2); // Should two vectors that have the same values be the same?
</code></pre><pre class="lang-java prettyprint-override"><code>Vector3 v1 = new Vector3(1.00000001f, 1.0f, 1.0f);
Vector3 v2 = new Vector3(1.0f, 1.0f, 1.0f);
assert v1.equals(v2); // What is the error tolerance?
</code></pre><p>A case could be made for each one of those being true or false. When in doubt, one can define a different relation that is clearer in the context of the domain.</p><p>For instance, you could define <code>isSameLocation(Address a)</code>:</p><pre class="lang-java prettyprint-override"><code>Address a1 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;John Street&#34;,&#34;SpringField&#34;);
Address a2 = new Address(&#34;123&#34;,&#34;000000-0&#34;,&#34;John St.&#34;,&#34;SpringField&#34;);

System.out.print(a1.equals(a2)); // false;
System.out.print(a1.isSameLocation(a2)); // true;
</code></pre><p>Or in the case of Vectors, <code>isInRangeOf(Vector v, float range)</code>:</p><pre class="lang-java prettyprint-override"><code>Vector3 v1 = new Vector3(1.000001f, 1.0f, 1.0f);
Vector3 v2 = new Vector3(1.0f, 1.0f, 1.0f);

System.out.print(v1.equals(v2)); // false;
System.out.print(v1.isInRangeOf(v2, 0.01f)); // true;
</code></pre><p>This way, you better describe your design intent for equality, and you avoid breaking future readers expectations regarding what your code actually does. (You can just take a look at all the slightly different answers to see how people&#39;s expectations varies regarding the equality relation of your example)</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/java-best-practice-what-can-be-the-hashcode-method-implementation-if-custom-field-used-in-equals-method-are-null/'>Java &#8211; Best Practice: What can be the hashCode() method implementation if custom field used in equals() method are null</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/java-is-it-a-good-idea-to-have-type-safe-equals/'>Java &#8211; Is it a good idea to have type safe equals</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/object-oriented-is-it-a-bad-idea-have-make-a-class-method-that-is-passed-class-variables/'>Object-oriented &#8211; Is it a bad idea have make a class method that is passed class variables</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>