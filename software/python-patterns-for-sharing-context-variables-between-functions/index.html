<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; Patterns for sharing context variables between functions &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1078307 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1078307" class="post-1078307 software type-software status-publish hentry category-software tag-functional-programming tag-python tag-variables"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; Patterns for sharing context variables between functions</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">functional programming</span><span class="mr-2 badge badge-info">python</span><span class="mr-2 badge badge-warning">variables</span></p><div class="entry-content"><p>I am looking for ways of passing around a set of contextual variables that are required by functions.</p><p>As a Python programmer, right now I can see three ways of solving the problem: passing them around as explicit arguments, class encapsulation and closures (function factory).</p><p>I find that explicit arguments tend to obscure the function logic, class encapsulation tend to lead to the do-it-all, thousand lines classes, whereas closures tend to create an programming overhead because of factory creation.</p><p>I was wondering if there were any other patterns that allow sharing of dynamically defined contextual variables between functions devoid of such shortcomings? For instance how this problem would be solved in the context of functional programming?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You might look into the Reader or State monads; they can be used for sharing data between (pure, monadic) functions, without resorting to explicit parameters or the like.</p><p>There&#39;s a tutorial series on <a href="http://fsharpforfunandprofit.com/posts/monadster/" rel="nofollow noreferrer">F# for fun and profit</a> about the State monad (AKA Workflow in F# parlence). I also gave a description of it in this <a href="https://stackoverflow.com/a/28224957/225292">SO answer</a> that appears to be fairly approachable.</p><p>There are some implementations of other <a href="http://www.valuedlessons.com/2008/01/monads-in-python-with-nice-syntax.html" rel="nofollow noreferrer">monads in python</a> that you could reference too, if you have to implement your own.</p><p>Many people (myself included) find monads challenging at first, so if you&#39;re not familiar with the concept then I&#39;d recommend looking at some of the simpler monads like Maybe or Either, and then perhaps Reader or Writer, before tackling State. The Python implementations linked to above may make things more clear for you than what you&#39;re likely to find elsewhere online (which would probably be Haskell).</p><p><strong>A few caveats:</strong> there is still a little overhead over just functions, since the monad is involved, and this has to be used with <em>functions</em>; I don&#39;t think you could do this with class methods (though I could be wrong -- I&#39;ve never tried it!).</p><p><strong>UPDATE:</strong></p><p>The &#34;monads in python&#34; page/lib I linked to above actually <em>does</em> have a state-monad implementation; check out the code starting at <code>###### StateChanger Monad #########</code> for the definition and examples.</p><p><strong>EDIT in response to question in comment:</strong></p><p>Yes, that&#39;s the way you&#39;d do it -- to be extra clear, the arguments you declare the function with should not include the environment variables, just the ones the function would need normally; the environment variables will be accessible through the monadic <code>get</code> and <code>set</code> functions.</p><p>A Python example using the notation given in the &#34;monads in python&#34; link above:</p><pre><code>@do(StateChanger) # &lt;-- this makes makes it a stateful computation
def my_stateful_function1(arg):
    # do something with `arg` here
    # then put it in the state:
    yield dict_state_set(key, var_from_arg)
    # I believe you can leave out `mreturn` for this

@do(StateChanger)
def my_stateful_function2(arg1, arg2):
    # something with `arg1` here
    # get the state chained via the monad:
    state = yield get_state()
    # do something else stateful:
    yield my_stateful_function1(arg2)
    # do something with `state` dict here
    # return; you have to use `mreturn` instead of `return`:
    mreturn(some_value)
</code></pre><p>To run this you&#39;d call:</p><pre><code>ret_val = my_stateful_function2(&#34;hello&#34;,&#34;world&#34;).run(initial_state_dict)
</code></pre><p>and your return value would be a tuple:</p><pre><code>(return_value_of_function, final_state_dict) = ret_val
</code></pre><p>Remember to use <code>yield</code> when calling other stateful functions.</p><p><strong>Admonition:</strong> Be careful about modifying the state in your functions since the Python dictionary type is mutable. You can get and set state vars, as well as apply a (lambda) function to them; you may wish to stick with this rather than pulling the state out and mutating it willy-nilly.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/method-flags-as-arguments-or-as-member-variables/'>Method flags as arguments or as member variables</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/python-how-should-you-cleanly-restrict-object-property-types-and-values-in-python/'>Python &#8211; How should you cleanly restrict object property types and values in Python</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/alternative-to-language-purity/'>Alternative to language purity</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/object-oriented-should-i-create-a-class-if-the-function-is-complex-and-has-a-lot-of-variables/'>Object-oriented &#8211; Should I create a class if the function is complex and has a lot of variables</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/python-sharing-docstrings-between-similar-functions/'>Python &#8211; Sharing Docstrings between similar functions</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>