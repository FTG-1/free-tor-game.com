<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Environment-aware Code &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069943 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069943" class="post-1069943 software type-software status-publish hentry category-software tag-c tag-development-environment tag-net tag-production tag-release-management"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Environment-aware Code</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">development-environment</span><span class="mr-2 badge badge-warning">net</span><span class="mr-2 badge badge-primary">production</span><span class="mr-2 badge badge-danger">release-management</span></p><div class="entry-content"><p>There are situations where the deployed environment (<strong>development</strong>, <strong>test</strong>, or <strong>production</strong>, for example) might dictate the outcome of certain actions.</p><p>For example, perhaps a successful &#34;user registration&#34; process will send a notification email to the new user.  Environment-specific actions:</p><ul><li><strong>Development:</strong> Do not actually send the email.  Email logs will provide enough for developers.</li><li><strong>Test:</strong> Send all emails to some testEnvironment@domain.com inbox and not to the user&#39;s address.</li><li><strong>Production:</strong> Send the email to the user.</li></ul><p>I have listed three possible solutions below.</p><h2><strong>CurrentEnvironment configuration value</strong></h2><p>One way of solving this, which I have seen a lot, is to have some configuration value (whether it be in some xml config file or in the database) such as <code>CurrentEnvironment</code> which specifies the current environment in which the system is deployed to.  This would require case/if checks in code to determine the desired action:</p><pre><code>if(CurrentEnvironment == Environment.Test)
{
    // Send all emails to some testEnvironment@domain.com inbox.
}
else if(CurrentEnvironment == Environment.Production)
{
    // Send the email to the user.
}
</code></pre><p>This is not a maintainable solution in my opinion.</p><h2><strong>Wipe all email addresses</strong></h2><p>Another method is to run a change script, once restoring a database, to do the following:</p><ul><li>Remove all user email addresses (in development),</li><li>Replace all user email addresses with testEnvironment@domain.com (in test)</li></ul><p>This is an extra step in the release process which, if missed, could have some dangerous results.  Additionally, this solution only fixes the email problem.  There are perhaps many other situations where the environment matters.</p><h2><strong>Config transformation</strong></h2><p>Another idea is to use <a href="http://msdn.microsoft.com/en-us/library/dd465318(v=vs.100).aspx" rel="nofollow">web.config transformations</a>.  This way the config can be different for different environments.  For example, we will have the following configs:</p><pre><code> web.config
   web.Development.config
   web.Test.config
   web.Production.config
</code></pre><p>The transformation can then use different &#34;providers&#34; or set certain attributes according to the environment.  For example, an <code>overrideDeliveryAddress</code> can be set in the <code>web.Test.config</code>:</p><pre><code>&lt;EmailService&gt;
  &lt;providers&gt;
    &lt;add 
      name=&#34;EmailServiceProvider&#34;
      type=&#34;CustomProviders.EmailServiceProvider, CustomProviders&#34;
      smtp=&#34;smtp.domain.com&#34; password=&#34;xyz&#34;
      overrideDeliveryAddress=&#34;testEnvironment@domain.com&#34;
      enabled=&#34;true&#34;
    /&gt;
 &lt;/providers&gt;
&lt;/EmailService&gt;
</code></pre><p>This solution requires much more work, but is more maintainable and less invasive.  Code is now environment-oblivious.</p><p>What other ways can the above be achieved?  Should code EVER be environment aware?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>First, you should not use your real production data (especially not person-related data) in development or test (you may use carefully choosen excerpts from production data, of course). So your data pools (maybe a database, maybe a pool of files, maybe both), should be separated between those environments. So the only thing you need to change is the config file where you switch between those 3 data pools (for example, the database connection string, or the path to the files). This means there will be no need for any &#34;environment-aware code&#34;, the only single thing which is enironment-aware is that entry in your main configuration file.</p><p>For example, your development environment should have development database with a list of email adresses, and your test environment a different database with a different list, and your production environment a database with the real mail adresses.</p><p>The problem you are describing seems to be a situation where you try to load a copy of the production database into your development environment and replace your development database with that. This is most probably a scenario you should avoid, better provide import/export mechanisms to transfer small portions of data from one database into another, where personal data is normally not transferred. If you <strong>really</strong> need an original copy of the production DB in your dev environment (because otherwise you cannot reproduce a certain bug), go with solution 2 and delete or anonymize any <em>personal</em> data like mail adresses (in many scenarios you must do this either for reasons of privacy).</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-design-pattern-for-different-code-behaviors-according-to-different-clients/'>C# &#8211; Design pattern for different code behaviors according to different clients</a></li><li class="list-group-item"><a href='../how-to-stop-uat-qa-test-services-being-used-in-a-production-environment/'>How to stop UAT/QA/Test services being used in a production environment</a></li><li class="list-group-item"><a href='../c-defining-a-web-service-endpoint-via-configuration-instead-of-code/'>C# &#8211; Defining a Web Service Endpoint via Configuration instead of Code</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>