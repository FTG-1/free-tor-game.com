<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Database &#8211; Is it OK to have a many-to-many relationship where one of the tables involved is already a junction table &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1081432 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1081432" class="post-1081432 software type-software status-publish hentry category-software tag-database tag-database-design tag-patterns-and-practices tag-relational-database"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Database &#8211; Is it OK to have a many-to-many relationship where one of the tables involved is already a junction table</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database</span><span class="mr-2 badge badge-info">database-design</span><span class="mr-2 badge badge-warning">patterns-and-practices</span><span class="mr-2 badge badge-primary">relational-database</span></p><div class="entry-content"><p>When planning our database, we ended up with a setup like this:</p><p>We have <code>Company</code>, <code>Product</code> and <code>Person</code>.</p><p>There is a many-to-many relationship between <code>Company</code> and <code>Product</code>, through a junction table <code>Company_Product</code>, because a given company may produce more than one product (such as &#34;car&#34; and &#34;bicycle&#34;), but also a given product, such as &#34;car&#34;, can be produced by multiple companies. In the junction table <code>Company_Product</code> there is an extra field &#34;price&#34; which is the price in which the given company sells the given product.</p><p>There is another many-to-many relationship between <code>Company_Product</code> and <code>Person</code>, through a junction table <code>Company_Product_Person</code>. Yes, it is a many-to-many relationship involving one entity that is already a junction table. This is because a Person can own multiple products, such as a car from company1 and a bicycle from company2, and in turn the same company_product can be owned by more than one person, since for example both person1 and person2 could have bought a car from company1. In the junction table <code>Company_Product_Person</code> there is an extra field &#34;thoughts&#34; which contains the thoughts of the person at the moment they purchased the company_product.</p><p><strong>Is this commonly-acceptable or is this a sign that something is wrong? If it&#39;s weird, what would be a better solution?</strong></p><p>I&#39;ve been running into a few problems with this (<a href="https://stackoverflow.com/q/48713019/4135063">such as this one</a>), so I was wondering, perhaps my database setup is wrong to begin with.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>In making the logical design of your database, you should not think in terms of &#34;junction tables&#34;, but in terms of relations.</p><p>Your first &#34;junction table&#34; seems to correspond to the relation &#34;<em>Company</em> sells <em>Product</em> for <em>Price</em>&#34;. Your second &#34;junction table&#34; seems to correspond to the relation &#34;<em>Person</em> owns <em>Product</em> manufactured by <em>Company</em>&#34;.</p><p>While it would depend on the full context, I&#39;d likely model the second relation as a table with foreign keys to the <code>Company</code>, <code>Product</code>, and <code>Person</code> tables and with no connection to the other &#34;junction table&#34;. This raises the risk that I could claim that a person owns a product that was never manufactured by a company, but it also allows deleting a row from the &#34;sells product&#34; table without losing all the ownership information for anybody that happened to own that product from that company. Maybe this isn&#39;t an issue for you, in which case this isn&#39;t a reason not to structure the tables in the way you suggest, and the risk I mentioned before <em>is</em> a reason to structure the tables in the way you suggest.</p><p>More generally, what I would recommend (besides thinking relationally rather than in terms of &#34;tables&#34; and &#34;junction tables&#34;) is to consider what happens as things change. For example, let&#39;s say you want to calculate how much a person has spent on various products. If the prices can change, then you can&#39;t do this with your suggested representation (nor my suggestion without adding additional information), since the person may have bought the product at a time when the price was different. Temporal database techniques can handle these situations generally, but fully doing this is often overkill. Nevertheless, I recommend looking at temporal databases as they tend to more accurately model the situation. From there you can consider what data (if any) is unimportant and thus you can lose. (Temporal databases are usually &#34;insert-only&#34;.) I suspect if you factor in how the data can change over time, you will want a schema different from your original suggestion and my suggestion.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-tracking-correct-order-details-in-commerce-database-when-modifying-products/'>Database &#8211; Tracking correct order details in commerce database when modifying &#8216;products&#8217;</a></li><li class="list-group-item"><a href='../optimal-database-design-for-3-way-relationship/'>Optimal Database design for 3-way relationship</a></li><li class="list-group-item"><a href='../database-how-to-store-ordered-information-in-a-relational-database/'>Database &#8211; How to store ordered information in a Relational Database</a></li><li class="list-group-item"><a href='../database-why-does-the-relational-model-for-a-database-matter/'>Database &#8211; Why does the relational model for a database matter</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>