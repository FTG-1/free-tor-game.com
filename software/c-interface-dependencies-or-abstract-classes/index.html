<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Interface Dependencies or Abstract Classes &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1084551 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1084551" class="post-1084551 software type-software status-publish hentry category-software tag-abstract-class tag-c tag-design tag-interfaces tag-object-oriented-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Interface Dependencies or Abstract Classes</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">abstract class</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">design</span><span class="mr-2 badge badge-primary">interfaces</span><span class="mr-2 badge badge-danger">object-oriented-design</span></p><div class="entry-content"><p>I have a decision to make and I am wondering what would be the better solution. I am refactoring an older application and intend to really get into the nuts and bolts of it.</p><p>There are 8 report types currently and one of the modifications are to allow different reports to be &#34;saved&#34; in different ways. My two thoughts on it were</p><ol><li><p>Have an Abstract Class with an abstract save method, then each report type can define its own way of doing things. Possibly have other abstract classes inheriting from that one, each implementing a virtual <code>Save()</code> method. Then the report classes can inherit from the one with the relevant save mechanism.</p></li><li><p>Have a report interface, which has a method signature like</p><pre><code>void Save(ISaveMechanism saveMechanism);
</code></pre><p>Then have an interface with a <code>Save()</code> method, then each report type can use <code>saveMechanism.Save();</code> and just use the concrete implementation required.</p></li></ol><p>Would either solution cause more issues/drawbacks than the other? This project doesn&#39;t currently have any associated unit tests but if given time, it would be good to add some later.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I don&#39;t think it&#39;s an either/or. I think you should use <strong>both</strong> Interfaces and Abstract Classes.</p><h1>TL;DR</h1><h2>Abstract Classes</h2><h3>Pros:</h3><ul><li>Relatively simple</li><li>You can provide basic functionality and &#34;hooks&#34; that the subclasses can use.</li></ul><h3>Cons:</h3><ul><li>You&#39;re &#34;stuck&#34; with the inheritance hierarchy</li><li>Client code knows about the Base Class</li></ul><h2>Interfaces</h2><h3>Pros:</h3><ul><li>Almost unlimited flexibility</li></ul><h3>Cons:</h3><ul><li>Zero implementation provided</li><li>May be harder for less experienced coders to understand.</li></ul><h1>Scenario</h1><p>Imagine that you create an Abstract Class today. We&#39;ll call it <code>BaseReport</code>. BaseReport provides an empty &#34;save&#34; method, and all your current types of reports extend from BaseReport and have their own implementation of save.</p><p>For the sake of argument, you also want to display the text of the report before saving it, so your BaseReport extends a simple View component provided by your language of choice that will allow you to put a few text objects and a save button on the screen and not much more. It&#39;s really lightweight, so it&#39;s a good choice based on all the reports you have in front of you. I&#39;ll call it <code>SimpleContainer</code>.</p><p>Now, you&#39;re nine months down the line, and you need to have a report that has multiple pages, and someone has asked that one of the reports be viewable in either portrait or landscape modes. Neither of these requirements can be fulfilled with a subclass of SimpleContainer.</p><p>However, you have a lot of client code that knows about BaseReport, and there might <em>even</em> be a place or two where you&#39;ve cast to SimpleContainer (where&#39;s the harm?). Not only that, the code is more like custom framework code, and you&#39;ve spawned off four projects that use it. So <em>all</em> of those projects will have to go through QA again if you refactor to go to IReport so you can extend <code>PagedContainer</code> for the one report and <code>RotatableContainer</code> for the other. More than likely, at this point your answer is &#34;sorry, we can&#39;t do that.&#34; Not because you really can&#39;t do that, but because it&#39;s too much of a risk to all the other things sitting on top of it.</p><p>But for the past 9 months, you&#39;ve been developing along like gangbusters because you had that base code in BaseReport that allowed you to rip out a new Report type in record time, so you don&#39;t want to throw the baby out with the bathwater. Instead, make your BaseReport implement IReport and just make sure that the client code <em>only</em> refers to it as IReport. When the requirement comes in for a PagedContainer, build a BasePagedContainer that implements IReport and then build your individual reports on top.</p><p>There&#39;s not really a downside to this approach, because the amount of labor it takes to create the interface and implement it into your Abstract Classes is minuscule compared to the amount of flexibility and future-proofing you gain.</p><p>And I might have changed a few details to protect the innocent, but the scenario is real, and it happened to me. :)</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-when-to-use-abstract-classes-instead-of-interfaces-with-extension-methods-in-c/'>C# &#8211; When to use abstract classes instead of interfaces with extension methods in C#</a></li><li class="list-group-item"><a href='../php-switching-from-abstract-class-to-interface/'>Php &#8211; Switching from abstract class to interface</a></li><li class="list-group-item"><a href='../c-abstract-class-inheritance-vs-interface/'>C# &#8211; Abstract class + Inheritance vs Interface</a></li><li class="list-group-item"><a href='../what-are-the-differences-between-abstract-classes-interfaces-and-when-to-use-them/'>What are the differences between abstract classes, interfaces, and when to use them</a></li><li class="list-group-item"><a href='../c-abstract-classes-and-constants/'>C# &#8211; Abstract classes and constants</a></li><li class="list-group-item"><a href='../c-convert-this-abstract-class-to-an-interface/'>C# &#8211; Convert this abstract class to an interface</a></li><li class="list-group-item"><a href='../c-workaround-for-casting-method-parameter-interface-to-desired-concrete-type-in-polymorphic-design/'>C# &#8211; Workaround for casting method parameter interface to desired concrete type in polymorphic design</a></li><li class="list-group-item"><a href='../java-should-an-abstract-class-implement-an-interface-as-opposed-to-defining-its-own-abstract-methods/'>Java &#8211; Should an abstract class implement an interface, as opposed to defining its own abstract methods</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>