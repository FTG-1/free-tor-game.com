<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Rest &#8211; How best do you represent a bi-directional sync in a REST api &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064154 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064154" class="post-1064154 software type-software status-publish hentry category-software tag-api tag-api-design tag-rest tag-synchronization"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Rest &#8211; How best do you represent a bi-directional sync in a REST api</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api</span><span class="mr-2 badge badge-info">api-design</span><span class="mr-2 badge badge-warning">rest</span><span class="mr-2 badge badge-primary">synchronization</span></p><div class="entry-content"><p>Assuming a system where there&#39;s a Web Application with a resource, and a reference to a remote application with another similar resource, how do you represent a bi-directional sync action which synchronizes the &#39;local&#39; resource with the &#39;remote&#39; resource?</p><p>Example:</p><p>I have an API that represents a todo list.</p><p>GET/POST/PUT/DELETE /todos/, etc.</p><p>That API can reference remote TODO services.</p><p>GET/POST/PUT/DELETE /todo_services/, etc.</p><p>I can manipulate todos from the remote service through my API as a proxy via</p><p>GET/POST/PUT/DELETE /todo_services/abc123/, etc.</p><p>I want the ability to do a bi-directional sync between a local set of todos and the remote set of TODOS.</p><p>In a rpc sort of way, one could do</p><p>POST /todo_services/abc123/sync/</p><p>But, in the &#34;verbs are bad&#34; idea, is there a better way to represent this action?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h1>Where and what are the resources?</h1><p>REST is all about addressing resources in a stateless, discoverable manner. It does not have to be implemented over HTTP, nor does it have to rely on JSON or XML, although it is strongly recommended that a hypermedia data format is used (see the <a href="http://en.wikipedia.org/wiki/HATEOAS" rel="noreferrer">HATEOAS</a> principle) since links and ids are desirable.</p><p>So, the question becomes: How does one think about synchronization in terms of resources?</p><h1>What is bi-directional sync?**</h1><p>Bi-directional sync is the process of updating the resources present on a graph of nodes so that, at the end of the process, all nodes have updated their resources in accordance with the rules governing those resources. Typically, this is understood to be that all nodes would have the latest version of the resources as present within the graph. In the simplest case the graph consists of two nodes: local and remote. Local initiates the sync.</p><p>So the key resource that needs to be addressed is a transaction log and, therefore, a sync process might look like this for the &#34;items&#34; collection under HTTP:</p><h2>Step 1 - Local retrieves the transaction log</h2><p><strong>Local:</strong> <code>GET /remotehost/items/transactions?earliest=2000-01-01T12:34:56.789Z</code></p><p><strong>Remote:</strong> <em>200 OK</em> with body containing transaction log containing fields similar to this.</p><ul><li><p><code>itemId</code> - a UUID to provide a shared primary key</p></li><li><p><code>updatedAt</code> - timestamp to provide a co-ordinated point when the data was last updated (assuming that a revision history is not required)</p></li><li><p><code>fingerprint</code> - a SHA1 hash of the contents of the data for rapid comparison if <code>updateAt</code> is a few seconds out</p></li><li><p><code>itemURI</code> - a full URI to the item to allow retrieval later</p></li></ul><h2>Step 2 - Local compares the remote transaction log with its own</h2><p>This is the application of the business rules of how to sync. Typically, the <code>itemId</code> will identify the local resource, then compare the fingerprint. If there is a difference then a comparison of <code>updatedAt</code> is made. If these are too close to call then a decision will need to be made to pull based on the other node (perhaps it is more important), or to push to the other node (this node is more important). If the remote resource is not present locally then a push entry is made (this contains the actual data for insert/update). Any local resources not present in the remote transaction log are assumed to be unchanged.</p><p>The pull requests are made against the remote node so that the data exists locally using the <code>itemURI</code>. They are not applied locally until later.</p><h2>Step 3 - Push local sync transaction log to remote</h2><p><strong>Local:</strong> <code>PUT /remotehost/items/transactions</code> with body containing the local sync transaction log.</p><p>The remote node might process this synchronously (if it&#39;s small and quick) or asynchronously (think <em>202 ACCEPTED</em>) if it&#39;s likely to incur a lot of overhead. Assuming a synchronous operation, then the outcome will be either <em>200 OK</em> or <em>409 CONFLICT</em> depending on the success or failure. In the case of a <em>409 CONFLICT</em>, then the process has to be started again since there has been an optimistic locking failure at the remote node (someone changed the data during the sync). The remote updates are processed under their own application transaction.</p><p><strong>Step 4 - Update locally</strong></p><p>The data pulled in Step 2 is applied locally under an application transaction.</p><p>While the above is not perfect (there are several situations where local and remote may get into trouble and having remote pull data from local is probably more efficient than stuffing it into a big PUT) it does demonstrate how REST can be used during a bi-directional synchronization process.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-api-concepts/'>REST API concepts</a></li><li class="list-group-item"><a href='../php-how-to-design-the-application-to-use-rest-for-itself/'>Php &#8211; How to design the application to use REST for itself</a></li><li class="list-group-item"><a href='../rest-how-to-correctly-implement-keyvalue-storage-rest-api/'>Rest &#8211; How to correctly implement key=value storage REST API</a></li><li class="list-group-item"><a href='../rest-consequences-of-not-doing-a-rest-api-the-right-way/'>Rest &#8211; Consequences of not doing a REST API the &#8220;right&#8221; way</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>