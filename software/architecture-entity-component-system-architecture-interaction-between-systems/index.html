<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Architecture &#8211; Entity-Component-System architecture: interaction between systems &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069542 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069542" class="post-1069542 software type-software status-publish hentry category-software tag-architecture tag-concepts tag-entity-component-system tag-message-passing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Architecture &#8211; Entity-Component-System architecture: interaction between systems</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">concepts</span><span class="mr-2 badge badge-warning">entity-component-system</span><span class="mr-2 badge badge-primary">message-passing</span></p><div class="entry-content"><p>I am studying the <a href="http://en.wikipedia.org/wiki/Entity_component_system" rel="noreferrer">Entity-Component-System architecture</a> philosophy. As I have read about it, a typical entity system has:</p><p>1) <strong>Entities</strong> &#8211; which are merely ID tags which have a number of components</p><p>2) <strong>Components</strong> &#8211; which contain <em>data</em> on various aspects of an enity that the component is responsible for</p><p>3) <strong>Systems</strong> &#8211; which update relevant components of every entity. Say, a rendering system updates the rendering component, or simply saying, draws a picture that is stored in the data of that component. A positional and movement system handles position and movement of each entity who has a corresponding component.</p><p>These statements follow from <a href="http://www.google.com/url?q=http%3A%2F%2Ft-machine.org%2Findex.php%2F2007%2F09%2F03%2Fentity-systems-are-the-future-of-mmog-development-part-1%2F&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGIW38J4n8To3M4VBOzLAxWivVdJw" rel="noreferrer">this article</a> which in my opition tries to be the most clear and pure in it&#39;s statements &#8211;</p><p>But the author did not explain how the interaction between systems should be realized. For example, the rendering system must know the data from the positional component of an entity in order to draw it in a correct position. And so on.</p><p>So the question is &#8211; how should I implement the interaction between the various systems?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>So the question is - how should I implement the interaction between
 the various systems?</p></blockquote><p>Ideally they don&#39;t interact, not in any direct sense. The systems in an ECS all have access to the central ECS database where they can fetch entities and components attached to them. They don&#39;t talk to each other directly. They talk to the database and all run independently of each other.</p><p><a href="../../../i.stack.imgur.com/buT3m.png" rel="noreferrer"><img src="../../../i.stack.imgur.com/buT3m.png" alt="enter image description here"/></a></p><p><strong>Dependencies Flow Towards Raw Data, Not Abstractions</strong></p><p>The dependencies in an ECS do not flow towards functions, not even abstract functionality. They all flow towards <em>raw data</em> which might sound like an epic violation of many accepted software engineering principles, and in my opinion it is, but yields something easier to maintain for some cases. Maybe some software engineering principles are wrong or at least not applicable for all scenarios. There are many situations where it&#39;s easier to achieve data stability than interface/design stability. As a basic example, it&#39;s much easier to reason about what data fields a raw matrix component should have once and for all and keep that stable (unchanging) for years to come. It&#39;s much harder to figure out all the functions an abstract <code>IMatrix</code> interface should provide once and for all and keep that perfectly stable (unchanging) for years to come without facing temptations, if not outright needs, to add and remove and change functions.</p><p>So in appropriate cases, when your dependencies flow towards data instead of abstract functionality, your codebase will find fewer and fewer and fewer reasons to have to face central design changes with cascading effects and potentially big parts having to be rewritten. To direct dependencies towards data in that case is directing them towards <em>stability</em>. It&#39;s worth asking yourself as a developer whether the tendency in your system is for developers to add, change, and remove functions or to add, change, and remove data from components. If it&#39;s the former case, you might benefit greatly from an ECS engine.</p><p>If systems start to depend on each other a lot, that&#39;s directing dependencies away from data and towards functionality, and many of the maintenance benefits and the ability to reason about the correctness of your engine and easily keep it stable at the design level will be lost. Of course a pragmatic solution might sometimes call for a system calling a function in another every once in a while, but you should generally seek to keep that to a bare minimum. Instead of talking directly to each other, you can have systems modify and attach components to entities in a way such that other systems can then pick up those changes and react accordingly.</p><p><strong>System Interaction</strong></p><blockquote><p>[...] the rendering system must know the data from the positional
 component of an entity in order to draw it in a correct position. And
 so on.</p></blockquote><p>That it can grab from the ECS database, looping through entities with renderable and position components, just as the physics system before it might loop through entities with position components and modify their position. Generally each system fits into a basic loop model:</p><pre><code>for each entity with the components I&#39;m interested in:
    do something with the components
</code></pre><p>... and you have to start thinking about doing things in passes, often multiple passes even if the intuitive solution is to do everything in one pass. For example, it might come more intuitively to loop through all your game entities and apply physics and respond to input and process AI and render them all in one go. That can minimize the amount of loops you have and also require less state. However, the ECS tackles this typically with multiple simpler passes and sometimes slightly more intermediary state to use from one pass to the next, but as a trade-off, it leads to a much easier system to maintain and one which is easier to change and potentially parallelize* and vectorize.</p><blockquote><ul><li>As yuri mentioned, it could also make things harder to parallelize, at least across systems in an inter-system way, but could make things easier to parallelize in an intra-system way because it&#39;s easier to reason about the correctness of a parallel loop without locking if it&#39;s, say, making less state changes on the way and the code involved in the pass is much simpler. In my blunt opinion, it&#39;s often not worth multithreading the systems themselves so much as the loops they are performing inside for the most performance-critical systems.</li></ul></blockquote><p><strong>Multiple, Simpler Passes</strong></p><p>It&#39;s somewhat similar to GPU programming since GPUs aren&#39;t so good at doing complex things with each iteration, so they often excel instead at doing simple things per iteration that add up to a complex task after repeatedly running through the same data with multiple, simpler passes.</p><p>Unlike GPU programming, you can still potentially do much more complex things in a single pass, but each pass will represent like one logical thought: &#34;<em>for each of these components, apply physics</em>&#34;, not both physics and rendering. The physics system performs its own pass just as the rendering system, living in its own isolated world, performs its own completely separate and detachable rendering pass. Each system lives in its own little world, seeing only the ECS database and being able to grab components and entities inside. They shouldn&#39;t have to bother with what other systems are doing.</p><p>In fact, in a well-designed ECS, you can remove any system from the engine and not have the codebase collapse horribly on itself because systems don&#39;t depend on each other to function. All they care about is the central database and the components (which are raw data) that they are interested in processing. They all live in their own isolated world. As a result you should be able to remove the physics system from your game, at which point motion components will cease to have physics applied, but everything else should keep on working just as before. It&#39;s extremely orthogonal in that respect.</p><p><strong>Event-Driven Programming</strong></p><p>Event-driven programming can be a bit awkward with ECS, but one straightforward way to solve that is to have event queue components. A system can push events to these queue components for another system to pop and process in a deferred fashion without the first system directly calling functions in the second. Again the bulk of your interactions should not be system-&gt;system, but system-&gt;ECS, and system-&gt;component.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-is-the-entity-component-system-architecture-object-oriented-by-definition/'>Object-oriented &#8211; Is the Entity Component System architecture object oriented by definition</a></li><li class="list-group-item"><a href='../object-oriented-entity-component-system-coupling/'>Object-oriented &#8211; Entity Component System Coupling</a></li><li class="list-group-item"><a href='../design-how-to-allow-for-custom-rules-in-a-entity-component-system-designed-game-engine/'>Design &#8211; How to allow for custom Rules in a Entity Component System designed game engine</a></li><li class="list-group-item"><a href='../c-a-more-data-oriented-design-approach-to-entity-component-system/'>C++ &#8211; A more data oriented design approach to Entity Component System</a></li><li class="list-group-item"><a href='../object-oriented-oop-ecs-vs-pure-ecs/'>Object-oriented &#8211; OOP ECS vs Pure ECS</a></li><li class="list-group-item"><a href='../isnt-an-entity-component-system-terrible-for-decoupling-information-hiding/'>Isn&#8217;t an Entity-Component System terrible for decoupling/information hiding</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>