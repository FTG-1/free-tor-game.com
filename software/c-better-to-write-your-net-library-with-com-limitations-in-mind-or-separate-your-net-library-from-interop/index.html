<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Better to write your .NET library with COM limitations in mind, or separate your .NET library from Interop &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1081406 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1081406" class="post-1081406 software type-software status-publish hentry category-software tag-c tag-com tag-interoperability"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Better to write your .NET library with COM limitations in mind, or separate your .NET library from Interop</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">com</span><span class="mr-2 badge badge-warning">interoperability</span></p><div class="entry-content"><p>I came across this interesting article: <a href="http://www.codeproject.com/Articles/769028/How-I-Came-to-Love-COM-Interoperability">How I Came to Love COM Interoperability</a> on CodeProject, which got me thinking&#8230;</p><p>The author argues that they do not want any COM-ities in their .NET library because it takes away from the beauty of their .NET library. Instead, they&#39;d rather write a separate Interop library that exposes their .NET library to COM. This Interop library would handle the fact that COM doesn&#39;t support Constructors with Parameters, Overloaded Methods, Generics, Inheritance, Static Methods, etc.</p><p>And while I think that is very novel, doesn&#39;t it just complect the project?</p><ul><li>Now you need to unit test your .NET library AND an Interop library.</li><li>Now you need to spend time figuring out how to work around your beautiful .NET library and expose it to COM.</li><li>You need to, effectively, double or triple your class count.</li></ul><p>I can certainly understand if you need your library to support both COM and non-COM. However, if you only intend to use COM does this sort of design bring any benefits that I don&#39;t see? Do you only gain the benefits of the C# language?</p><p>Or, does it make versioning your library easier by providing you a wrapper? Does it make your Unit Tests run faster by not requiring the use of COM?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>However, if you only intend to use COM does this sort of design bring any benefits that I don&#39;t see?</p></blockquote><p>This snippet of your question is <em>the</em> most important part of your design decision here, and the answer is (as always) <em>it depends</em>.</p><p>If you only intend to use the library via COM Interop, then you should design the entire system with this in mind. There is no reason to triple the line count. The more LoC in the system, the more defects it will have. You should therefore design your system to only use COM compatible functionality.</p><p><strong><em>However</em></strong>, I can&#39;t think of a good reason to restrict the use of a .Net library to COM. <strong><em>Why wouldn&#39;t</em></strong> you want to be able to use the assembly in other .Net code? It makes little sense to limit yourself this way.</p><p>I have some experience with this, so I will share how I have handled it. Its certainly not ideal. I have made some trade offs. I only use a facade for COM classes (interfaces really) that are incompatible with the newer .Net idioms, otherwise, I directly expose the .Net interface to COM. This basically means that I use a facade for any interface that uses generics. Generics are the only thing I&#39;ve come across that are just simply incompatible. Unfortunately, this means a facade for anything that returns an <code>IEnumerable&lt;T&gt;</code>, which is fairly common.</p><p>However, this isn&#39;t nearly as bad as it seems to be, because your facade class inherits from your .Net class and implements a specific Interop interface. Something like this.</p><pre><code>namespace Company.Product.Feature
{
    public class MyClass : INetInterface 
    {
        // lots of code
    }
}

namespace Company.Product.Interop
{
    public class MyClass : Feature.MyClass, IComInterface
    {
        // over ride only the  incompatible properties/methods
    }
}
</code></pre><p>This keeps your duplicate code to an absolute minimum and protects your COM interface from &#34;unintentional&#34; changes. As your core class/interface change, your adapter class has to over ride more methods (or break the interface and bump the major version number). On the other hand, not all of your Interop code is stored in the <code>Interop</code> namespace, which can lead to a confusing file organization. Like I said, it&#39;s a trade off.</p><p>For a full blown example of this, you can browse through the <a href="https://github.com/retailcoder/Rubberduck/tree/6028d73f76a47653fb15df87ff59d03fdb7668f4/RetailCoder.VBE/SourceControl" rel="noreferrer">SourceControl</a> and <a href="https://github.com/retailcoder/Rubberduck/tree/6028d73f76a47653fb15df87ff59d03fdb7668f4/RetailCoder.VBE/Interop" rel="noreferrer">Interop</a> folders of my repo. <code>ISourceControlProvider</code> and <code>GitProvider</code> will be of particular interest.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/c-com-interop-support-which-is-better-c-or-vb/'>C# &#8211; COM INTEROP Support &#8211; which is better? C# or VB</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/best-way-to-handle-language-interoperability/'>Best way to handle language interoperability</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-how-does-breaking-up-a-big-method-into-smaller-methods-improve-unit-testability-when-the-methods-are-all-private/'>C# &#8211; How does breaking up a big method into smaller methods improve unit testability when the methods are all private</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-dependency-injection-for-a-library-with-internal-dependencies/'>C# &#8211; Dependency injection for a library with internal dependencies</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-should-net-core-class-libraries-register-their-own-implementations/'>C# &#8211; Should .NET Core class libraries register their own implementations</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>