<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How to decouple configuration data from the program that uses it &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079831 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079831" class="post-1079831 software type-software status-publish hentry category-software tag-design-patterns"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How to decouple configuration data from the program that uses it</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span></p><div class="entry-content"><p>I am a beginning programmer who has written a spider application in PHP. Currently there are three parts:</p><pre><code>1) The Spider (spider.php)
2) The Harvester (harvest.php)
3) The Configuration file (for example, craigslist_config.php)
</code></pre><p>I use the spider to search the web for items I want to buy. An item can be found on any website, like ebay, craigslist, etc. The Harvester provides three functions to spider so it can act on the data it finds &#8211; <code>get_title_from($markup)</code>, <code>get_description_from($markup)</code>, and <code>get_price_from($markup)</code>.</p><p>Each web site that I want to spider has, of course, different markup surrounding the data that I want to extract. My config file contains a configuration array that holds the regex patterns for each of the items I want to find. The structure of the file is always the same, the only thing that changes is the regex patterns. So, I would have craigslist_config.php, ebay_config.php, etc.</p><pre><code>$conf = array(
    &#39;title&#39; =&gt; &#39; specific_site title pattern&#39;,
    &#39;description =&gt; &#39;specific_site description pattern&#39;,
    &#39;price&#39; =&gt; &#39;specific_site price pattern&#39;
);
</code></pre><p>My problem is when I want to add a new website.  I have to edit the Spider.php file and add to an ever-growing &#34;if, elseif&#34; statement that detects what site is currently being read, and load the correct config file, which in turn feeds the correct REGEX data to the harvester functions.</p><p>How can I decouple my configuration from my Spider.php file? What I have designed does not feel like a flexible, scalable solution, and I don&#39;t want to have to mess with spider.php everytime I want to add or take away a new site.</p><p>Ultimately, what I am trying to achieve is the ability to simply drop in a new configuration file into my config directory and move the &#39;if, elseif&#39; logic somewhere else so that the spider and harverster functions never have to worry about what files are or are not included in the config directory. It&#39;s the &#34;somewhere else&#34; I am having trouble figuring out. Actually, it would be even better if I could get rid of the &#39;if else&#39; logic all together so that everything just &#39;works.&#39;</p><p>My current design is not an OOP approach, however I am not opposed to one. I am currently reading, &#34;PHP Objects, Patterns, and Practice&#34; to get up to speed on OOP and related design patterns, so feel free to suggest in that direction should you feel it a solution.</p><p><strong>EDIT:</strong> Based on Doc Brown&#39;s direction, I have come up with the following. I have individual configuration files with content like so:</p><pre><code>$conf[&#39;specificwebsite1.com&#39;] = array(
    &#39;title&#39; =&gt; &#39;title pattern&#39;,
    &#39;price&#39; =&gt; &#39;price pattern&#39;,

    etc...
);  
</code></pre><p>In my Harvester file I have a new function called <code>load_config($url, $config)</code>. As suggested, I loops through all the configuration files and load them into one large $conf array. Then, the <code>load_config</code> function checks if the key is a sub string of the url I&#39;m currently reading. If so, then it loads all the necessary values to continue parsing.  This is the function:</p><pre><code>function load_config($url, $config){
  foreach($config as $key =&gt; $value){
    if(stristr($url, $key) !== FALSE){
      ## see if a key in our config file
      ## is a substring of our url. 
      $conf = $config[$key];
      break;
    } else {

      $conf = FALSE;
    }
  }

  return $conf;
}
</code></pre><p>This is working really well, so I&#39;ll accept that as the answer. But please feel free to make suggestions for improvements in the comments or as another answer.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Ultimately, what I am trying to achieve is the ability to simply drop in a new configuration file into my config directory</p></blockquote><p>First, add the related web address to your config file:</p><pre><code>$conf = array(
    &#39;url&#39; =&gt; &#39; specific_site url or url pattern&#39;,
    &#39;title&#39; =&gt; &#39; specific_site title pattern&#39;,
    &#39;description =&gt; &#39;specific_site description pattern&#39;,
    &#39;price&#39; =&gt; &#39;specific_site price pattern&#39;
);
</code></pre><p>Now, change the code in your Spider.php that it checks all .php files in that config directory,  loads them all dynamically one-by-one, and store the &#34;$conf&#34; content in a dictionary where the url is used as a key. Then it should be easy to replace your &#34;if-else&#34; list by a simple loop over that dictionary.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-design-for-creating-a-menu-based-on-user-type/'>Php &#8211; Design for creating a menu based on user type</a></li><li class="list-group-item"><a href='../c-which-pattern-is-most-intuitive-for-a-calculator-app/'>C# &#8211; which pattern is most intuitive for a calculator app</a></li><li class="list-group-item"><a href='../c-how-to-design-configurable-validations-to-import-excel-files/'>C# &#8211; How to design configurable validations to import Excel files</a></li><li class="list-group-item"><a href='../java-implementing-strategy-pattern-via-configuration/'>Java &#8211; Implementing strategy pattern via configuration</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>