<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Implement Haskell typeclass with C# interface &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076173 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076173" class="post-1076173 software type-software status-publish hentry category-software tag-c tag-haskell"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Implement Haskell typeclass with C# interface</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">haskell</span></p><div class="entry-content"><p>I&#39;m trying to compare Haskell&#39;s type classes and C#&#39;s interfaces. Suppose there is a <a href="https://hackage.haskell.org/package/base-4.2.0.0/docs/Data-Functor.html" rel="noreferrer"><code>Functor</code></a>.</p><p>Haskell:</p><pre><code>class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre><p>How to implement this type class as interface in C#?</p><p>What I have tried:</p><pre><code>interface Functor&lt;A, B&gt;
{
    F&lt;B&gt; fmap(Func&lt;A, B&gt; f, F&lt;A&gt; x);
}
</code></pre><p>This is invalid implementation and I&#39;m actually stucked with generic <code>F</code> type that should be returned by <code>fmap</code>. How it should be defined and where?</p><p>Is it impossible to implement <code>Functor</code> in C# and why? Or maybe there is another approach?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>C#&#39;s type system lacks a couple features necessary to properly implement type classes as an interface.</p><p>Let&#39;s start with your example, but the key is showing a fuller account of what a typeclass is and does, and then trying to map those to C# bits.</p><pre><code>class Functor f where
  fmap :: (a -&gt; b) -&gt; f a -&gt; f b
</code></pre><p>This is the type class definition, or similar to the interface. Now let&#39;s look at a definition of a type and it&#39;s implementation of that type class.</p><pre><code>data Awesome a = Awesome a a

instance Functor Awesome where
  fmap f (Awesome a1 a2) = Awesome (f a1) (f a2)
</code></pre><p>Now we can see very obviously one distinct fact of type classes that you <em>cannot</em> have with interfaces. The implementation of the type class is not a part of the definition of the type. In C#, to implement an interface, you must implement it as a part of the definition of the type that implements it. This means you may not implement an interface for a type which you do not implement yourself, however in Haskell you may implement a type class for any type you have access to.</p><p>That&#39;s probably the largest immediately, but there&#39;s another fairly significant difference that makes the C# equivalent really not work nearly as well, and you are touching on it in your question. It&#39;s about Polymorphism. Also there&#39;s some relatively generic things Haskell allows you to do with type classes which outright do not translate especially when you start looking at the amount of genericism in existential types or other GHC extensions like Generic ADTs.</p><p>You see, with Haskell you can define the functors</p><pre><code>data List a = List a (List a) | Terminal
data Tree a = Tree val (Tree a) (Tree a) | Terminal

instance Functor List where
  fmap :: (a -&gt; b) -&gt; List a -&gt; List b
  fmap f (List a Terminal) = List (f a) Terminal
  fmap f (List a rest) = List (f a) (fmap f rest)

instance Functor Tree where
  fmap :: (a -&gt; b) -&gt; Tree a -&gt; Tree b
  fmap f (Tree val Terminal Terminal) = Tree (f val) Terminal Terminal
  fmap f (Tree val Terminal right) = Tree (f val) Terminal (fmap f right)
  fmap f (Tree val left Terminal) = Tree (f val) (fmap f left) Terminal
  fmap f (Tree val left right) = Tree (f val) (fmap f left) (fmap f right)
</code></pre><p>Then in consumption you can have a function:</p><pre><code>mapsSomething :: Functor f, Show a =&gt; f a -&gt; f String
mapsSomething rar = fmap show rar
</code></pre><p>Herein lies the problem. In C# how do you write this function?</p><pre><code>public Tree&lt;a&gt; : Functor&lt;a&gt;
{
    public a Val { get; set; }
    public Tree&lt;a&gt; Left { get; set; }
    public Tree&lt;a&gt; Right { get; set; }

    public Functor&lt;b&gt; fmap&lt;b&gt;(Func&lt;a,b&gt; f)
    {
        return new Tree&lt;b&gt;
        {
            Val = f(val),
            Left = Left.fmap(f);
            Right = Right.fmap(f);
        };
    }
}
</code></pre><pre><code>public string Show&lt;a&gt;(Showwable&lt;a&gt; ror)
{
    return ror.Show();
}

public Functor&lt;String&gt; mapsSomething&lt;a,b&gt;(Functor&lt;a&gt; rar) where a : Showwable&lt;b&gt;
{
    return rar.fmap(Show&lt;b&gt;);
}
</code></pre><p>So there&#39;s a couple things wrong with the C# version, for one thing I&#39;m not even certain it will allow you to use the <code>&lt;b&gt;</code> qualifier like I did there, but without it I <em>am</em> certain it wouldn&#39;t dispatch <code>Show&lt;&gt;</code> appropriately (feel free to try and compile to find out; I didn&#39;t).</p><p>The bigger problem here however is that unlike above in Haskell where we had our <code>Terminal</code>s defined as part of the type and then usable in place of the type, due to C# lacking appropriate parametric polymorphism (which becomes super obvious as soon as you try to interop F# with C#) you can&#39;t clearly or cleanly distinguish whether Right or Left are <code>Terminal</code>s. Best you can do is use <code>null</code>, but what if you&#39;re trying to make a value type a <code>Functor</code> or in the case of <code>Either</code> where you&#39;re distinguishing two types that both carry a value? Now you have to use one type and have two different values to check and switch between to model your discrimination?</p><p>The lack of proper sum types, union types, ADTs, whatever you want to call them really makes a lot of what typeclasses give you fall away because at the end of the day they let you treat multiple types (constructors) as a single type, and .NET&#39;s underlying type system simply has no such concept.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-how-does-go-improve-productivity-with-implicit-interfaces-and-how-does-that-compare-with-cs-notion-of-extension-methods/'>C# &#8211; How does Go improve productivity with &#8220;implicit&#8221; interfaces, and how does that compare with C#&#8217;s notion of Extension Methods</a></li><li class="list-group-item"><a href='../are-types-erased-in-haskell/'>Are types erased in Haskell</a></li><li class="list-group-item"><a href='../java-what-exactly-makes-the-haskell-type-system-so-revered-vs-say-java/'>Java &#8211; What exactly makes the Haskell type system so revered (vs say, Java)</a></li><li class="list-group-item"><a href='../python-difference-between-python-classes-and-haskell-typeclasses/'>Python &#8211; Difference between Python classes and Haskell typeclasses</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>