<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; How should I unit test a bitmap modifying method &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070525 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070525" class="post-1070525 software type-software status-publish hentry category-software tag-c tag-resources tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; How should I unit test a bitmap modifying method</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">resources</span><span class="mr-2 badge badge-warning">unit testing</span></p><div class="entry-content"><p>My <code>Sprite</code> class has a method:</p><p><code>private void updateWithBitmap(Bitmap b, int x, int y)</code></p><p>This will &#39;lay on top&#39; the bitmap that&#39;s passed in, the top left corner of the passed in bitmap being at the x,y position of the parent bitmap.</p><p>Now I want write unit tests to check that this method is working correctly.</p><p>For example, we&#39;ll need to check that an exception is thrown when the passed in bitmap is larger, or is out of bounds of the parent bitmap.</p><pre><code>    [TestMethod]
    [ExpectedException(typeof(System.ArgumentOutOfRangeException))]
    public void TestUpdateWithBitMap_SmallerParent_ThrowsOutOfRangeException()
    {
       Sprite parent =  new Sprite(new Bitmap(10,10));
       Bitmap child = new Bitmap(20, 20); 
       parent.updateWithBitmap(child,0,0)


    }

    [TestMethod]
    [ExpectedException(typeof(System.ArgumentOutOfRangeException))]
    public void TestUpdateWithBitMap_PassedBitMapOutOfBounds_ThrowsOutOfRangeException()
    {
        Sprite parent =  new Sprite(new Bitmap(10,10));
        Bitmap child = new Bitmap(3, 3); 
        parent.updateWithBitmap(child, 9,9)


    }
</code></pre><p>Good so far.</p><p>But also we want to test that the method genuinely is updating correctly.</p><p><img src="../../../i.stack.imgur.com/51ZA6.png" alt="enter image description here"/></p><p>For example, if the left most image is our parent bitmap, and the middle is the child bitmap, and we call our method with:</p><p><code>parent.updateWithBitmap(child, 3,3);</code></p><p>we get the rightmost bitmap as a result.</p><p>The question is:</p><p>Is it appropriate to store these bitmaps as resources, and then check the results are equal?</p><p>eg.</p><pre><code>    [TestMethod]        
    public void TestUpdateWithBitMap_UpdatesCorrectly()
    {
        Sprite parent =  new Sprite(Properties.Resources.TestBitmapParent1);
        Bitmap child = Properties.Resources.TestBitmapChild1; 
        parent.updateWithBitmap(child, 3,3)
        #something like Assert.Equal(parent.getBitmap(), Properties.Resources.TestBitmapResult1); 



    }
</code></pre></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Is it appropriate to store these bitmaps as resources</p></blockquote><p>Well, whatever will work for you is appropriate, isn&#39;t it? Your unit tests should run quick, be functional, should be easy to maintain and to extend, and if they fail, they should make root cause analysis easier for you.</p><ul><li><p>&#34;quick&#34; can be fulfilled by using very small bitmaps</p></li><li><p>&#34;functional&#34;: to include significant cases, the bitmaps must be actually not too small. For your case, I guess bitmaps with a side length of minimum of 3 or 4 will probably make sense.</p></li><li><p>easy to maintain and to extend: well, as long as your tool set allows easy bitmap manipulation, storing of bitmaps in a resource <em>and retrieving</em> it again, that should not be much of an issue</p></li><li><p>&#34;make root cause analysis easy&#34;: for this, you may have to make some provisions. If you just &#34;check if the results of a bitmap comparison are equal&#34;, you might not easily see how your &#34;testBitmap&#34; looks like and why it does not match the expected results. But it should be pretty simple to add some code which in case the equality test fails, writes your test bitmap to disk so you can check it easily with an imager viewer (either just visually, or by creating something like a &#34;difference image&#34; between the expected bitmap and your test bitmap)</p></li></ul><p>Of course, the alternative would be to create some per-pixel tests with hard-encoded colors and coordinates, but though that will surely work, IMHO that&#39;s not easier to maintain and can become very tedious.</p><p>Some related posts on other SE sites:</p><p><a href="https://stackoverflow.com/questions/16217982/comparing-images-as-byte-arrays-for-unit-tests">https://stackoverflow.com/questions/16217982/comparing-images-as-byte-arrays-for-unit-tests</a></p><p><a href="https://sqa.stackexchange.com/questions/3136/how-to-test-the-graphical-contents-of-a-bitmap-or-a-pdf-file">https://sqa.stackexchange.com/questions/3136/how-to-test-the-graphical-contents-of-a-bitmap-or-a-pdf-file</a></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-should-unit-test-expected-results-be-hardcoded/'>C# &#8211; Should unit test expected results be hardcoded</a></li><li class="list-group-item"><a href='../unit-testing-how-unit-test-service-method-that-use-repository-method/'>Unit-testing &#8211; How unit test service method that use repository method</a></li><li class="list-group-item"><a href='../c-should-i-document-a-simple-unit-test-project/'>C# &#8211; Should I document a simple Unit Test project</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>