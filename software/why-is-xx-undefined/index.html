<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Why is x=x++ undefined &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068364 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068364" class="post-1068364 software type-software status-publish hentry category-software tag-c tag-language-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Why is x=x++ undefined</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">language-design</span></p><div class="entry-content"><p>It&#39;s undefined because the it modifies <code>x</code> twice between sequence points. The standard says it&#39;s undefined, therefore it&#39;s undefined.<br /> That much I know.</p><h3>But why?</h3><p>My understanding is that forbidding this allows compilers to optimize better. This could have made sense when C was invented, but now seems like a weak argument.<br /> If we were to reinvent C today, would we do it this way, or can it be done better?<br /> Or maybe there&#39;s a deeper problem, that makes it hard to define consistent rules for such expressions, so it&#39;s best to forbid them?</p><p>So suppose we were to reinvent C today. I&#39;d like to suggest simple rules for expressions such as <code>x=x++</code>, which seem to me to work better than the existing rules.<br /> I&#39;d like to get your opinion on the suggested rules compared to the existing ones, or other suggestions.</p><h3>Suggested Rules:</h3><ol><li>Between sequence points, order of evaluation is unspecified.</li><li>Side effects take place immediately.</li></ol><p>There&#39;s no undefined behavior involved. Expressions evaluate to this value or that, but surely won&#39;t format your hard disk (strangely, I&#39;ve never seen an implementation where <code>x=x++</code> formats the hard disk).</p><h3>Example Expressions</h3><ol><li><p><code>x=x++</code> &#8211; Well defined, doesn&#39;t change <code>x</code>.<br /> First, <code>x</code> is incremented (immediately when <code>x++</code> is evaluated), then it&#39;s old value is stored in <code>x</code>.</p></li><li><p><code>x++ + ++x</code> &#8211; Increments <code>x</code> twice, evaluates to <code>2*x+2</code>.<br /> Though either side may be evaluated first, the result is either <code>x + (x+2)</code> (left side first) or <code>(x+1) + (x+1)</code> (right side first).</p></li><li><p><code>x = x + (x=3)</code> &#8211; Unspecified, <code>x</code> set to either <code>x+3</code> or <code>6</code>.<br /> If the right side is evaluated first, it&#39;s <code>x+3</code>. It&#39;s also possible that <code>x=3</code> is evaluated first, so it&#39;s <code>3+3</code>. In either case, the <code>x=3</code> assignment happens immediately when <code>x=3</code> is evaluated, so the value stored is overwritten by the other assignment.</p></li><li><p><code>x+=(x=3)</code> &#8211; Well defined, sets <code>x</code> to 6.<br /> You could argue that this is just shorthand for the expression above.<br /> But I&#39;d say that <code>+=</code> must be executed after <code>x=3</code>, and not in two parts (read <code>x</code>, evaluate <code>x=3</code>, add and store new value).</p></li></ol><h3>What&#39;s the Advantage?</h3><p>Some comments raised this good point.<br /> I certainly don&#39;t think expressions such as <code>x=x++</code> should be used in any normal code.<br /> Actually, I&#39;m much more strict than that &#8211; I think the only good usage for <code>x++</code> in as <code>x++;</code> alone.</p><p>However, I think the language rules must be as simple as possible. Otherwise programmers just don&#39;t understand them. the rule forbidding changing a variable twice between sequence points is certainly a rule most programmers don&#39;t understand.</p><p>A very basic rule is this:<br /> If A is valid, and B is valid, and they&#39;re combined in a valid way, the result is valid.<br /> <code>x</code> is a valid L-value, <code>x++</code> is a valid expression, and <code>=</code> is a valid way to combine an L-value and an expression, so how come <code>x=x++</code> isn&#39;t legal?<br /> The C standard makes an exception here, and this exception complicates the rules. You can search <a href="http://www.stackoverflow.com/">stackoverflow.com</a> and see how much this exception confuses people.<br /> So I say &#8211; get rid of this confusion.</p><p>=== Summary of Answers ===</p><ol><li><p>Why do that?<br /> I tried to explain in the section above &#8211; I want C rules to be simple.</p></li><li><p>Potential for optimization:<br /> This does take some freedom from the compiler, but I didn&#39;t see anything that convinced me that it might be significant.<br /> Most optimizations can still be done. For example, <code>a=3;b=5;</code> can be reordered, even though the standard specifies the order. Expressions such as <code>a=b[i++]</code> can still be optimized similarly.</p></li><li><p>You can&#39;t change the existing standard.<br /> I admit, I can&#39;t. I never thought I can actually go ahead and change standards and compilers. I only wanted to think if things could have been done differently.</p></li></ol></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Maybe you should first answer the question why it should be defined? Is there any advantage in programming style, readability, maintainability or performance by allowing such expressions with additional side effects? Is</p><pre><code>y = x++ + ++x;
</code></pre><p>more readable than</p><pre><code>y = 2*x + 2;
x += 2;
</code></pre><p>Given that such a change is extremely fundamental and breaking to the existing code base.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-philosophy-behind-undefined-behavior/'>C++ &#8211; Philosophy behind Undefined Behavior</a></li><li class="list-group-item"><a href='../why-is-0-false/'>Why is 0 false</a></li><li class="list-group-item"><a href='../clarification-about-grammars-lexers-and-parsers/'>Clarification about Grammars , Lexers and Parsers</a></li><li class="list-group-item"><a href='../python-how-to-make-decorators-as-powerful-as-macros/'>Python &#8211; How to make decorators as powerful as macros</a></li><li class="list-group-item"><a href='../when-did-undefined-behavior-in-c-jump-the-causality-barrier/'>When did Undefined Behavior in C jump the causality barrier</a></li><li class="list-group-item"><a href='../c-doesnt-always-initialize-variables-lead-to-important-bugs-being-hidden/'>C++ &#8211; Doesn&#8217;t &#8220;always initialize variables&#8221; lead to important bugs being hidden</a></li><li class="list-group-item"><a href='../sql-empty-value-list-for-the-in-predicate-literals-not-subqueries/'>SQL: Empty value list for the IN predicate (literals, not subqueries)</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>