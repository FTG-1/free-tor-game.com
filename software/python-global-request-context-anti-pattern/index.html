<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; Global request context &#8211; anti-pattern &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070172 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070172" class="post-1070172 software type-software status-publish hentry category-software tag-anti-patterns tag-design-patterns tag-flask tag-python"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; Global request context &#8211; anti-pattern</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">anti-patterns</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">flask</span><span class="mr-2 badge badge-primary">python</span></p><div class="entry-content"><p>I was talking today to a colleague of mine about Python web frameworks and our impressions about them. I told him I think Flask having a global request smells badly and is an anti-pattern.</p><p>The <a href="http://flask.pocoo.org/docs/appcontext/">docs</a> say about request context:</p><blockquote><p>In contrast, during request handling, a couple of other rules exist:</p><ul><li>while a request is active, the context local objects (flask.request and others) point to the current request.</li><li>any code can get hold of these objects at any time.</li></ul></blockquote><p>I think I understand the idea behind this design decision &#8212; to make the application simpler. It&#39;s just a compromise, like in the case of <a href="http://flask.pocoo.org/docs/design/#thread-locals">Thread Locals</a>:</p><blockquote><p>Yes it is usually not such a bright idea to use thread locals. They<br /> cause troubles for servers that are not based on the concept of<br /> threads and make large applications harder to maintain. However Flask<br /> is just not designed for large applications or asynchronous servers.<br /> Flask wants to make it quick and easy to write a traditional web<br /> application.</p></blockquote><p>Is patching a global object with the current request information an anti-pattern?</p><p>I believe it is, because it is in the view of static code analyzer a global state, though it&#39;s not. And I as a programmer will not understand how it works without reading the <a href="http://flask.pocoo.org/docs/reqcontext/">docs</a> carefully. And this has <a href="http://flask.pocoo.org/docs/testing/#other-testing-tricks">consequences on tests</a>.</p><p>Isn&#39;t it a good practice to pass the request as an argument to views? I think it&#39;s more readable, explicit and easier to debug. And avoids global state.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Many web frameworks have this same structure: a global request. In a sense, it&#39;s the right thing to do because hey, there really IS only one request at a time.</p><p>So is there any point in passing the request around as a parameter? No. The request is the request, and parameters are for passing in different things at different times.</p><p>The <strong>real</strong> problem comes as you start to consider lower levels of a larger application. With a global request there is the temptation to write code all over the place that accesses the request globally. That is a <strong>very bad thing</strong>. It produces coupling between different parts of the code, makes it hard to change things and makes it hard to test things.</p><p>So my answer is: keep the global request and live with it. However, wherever an individual module or function does not need the whole request, pass only the data it needs in as a parameter. Pass just the referrer, or the url, or the command tail and whatever bits you need into your functions. This will help keep the code modular, reduce coupling and improve testability.</p><p>For tiny programs it scarcely matters, but for bigger ones this can be a real lifesaver.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-term-for-the-error-handling-anti-pattern-of-discarding-all-available-info-and-just-returning-failure/'>C++ &#8211;  term for the error-handling anti-pattern of discarding all available info and just returning failure</a></li><li class="list-group-item"><a href='../concurrency-pattern-of-logger-in-multithreaded-application/'>Concurrency pattern of logger in multithreaded application</a></li><li class="list-group-item"><a href='../passing-an-object-into-a-method-which-changes-the-object-is-it-a-common-anti-pattern/'>Passing an object into a method which changes the object, is it a common (anti-) pattern</a></li><li class="list-group-item"><a href='../patterns-for-passing-context-through-a-method-chain/'>Patterns for passing context through a method chain</a></li><li class="list-group-item"><a href='../python-are-we-overlooking-bad-effects-of-global-state-in-this-design/'>Python &#8211; Are we overlooking bad effects of global state in this design</a></li><li class="list-group-item"><a href='../do-i-actually-need-a-message-broker-or-are-websockets-enough/'>Do I actually need a message broker or are websockets enough</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>