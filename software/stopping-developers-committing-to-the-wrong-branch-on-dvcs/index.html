<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Stopping developers committing to the wrong branch on DVCS &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1083416 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1083416" class="post-1083416 software type-software status-publish hentry category-software tag-dvcs tag-training tag-version-control"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Stopping developers committing to the wrong branch on DVCS</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">dvcs</span><span class="mr-2 badge badge-info">training</span><span class="mr-2 badge badge-warning">version control</span></p><div class="entry-content"><h2>The problem</h2><p>I am on a software project which has about 10 developers, we share source code via Mercurial. We have a development and production branch per release. Repeatedly during the course of the project we have had source code from one branch i.e. v1 getting into patch and maintenance branches for earlier releases of software i.e. v2.</p><p>This results in either time spent backing out the wrong commit, or wrong (possibly non-QAd) code reaching and getting deployed in the wrong branch if we don&#39;t notice that the code has gone into the wrong branch.</p><h3>Our branch and merge design/method</h3><pre><code>               v1-test   v1-patch1   v1-patch2
               ^---------^-----------^                v1-prod
              /         / \           \
-----------------------/   \           \              v1-dev
              \             \           \
               --------------------------\            v2-dev
                             \       \    \ 
                              ^-------^-------------  v2-prod
                              v2-test v2-patch1      
</code></pre><p>Hence we will work on a release development branch, until it&#39;s deemed <em>ready</em>, branch it off for a single testing/UAT/Production branch, where all releases and maintenance is done. Tags are used to build releases of this branch. While v1 is being tested, a branch will have been made for v2 and developers will start working on new features.</p><p>What tends to happen is that a developer commits work due for v2-dev branch into v1-dev or v1-prod, or worse, they merge v2-dev into v1-prod (or similar such mistakes).</p><p>We tell most developers not to access the <strong>-prod</strong> branches, however code still sneaks in. A group of more senior developers `look after&#39; the -prod branch.</p><p>It should be noted that while v2 has just started development, there may still be some quite hefty patches going into v1 to fix issues. I.e. v1 may not just be getting the odd small patch.</p><h2>What we&#39;ve tried so far</h2><ul><li>Having a separate -prod branch, with gatekeepers. A -prod branch should raise warnings through its name and most developers don&#39;t need to ever be in that branch. This has not really reduced the problem.</li><li>Raised awareness of this problem amongst the developers, to try and make them more vigilant. Again this has not been very successful.</li></ul><h2>Possible reasons I see for developers committing to the wrong branch</h2><ul><li>Too complex a branch design</li><li>Having active development in multiple branches in parallel. (The project does exhibit symptoms of using the <a href="http://en.wikipedia.org/wiki/Avalanche_model" rel="nofollow noreferrer">avalanche-model</a>.)</li><li>Developers don&#39;t understand the DVCS well enough</li></ul><h3>Questions I&#39;ve read which were somewhat relevant</h3><p>I&#39;ve read <a href="https://softwareengineering.stackexchange.com/questions/114352/how-do-you-avoid-working-on-the-wrong-branch">this question</a> on not committing to the wrong branch and I feel that the answers regarding visual cues may be helpful. However I am not entirely convinced that the problems we&#39;re experiencing are not symptoms of a more fundamental problem.</p><p>With the visual clues, we can incorporate them into the command line easily, however about half the team use eclipse which I&#39;m unsure how to incorporate visual cues.</p><h2>Question</h2><p>What methods, in the form of software, project management or governance can we use to reduce (ideally stop) commits to the wrong branch taking up our time or dirtying our deployed code?</p><p>Specific comment on the reasons I believe may be contributing as outlined above would be appreciated, but this shouldn&#39;t limit your reply.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The problem is you are changing what the <em>meaning</em> of a branch is part way through the process.</p><p>Initially, the <code>v1 dev</code> branch is for development.  All new features go there.  At some point in the future, it becomes a maintenance branch for the <code>v1 release</code> branch. This is the crux of the problem.</p><p>Its not that the developers are sloppy, its that the permissions and roles of the branch are sloppy and subject to change.</p><p>What you need to do is establish what role each branch as, and maintain that role.  If the role changes, branch.</p><p>For example:</p><pre><code> developer
  commits    |   |  |   |    |     |   |     |
             v   v  v   v    v     v   v     v
 dev  +--+---------------------+-------------------&gt;
         |           ^    ^    |           ^    ^
         |           |    |    |           |    |
 v1      +----+------+----+    |           |    |
           prod  patches       |           |    |
                               |           |    |
                               |           |    |
 v2                            +-----+-----+----+
                                  prod  patches
</code></pre><p>In this model, developers always commit to dev.  If you are building a patch, you check the patch into that release&#39;s branch (or better yet, branch the release branch for a patch and then merge it back into the release branch).</p><p>One article that you should read (and its probably an understatement for &#39;should&#39;) is <a href="http://vance.com/steve/perforce/Branching_Strategies.html" rel="nofollow noreferrer">Advanced SCM Branching Strategies</a> by Stephen Vance.</p><blockquote><p><sup>In this paper, I first define branching in a general sense. I then discuss various strategies for branching, starting with the obvious and moving up to several that are more appropriate for larger development efforts. Along the way, I discuss the pros and cons of each strategy, using them to motivate the changes that compose the more complex strategies...</sup></p></blockquote><p>In this article, he identifies five roles that branches may have.  Sometimes a branch may fill two roles and roles do not necessarily need a new branch <strong>as long as the role policies do not change mid branch</strong> (you will occasionally see mention of &#34;branch on incompatible policy&#34;).</p><p>These roles are:</p><ol><li>Mainline.  This is where branches are made from.  Always branching from the mainline makes merges easier since the two branches will have a common ancestor that isn&#39;t branch upon branch upon branches.</li><li>Development.  This is where developers check in code.  One may have multiple development branches to isolate high risk changes from the ones that are routine and mundane.</li><li>Maintenance. Bug fixes on an existing production environment.</li><li>Accumulation.  When merging two branches, one may not want to risk destabilizing the mainline.  So branch the mainline, merge the branches into the accumulator and merge back to the mainline once things are settled.</li><li>Packaging.  Packaging a release happens in the packaging branches.  This often becomes the release and serves to isolate the release effort from development.  See <a href="https://softwareengineering.stackexchange.com/questions/191191/how-to-deal-with-undesired-commits-that-break-long-running-release-builds">How to deal with undesired commits that break long-running release builds?</a> for an example of where the packaging conflicts with development.</li></ol><p>In your example, you&#39;ve got a cascading mainline (this is a problem - it makes merges more difficult - what happens if you want to merge a fix for v1 into v2 and v3?), a dev branch that becomes a maintenance branch (change of policy, this is a problem).</p><p>Ok, you say, thats great, but this was written for perforce which is a centralized VCS - I&#39;m using DVCS.</p><p>Lets look at the <a href="http://nvie.com/posts/a-successful-git-branching-model/" rel="nofollow noreferrer">git-flow model</a> and see how it applies.</p><p><img src="../../../i.stack.imgur.com/lb4CT.png" alt=""/></p><p>The master branch (blue) is the release branch - for tagging.  It is not the mainline.  The mainline is actually the develop branch (yellow).  The release branches (green) are the packaging role.  Low risk development happens in the mainline, high risk development happens in the feature branches (pink).  In this model, accumulation is done in the develop branch.  Maintenance are considered &#39;hot fixes&#39; which are red.</p><p>While the role policies aren&#39;t exact match (each product has its own slightly different lifecycle), they are a match.</p><p>Doing this should simplify your branching policy and make it easier for everyone involved.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../coming-up-with-a-version-control-strategy-for-svn/'>Coming up with a version control strategy for SVN</a></li><li class="list-group-item"><a href='../maintaining-svn-history-for-a-file-when-merge-is-done-from-the-dev-branch-to-trunk/'>Maintaining SVN history for a file when merge is done from the dev branch to trunk</a></li><li class="list-group-item"><a href='../git-is-it-ever-ok-to-commit-non-working-code/'>Git &#8211; Is it ever OK to commit non-working code</a></li><li class="list-group-item"><a href='../source-control-branch-design-for-deployed-environments/'>Source control branch design for deployed environments</a></li><li class="list-group-item"><a href='../git-should-versions-be-bumped-in-dev-branches-or-master-branch/'>Git &#8211; Should versions be bumped in dev branches or master branch</a></li><li class="list-group-item"><a href='../what-are-the-risks-of-having-a-release-branch/'>What are the risks of having a release branch</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>