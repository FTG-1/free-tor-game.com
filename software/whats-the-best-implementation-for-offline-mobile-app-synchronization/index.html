<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>What&#8217;s the best implementation for offline mobile app synchronization &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069324 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069324" class="post-1069324 software type-software status-publish hentry category-software tag-android-development tag-azure tag-mobile tag-synchronization"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">What&#8217;s the best implementation for offline mobile app synchronization</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">android-development</span><span class="mr-2 badge badge-info">azure</span><span class="mr-2 badge badge-warning">mobile</span><span class="mr-2 badge badge-primary">synchronization</span></p><div class="entry-content"><p>We have an Android app written as a Cordova AngularJS SPA which has now grown so that we need to add some work to it meaning we have to improve the synchronization part of the app.  The app is mainly used offline.  I can&#39;t give details of the business use but data structure and constraints can be illustrated with an over simplified car mechanic&#39;s business!</p><p>Imagine the data entities are similar to this :<br /> <a href="../../../i.stack.imgur.com/n1rwH.png" rel="nofollow noreferrer"><img src="../../../i.stack.imgur.com/n1rwH.png" alt="entity diagram"/></a></p><p>Claims are at Company, Garages and Car level, so in other words Jack may be able to see all garages and all cars in company A, Jill may be able to see all garages in Company A and only some cars in each garage, Jo may be able to see only one garage and only some of the cars in that garage. &#8211; you get the idea.</p><ul><li>The app downloads information that the mechanic can see about their jobs.  They are able to see all jobs assigned to them and any other jobs that the claims they have allow them to see, so that they can pick those jobs up.  A job is a grouping of Checkpoints that need to be completed on a car.</li><li>The garage workshop has no data connection, the mechanic can only sync when they go back to the office.  This may need to be user initiated, not entirely sure yet though.</li><li>More than one mechanic can work on a job, if the same data item gets updated by both mechanics the last item synchronised wins.</li><li>If a data item has been updated on the server since the mechanic downloaded it to the tablet app, they then updated it and uploaded it, the mechanic&#39;s change wins.</li><li>Jobs may only be partially complete at time of synchronisation.</li><li>When the app synchronises it needs to apply the changes it holds and update what data is held locally with the most up to date information from the SQL database.  It may need to remove data from the app that is no longer relevant to the jobs being worked on currently or in the future.</li></ul><p>The backend is hosted on Azure, data stored in an Azure SQL database.  There is an OData API we&#39;re phasing out and a Web API that can be used / added to.  The complex authorisation happens within a shared module in the APIs, the only data taken down to an app would be data the user is allowed to see.</p><p>The data will get fairly large over time.</p><p>This needs to be transactional – ie. If there is a problem with the sync we want a whole job to have been synchronized at a time, not entity type at a time.</p><p>The app has been written as a SPA Cordova application so, unless there is a compelling reason not to, it has to remain this way.</p><p><strong>Ideas we&#39;ve considered so far :</strong></p><p>BreezeJS has been used to track changes.  We could send just those changes up to the server, wait for a process on the server to apply those changes to the database and then start the download of any changes and new data required.  However this could mean that the sync will take a long time to complete if lots of people are syncing at the same time and things get clogged up in a queue of some sort.</p><p>Using CouchDb/PouchDB &#8211; I know very little about this, would this work with the authorisation model we have?  And how would it work getting the changes to/from the master SQL database?</p><p>Azure offline data sync (<a href="https://docs.microsoft.com/en-us/azure/app-service-mobile/app-service-mobile-offline-data-sync" rel="nofollow noreferrer">https://docs.microsoft.com/en-us/azure/app-service-mobile/app-service-mobile-offline-data-sync</a>) &#8211; As far as I can see this is pretty similar to using CouchDb, or have I misunderstood?</p><p>The required authorisation model is the part that seems to be the blocker to several solutions being viable, we need different users to have different sets of common data at a given time, this is imperative.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>If you&#39;re going to sync against your master SQL database you will always have the same problem: how do you resolve conflicting changes?</p><p>CouchDB doesn&#39;t help you there. It explicitly does not handle conflicts and leaves it up the user to handle them (by picking sides). Other solutions also can&#39;t really help you, because to resolve a conflict you must understand the meaning of the data that is in a conflicting state. In other words, there is no generic &#34;perfect&#34; solution to this problem.</p><p>My advice would be to develop some solution yourself using that upload changes to a queue strategy you described. Performance likely won&#39;t be your biggest issue, but conflict resolution will be. Choose one of several strategies for handling that queue:</p><ol><li>Optimistic concurrency control</li></ol><p>Keep track of the timestamp when a client took data out of the system, and when uploading a new version of that data check that no changes occurred. If changes did occur, either use strategy 3 or allow the user to force or discard.</p><ol start="2"><li>Locking</li></ol><p>Allow the user to explicitly do a &#34;check out&#34; and &#34;check in&#34; operation. Some basic things to take into account: other users need to be able to see who has a lock, and take that lock away from them. Only the user with a lock may check in changes performed on data held under that lock. Look at how subversion (and clients like tortoisesvn) handles locks, it&#39;s sane, as far as such things go.</p><ol start="3"><li>Merging</li></ol><p>This is a variation on strategy 1, except that when you detect conflicts you perform a merge. You can implement this using multiple strategies. Last one wins, first one wins, explicit user choice (possibly showing them the delta). You can reduce the risk of conflicts by tracking the data at a finer-grained level (per-field instead of per-form).</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../solutions-for-ios-collaborative-sync-icloud-coredata-couchdb/'>Solutions for iOS collaborative sync (iCloud CoreData, CouchDB)</a></li><li class="list-group-item"><a href='../database-implementation-details-of-database-synchronisation-api/'>Database &#8211; Implementation details of database synchronisation API</a></li><li class="list-group-item"><a href='../whats-the-best-way-to-track-updates-when-syncing-data-from-mysql-remote-server-to-local-sqlite-database/'>What&#8217;s the best way to track updates when syncing data from MySQL remote server to local SQLite database</a></li><li class="list-group-item"><a href='../c-how-to-design-a-database-schema-for-a-multi-user-to-do-application-in-azure/'>C# &#8211; How to design a database schema for a multi-user To-Do application in Azure</a></li><li class="list-group-item"><a href='../a-simple-approach-for-data-synchronisation/'>A simple approach for data synchronisation</a></li><li class="list-group-item"><a href='../design-how-to-check-if-app-is-offline/'>Design &#8211; How to check if app is offline</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>