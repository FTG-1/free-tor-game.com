<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Unit-testing &#8211; When, Where, and How to Unit Test &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087987 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087987" class="post-1087987 software type-software status-publish hentry category-software tag-design-patterns tag-object-oriented-design tag-unit-testing tag-xunit"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Unit-testing &#8211; When, Where, and How to Unit Test</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design-patterns</span><span class="mr-2 badge badge-info">object-oriented-design</span><span class="mr-2 badge badge-warning">unit testing</span><span class="mr-2 badge badge-primary">xunit</span></p><div class="entry-content"><div><aside class="s-notice s-notice__info post-notice js-post-notice mb16" role="status"><div class="d-flex fd-column fw-nowrap"><div class="d-flex fw-nowrap"><div class="flex--item wmn0 fl1 lh-lg"><div class="flex--item fl1 lh-lg"> <b>This question already has answers here</b>:</p></div></p></div></p></div><div class="flex--item mb0 mt4"> <a href="../../questions/66480/when-is-it-appropriate-to-not-unit-test.html" dir="ltr">When is it appropriate to not unit test?</a><br /> <span class="question-originals-answer-count"><br /> (14 answers)<br /> </span></div><div class="flex--item mb0 mt8">Closed <span title="2013-10-01 23:45:11Z" class="relativetime">8 years ago</span>.</div></p></div></aside></div><p>I&#39;m very familiar with xUnit frameworks and I try to implement unit tests on every project I start. Somewhere along the way, I realize that I&#39;m writing the same tests over and over again, and then I run into a really difficult to test method or a test involving remote resources, and then I give up for a while. I end up coming back eagerly whenever I can to test simple things, but as soon as I run into harder things to test, I run for the hills with my tail between my legs.</p><p>Let&#39;s throw in some examples.</p><ol><li><p>Long flow of things to do in a method. (How do I test this? Do I just make sure that the code&#39;s being called by stubbing things out? How should I rewrite the code to facilitate easier testing?)</p><pre><code>public void doSomething() {
    Object1 value1 = doSomething1(this.getName());
    if (value1.isError()) {
        sendError(new Object1Error(value1.getError().getMessage()));
        return;
    }

    Object2 value2 = doSomething2(value1, this.getName());
    if (value2.isError()) {
        sendError(new Object2Error(value2.getError().getMessage()));
        return;
    }

    /* ad infinitum... */
}
</code></pre></li><li><p>Overloaded methods and constructors.</p><pre><code>public String toJSON() {
    return toJSON(true);
}

public String toJSON(boolean prettyPrint) {
    /* do work */
    return result;
} 

/* test */
@Test public void testToJSON() { ... };

@Test public void testToJSONBoolean() { /* redundant similar test code... */ }
</code></pre></li><li><p>Remote resources. How do I test that my upload API is working (ie: right request method, host, request content type, payload, etc.) without actually doing an upload? These uploads go to servers outside of my control.</p><pre><code>public void doUpload() throws IOException {
    HttpClient client = new HttpClient();
    PutMethod putMethod = new PutMethod(...);
    putMethod.setRequestHeader(...);
    putMethod.setRequestEntity(new FileInputStreamRequestEntity(...));

    /* etc. */

    final int responseCode = client.executeMethod(putMethod);
}
</code></pre></li><li><p>Testing server interactions with clients.</p><pre><code>/* before we even get here, other interactions need to take place */
public void updateClientProfile(UserProfile profile) {
    // 1. validate the input
    // 2. update the user in the db
    // 3. generate an email in HTML
    // 4. send the email
    // 5. serve out a view
}
</code></pre></li></ol><p>Testing at first glance seems easy, until I get to these kind of situations. How do I keep my motivation for testing and write my code to be more testable?</p><p>It seems that the more things that a method needs to do, the exponentially more difficult and frustrating unit tests are to write. Do I test simply that the code is calling the right services and methods? Do I write unit tests simply to prove to myself that my code calls the methods I told it to call, or to determine that the logic is right? Help!</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>&#34;Don&#39;t blame the mirror for the ugly face&#34;</p><p>Problems you observe in tests just honestly reflect the problems with the quality of the source code.</p><p>It is very (<strong>very</strong>) unlikely that continuing blindly throwing unit tests on code that you found to be poorly designed will help you make further progress here. I tried that and I failed. I have been ready to convince self that it&#39;s my fault, that it&#39;s just me unable of making it work, but I dropped that idea after I saw that colleagues much more talented than me are having exactly the same problems (an advantage of working in strong team is that you can easily gauge when things go wrong because of your own limitations and when it happens because <strong>things</strong> are wrong).</p><p>Your best bet would be to get in touch with professional testers, setup a thorough QA to catch functional regressions and <strong>after</strong> that, refactor the code into something better - into something that makes writing unit tests productive and fun, as it should be.</p><p><a href="https://softwareengineering.stackexchange.com/a/135369/31260" title="another answer">Quoting self</a> - thing is, approaches applicable with better codebase just don&#39;t cut it:</p><blockquote><p><sup>With bad code... unit tests do things opposite to how I use them in good code, like breaking at reasonable changes and failing to catch the real mistakes I make. Which is painful but not surprising - what else would one expect from testing <em>units</em> which have bad design to start with? Instead of helping you improve the design, unit tests often work to preserve bad code - eg in my recent maintenance project I was regularly removing large chunks of code which was only referenced from outdated senseless unit tests. BTW I use that knowledge when writing new code: when I find out that my unit tests tend to get too complicated / fragile, this indicates a need to fix some issue with my own design...</sup></p></blockquote></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-unit-testing-methods-that-call-suppliers-webservices/'>Unit-testing &#8211; Unit testing methods that call suppliers webservices</a></li><li class="list-group-item"><a href='../c-unit-testing-a-method-that-contains-two-output-type-parameters/'>C# &#8211; Unit Testing a method that contains two output type parameters</a></li><li class="list-group-item"><a href='../unit-testing-how-to-not-test-implementation-when-method-returns-void/'>Unit-testing &#8211; How to not test implementation when method returns void</a></li><li class="list-group-item"><a href='../unit-testing-how-should-i-unit-test-a-function-that-uses-setters/'>Unit-testing &#8211; How should I unit test a function that uses setters</a></li><li class="list-group-item"><a href='../unit-testing-how-to-avoid-the-need-to-unit-test-private-methods/'>Unit-testing &#8211; How to avoid the need to Unit test private methods</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>