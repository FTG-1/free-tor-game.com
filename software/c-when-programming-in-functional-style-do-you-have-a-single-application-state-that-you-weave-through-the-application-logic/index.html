<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; When programming in Functional style, do you have a single application state that you weave through the application logic &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079977 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079977" class="post-1079977 software type-software status-publish hentry category-software tag-c tag-functional-programming tag-immutability tag-monad tag-state"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; When programming in Functional style, do you have a single application state that you weave through the application logic</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">functional programming</span><span class="mr-2 badge badge-warning">immutability</span><span class="mr-2 badge badge-primary">monad</span><span class="mr-2 badge badge-danger">state</span></p><div class="entry-content"><p><strong>How do I construct a system that has all of the following</strong>:</p><ol><li>Using pure functions with immutable objects.</li><li>Only pass into a function data that the function it needs, no more (i.e. no big application state object)</li><li>Avoid having too many arguments to functions.</li><li>Avoid having to construct new objects just for the purpose of packing and unpacking parameters to functions, simply to avoid too many parameters being passed to functions.  If I&#39;m going to pack multiple items to a function as a single object, I want that object to be the owner of that data, not something constructed temporarily</li></ol><p>It seems to me that the State monad breaks rule #2, although it&#39;s not obvious because it&#39;s weaved in through the monad.</p><p>I have a feeling i need to use Lenses somehow, but very little is written about it for non-Functional languages.</p><p><strong>Background</strong></p><p>As an exercise, I&#39;m converting one of my existing applications from an object-oriented style to a functional style.  The first thing I&#39;m trying to do is to make as much of the inner-core of the application as possible.</p><p>One thing I&#39;ve heard is that how to manage &#34;State&#34; in a purely-functional language, and this is what I believe is done by State monads, is that logically, you call a pure function, &#34;passing in the state of the world as it is&#34;, then when the function returns, it returns to you the state of the world as it has changed.</p><p>To illustrate, the way you can do a &#34;hello world&#34; in a purely functional way is kinda like, you pass in your program that state of the screen, and receive back the state of the screen with &#34;hello world&#34; printed on it.   So technically, you&#39;re making a call to a pure function, and there are no side-effects.</p><p>Based on that, I went through my application, and:<br /> 1. First put all my application state into a single global object (GameState)<br /> 2. Second, I made GameState immutable.   You can&#39;t change it.  If you need a change, you have to construct a new one.   I did this by adding a copy-constructor, that optionally takes one or more fields that changed.<br /> 3. To each application, I pass in the GameState as a parameter.  Within the function, after it&#39;s doing what it&#39;s gonna do, it creates a new GameState and returns it.</p><p>How I have a pure functional core, and a loop on the outside that feeds that GameState into the main workflow loop of the application.</p><p><strong>My Question:</strong></p><p>Now, my problem is that, the GameState has about 15 different immutable objects.  Many of the functions at the lowest level only operate on few of those objects, such as keeping score.   So, let&#39;s say I have a function that calculates the score.   Today, the GameState is passed to this function, which modifies the score by creating  new GameState with a new score.</p><p>Something about that seems wrong.   The function doesn&#39;t need the entirety of GameState.  It just needs the Score object.   So I updated it to pass in the Score, and return the Score only.</p><p>That seemed to make sense, so I went further with other functions.  Some functions would require me to pass in 2, 3 or 4 parameters from the GameState, but as I used the pattern all the way the outer core of the application, I&#39;m passing in more and more of the application state.   Like, at the top of the workflow loop, I would call a method, that would call method that would call a method, etc., all the way down to where the score is calculated.   That means the current score is passed along through all those layers just because a function at the very bottom is going to calculate the score.</p><p>So now I have functions with sometimes dozens of parameters.   I could put those parameters into an object to lower the number of parameters, but then I would like that class to be the master location of the state application state, rather than an object that&#39;s simply constructed at the time of the call simply to avoid passing in multiple parameters, and then unpack them.</p><p>So now I&#39;m wondering if the problem I have is that my functions are nested too deeply.   This is the result of wanting to have small functions, so I refactor when a function gets to big, and split it into multiple smaller functions.  But doing that produces a deeper hierarchy, and anything passed into the inner functions need to be passed in to the outer function even if the outer function isn&#39;t operating on those objects directly.</p><p>It seemed like simply passing in the GameState along the way avoided this problem.   But I am back to the original problem of passing in more information to a function than the function needs.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m not sure if there&#39;s a good solution. This may or not be an answer, but it&#39;s far too long for a comment. I was doing a <a href="https://softwareengineering.stackexchange.com/q/107769/14167">similar thing</a> and the following tricks have helped:</p><ul><li>Split the <code>GameState</code> hierarchically, so you get 3-5 smaller parts instead of 15.</li><li>Let it implements interfaces, so your methods see only the needed parts. Don&#39;t ever cast them back as you&#39;d lie to yourself about the real type.</li><li>Let also the parts implement interfaces, so you get fine control of what you pass.</li><li>Use parameter objects, but do it sparingly and try to turn them them into real objects with their own behavior.</li><li>Sometimes passing slightly more than needed is better than a lengthy parameter list.</li></ul><blockquote><p>So now I&#39;m wondering if the problem I have is that my functions are nested too deeply.</p></blockquote><p>I don&#39;t think so. Refactoring into small functions is right, but maybe you could regroup them better. Sometimes, it isn&#39;t possible, sometimes it just needs a second (or third) look at the problem.</p><p>Compare your design to the mutable one. Are there things which have got worse by the rewrite? If so, can&#39;t you make them better in the same way you did originally?</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../an-example-of-a-continuation-not-implemented-as-a-procedure/'>An example of a continuation not implemented as a procedure</a></li><li class="list-group-item"><a href='../python-is-the-benefit-of-the-io-monad-pattern-for-handling-side-effects-purely-academic/'>Python &#8211; Is the benefit of the IO monad pattern for handling side effects purely academic</a></li><li class="list-group-item"><a href='../c-what-can-go-wrong-in-context-of-functional-programming-if-the-object-is-mutable/'>C# &#8211; what can go wrong in context of functional programming if the object is mutable</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>