<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Most efficient way of saving images and sending them to client browser &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1078123 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1078123" class="post-1078123 software type-software status-publish hentry category-software tag-azure tag-blob tag-image-manipulation tag-image-processing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Most efficient way of saving images and sending them to client browser</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">azure</span><span class="mr-2 badge badge-info">blob</span><span class="mr-2 badge badge-warning">image manipulation</span><span class="mr-2 badge badge-primary">image processing</span></p><div class="entry-content"><p>I&#39;m building an app where users list items for sale and they can include up to five photos for each item. I&#39;m using Azure Blob storage for storing the images.</p><p>In my app, I&#39;ll be displaying these images in several different ways and sizes. I&#39;ll show them as thumbnails,  as roughly 250px in width and full size, depending on the page on which they are being displayed.</p><p>I&#39;d like to know best practice for storing these images and sending them to the client. I have a couple choices. I could store just the single image, and then retrieve and resize it, depending on how it&#39;s going to get displayed, on the server before sending it to the client. Or, I could store several copies of each image, each with the appropriate size that will be required in the client pages.</p><p>I&#39;m leaning towards the first option where I just save the single original copy, resize it on the server and then send it to the client. I have no experience with this sort of thing so I&#39;m not certain the best approach, or if there are others.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>There are couple optimizations that can be done:</p><ol><li>After retrieving the images from the blobs, cache it into memory, depending on hit frequency. If the amount of images is very important, consider using redis as a L2 cache provider (now available on Azure). If the web server has to support a massive amount of hits, and the images can be publicly available, I recommend to <strong>delegate Images transfers</strong> to the azure CDN, to get a (very) low latency.</li><li><strong>Set the Cache-Control http header</strong> to an appropriate value. This will greatly limit the amount of round-trip per client</li><li>If the images are meant to be viewed at multiple sizes, consider sending only two versions: Thumbnails and HD. Then you can easily integrate the image to any size using the CSS3 background-size:contain; property, which gives great results.</li><li><p>In order to limit client/server round-trips, I would advise to <strong>send your images grouped.</strong> Using CSS3, you can inline multiple images in a single css file. Here is a method I wrote that merge images from a directory, as a single CSS string:</p><pre><code>private static string images2css(string directory = &#34;~/Images&#34;)
{
    StringBuilder css = new StringBuilder();
    foreach (string f in Directory.GetFiles(System.Web.Hosting.HostingEnvironment.MapPath(directory)).Where(x =&gt; x.EndsWith(&#34;.png&#34;) || x.EndsWith(&#34;.jpg&#34;) || x.EndsWith(&#34;.jpeg&#34;)))
    {
        var img = Image.FromFile(f);
        byte[] raw = File.ReadAllBytes(f);
        string name = Path.GetFileNameWithoutExtension(f);
        string ext = Path.GetExtension(f).Substring(1);

        css.AppendFormat(&#34;.img-{0}{{&#34;, name.Replace(&#39;_&#39;, &#39;-&#39;));
        css.AppendLine(&#34;background-color: transparent; background-repeat: no-repeat; background-position: left top;&#34;);
        css.AppendLine(string.Format(&#34;background-image: url(data:image/{1};base64,{0});&#34;, Convert.ToBase64String(raw), ext));
        css.AppendLine(string.Format(&#34;padding-left: {0}px !important; min-height: {1}px;&#34;, img.Width + 5, img.Height));
        //   css.AppendLine(&#34;background-size: contain;&#34;);
        css.AppendLine(&#34;}&#34;);
        img.Dispose();
    }

    return css.ToString();
}
</code></pre></li></ol><p>Shouldn&#39;t be too much work adapting it to fetch the images from an Azure Blob. You could also save the css string back to another blob with Gzip compression, and make it available to the cdn.</p><p>Overall, there are 3 main parameters to consider to choose the best strategy:</p><ul><li>Are there a lot of Images? (no: L1 cache, yes: L2 cache)</li><li>Does the front server has to handle a massive amount of hits? (yes: the front server must not send images. Best option is CDN)</li><li>Does a page displays the same set of images (=&gt; group images in one file), or the combination always different? (=&gt; L2 cache or CDN)</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../best-practice-handling-images-on-website/'>Best practice- handling images on website</a></li><li class="list-group-item"><a href='../store-highres-photos-in-database-or-as-file/'>Store HighRes photos in Database or as File</a></li><li class="list-group-item"><a href='../best-way-to-design-file-storage-for-image-processing-system/'>Best way to design file storage for image processing system</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>