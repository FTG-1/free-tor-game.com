<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; How to impersonate user in web app &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082755 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082755" class="post-1082755 software type-software status-publish hentry category-software tag-asp-net tag-c tag-javascript tag-jquery"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; How to impersonate user in web app</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asp.net</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">javascript</span><span class="mr-2 badge badge-primary">jquery</span></p><div class="entry-content"><p>I am building an intranet web app with ASP.NET. We are using Windows authentication for granting access to different web pages.  We grab your Windows login server side, then build web pages accordingly.  I have a need for a group of tech users to be able to impersonate business users so that the tech users can see the same page the business user sees and confirm that the app is correctly configured for the business user.  Is there a good pattern to use for this?  We are talking about seeing payroll data for different departments.  SSL is not an option here (long story).</p><p>My server side language, where I get the Windows login, is C#. I am using jquery on the client side for manipulating the DOM.</p><p>In response to Flater&#39;s really good points: I&#39;m trying to come up with a way for a business user, who would be a member of a support team, to be able to see the same thing an end user sees in their browser for this one web app.  I&#39;m not trying to fool Windows that I am someone else for all things.  So I am looking at building something into my web page that allows the business user to pick an end user from a list of names, then pass that login name along to the web server and have the web server render a page with the info the end user should see.  In the past, I have done this with a config file or database record; that&#39;s fine for devs but not so much for business users. Since all our permissions are based on AD groups, I think the best solution would be to show a separate list of AD groups of which the user is a member, then show a matrix of what the web server should be rendering for that user.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p><strong>Update to your update.</strong></p><blockquote><p>So I am looking at building something into my web page that allows the business user to pick an end user from a list of names, then pass that login name along to the web server and have the web server render a page with the info the end user should see.</p></blockquote><p>The issue here is that your backend is currently set up to take a Windows identity. Windows identities for an IIS app should not be configurable from the <strong>client&#39;s</strong> side, as that is granting an obvious backdoor for malicious clients.</p><p>There are several ways to approach this without compromising the backend&#39;s current authentication setup:</p><ul><li>On the client computer, you run the browser under the desired user&#39;s account.<ul><li>Go to the browser .exe</li><li>Shift + right click it</li><li>Select &#34;Run as different user&#34; and log in with his credentials (this obviously requires knowing their password).</li><li>This browser should correctly send the chosen user&#39;s credentials to the backend server.</li></ul></li><li>On the backend IIS configuration, you can set the app pool to impersonate a user. Note that this affects <strong>all</strong> requests. This is an easy approach if you&#39;re e.g. debugging locally, but you should obviously never do this on production (or any environment with multiple concurrent users).<ul><li>You can find this in the advanced settings of the app pool.</li><li>This also requires knowing the user&#39;s password.</li></ul></li></ul><p>Needing the user&#39;s password is a recurring feature here, <strong>for good reason</strong>. No one except the user is allowed to perform actions on the user&#39;s behalf. Even those with more rights than the user can still not pretend to be the user (in Windows&#39; internal security, at least).</p><p>However, I&#39;m still on the fence whether impersonating the user is a good approach. It seems like an overzealous approach. If there&#39;s any auditing on the application (which I would expect from a payroll application), then a developer is effectively able to hide his actions.<br/> What&#39;s stopping a developer from pretending to be someone else and possibly updating the payroll data? If they can choose to be whoever they are, then you&#39;re giving them the keys to the castle.</p><p>A better approach would be to retain the user&#39;s actual identity, but mock their <em>settings</em>. That way, you still get the same mocked output, without messing with any audit security. You mention different departments, so I&#39;ll assume that this is the setting you want to mock.</p><ul><li>Give your developers a special privilege in AD or assign them to a special group (e.g. CAN_MOCK_DEPARTMENT)</li><li>The backend renders an additional &#34;select your department&#34; dropdown list on the webpage if the current user is part of the CAN_MOCK_DEPARTMENT privilege/group.</li><li>When such a developer sends a request to the backend, instead of taking the current user&#39;s department; the backend will use the value of the &#34;select your department&#34; dropdown. For all other users, the backend will always use their actual department.</li><li>Make sure that the backend doesn&#39;t rely on the department dropdown for non-developer users! A clever user can change this dropdown&#39;s value even if it is disabled (via jQuery in the F12 console)!</li></ul><hr/><p><strong>The original answer.</strong></p><blockquote><p>I have a need for a group of tech users to be able to impersonate business users so that the tech users can see the same page the business user sees and confirm that the app is correctly configured for the business user.</p></blockquote><p>This raises a massive red flag for me.</p><p>There is a very meaningful difference between impersonating an authenticated identity, and having the ability to mirror a user&#39;s privileges or settings.</p><blockquote><p>We are talking about seeing payroll data for different departments.</p></blockquote><p>Your developers should have explicit rights to mock which department they belong to, in the payroll application (not on the AD level itself). This is nowhere near the same as impersonating a user account across the network.</p><hr/><p>Think about what you&#39;re asking. You&#39;re asking for the ability to pretend to be <strong>any</strong> user, at will, without logically provable permission from said user, at all times, which will give you access to highly confidential payroll information.<br/> If you have the user&#39;s password, doing so is trivial (just log in as them). If you don&#39;t have their password, but were somehow able to pretend to be them anyway, <strong>then what&#39;s the point of having a password?</strong></p><p>You&#39;re effectively asking &#34;how do I lockpick all front doors because I sometimes would like to test the TVs of some of my neighbours&#34;.</p><p>The direct answer here is that you either need to get a <strong>similar</strong> TV (just like how you get a similar privilege/department), or you simply do it <strong>with the owner&#39;s express permission</strong> (i.e. having them log you into their account, or remotely taking over their machine).</p><p>If you were able to do what you expect to be able to do; then security is meaningless.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../javascript-asp-vs-javascript-vs-jquery-vs-user-controls-vs-ajax/'>Javascript &#8211; ASP vs javascript vs jQuery vs User Controls vs AJAX</a></li><li class="list-group-item"><a href='../sharing-authentication-methods-across-api-and-web-app/'>Sharing authentication methods across API and web app</a></li><li class="list-group-item"><a href='../javascript-how-does-authentication-work-with-asp-net-using-live-id-andor-windows-authentication/'>Javascript &#8211; How does authentication work with ASP.NET (using Live ID and\or Windows Authentication)</a></li><li class="list-group-item"><a href='../is-it-good-idea-to-save-user-password-and-get-token-from-server-automatically-behind-the-eyes-of-the-user/'>Is it good idea to save user/password and get token from server automatically behind the eyes of the user</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>