<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Pythonic use of the isinstance function &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1072163 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1072163" class="post-1072163 software type-software status-publish hentry category-software tag-coding-style tag-python"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Pythonic use of the isinstance function</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">coding-style</span><span class="mr-2 badge badge-info">python</span></p><div class="entry-content"><p>Whenever I find myself wanting to use the isinstance() function I usually know that I&#39;m doing something wrong and end up changing my ways.  However, in this case I think I have a valid use for it.  I will use shapes to illustrate my point although I am not actually working with shapes.  I am parsing XML configuration files that look like the following:</p><pre><code>&lt;square&gt;
  &lt;width&gt;7&lt;/width&gt;
&lt;/square&gt;
&lt;rectangle&gt;
  &lt;width&gt;5&lt;/width&gt;
  &lt;height&gt;7&lt;/height&gt;
&lt;/rectangle&gt;
&lt;circle&gt;
  &lt;radius&gt;4&lt;/radius&gt;
&lt;/circle&gt;
</code></pre><p>For each element I create an instance of the Shape class and build up a list of Shape objects in a class called the ShapeContainer.  Different parts of the rest of my application need to refer to the ShapeContainer to get certain shapes.  Depending on what the code is doing it might need just rectangles, or it might operate on all quadrangles, or it might operate on all shapes.  I have created the following function in the ShapeContainer class (the actual function uses a list comprehension but I have expanded it here for readability):</p><pre><code>def locate(self, shapeClass):
  result = []
  for shape in self.__shapes:
    if isinstance(shape,shapeClass):
      result.append(shape)
  return result
</code></pre><p>Is this a valid use of the isinstance function?  Is there another way I can do this which might be more pythonic?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h3>Use polymorphism and duck-typing before <code>isinstance()</code></h3><p>You generally define what you want to <em>do</em> with the shapes, then either use polymorphism to adjust how each shape responds to what you want to do, or you use duck typing; test if the shape at hand can do the thing you want to do in the first place. This is the invocation versus introspection trade-off, conventional wisdom states that invocation is preferable over introspection, but in Python, duck-typing is preferred over <code>isinstance</code> testing.</p><p>So you need to work out why you need to filter on class in the first place; why do you need to find all the rectangles? Perhaps they are the only type that implements a certain method, in which case you use duck typing to test for that method instead.</p><p>Or perhaps you need to process each type in a different way, because each type has to be handled just right for whatever you are doing with them. In that case, you need to give each shape the same method, but implement it differently for each type, placing the responsibility for adaptation in each object.</p><h3>ABCs</h3><p>With duck-typing, you may find that you have to test for multiple methods, and thus a <code>isinstance()</code> test may look a better option. In such cases, using a <a href="http://docs.python.org/2/library/abc.html">Abstract Base Class (ABC)</a> could also be an option; using an ABC let&#39;s you &#39;paint&#39; several different classes as being the right type for a given operation, for example. Using a ABC let&#39;s you focus on the tasks that need to be performed rather than the specific implementations used; you can have a <code>Paintable</code> ABC, a <code>Printable</code> ABC, etc.</p><h3>Zope interfaces and component architecture</h3><p>If you find your application is using an <em>awful</em> lot of ABCs or you keep having to add polymorphic methods to your classes to deal with various different situations, the next step is to consider using a full-blown component architecture, such as the <a href="http://www.muthukadan.net/docs/zca.html">Zope Component Architecture (ZCA)</a>.</p><p><code>zope.interface</code> interfaces are ABCs on steroids, especially when combined with the ZCA adapters. Interfaces document expected behaviour of a class:</p><pre><code>if IRectangleShape.providedBy(yourshape):
    # it&#39;s a rectangle
</code></pre><p>but it also let&#39;s you look up adapters; instead of putting all the behaviours for every use of shapes in your shape classes, you implement adapters to provide polymorphic behaviours for specific use-cases. You can adapt your shapes to be printable, or paintable, or exportable to XML:</p><pre><code>class RectangleXMLExport(object):
    adapts(IRectangleShape)
    provides(IXMLExport)

    def __init__(self, rectangle):
        self.rectangle = rectangle

    def export(self):
        return u&#39;&lt;rectangle&gt;&lt;width&gt;{0}&lt;/width&gt;&lt;height&gt;{0}&lt;/height&gt;&lt;/rectangle&gt;&#39;.format(
            self.rectangle.width, self.rectangle.height)
</code></pre><p>and your code merely has to look up adapters for each shape:</p><pre><code>for shape in shapebag:
    self.result.append(IXMLExport(shape).export())
</code></pre></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../python-how-should-you-cleanly-restrict-object-property-types-and-values-in-python/'>Python &#8211; How should you cleanly restrict object property types and values in Python</a></li><li class="list-group-item"><a href='../python-more-pythonic-subclassing-dict-or-creating-external-functions-to-manipulate-them/'>Python &#8211;  more pythonic &#8211; subclassing dict or creating external functions to manipulate them</a></li><li class="list-group-item"><a href='../python-the-best-most-pythonic-way-to-mock-a-private-function/'>Python &#8211;  the best/most Pythonic way to mock a private function</a></li><li class="list-group-item"><a href='../python-when-is-it-not-pythonic-to-use-properties-instead-of-a-method-that-doesnt-take-arguments/'>Python &#8211; When is it not Pythonic to use properties instead of a method that doesn&#8217;t take arguments</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>