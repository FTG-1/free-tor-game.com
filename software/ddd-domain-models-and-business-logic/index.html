<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>DDD Domain Models and Business Logic &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070936 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070936" class="post-1070936 software type-software status-publish hentry category-software tag-domain-driven-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">DDD Domain Models and Business Logic</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">domain-driven-design</span></p><div class="entry-content"><p>I&#39;m a seasoned programmer but a novice with DDD.  I have a project that I&#39;m trying to implement with DDD and my understanding is that there is some ambiguity with regard to the use of domain models and application services.  In the purest of DDD implementations, my understanding is that domain models are supposed to contain all business logic.  However, this doesn&#39;t seem like a realistic goal to me.  In simple validation scenarios and such, this is all well and good, but the goal of encapsulating business logic in domain models gets a little slippery when we think about logic requiring additional services such as database lookups/persistence and other external dependencies.</p><p>For example, I have a domain model &#34;Order&#34; that has a method &#34;IsValid&#34;.  To determine whether an order is valid, a database read must be performed.  In order to keep the model clean, I don&#39;t want to inject any database work into it.  OK fine &#8211; I create an OrderService to do the database hit and pass in a result to &#34;IsValid&#34; so that the dependency on the database resides with the service.  However, what happens if there are multiple database hits that depend on business logic?  Is it appropriate to add that logic to the application service?  If so, it seems that business logic is leaking into the application services layer which is a violation of DDD.  However, if we move the logic inside the domain model and do the database hit there, we&#39;re mixing concerns and also violating DDD.</p><p>Can anyone experienced with DDD provide any insight into how to deal with this sort of an issue?  DDD seems like it provides a lot of nice value, but I&#39;m worried about these kinds of issues leading to design &#34;rot&#34;.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This is a very broad question but I will try to give you an answer.</p><blockquote><p>...there is some ambiguity with regard to the use of domain models and application services</p></blockquote><p>There is no ambiguity if you design well your bounded contexts, the domain models and the relationships between them.</p><blockquote><p>However, what happens if there are multiple database hits that depend on business logic?</p></blockquote><p>In <code>DDD</code>, all the operations go through the <code>Aggregate root</code> (<code>AR</code>). The <code>application services</code> load the <code>ARs</code> from the persistence, send commands to them, then persist those <code>ARs</code> back. <code>ARs</code> don&#39;t need to hit the database at all. In fact a good designed <code>AR</code> does not even know that databases exists at all. All they touch/see/smell is their internal state and the <strong>immutable</strong> arguments that they receive in their command methods. If an <code>AR</code> needs something from the database then the <code>Application service</code> pass that thing as argument.</p><p><code>ARs</code> should be pure, side effects free objects/functions. One reason is that commands applied on them must be retry-able, in case of concurrent modifications.</p><p>As an example: <code>ARs</code> don&#39;t send emails, they return a <code>value object</code> that holds the email data (from, to, subject and body) and the Application service takes that value object and passes it to a infrastructure service that does the actual sending of the email.</p><blockquote><p>For example, I have a domain model &#34;Order&#34; that has a method &#34;IsValid&#34;. To determine whether an order is valid, a database read must be performed.</p></blockquote><p>You don&#39;t need an <code>isValid</code> method, as an <code>Order</code> cannot get into an invalid state anyway because any modifications are done through it&#39;s methods. If you are referring to the existence of an <code>Order</code> then this kind of validation is done by the <code>Application service</code>: if it does not find the <code>Order</code> in the persistence then it does not exist, as simple as that. Maybe you are referring to the <code>ShoppingCart</code> as being valid, not the <code>Order</code>. What about then? Well, you could try to create an <code>Order</code> from a <code>ShoppingCart</code> and if you succeed then a <code>Cart</code> is ready to be ordered. As the <code>Order</code> is side effect free, no order will actually be created. Just an example of how you might think in <code>DDD</code>.</p><blockquote><p>DDD seems like it provides a lot of nice value, but I&#39;m worried about these kinds of issues leading to design &#34;rot&#34;.</p></blockquote><p>If you follow the <code>DDD</code> approach well, your design will never rot. <strong>Never</strong>.</p><p>As a foot note: In the beginning I was a little miss-leaded by the <a href="https://en.wikipedia.org/wiki/Multitier_architecture" rel="noreferrer">Layered architecture</a>. Don&#39;t make the same mistake. Take a look at some <em>newer</em> architectures like <code>CQRS</code> that fits very well with <code>DDD</code>.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../ddd-with-orm-where-should-the-business-logic-go/'>DDD with ORM where should the business logic go</a></li><li class="list-group-item"><a href='../rest-do-restful-apis-tend-to-encourage-anemic-domain-models/'>Rest &#8211; Do RESTful APIs tend to encourage anemic domain models</a></li><li class="list-group-item"><a href='../in-ddd-is-validation-application-logic-or-domain-logic/'>In DDD, is validation application logic, or domain logic</a></li><li class="list-group-item"><a href='../design-ddd-repositories-in-application-or-domain-service/'>Design &#8211; DDD repositories in application or domain service</a></li><li class="list-group-item"><a href='../sqlalchethe-and-ddd-its-own-pattern/'>SQLAlchethe and DDD: It&#8217;s own pattern</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>