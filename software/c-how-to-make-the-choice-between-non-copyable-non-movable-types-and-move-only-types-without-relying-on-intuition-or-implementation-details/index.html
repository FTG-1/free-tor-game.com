<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; How to make the choice between non-copyable non-movable types and move-only types without relying on intuition or implementation details &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1077248 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1077248" class="post-1077248 software type-software status-publish hentry category-software tag-c"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; How to make the choice between non-copyable non-movable types and move-only types without relying on intuition or implementation details</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span></p><div class="entry-content"><p>Before the introduction of the move constructor and move assignment in C++, I had two clear conceptual categories of classes: values for which using a copy was not different from using the original value, entities for which it was different.  For values, I provided the copy constructor and assignment operator (and equality operators), for entities I didn&#39;t (if a copying operation made sense, the copy constructor was explicit, and the copy operation was not provided by assignment operator; equality was never a meaningful concept).</p><p>Introduction of move introduced a new category, and sadly I seem not to have found out a conceptual criteria which would allow me to do the choice of providing move operations or not for non value classes.  Currently, I&#39;m mostly driven by implementation considerations and that leaves me unsatisfied.  More, recently I had to make a class evolve and I had to make the choice of either removing the move operations or introduce unwarranted complexity.  Luckily, move operations were provided and not used and the choice was thus not too difficult. That event highlighted the fact that I had a conceptual issue.</p><p>How to make the choice between non-copyable non-movable types and move-only types without relying on intuition or implementation details?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The way to look at this is not a matter of copy vs. move vs. immobility. It&#39;s two separate questions:</p><ol><li><p>Mobility vs. immobility. Do you want it to be able to transfer the contents of the object to another object in some way?</p></li><li><p>If it&#39;s mobile, then is it fully copyable or move-only?</p></li></ol><p>The thing is, the answer to either question is not always a matter of design.</p><p><code>mutex</code> is not immobile because we conceptually think of a <code>mutex</code> as something that cannot be moved. We know <em>exactly</em> what it ought to mean to move a <code>mutex</code>: the locks on that <code>mutex</code> still work. It isn&#39;t immobile by design; it is immobile by <em>implementations</em>. Some backends could make a mobile <code>mutex</code>, but others cannot (without memory allocations or other overhead). Thus, we get the lowest-common-denominator.</p><p>By contrast, <code>lock_guard</code> is immobile by design. That&#39;s its purpose. The same goes for types like <code>boost::scoped_ptr</code>; the whole point is that the lifetime of the managed construct <em>will end</em> at the termination of that scope. While at some times we may desire to move such objects, from the perspective of those who designed them, they did not <em>want</em> them to be mobile.</p><p>When it comes to the question of what form of mobility a type has, the same things apply. <code>unique_ptr</code> is move-only because that&#39;s its job. That&#39;s why it exists: to permit the transfer of unique ownership from one location to another.</p><p>By contrast, one could <em>conceive</em> of the ability to copy a <code>std::thread</code>. You would just pause the thread&#39;s execution, copy its call stack, and start a new thread of execution with the copied call stack. That&#39;s quite simple conceptually, yet it is impossible to implement with C++&#39;s object model. After all, you might have a <code>scoped_ptr</code> on the stack, a type you&#39;re <em>not allowed</em> to copy. You might have a pointer/reference to a stack object <em>on the stack</em>; how do you update it to point to the correct object?</p><p>Implementations inform interfaces. The problem with your &#34;conceptual criteria&#34; is that it makes you think that you can build a couple of simple rules to categorize the world, and if you stick to those categories, you&#39;ll be alright.</p><p>Programming is not that simple. You&#39;re going to have to learn how to exercise <em>judgment</em>; it&#39;s one of the skills that any good programmer needs.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-the-rule-of-5-to-use-it-or-not/'>C++ &#8211; The rule of 5 &#8211; to use it or not</a></li><li class="list-group-item"><a href='../c-doing-work-in-vectors-push-back/'>C++ &#8211; Doing work in vector&#8217;s push back</a></li><li class="list-group-item"><a href='../c-the-pattern-for-a-safe-interface-in-c/'>C++ &#8211;  the pattern for a safe interface in C++</a></li><li class="list-group-item"><a href='../c-subscript-assignment-binary-operator-in-c/'>C++ &#8211; Subscript/assignment binary operator in C++</a></li><li class="list-group-item"><a href='../c-object-lifetime-invariants-vs-move-semantics/'>C++ &#8211; Object lifetime invariants vs. move semantics</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>