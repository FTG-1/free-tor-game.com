<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Why would Square inheriting from Rectangle be problematic if we override the SetWidth and SetHeight methods &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064585 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064585" class="post-1064585 software type-software status-publish hentry category-software tag-abstraction tag-inheritance tag-object-oriented-design tag-solid"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Why would Square inheriting from Rectangle be problematic if we override the SetWidth and SetHeight methods</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">abstraction</span><span class="mr-2 badge badge-info">inheritance</span><span class="mr-2 badge badge-warning">object-oriented-design</span><span class="mr-2 badge badge-primary">solid</span></p><div class="entry-content"><p>If a Square is a type of Rectangle, than why can&#39;t a Square inherit from a Rectangle? Or why is it a bad design?</p><p>I have heard people say:</p><blockquote><p>If you made Square derive from Rectangle, then a Square should be<br /> usable anywhere you expect a rectangle</p></blockquote><p>What is the problem here? And why would Square be usable anywhere you expect a rectangle? It would only be usable if we create the Square object, and if we override the SetWidth and SetHeight methods for Square than why would there be any issue?</p><blockquote><p>If you had SetWidth and SetHeight methods on your Rectangle base class<br /> and if your Rectangle reference pointed to a Square, then SetWidth and<br /> SetHeight don&#39;t make sense because setting one would change the<br /> other to match it. In this case Square fails the Liskov Substitution<br /> Test with Rectangle and the abstraction of having Square inherit from<br /> Rectangle is a bad one.</p></blockquote><p>Can someone explain the above arguments? Again, if we over-ride SetWidth and SetHeight methods in Square, wouldn&#39;t it resolve this issue?</p><p>I have also heard/read:</p><blockquote><p>The real issue is that we are not modeling rectangles, but rather<br /> &#34;reshapable rectangles&#34; i.e., rectangles whose width or height can be<br /> modified after creation (and we still consider it to be the same<br /> object). If we look at the rectangle class in this way, it is clear<br /> that a square is not a &#34;reshapable rectangle&#34;, because a square cannot<br /> be reshaped and still be a square (in general). Mathematically, we<br /> don&#39;t see the problem because mutability doesn&#39;t even make sense in a<br /> mathematical context</p></blockquote><p>Here I believe &#34;re-sizeable&#34; is the correct term. Rectangles are &#34;re-sizeable&#34; and so are squares. Am I missing something in the above argument? A square can be re-sized like any rectangle.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Basically we want things to behave sensibly.</p><p>Consider the following problem:</p><p>I am given a group of rectangles and I want to increase their area by 10%.  So what I do is I set the length of the rectangle to 1.1 times what it was before.</p><pre class="lang-cs prettyprint-override"><code>public void IncreaseRectangleSizeByTenPercent(IEnumerable&lt;Rectangle&gt; rectangles)
{
  foreach(var rectangle in rectangles)
  {
    rectangle.Length = rectangle.Length * 1.1;
  }
}
</code></pre><p>Now in this case, all of my rectangles now have their length increased by 10%, which will increase their area by 10%.  Unfortunately, someone has actually passed me a mixture of squares and rectangles, and when the length of the rectangle was changed, so was the width.</p><p>My unit tests pass because I wrote all my unit tests to use a collection of rectangles.  I now have introduced a subtle bug into my application which can go unnoticed for months.</p><p>Worse still, Jim from accounting sees my method and writes some other code which uses the fact that if he passes squares into my method, that he gets a very nice 21% increase in size.  Jim is happy and nobody is any wiser.</p><p>Jim gets promoted for excellent work to a different division. Alfred joins the company as a junior.  In his first bug report, Jill from Advertising has reported that passing squares to this method results in a 21% increase and wants the bug fixed.  Alfred sees that Squares and Rectangles are used everywhere in the code and realises that breaking the inheritance chain is impossible.  He also does not have access to Accounting&#39;s source code.  So Alfred fixes the bug like this:</p><pre class="lang-cs prettyprint-override"><code>public void IncreaseRectangleSizeByTenPercent(IEnumerable&lt;Rectangle&gt; rectangles)
{
  foreach(var rectangle in rectangles)
  {
    if (typeof(rectangle) == Rectangle)
    {
      rectangle.Length = rectangle.Length * 1.1;
    }
    if (typeof(rectangle) == Square)
    {
      rectangle.Length = rectangle.Length * 1.04880884817;
    }
  }
}
</code></pre><p>Alfred is happy with his uber hacking skills and Jill signs off that the bug is fixed.</p><p>Next month nobody gets paid because Accounting was dependent on being able to pass squares to the <code>IncreaseRectangleSizeByTenPercent</code> method and getting an increase in area of 21%.  The entire company goes into &#34;priority 1 bugfix&#34; mode to track down the source of the issue.  They trace the problem to Alfred&#39;s fix.  They know that they have to keep both Accounting and Advertising happy.  So they fix the problem by identifying the user with the method call like so:</p><pre class="lang-cs prettyprint-override"><code>public void IncreaseRectangleSizeByTenPercent(IEnumerable&lt;Rectangle&gt; rectangles)
{
  IncreaseRectangleSizeByTenPercent(
    rectangles, 
    new User() { Department = Department.Accounting });
}

public void IncreaseRectangleSizeByTenPercent(IEnumerable&lt;Rectangle&gt; rectangles, User user)
{
  foreach(var rectangle in rectangles)
  {
    if (typeof(rectangle) == Rectangle || user.Department == Department.Accounting)
    {
      rectangle.Length = rectangle.Length * 1.1;
    }
    else if (typeof(rectangle) == Square)
    {
      rectangle.Length = rectangle.Length * 1.04880884817;
    }
  }
}
</code></pre><p>And so on and so forth.</p><p>This anecdote is based on real-world situations that face programmers daily.  Violations of the Liskov Substitution principle can introduce very subtle bugs that only get picked up years after they&#39;re written, by which time fixing the violation will break a bunch of things and <em>not fixing</em> it will anger your biggest client.</p><p>There are two realistic ways of fixing this problem.</p><p>The first way is to make Rectangle immutable.  If the user of Rectangle cannot change the Length and Width properties, this problem goes away.  If you want a Rectangle with a different length and width, you create a new one.  Squares can inherit from rectangles happily.</p><p>The second way is to break the inheritance chain between squares and rectangles.  If a square is defined as having a single <code>SideLength</code> property and rectangles have a <code>Length</code> and <code>Width</code> property and there is no inheritance, it&#39;s impossible to accidentally break things by expecting a rectangle and getting a square.  In C# terms, you could <code>seal</code> your rectangle class, which ensures that all Rectangles you ever get are actually Rectangles.</p><p>In this case, I like the &#34;immutable objects&#34; way of fixing the problem.  The identity of a rectangle is its length and width.  It makes sense that when you want to change the identity of an object, what you really want is a <em>new</em> object.  If you lose an old customer and gain a new customer, you don&#39;t change the <code>Customer.Id</code> field from the old customer to the new one, you create a new <code>Customer</code>.</p><p>Violations of the Liskov Substitution principle are common in the real world, mostly because a lot of code out there is written by people who are incompetent/ under time pressure/ don&#39;t care/ make mistakes.  It can and does lead to some very nasty problems.  In most cases, you want to <a href="http://codingdelight.com/2014/01/16/favor-composition-over-inheritance-part-1/" rel="noreferrer">favour composition over inheritance</a> instead.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-specific-name-for-the-square-inherits-from-rectangle-paradox/'>Object-oriented &#8211;  specific name for the &#8220;Square inherits from Rectangle&#8221; paradox</a></li><li class="list-group-item"><a href='../does-this-code-solve-the-square-rectangle-liskov-substution-principle-example/'>Does this code solve the square/rectangle Liskov Substution Principle example</a></li><li class="list-group-item"><a href='../object-oriented-why-does-the-square-rectangle-problem-violate-solid-principles/'>Object-oriented &#8211; Why does the Square–Rectangle problem violate SOLID principles</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>