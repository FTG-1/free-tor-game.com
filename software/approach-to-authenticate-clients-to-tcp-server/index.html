<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Approach to Authenticate Clients to TCP Server &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075159 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075159" class="post-1075159 software type-software status-publish hentry category-software tag-algorithms tag-authentication tag-security"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Approach to Authenticate Clients to TCP Server</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">authentication</span><span class="mr-2 badge badge-warning">Security</span></p><div class="entry-content"><p>I&#39;m writing a Server/Client application where clients will connect to the server. What I want to do, is make sure that the client connecting to the server is actually using my protocol and I can &#34;trust&#34; the data being sent from the client to the server.</p><p>What I thought about doing is creating a sort of hash on the client&#39;s machine that follows a particular algorithm. What I did in a previous version was took their IP address, the client version, and a few other attributes of the client and sent it as a calculated hash to the server, who then took their IP, and the version of the protocol the client claimed to be using, and calculated that number to see if they matched. This works ok until you get clients that connect from within a router environment where their internal IP is different from their external IP. My fix for this was to pass the client&#39;s internal IP used to calculate this hash with the authentication protocol. My fear is this approach is not secure enough. Since I&#39;m passing the data used to create the &#34;auth hash&#34;.</p><p>Here&#39;s an example of what I&#39;m talking about:</p><pre><code>Client IP: 192.168.1.10, Version: 2.4.5.2
hash = 2*4*5*1 * (1+9+2) * (1+6+8) * (1) * (1+0)
Client Connects to Server
client sends: auth hash ip version
Server calculates that info, and accepts or denies the hash.
</code></pre><p>Before I go and come up with another algorithm to prove a client can provide data a server (or use this existing algorithm), I was wondering if there are any existing, proven, and secure systems out there for generating a hash that both sides can generate with general knowledge. The server won&#39;t know about the client until the very first connection is established.</p><p>The protocol&#39;s intent is to manage a network of clients who will be contributing data to the server periodically.</p><p>New clients will be added simply by connecting the client to the server and &#34;registering&#34; with the server. So a client connects to the server for the first time, and registers their info (mac address or some other kind of unique computer identifier), then when they connect again, the server will recognize that client as a previous person and associate them with their data in the database.</p><p>Edit:<br /> The approach I ended up going was this:</p><p>I ended up using an approach similar to what OpenSSH does, but reverse. Since when a client connects, I&#39;m not sure I can trust the client.</p><p>If it is the first time a client is connecting, it will provide me with a public key and a unique identifier (In this case, I will be using a computer&#39;s service tag since the computers I&#39;m going to be dealing with are all Dells). The server stores the id and public key in the database then sends the client a secret question encrypted using the public key. The client will then need to respond with the decrypted answer. Before a client can be accepted by the server, I may end up doing a unique id registration on the server manually before connecting the client for the first time, this way not any sly person can just generate public keys and emulate what a client does with a &#34;new unique id&#34;.</p><p>Thanks for the help! I hope this helps someone down the line. Feel free to tear apart the security flaws of this approach ðŸ™‚</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You can&#39;t really do authentication without sharing anything before hand. If you can have any sort of shared secret (i.e a key), you can use <a href="https://en.wikipedia.org/wiki/Challengeâ€“response_authentication" rel="nofollow noreferrer">challenge-response authentication</a> using an appropriate message digest algorithm.</p><p>On the topic of protocol compatibility, I would separate the concerns. You can use a traditional handshake to verify that the customer is speaking the same protocol/version the server uses (or a compatible one), but authentication is best dealt with separately.</p><p>An alternative with an acceptable tradeoff in many distributed systems is trusting the first connection from a specific client, sharing a key and then validating all subsequent connections from the same client using that. This is what OpenSSH does when connecting to a new server (prompts you whether you want to connect to an unknown host, and then store the fingerprint of that host and validate it on subsequent connections). You can find <a href="https://winscp.net/eng/docs/ssh#verifying_host_key" rel="nofollow noreferrer">a more detailed explanation of the SSH &#34;known hosts&#34; mechanism on the WinSCP wiki</a>.</p><p>Puppet uses a variant of this where they have a signed (trusted) SSL certificate on each client. When first connecting an agent with the server, the agent will issue a certificate signing request for the server that you then have to manually sign and give to the agent. This has added security but can become annoying quickly if you need to set up lots of clients, or do it without anyone interacting with the system. This is why there is a configuration option that changes the behavior to be like SSH&#39;s (trust everyone that you haven&#39;t seen before, validate identities only for known hosts). This is described in more detail at the <a href="http://projects.puppetlabs.com/projects/1/wiki/certificates_and_security" rel="nofollow noreferrer">PuppetLabs website</a>.</p><p>In the end, what you have is an issue of trust. The question remains: how can you trust a connection from a client? The answer to this isn&#39;t technical in nature - accepting any new connection by an unknown host and trusting it blindly might work for some systems, but not for all. It really depends on the tradeoffs of the actual system you are implementing, and the capabilities granted to the client by the server.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-api-security-hmac-key-hashing-vs-jwt/'>REST API security: HMAC/key hashing vs JWT</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>