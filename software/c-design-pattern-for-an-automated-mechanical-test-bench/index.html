<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Design pattern for an automated mechanical test bench &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087214 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087214" class="post-1087214 software type-software status-publish hentry category-software tag-automation tag-c tag-io tag-real-time"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Design pattern for an automated mechanical test bench</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">automation</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">io</span><span class="mr-2 badge badge-primary">real time</span></p><div class="entry-content"><p><strong>Background</strong></p><p>I have a test fixture with a number of communication/data acquisition devices on it that is used as an end of line test for a product.</p><p>Because of all the various sensors used in the bench and the need to run the test procedure in near real-time, I&#39;m having a hard time structuring the program to be more friendly to modify later on. For example, a National Instruments USB data acquisition device is used to control an analog output (load) and monitor an analog input (current), a digital scale with a serial data interface measures position, an air pressure gauge with a different serial data interface, and the product is interfaced through a proprietary DLL that handles its own serial communication.</p><p><strong>The hard part</strong></p><p>The &#34;real-time&#34; aspect of the program is my biggest tripping point. For example, I need to time how long the product needs to go from position 0 to position 10,000 to the tenth of a second. While it&#39;s traveling, I need to ramp up an output of the NI DAQ when it reaches position 6,000 and ramp it down when it reaches position 8,000. This sort of control looks easy from browsing NI&#39;s LabVIEW docs but I&#39;m stuck with C# for now. All external communication is done by polling which makes for lots of annoying loops.</p><p>I&#39;ve slapped together a loose Producer Consumer model where the Producer thread loops through reading the sensors and sets the outputs. The Consumer thread executes functions containing timed loops that poll the Producer for current data and execute movement commands as required. The UI thread polls both threads for updating some gauges indicating current test progress.</p><p><strong>Unsure where to start</strong></p><p>Is there a more appropriate pattern for this type of application?</p><p>Are there any good resources for writing control loops in software (non-LabVIEW) that interface with external sensors and whatnot?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This is a good question that relies heavily on context. My approach will be to describe the patterns available for your review. The following is a high-level overview.</p><p>I&#39;m looking in the pinnacle book <em>Design Patterns - Elements of Reusable Object-Oriented Software</em>, by Gamma, Helm, Johnson, and Vlissides. It is written for C++ but would be largely applicable in C#.</p><ol><li><p>Anti-Pattern. One down-side to design patterns is the potential to apply them just for the sake of doing so. It is important to realize that these patterns solve specific problems, and should not be implemented unless that problem exists. Doing so would be an anti-pattern.</p></li><li><p>Facade. &#39;Provide a unified interface to a set of interfaces in a subsystem.&#39; This sounds potentially useful for you to group all of your disparate Objects into a single interface. This will simplify your ability to access them should they all be grouped into a &#39;Singleton&#39; called, something like, Sensors or Consumers.</p></li><li><p>Singleton. Guarantee a single instance of an object. This may be helpful in collaboration with other patterns. This can be commonly used as Manager object, or a Proxy, for example.</p></li><li><p>Proxy. &#39;Provide a surrogate placeholder to control access.&#39; This may be helpful to review to abstract your connection points.</p></li><li><p>Chain of Responsibility, Observer, Publisher Subscriber. These are the notion of decoupling interface dependencies. One of these may be helpful for you between your Producer Consumer so that your producer is not hung up waiting for a consumer to run, or respond. Instead what can happen is the events allow a separation between the two.</p></li><li><p>Strategy. &#39;A family of algorithms, encapsulate each one, and make them interchangable.&#39; This may be helpful for you if you have different behaviors that need to change dynamically for different states.</p></li><li><p>Iterator. This may provide some optimization for your accumulation of loops.</p></li></ol><p>Again, this is a high level overview. I am certain that some of these will not be a good fit for your implementation, but reviewing them <em>can</em> give a good idea of what optimization&#39;s are available.</p><p>Lastly, keep in mind that these patterns are best applied at Design Time. If you have a rather robust legacy implementation a high level of complex refactoring would be a reasonable expectation.</p><p>Also take a look around for C# specific patterns. Often times the original patterns posed above morph as they transcend languages. They may be essentially the same pattern, but with different implementation specific requirements, they can change names. Like PubSub/Observer.</p><p>Hope that helps.
All the best!
Nash</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/an-enterprise-automated-deployment-tool/'>An Enterprise/Automated Deployment tool</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/what-does-automated-build-mean/'>What does &#8220;automated build&#8221; mean</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/unit-testing-real-time-unit-testing-or-how-to-mock-now/'>Unit-testing &#8211; Real time unit testing &#8211; or &#8220;how to mock now&#8221;</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>