<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; How to deal with static utility classes when designing for testability &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064701 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064701" class="post-1064701 software type-software status-publish hentry category-software tag-java tag-static-methods tag-tdd tag-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; How to deal with static utility classes when designing for testability</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">java</span><span class="mr-2 badge badge-info">static methods</span><span class="mr-2 badge badge-warning">tdd</span><span class="mr-2 badge badge-primary">testing</span></p><div class="entry-content"><p>We are trying to design our system to be testable and in most parts developed using TDD. Currently we are trying to solve the following problem:</p><p>In various places it is necessary for us to use static helper methods like ImageIO and URLEncoder (both standard Java API) and various other libraries that consist mostly of static methods (like the Apache Commons libraries). But it is extremely difficult to test those methods that use such static helper classes.</p><p>I have several ideas for solving this problem:</p><ol><li>Use a mock framework that can mock static classes (like PowerMock). This may be the simplest solution but somehow feels like giving up.</li><li>Create instantiable wrapper classes around all those static utilities so they can be injected into the classes that use them. This sounds like a relatively clean solution but I fear we&#39;ll end up creating an awful lot of those wrapper classes.</li><li>Extract every call to these static helper classes into a function that can be overridden and test a subclass of the class I actually want to test.</li></ol><p>But I keep thinking that this just has to be a problem that many people have to face when doing TDD &#8211; so there must already be solutions for this problem.</p><p>What is the best strategy to keep classes that use these static helpers testable?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>(No &#34;official&#34; sources here, I&#39;m afraid - it&#39;s not like there&#39;s a specification for how to test well. Just my opinions, which will hopefully be useful.)</p><p>When these static methods represent <em>genuine</em> dependencies, create wrappers. So for things like:</p><ul><li>ImageIO</li><li>HTTP clients (or anything else network-related)</li><li>The file system</li><li>Getting the current time (my favourite example of where dependency injection helps)</li></ul><p>... it makes sense to create an interface.</p><p>But many of the methods in Apache Commons probably <em>shouldn&#39;t</em> be mocked/faked. For example, take a method to join together a list of strings, adding a comma between them. There&#39;s <em>no point</em> in mocking these - just let the static call do its normal work. You don&#39;t want or need to replace the normal behaviour; you&#39;re not dealing with an external resource or something that&#39;s hard to work with, it&#39;s just data. The result is predictable and you&#39;d never want it to be anything <em>other</em> than what it&#39;ll give you anyway.</p><p>I suspect that having removed all the static calls which really are <em>convenience</em> methods with predictable, &#34;pure&#34; outcomes (like base64 or URL encoding) rather than entry points into a whole big mess of logical dependencies (like HTTP) you&#39;ll find it&#39;s entirely practical to do the right thing with the genuine dependencies.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-mocking-static-methods/'>Java &#8211; Mocking static methods</a></li><li class="list-group-item"><a href='../java-how-and-should-i-unit-test-an-entire-package/'>Java &#8211; how and should I &#8216;unit test&#8217; an entire package</a></li><li class="list-group-item"><a href='../java-is-creating-the-objects-you-think-you-will-need-ok-in-a-first-test-in-tdd/'>Java &#8211; Is creating the objects you think you will need ok in a first test in TDD</a></li><li class="list-group-item"><a href='../java-converting-static-utility-class-into-singleton/'>Java &#8211; Converting static utility class into singleton</a></li><li class="list-group-item"><a href='../java-is-static-interface-a-good-practice/'>Java &#8211; Is &#8220;static interface&#8221; a good practice</a></li><li class="list-group-item"><a href='../unit-testing-unit-testing-utility-classes/'>Unit-testing &#8211; Unit testing utility classes</a></li><li class="list-group-item"><a href='../java-wrapping-utility-classes-and-injecting-them-for-unit-testing-purposes/'>Java &#8211; Wrapping utility classes and injecting them for unit testing purposes</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>