<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Get rid of long/Complex if..else statements using Chain of Responsibility &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076425 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076425" class="post-1076425 software type-software status-publish hentry category-software tag-asp-net tag-c tag-design-patterns tag-refactoring"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Get rid of long/Complex if..else statements using Chain of Responsibility</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asp.net</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">design-patterns</span><span class="mr-2 badge badge-primary">refactoring</span></p><div class="entry-content"><p>I&#39;ve an HttpHandler, which allows users to login to a system by passing in an encrypted code.</p><p>Inside the <code>ProcessRequest</code> it performs quite a few steps.</p><ol><li>Retrieve the encrypted code from request (could be in Form/X-Header/Query)</li><li>Decrypt it. (Results in an JSON string)</li><li>Deserialize to a dynamic type</li><li>Determine the type of request, could be login/register/activate</li><li>Validate request</li><li>Load user subscription</li><li>Load User entity</li><li>If Req.Type = Login -&gt; Login using FormsAuth</li><li>If Req.Type = Register -&gt; Create user</li><li>If Req.Type = Register -&gt; Send Activation email</li></ol><p>This goes on. Currently this is something like a long if/else statement which I&#39;m trying to refactor.<br /> I&#39;m thinking of using the Chain Of Responsibility pattern to convert these steps in if/else to a chain which executes sequentially.<br /> However, this will be different from original CoR as only last few steps will actually &#34;handle&#34; the request, first steps will just do some pre-processing and make stage for last steps to perform it&#39;s job.</p><p>My main problem is, different steps in the chain will work on different input data. First few steps (Decryption, Deserialization, etc) will work on strings while latter half should ideally work on deserialized dynamic object. I don&#39;t like the way it sounds.</p><p>Am I trying to fit a round lid to an square bottle? Is this not a scenario where CoR can/should be applied? Are there any other patterns/strategies I could use to solve such scenarios.</p><p>I thought of using the decorator pattern as well, but that doesn&#39;t suite me very well, as I&#39;d like to be able to switch certain steps in and out (ex: email activation) for some scenarios.</p><p>NOTE: I&#39;ve seen <a href="https://codereview.stackexchange.com/questions/4250/refactor-if-into-chain-of-responsibility-pattern">this question</a> as well, but not sure if it answers my question.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Your ProcessRequest method is doing too much in one block of code. <strong>Chain of Responsibility</strong> is an inappropriate pattern because some of these steps are mandatory and some are alternatives.</p><p>Look at the last 3 steps - 8 to 10.  Your main method should not care what has to be done for each individual type of request.  All that should be happening here is</p><ol><li>Is the request type in my set of permitted types?</li><li>If yes, invoke the corresponding class</li><li>If no, handle the error.</li></ol><p>That&#39;s going to be a very short block of code.  It does require you, somewhere else in your code, to create your request-type-specific class (and subclasses) and the set to contain them, but the benefit is that this block of code in your main method need never change.</p><p>Step 5 should be a method of the type-specific class.</p><p>Steps 6 and 7 can probably be encapsulated in a User object but also only mean something for existing users, so the User-object handling stuff should go inside the type-specific class.</p><p>So we&#39;ve already reduced the code to</p><ol><li>Retrieve the encrypted code from request (could be in Form/X-Header/Query)</li><li>Decrypt it. (Results in an JSON string)</li><li>Deserialize to a dynamic type</li><li>Determine the type of request, could be login/register/activate</li><li>if type in set-of-allowed-types then request-type = new type-specific-class else fail.</li><li>if not request-type.validate() then fail</li><li>request-type.dostuff()</li></ol><p>See?  No patterns involved.  If-then-else chains are a bad smell, yes, but they can usually be replaced with a set of valid options or a switch statement.  Try that simple approach before going all pattern-mad.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-how-to-implement-a-step-builder-for-which-the-order-of-setters-doesnt-matter/'>Java: How to implement a step builder for which the order of setters doesn&#8217;t matter</a></li><li class="list-group-item"><a href='../c-refactoring-many-else-if-else-if-else-if-etc-statements/'>C# &#8211; Refactoring many else if, else if, else if, etc. statements</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>