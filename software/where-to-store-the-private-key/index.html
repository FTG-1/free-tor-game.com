<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Where to store the private key &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1063650 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1063650" class="post-1063650 software type-software status-publish hentry category-software tag-cryptography tag-security"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Where to store the private key</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">cryptography</span><span class="mr-2 badge badge-info">Security</span></p><div class="entry-content"><p>Say I want some parts of my software to be encrypted. For example, the credentials for a database, etc. I need to store those values somewhere, but doing so in cleartext would make it easy for an attacker to gain unauthorised access.</p><p>However, if I encrypt some cleartext, then where do I store the key? Anything that software has access to, a determined attacker would have access to, no matter what level of obfuscation:</p><ul><li>Say the key is protected by the filesystem&#39;s security model; but what about (malicious) superusers, or platforms that don&#39;t provide such fidelity?</li><li>Or the key is hardcoded into software binaries, but it could always be decompiled and what about open source software or interpreted code?</li><li>If the key is generated, such an algorithm would need to be deterministic (presumably) and then the same problem applies to the seed.</li><li>etc.</li></ul><p>Cryptography is only as strong as the weakest link in its chain and this seems like a pretty loose one! Presuming it&#39;s the right tool for the job (humour me), then how can one secure such information robustly?</p><hr/><p>Regarding the right tool for the job: Probably, in &#8212; for example &#8212; the case of service access (DBs, authentication servers, etc.), you would restrict access at this tier with a service account, maybe with some service-level auditing, etc. and so having the credentials in cleartext isn&#39;t such a worry.</p><p>To me, however, that still seems inadequate: I don&#39;t want anyone poking around where they shouldn&#39;t be!</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>First of all, I would not refer to myself as a security expert, but I have been in the position of having to answer this question.  What I found out surprised me a bit: <em>There is no such thing as a completely secure system</em>.  Well, I guess a completely secure system would be one where the servers are all turned off :)</p><p>Someone working with me at the time described designing a secure system in terms of <em>raising the bar</em> to intruders.  So, each layer of securing decreases the opportunity for an attack.</p><p>For example, even if you could perfectly secure the private key, the system is not <em>completely</em> secure.  But, correctly using the security algorithms and being up to date with patches raises the bar.  But, yes, a super computer powerful enough and given enough time can break encryption.  I&#39;m sure all of this is understood, so I&#39;ll get back the question.</p><p>The question is clear so I&#39;ll first try to address each of your points:</p><blockquote><p>Say the key is protected by the filesystem&#39;s security model; but what
 about (malicious) superusers, or platforms that don&#39;t provide such
 fidelity?</p></blockquote><p>Yes, if you use something like <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb204778(v=vs.85).aspx" rel="noreferrer">Windows Key Store</a> or a password encrypted TLS private key you are exposed to the users that have the password (or access) to the private keys.  But, I think you will agree that raises the bar.  The file system ACLs (if implemented properly) provide a pretty good level of protection.  And you are in the position to personally vet and know your super users.</p><blockquote><p>Or the key is hardcoded into software binaries, but it could always be
 decompiled and what about open source software or interpreted code?</p></blockquote><p>Yes, I&#39;ve seen hardcoded keys in binaries.  Again, this does raise the bar a bit.  Someone attacking this system (if it is Java) has to understand that Java produces byte code (etc) and must understand how to decompile it are read it.  If you are using a language that writes directly to machine code, you can see that this raises the bar a bit higher.  It is not an ideal security solution, but could provide some level of protection.</p><blockquote><p>If the key is generated, such an algorithm would need to be
 deterministic (presumably) and then the same problem applies to the
 seed.</p></blockquote><p>Yes, essentially then the algorithm becomes the private key information for creating the private key.  So, it would need to now be protected.</p><p>So, I think you have identified a core issue with any security policy, <strong>key management</strong>.  Having a key management policy in place is central to providing a secure system.  And, it is a <a href="http://en.wikipedia.org/wiki/Key_management" rel="noreferrer">pretty broad topic</a>.</p><p>So, the question is, how secure does your system (and, therefore the private key) need to be? How high, in your system, does the bar need to be raised?</p><p>Now, if you willing to pay, there are some people out there that produce solutions to this.  We ended up using an <a href="http://en.wikipedia.org/wiki/Hardware_security_module" rel="noreferrer">HSM (Hardware Security Module)</a>.  It is basically a tamper-proof server that contains a key in hardware.  This key can then be used to create other keys used for encryption.  The idea here is that (if configured correctly), the key <em>never leaves</em> the HSM.  HSMs cost <em>a lot</em>.  But in some businesses (protecting credit card data lets say), the cost of a breach is much higher.  So, there is a balance.</p><p>Many HSMs use key cards from maintenance and admin of the features.  A quorum of key cards (5 of 9 lets say) have to be physically put into the server in order to change a key.  So, this raises the bar pretty high by only allowing a breach if a quorum of super users collude.</p><p>There may be software solutions out there that provide similar features to an HSM but I&#39;m not aware of what they are.</p><p>I know this only goes some way to answering the question, but I hope this helps.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-i-need-advice-developing-a-sensitive-data-transfer-storage-encryption-system/'>C# &#8211; I need advice developing a sensitive data transfer/storage/encryption system</a></li><li class="list-group-item"><a href='../how-to-manage-the-private-key-for-signing-net-assemblies/'>How to manage the private key for signing .NET assemblies</a></li><li class="list-group-item"><a href='../how-to-securely-implement-auto-login/'>How to securely implement auto-login</a></li><li class="list-group-item"><a href='../where-to-store-hashes-salts-keys-in-desktop-applications/'>Where to store hashes, salts, keys in Desktop Applications</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>