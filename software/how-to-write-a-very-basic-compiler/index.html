<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How to write a very basic compiler &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1062864 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1062864" class="post-1062864 software type-software status-publish hentry category-software tag-c tag-compilation tag-compiler tag-gcc"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How to write a very basic compiler</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">compilation</span><span class="mr-2 badge badge-warning">compiler</span><span class="mr-2 badge badge-primary">gcc</span></p><div class="entry-content"><p>Advanced compilers like <code>gcc</code> compile codes into machine readable files according to the language in which the code has been written (e.g. C, C++, etc). In fact, they interpret the meaning of each codes according to library and functions of the corresponding languages. Correct me if I&#39;m wrong.</p><p>I wish to better understand compilers by writing a very basic compiler (probably in C) to compile a static file (e.g. Hello World in a text file). I tried some tutorials and books, but all of them are for practical cases. They deal with compiling dynamic codes with meanings connected with the corresponding language.</p><p>How can I write a basic compiler to convert a static text into a machine readable file?</p><p>The next step will be introducing variables into the compiler; imagine that we want to write a compiler which compile only some functions of a language.</p><p>Introducing practical tutorials and resources is highly appreciated ðŸ™‚</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><h2>Intro</h2><p>A typical compiler does the following steps:</p><ul><li>Parsing: the source text is converted to an abstract syntax tree (AST).</li><li>Resolution of references to other modules (C postpones this step till linking).</li><li>Semantic validation: weeding out syntactically correct statements that make no sense, e.g. unreachable code or duplicate declarations.</li><li>Equivalent transformations and high-level optimization: the AST is transformed to represent a more efficient computation with the same semantics. This includes e.g. early calculation of common subexpressions and constant expressions, eliminating excessive local assignments (see also <a href="https://en.wikipedia.org/wiki/Static_single_assignment_form" rel="noreferrer">SSA</a>), etc.</li><li>Code generation: the AST is transformed into linear low-level code, with jumps, register allocation and the like. Some function calls can be inlined at this stage, some loops unrolled, etc.</li><li>Peephole optimization: the low-level code is scanned for simple local inefficiencies which are eliminated.</li></ul><p>Most modern compilers (for instance, gcc and clang) repeat the last two steps once more. They use an intermediate low-level but platform-independent language for initial code generation. Then that language is converted into platform-specific code (x86, ARM, etc) doing roughly the same thing in a platform-optimized way. This includes e.g. the use of vector instructions when possible, instruction reordering to increase branch prediction efficiency, and so on.</p><p>After that, object code is ready for linking. Most native-code compilers know how to call a linker to produce an executable, but it&#39;s not a compilation step per se. In languages like Java and C# linking may be totally dynamic, done by the VM at load time.</p><h2>Remember the basics</h2><ul><li>Make it work</li><li>Make it beautiful</li><li>Make it efficient</li></ul><p>This classic sequence applies to all software development, but bears repetition.</p><p>Concentrate on the first step of the sequence. Create the simplest thing that could possibly work.</p><h2>Read the books!</h2><p>Read the <a href="https://rads.stackoverflow.com/amzn/click/com/0321486811" rel="noreferrer" rel="nofollow noreferrer">Dragon Book</a> by Aho and Ullman. This is classic and is still quite applicable today.</p><p><a href="https://rads.stackoverflow.com/amzn/click/com/0471976970" rel="noreferrer" rel="nofollow noreferrer">Modern Compiler Design</a> is also praised.</p><p>If this stuff is too hard for you right now, read some intros on parsing first; usually parsing libraries include intros and examples.</p><p>Make sure you&#39;re comfortable working with graphs, especially trees. These things is the stuff programs are made of on the logical level.</p><h2>Define your language well</h2><p>Use whatever notation you want, but make sure you have a complete and consistent description of your language. This includes both syntax and semantics.</p><p>It&#39;s high time to write snippets of code in your new language as test cases for the future compiler.</p><h2>Use your favorite language</h2><p>It&#39;s totally OK to write a compiler in Python or Ruby or whatever language is easy for you. Use simple algorithms you understand well. The first version does not have to be fast, or efficient, or feature-complete. It only needs to be correct enough and easy to modify.</p><p>It&#39;s also OK to write different stages of a compiler in different languages, if needed.</p><h3>Prepare to write a lot of tests</h3><p>Your entire language should be covered by test cases; effectively it will be <em>defined</em> by them. Get well-acquainted with your preferred testing framework. Write tests from day one. Concentrate on &#39;positive&#39; tests that accept correct code, as opposed to detection of incorrect code.</p><p>Run all the tests regularly. Fix broken tests before proceeding. It would be a shame to end up with an ill-defined language that cannot accept valid code.</p><h2>Create a good parser</h2><p><a href="http://en.wikipedia.org/wiki/Comparison_of_parser_generators" rel="noreferrer">Parser generators are many</a>. Pick whatever you want. You may also write your own parser from scratch, but it only worth it if syntax of your language is <em>dead</em> simple.</p><p>The parser should detect and report syntax errors. Write a lot of test cases, both positive and negative; reuse the code you wrote while defining the language.</p><p>Output of your parser is an abstract syntax tree.</p><p>If your language has modules, the output of the parser may be the simplest representation of &#39;object code&#39; you generate. There are plenty of simple ways to dump a tree to a file and to quickly load it back.</p><h2>Create a semantic validator</h2><p>Most probably your language allows for syntactically correct constructions that may make no sense in certain contexts. An example is a duplicate declaration of the same variable or passing a parameter of a wrong type. The validator will detect such errors looking at the tree.</p><p>The validator will also resolve references to other modules written in your language, load these other modules and use in the validation process. For instance, this step will make sure that the number of parameters passed to a function from another module is correct.</p><p>Again, write and run a lot of test cases. Trivial cases are as indispensable at troubleshooting as smart and complex.</p><h2>Generate code</h2><p>Use the simplest techniques you know. Often it&#39;s OK to directly translate a language construct (like an <code>if</code> statement) to a lightly-parametrized code template, not unlike an HTML template.</p><p>Again, ignore efficiency and concentrate on correctness.</p><h3>Target a platform-independent low-level VM</h3><p>I suppose that you ignore low-level stuff unless you&#39;re keenly interested in hardware-specific details. These details are gory and complex.</p><p>Your options:</p><ul><li>LLVM: allows for efficient machine code generation, usually for x86 and ARM.</li><li>CLR: targets .NET, multiplatform; has a good JIT.</li><li>JVM: targets Java world, quite multiplatform, has a good JIT.</li></ul><h2>Ignore optimization</h2><p>Optimization is hard. Almost always optimization is premature.
Generate inefficient but correct code. Implement the whole language before you try to optimize the resulting code.</p><p>Of course, trivial optimizations are OK to introduce. But avoid any cunning, hairy stuff before your compiler is stable.</p><h2>So what?</h2><p>If all this stuff is not too intimidating for you, please proceed! For a simple language, each of the steps may be simpler than you might think.</p><p>Seeing a &#39;Hello world&#39; from a program that your compiler created might be worth the effort.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../python-general-rules-for-writing-a-x-compiler-to-z-in-y/'>Python &#8211; General rules for writing a X compiler to Z in Y</a></li><li class="list-group-item"><a href='../are-c-object-files-created-with-different-compilers-binary-compatible/'>Are (C) object files created with different compilers binary-compatible</a></li><li class="list-group-item"><a href='../does-an-interpreter-produce-machine-code/'>Does an interpreter produce machine code</a></li><li class="list-group-item"><a href='../is-it-possible-to-create-a-bootstrapped-interpreter-independent-of-the-original-interpreter/'>Is it possible to create a &#8220;bootstrapped&#8221; interpreter independent of the original interpreter</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>