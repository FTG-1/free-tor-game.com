<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Microservices session data when communicating internally &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1072530 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1072530" class="post-1072530 software type-software status-publish hentry category-software tag-authentication tag-authorization tag-microservices tag-services"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Microservices session data when communicating internally</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">authentication</span><span class="mr-2 badge badge-info">authorization</span><span class="mr-2 badge badge-warning">microservices</span><span class="mr-2 badge badge-primary">services</span></p><div class="entry-content"><p>I&#39;m not sure the title is correct, so please advise if you think of a better title.</p><p>The scenario is:</p><ol><li>We have an API gateway that exposes REST API to our clients (web and<br /> mobile apps).</li><li>We have a &#34;sessions&#34; microservice that keeps track of<br /> the logged in users. When a user logs in, a new session is stored in<br /> this microservice, and for each request that requires<br /> authentication, the API GW first communicates with this microservice<br /> to validate the session token and get session related information<br /> (user id, permissions list etc.)</li><li>The API GW after validating the<br /> session performs some calls to other microservices that are required<br /> to fulfill the request, but some of them needs the logged in user<br /> ID.</li></ol><p>A simple example is a blogs website, where the logged in user wants to add a post to his blog.</p><ol><li>Performs a POST to /posts with his new blog post and the session token (unique session ID)</li><li>The request reaches the API GW.</li><li>The API GW checks the session token against the sessions microservice that validates the token and returns the session data (user id, permissions)</li><li><strong>The API GW now need to send a request to the posts microservice to add the post to the user.</strong></li></ol><p>The question is about the <strong>4th</strong> step &#8211; what would be considered <strong>a better practice</strong>:</p><ul><li><p>Sending the user ID as part of the post object, meaning, the post service does not handle any authentication / autharization, it simply stores the object after basic validation of the object.</p><p><strong>OR</strong></p></li><li><p>Using some sort of JWT that contains the sessions information and pass it with the blog post to the posts service, that must then validate the JWT and use the user ID from the JWT when storing the post data that was passed without any user ID in it?</p></li></ul></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p><strong>Use Both.</strong></p><p>First, JWT should not be used to replace your client-side session. They were made to solve a different problem. For more details visit the reference link.</p><p>Reference Link <a href="http://cryto.net/~joepie91/blog/2016/06/13/stop-using-jwt-for-sessions/" rel="nofollow noreferrer">http://cryto.net/~joepie91/blog/2016/06/13/stop-using-jwt-for-sessions/</a></p><p>I had the same question a while ago. The way I solved my problem was the following:</p><p><strong>Store the sessions on the backend (High Available Key-value store with constant time complexity O(1) ) and use the JWT to store the user id or the session id so you can retrieve in the backend.</strong></p><p>This link has an interesting implementation. <a href="https://sequoia.makes.software/session-management-with-microservices/" rel="nofollow noreferrer">https://sequoia.makes.software/session-management-with-microservices/</a></p><p>There are a couple of variations to this. The main concept to remember is to use the right tools for the job and TRY to keep it simple.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../populate-user-info-between-services-on-microservices-architecture/'>Populate User info between services on microservices architecture</a></li><li class="list-group-item"><a href='../cookie-based-vs-session-vs-token-based-vs-claims-based-authentications/'>Cookie-based vs Session vs Token-based vs Claims-based authentications</a></li><li class="list-group-item"><a href='../architecture-verifying-access-token-in-each-service-of-a-microservice-architecture/'>Architecture &#8211; Verifying Access Token in Each Service of a Microservice Architecture</a></li><li class="list-group-item"><a href='../how-to-efficiently-pass-permissions-that-control-view-and-access-of-specific-front-end-elements-from-backend-to-the-spa-using-jwt/'>How to efficiently pass permissions that control view and access of specific front-end elements from backend to the SPA using JWT</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>