<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; share method logic along classes without inheriting from abstract class &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074840 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074840" class="post-1074840 software type-software status-publish hentry category-software tag-c tag-inheritance tag-interfaces tag-multiple-inheritance tag-programming-logic"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; share method logic along classes without inheriting from abstract class</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">inheritance</span><span class="mr-2 badge badge-warning">interfaces</span><span class="mr-2 badge badge-primary">multiple-inheritance</span><span class="mr-2 badge badge-danger">programming-logic</span></p><div class="entry-content"><p>In some languages (e.g. C#) a class can only ever have 1 base class which seems like a problem for what I&#39;m trying to do. I will give you an example of what i&#39;m trying to do, hopefully this will make my problem clear.</p><p>I have got a lot of data objects, some of these data objects have an hierarchy, they can have a parent or a child. For these classes I created an abstract class which has 2 lists (1 of the parents and one of the children) it also has a few methods: <code>AddChild()</code>, <code>AddParent()</code>, <code>RemoveChild()</code>, <code>RemoveParent()</code>.</p><p>quick example:</p><pre><code> Owner.AddChild(child):&lt;br&gt;
 Adds the child to the collection of childs of &#39;Owner&#39;&lt;br&gt;
 It also adds &#39;Owner&#39; to the collection of parents of &#39;child&#39;.
</code></pre><p>To make sure all classes which have hierarchical components do this I created an abstract class which they all inherit so no one forgets to do it both ways.</p><p>I have also made a class for objects I want to update.<br /> This is an abstract class not necessarily for the update part but for the equals part since I need all these classes to overwrite the <code>Equals(object obj)</code> method and <code>GetHashcode()</code> method and you cannot define an override in an interface (at lest not in C#)</p><p>Now clearly I&#39;m going at this all wrong, thus my question how do I design my classes so they do get the functionality they need (and share with other classes) without creating an abstract class.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>To make sure all classes which have hierarchical components do this I
 created an abstract class which they all inherit <strong>so no one forgets to
 do it both ways.</strong></p></blockquote><p>An <a href="https://msdn.microsoft.com/en-us/library/87d83y5b.aspx" rel="noreferrer">interface</a> would also &#34;remind&#34; developers to add those methods.</p><blockquote><p>.. how do I design my classes so they do get the functionality they
 need (and share with other classes) without creating an abstract
 class.</p></blockquote><p>If the amount of duplicative code is small or simple, use an interface and just force inheritors to write their own implementations. In your example, <code>AddChild()</code>, <code>AddParent()</code>, <code>RemoveChild()</code>, and <code>RemoveParent()</code> all seem pretty straightforward and simple to build.</p><p>But, if the implementations are difficult for you to repeat, you could provide an &#34;inner&#34; class (like <code>TreeNode</code>) for inheritors to wrap:</p><pre><code>class DomNodeOrSomething&lt;T&gt; : ITreeNode
{
  private TreeNode data = new TreeNode&lt;T&gt;();

  void AddChild(T item)
  {
    data.AddChild(item);
  }

  void AddParent(T item)
  {
    data.AddParent(item);
  }

  void RemoveChild(T item)
  {
    data.RemoveChild(item);
  }

  void RemoveParent(T item)
  {
    data.RemoveParent(item);
  }
}
</code></pre><p>And, if that doesn&#39;t float your boat, use <a href="https://msdn.microsoft.com/en-us//library/bb383977.aspx" rel="noreferrer">extension methods</a>.</p><p>In the example from MS, a <code>WordCount()</code> method is added to the <code>String</code> interface. When this namespace is included, all <code>String</code>&#39;s will &#34;automagically&#34; have a <code>.WordCount()</code> method dangling off them.</p><pre><code>namespace ExtensionMethods
{
    public static class MyExtensions
    {
        public static int WordCount(this String str)
        {
            return str.Split(new char[] { &#39; &#39;, &#39;.&#39;, &#39;?&#39; }, 
                             StringSplitOptions.RemoveEmptyEntries).Length;
        }
    }   
}
</code></pre><p>I believe you can do the same sort of thing for any interface. Something like:</p><pre><code>namespace ExtensionMethods
{
  public static class TreeNodeExtensions
  {
    public static void AddChild(this ITreeNode self, ITreeNode item)
    {
      self.children.add(item);
    }
  }
}
</code></pre><p>This would still require that the <code>ITreeNode</code> interface force inheritors to provide common properties that the extension methods can manipulate.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-switching-from-abstract-class-to-interface/'>Php &#8211; Switching from abstract class to interface</a></li><li class="list-group-item"><a href='../object-oriented-class-design-for-calling-the-same-method-on-different-classes-from-one-place/'>Object-oriented &#8211; Class design for calling &#8220;the same method&#8221; on different classes from one place</a></li><li class="list-group-item"><a href='../object-oriented-child-class-accessing-its-parents-method-from-ancestor-method/'>Object-oriented &#8211; Child class accessing its parent&#8217;s method from Ancestor method</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>