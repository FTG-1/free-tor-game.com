<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; Exception handling in Python &#8211; Am I doing this wrong (and why?) &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1065906 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1065906" class="post-1065906 software type-software status-publish hentry category-software tag-exceptions tag-python"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; Exception handling in Python &#8211; Am I doing this wrong (and why?)</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">exceptions</span><span class="mr-2 badge badge-info">python</span></p><div class="entry-content"><p>I&#39;ve read many questions and articles on exception handling in Python (and in general), but I still think that it&#39;s the most confusing thing ever. I ended up doing something like this:</p><pre><code># error class for exceptions specific to this script
class MyError(Exception): pass

# error class for exceptions in MyClass,
# which can be used from outside of this script
class MyClassError(Exception): pass

class MyClass:
    ...
    # class has method that takes a function as a parameter
    def method(self, param_function):
        ...
        param_function(a, b, c, d)
        try:
            some_other_funtion(arg)
        except ValueError, e:
            raise MyClassError(&#34;Some message&#34;)
        ...

# outside of MyClass
if __name__ == &#34;__main__&#34;:

    # read input from console etc.
    # ...   

    def function(a, b, c, d):
       # ....
        try:
            # something with a
        except ValueError, e:
            raise MyError(&#34;My message:&#34; + a)
        try:
            # something with b
        except ValueError, e:
            raise MyError(&#34;My message:&#34; + b)
       try:
            # something with c
        except ValueError, e:
            raise MyError(&#34;My message:&#34; + c)
        try:
            # something with d 
        except ValueError, e:
            raise My Error(&#34;My slightly different message:&#34; + d)  

    x = MyClass()
    try:
        x.method(function)     
    except (IOError, MyError, MyClassError) as e:
        print e
</code></pre><p><strong>Explanation:</strong></p><p>I want the user of the script to just get a user-friendly message if the error is a result of him passing the wrong input.<br /> The messages with which I raise my custom exceptions are user-friendly, and they (in my opinion) contain all the information I want the user to see.</p><p>That&#39;s also the reason why I&#39;m handling IOError in a similar manner. I expect an IOError only if the user provides a wrong filename, and I want him to see something like &#34;File not found: name of the file&#34; and nothing more.</p><p><strong>Why this seems wrong:</strong></p><p>In my main function, in <code>function</code>, I&#39;m basically surrounding every line of code with a try-catch, and handling every exception in a similar manner &#8211; sometimes the message the user should see is a little different, but mostly the only difference is the parameter in the message.</p><p><strong>Questions:</strong></p><p>Am I handling my exceptions in the right places?<br /> Am I handling them in the right way?<br /> Is the code duplication that I&#39;m doing in <code>function</code> neccessary?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>User input sucks. You can&#39;t trust those users to get anything right, and so you&#39;ve got to handle all kinds of special cases that make your life difficult. Having said that, we can minimize the difficulty with general principles.</p><h1>Validate early, not often</h1><p>Check input for validity as soon as it read into your program. If you read in a string that should be a number, convert it into a number right away and complain to the user if it isn&#39;t a number. Any rogue data you don&#39;t verify at input will make its way into the rest of the program and produce bugs.</p><p>Now, you can&#39;t always do this. There will be cases where you can&#39;t verify the correct properties right away, and you&#39;ll have to verify them during later processing. But you want as much verification to happen as early as possible so that you have your special cases around input logic centralized to one location as much as possible.</p><h1>Use Schemas</h1><p>Let&#39;s consider a function that parses some json.</p><pre><code>def parse_student(text):
    try: 
        data = json.parse(text)
    except ValueError as error:
        raise ParseError(error)

    if not isinstance(data, dict):
        raise ParseError(&#34;Expected an object!&#34;)
    
    try:
        name = data[&#39;name&#39;]
    except KeyError:
        raise ParseError(&#39;Expected a name&#39;)

    if not isinstance(name, dict):
       raise ParseError(&#34;Expected an object for name&#34;)

    try:
        first = name[&#39;first&#39;]
    except KeyError:
        raise ParseError(&#34;Expected a first name&#34;)
    
    if not isinstance(first, basestring):
        raise ParseError(&#34;Expected first name to be a string&#34;)
    
    if first == &#39;&#39;:
        raise ParseError(&#34;Expected non-empty first name&#34;)
</code></pre><p>That was a lot of work just to extract the first name, let alone any other attributes. We can make this a lot better if we can use a json-schema. See: <a href="http://json-schema.org/" rel="nofollow noreferrer">http://json-schema.org/</a>.</p><p>I can describe what my student object looks like:</p><pre><code>{
    &#34;type&#34;: &#34;object&#34;,
    &#34;properties&#34;: {
        &#34;name&#34;: {
            &#34;type&#34;: &#34;object&#34;,
            &#34;properties&#34;: {
                  &#34;first&#34; : {
                       &#34;type&#34; : &#34;string&#34;
                  }
            },
            &#34;required&#34;: &#34;first&#34;
        },
    } 
    &#34;required&#34;: [&#34;name&#34;]
}
</code></pre><p>When I parse I then do something like:</p><pre><code>def parse_student(text):
    try: 
        data = json.parse(text)
    except ValueError as error:
        raise ParseError(error)

    try:
        validate(data, STUDENT_SCHEMA)
    except ValidationError as error:
        raise ParseError(error)

    first = data[&#39;name&#39;][&#39;first&#39;]
</code></pre><p>Checking against the schema verifies must of the structure that I need. If the user input failing the schema, the schema validator will produce a nice error message explaining exactly what was wrong. It will do so far more consistently and correctly then if I wrote the checking code by hand. Once the validation has been passed, I can just grab data out of the json object, because I know that it will have the correct structure.</p><p>Now, you probably aren&#39;t parsing JSON. But you may find that you can do something similar for your format that lets you reuse the basic validation logic across the different pieces of information that you fetch.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-exception-hierarchy-design/'>Java &#8211; Exception hierarchy design</a></li><li class="list-group-item"><a href='../java-smells-in-exception-handling-how-to-separate-between-public-and-internal-exceptions/'>Java &#8211; Smells in exception handling: how to separate between public and internal exceptions</a></li><li class="list-group-item"><a href='../c-sending-exceptions-as-event-arguments/'>C# &#8211; Sending Exceptions as event arguments</a></li><li class="list-group-item"><a href='../c-exception-hierarchy-and-use-of-what-message-for-parsing-strings/'>C++ &#8211; Exception Hierarchy and Use of What Message for Parsing Strings</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>