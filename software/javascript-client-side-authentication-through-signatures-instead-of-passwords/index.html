<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Javascript &#8211; Client side authentication through signatures instead of passwords &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082483 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082483" class="post-1082483 software type-software status-publish hentry category-software tag-authentication tag-client-server tag-encryption tag-javascript tag-passwords"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Javascript &#8211; Client side authentication through signatures instead of passwords</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">authentication</span><span class="mr-2 badge badge-info">client-server</span><span class="mr-2 badge badge-warning">encryption</span><span class="mr-2 badge badge-primary">javascript</span><span class="mr-2 badge badge-danger">passwords</span></p><div class="entry-content"><p>I want to save some user-generated data with some signature of the user that generated it (let&#39;s say that the user has to fill some forms with some data and I want him to sign the written data).</p><p>The server side is some random server language (that has big enough libraries to cover everything I&#39;ll need to do), the client side is Javascript (and the webapp is a SPA, Single Page Application). The client machine can be a cellular (a fairly new smartphone&#8230; but still a slow CPU compared to standard desktops/laptops)</p><p>The DB backend is &#34;insecure&#34;. It is possible to tamper the data (many persons have access to the machine, perhaps it&#39;s &#34;in the cloud&#34;), but there is and a strong sequential continuous backup where it is very difficult to tamper with the already written data (something similar to a secured sequential log) (perhaps a digest of the log is shipped continuously to a secure server, or the sequential log is kept in another cloud totally separate from the first one, or if it only has to save some hashes, even a random machine can do it).</p><p>What I want to be able to do is make very difficult for third parties that have read/write access to the DB machine and read access to the server machine to add/modify records created by the user. For the deletion I&#39;ll do this: the program doesn&#39;t do any real update/delete operation. Every update/delete simply add a new version of the data and marks the old as &#34;old&#34;. The hash of all the data is continuously saved on the tamper proof backup. This will even protect me from updates to old data. The only thing it won&#39;t protect me is against adding new data through spoofing an existing user.</p><p>I will use https to secure transmission (with certificates bought from some SSL cert authority).</p><p>I know I can&#39;t really secure the site (as in &#34;the javascripts that will go to the user&#34;), so that this is a weak point (someone could install a keylogger directly in the javascript code). I&#39;ve watched around but it doesn&#39;t seem possible to sign some javascript code, send it to a client and let the client check the signature (probably because the javascript, being a dynamic language, would let a malicious javascript inject himself in the signed code/in a random piece of the javascript base library, so it would be very difficult to firewall everything the pre-existing environment). I could check the signature from the server side (the server program is signed and sends only javascripts that are signed).</p><p>I don&#39;t want to use client-side SSL certificates because they are difficult to use for the user (if the user changes computer he has to reinstall the certificate, if the user forgets he has a certificate in a computer it&#39;s possible to steal it&#8230;)</p><p>The solution I thought was to use ECDsa, generate a public/private keypair from the user password (plus some other data) and then the client signs the user&#39;s data client-side. The public/private key generation happens client side. When the user is created and the password is chosen, the client generates the public/private keypair and tells the server the generated public key. The user only needs to remember its password.</p><p>Clearly the weak point of this is that someone could add a new public key of the user on the server and sign something with the new public key, but it would be quite easy to spot this, because there would be a new public key. Something more clever would be to change an old public key and then resign everything the user signed with that new key, so it would be impossible to show if the data was tampered, but for this there is the tamper-proof log.</p><p>Another weak point would be from the user side: someone could install a keylogger and steal the password, but this is a problem of all the &#34;standard&#34; password schemes (for this I&#39;ll add a TOTP authentication, see at the end)</p><p>Password recovery would be handled &#34;manually&#34; (a super-user would have to confirm the identity of the user and then sign the change of the password with the super-user&#39;s key)</p><p>Now let&#39;s make it a little more complex: the private key is generated from the PBKDF2 of a salt unique for each user (sent by the server) plus the user&#39;s password. Sadly to make the software compatible with cell phones I will need to keep the iterations of PBKDF2 low (mmmh&#8230; On my old Optimus W, 1000 iterations require 8 seconds, while with the S3 it&#39;s nearly instantaneous&#8230; But 1000 iterations isn&#39;t very strong) (perhaps I could use Scrypt instead of PBKDF2&#8230; It should be more resistant to GPU attacks)</p><p>So in the end it would be:</p><p>User inserts username and password and press a button. The client asks the server for the salt, for the number of iterations of the hashing function and for the time of the day (this to stop attacks based on reusing the same signature), then calculates the hash of the password by using PBKDF2/Scrypt, regenerates the ECC private key, signs the message (that contains the operation requested and the time of the day received by the server) and sends the signature. The server must remember what challenges he has given and what have been replied (and so are &#34;exhausted&#34;).</p><p>After this I could add a two step verification (using the algorithm used by Google Authenticator, for example). The key of this would be shared between user and server. The one-time password could be inserted in the various messages signed by the client. The server could save the calculated time of the TOTP so that it would be easy to verify at a later time.</p><p>So the question is: is everything ok? Is there a pre-made solution that does everything? Is there an hole in my reasoning?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>The DB backend is &#34;insecure&#34;. It is possible to tamper the data (many persons have access to the machine, perhaps it&#39;s &#34;in the cloud&#34;) [...]</p><p>What I want to be able to do is make very difficult for third parties that have read/write access to the DB machine [...]</p></blockquote><p>Your goal shouldn&#39;t be to make it <em>very difficult</em> for third parties to modify the data from your database. Your goal should be to prevent anyone but the administrators to access both the server and the database.</p><p>What you are doing right now is like giving your bank account number and password to complete strangers and then ask how you make it difficult for those strangers to take your money. Well, you might think of not sharing the account information in the first place.</p><p>It&#39;s also unclear what “in the cloud” has to do with security. Most cloud providers such as Amazon or Microsoft do a great job of hosting virtual machines in a very secure manner.</p><p>Therefore:</p><ul><li><p>Get rid of those “third parties” who can SSH your server with <code>su</code> access. This is the wrong way of hosting web applications. Don&#39;t do that. And if you do, please, inform your users on the website that all personal information they give you can and will be shared with complete strangers.</p></li><li><p>Use TLS. There are no reasons not to use one, especially since free services exist.</p></li><li><p>Don&#39;t trust client-side. No, you can&#39;t sign JavaScript, and in general, on client-side, you can&#39;t protect your users neither from themselves, nor from any crap they install on their machines. Viruses would be able to inject themselves into a browser and modify JavaScript; if you do a mechanism which checks if JavaScript is tampered, they would be able to tamper the checking mechanism itself.</p></li><li><p>While you can encrypt information on client-side, there are few good reasons limited to few cases where you would actually do it. The reason is that, once again, client machine shouldn&#39;t be trusted, because it&#39;s usually difficult for a user to secure his device. The server, on the other hand, can be secured very easily, and with TLS, man in the middle attacks could effectively be prevented.</p></li></ul><p>Thus, ensure both your servers and the communication between the servers and the clients are secure.</p><p>A few notes:</p><blockquote><p>Sadly to make the software compatible with cell phones I will need to keep the iterations of PBKDF2 low [...] (perhaps I could use Scrypt instead of PBKDF2... It should be more resistant to GPU attacks)</p></blockquote><p>This is why you need to compute the hash <em>on the server</em>. If you reduce the number of iterations, you&#39;re making it easier for the attacker to bruteforce the hashes.</p><p>Searching for a different algorithm is a wrong solution here. Remember that an attacker <em>will</em> have powerful CPUs and GPUs. Your goal is to slow an attacker, and you do that by increasing the iterations.</p><blockquote><p>After this I could add a two step verification (using the algorithm used by Google Authenticator, for example). The key of this would be shared between user and server.</p></blockquote><p>Which means that your “third parties” will have full access to those keys. In this context, two-step verification makes things much worse: <strong>it gives you a sense of security, while providing absolutely no benefit.</strong></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../options-for-client-side-encryption-of-local-web-databases/'>Options for client-side encryption of local web databases</a></li><li class="list-group-item"><a href='../javascript-client-side-coding-how-to-prevent-malicious-use/'>Javascript &#8211; Client-side coding: How to prevent malicious use</a></li><li class="list-group-item"><a href='../how-to-implement-simple-secure-client-side-encryption/'>How to implement simple secure client side encryption</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>