<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Unit-testing &#8211; How to unit test method that returns a collection while avoiding logic in the test &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066636 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066636" class="post-1066636 software type-software status-publish hentry category-software tag-collections tag-logic tag-loops tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Unit-testing &#8211; How to unit test method that returns a collection while avoiding logic in the test</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">collections</span><span class="mr-2 badge badge-info">logic</span><span class="mr-2 badge badge-warning">loops</span><span class="mr-2 badge badge-primary">unit testing</span></p><div class="entry-content"><p>I am test-driving a method that is to generate a collection of data objects. I want to verify that the properties of the objects are being set correctly. Some of the properties will be set to the same thing; others will be set to a value which is dependent on their position in the collection. The natural way to do this seems to be with a loop. However, Roy Osherove strongly recommends against using logic in unit tests (<em>Art of Unit Testing</em>, 178). He says:</p><blockquote><p>A test that contains logic is usually testing more than one thing at a time, which isn&#39;t recommended, because the test is less readable and more fragile. But test logic also adds complexity that may contain a hidden bug.</p><p>Tests should, as a general rule, be a series of method calls with no control flows, not even <code>try-catch</code>, and with assert calls.</p></blockquote><p>However, I can&#39;t see anything wrong with my design (how else do you generate a list of data objects, some of whose values are depended on where in the sequence they are?—can&#39;t exactly generate and test them separately). Is there something non-test-friendly with my design? Or am being too rigidly devoted to Osherove&#39;s teaching? Or is there some secret unit test magic I don&#39;t know about that circumvents this problem? (I&#39;m writing in C#/VS2010/NUnit, but looking for language-agnostic answers if possible.)</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>TL;DR:</p><ul><li>Write the test</li><li>If the test does too much, the code may do too much too.</li><li>It may not be a unit test (but not a bad test).</li></ul><hr/><p>The first thing for testing is about dogma being unhelpful.  I enjoy reading <a href="http://www.agitar.com/downloads/TheWayOfTestivus.pdf">The Way of Testivus</a> which points out some issues with dogma in a lighthearted way.</p><blockquote><p>Write the test that needs to be written.</p></blockquote><p>If the the test needs to be written some way, write it that way.  Attempting to force the test into some idealized test layout or not have it at all is not a good thing.  Having a test today that tests it is better than having a &#34;perfect&#34; test some later day.</p><p>I will also point to the bit on the ugly test:</p><blockquote><p>When the code is ugly, the tests may be ugly.</p><p>You don’t like to write ugly tests, but ugly code needs testing the most.</p><p>Don’t let ugly code stop you from writing tests, but let ugly code stop you from writing more of it.</p></blockquote><p>These can be considered truisms to those who have been following for a long time... and they just become ingrained in the way of thinking and writing tests.  For people that haven&#39;t been and are trying to get to that point, reminders can be helpful (I even find re-reading them helps me avoid getting locked into some dogma).</p><hr/><p>Do consider that when writing an ugly test, if the code it may be an indication that the code is trying to do too much too.  If the code that you are testing is too complex to be properly exercised by writing a simple test, you might want to consider breaking the code into smaller parts that can be tested with the simpler tests.  One should not write a unit test that does everything (it might not be a <em>unit</em> test then).  Just as &#39;god objects&#39; are bad, &#39;god unit tests&#39; are bad too and should be indications to go back and look at the code again.</p><p>You <em>should</em> be able to exercise all the code with reasonable coverage through such simple tests.  Tests that do more end to end testing that deal with larger questions (&#34;I have this object, marshalled into xml, sent to the web service, through the rules, back out, and unmarshalled&#34;) is an excellent test - but it certainly isn&#39;t a <em>unit</em> test (and falls into the integration testing realm - even if it has mocked services that it calls and custom in memory databases to do the testing).  It may still use the XUnit framework for testing, but the testing framework doesn&#39;t make it a unit test.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-why-is-it-important-that-a-unit-test-not-test-dependencies/'>Unit-testing &#8211; (Why) is it important that a unit test not test dependencies</a></li><li class="list-group-item"><a href='../unit-testing-assert-message-in-unit-tests/'>Unit-testing &#8211; Assert Message in Unit Tests</a></li><li class="list-group-item"><a href='../unit-testing-how-to-not-test-implementation-when-method-returns-void/'>Unit-testing &#8211; How to not test implementation when method returns void</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>