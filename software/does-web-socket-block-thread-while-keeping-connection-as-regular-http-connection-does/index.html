<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Does Web Socket block thread while keeping connection as regular http connection does &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074292 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074292" class="post-1074292 software type-software status-publish hentry category-software tag-multithreading tag-spring tag-tomcat tag-websockets"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Does Web Socket block thread while keeping connection as regular http connection does</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">multithreading</span><span class="mr-2 badge badge-info">spring</span><span class="mr-2 badge badge-warning">tomcat</span><span class="mr-2 badge badge-primary">websockets</span></p><div class="entry-content"><p>Let&#39;s take Spring web socket (with tomcat) for example.</p><p>Does Web Socket blocks thread while keeping the connection between server and client? (For example, connection can last 2-3 hours).</p><p>(<br /> <strong>Does web socket uses thread the same way as regular http request does (e.g., blocks/owns thread while performing the requests)</strong><br /> )</p><p>Let&#39;s say server configured to have 200 threads in the thread pool and uses blocking io.</p><p>Does it mean that if we have 200 open long-living websocket connections, the server will not be able to handle other regular http requests or web socket connections while those 200 connections are open?</p><p>From tomcat docs (<a href="https://tomcat.apache.org/tomcat-8.5-doc/config/http.html" rel="nofollow noreferrer">https://tomcat.apache.org/tomcat-8.5-doc/config/http.html</a>):</p><blockquote><p><strong>maxThreads</strong></p><p>The maximum number of request processing threads to be created by this<br /> Connector, which therefore determines the maximum number of<br /> simultaneous requests that can be handled. If not specified, this<br /> attribute is set to <strong>200</strong>. If an executor is associated with this<br /> connector, this attribute is ignored as the connector will execute<br /> tasks using the executor rather than an internal thread pool. Note<br /> that if an executor is configured any value set for this attribute<br /> will be recorded correctly but it will be reported (e.g. via JMX) as<br /> -1 to make clear that it is not used.</p></blockquote><p>So this means that if we have 200 long-living web sockets, the server will not able to accept any requests anymore?</p><p>Then, if some web site has huge amount of users, and it needs to server at least 10000 users (which open WebSocket) simultaneously, does this means that it needs 50 servers only for those 10 000 users?</p><p>What about non-blocking io? (Netty, Akka http)</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I created a server with a limited number of max threads before. The solution is to put a cap on the lifetime of the open connections and/or the number of requests that a connection will run before being closed by the server. The client then simply gets back in line to request another connection. This can only work if your client requests are independent and do not require a long lived connection (which should be the case). I used blocking I/O, but had a timeout on receiving request data.</p><p>In my case, I allowed an HTTP connection (handled by a newly spawned thread) to process up to 10 requests and live up to 2 seconds (final request runs to completion, of course), then the thread finishes. This ensures fairness. I used a counting semaphore to limit the number of open connections / threads. I also provided a means for multiple server processes so that in case a server process crashed (which didn&#39;t happen), requests would simply go to another process until the failed one had restarted. I could update the software live that way, sending a hangup signal to tell the server to restart.</p><p>I had a way of monitoring connection status across all of the servers and it worked very smoothly and well. Unix did all the heavy lifting, I just had to learn about and take advantage of what it provided. This was back in 1999.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../many-blocking-vs-single-non-blocking-workers/'>Many Blocking VS Single Non-Blocking Workers</a></li><li class="list-group-item"><a href='../design-patterns-for-multi-threaded-messaging-server/'>Design patterns for multi-threaded messaging server</a></li><li class="list-group-item"><a href='../java-websockets-vs-ajax-call-for-scheduled-event/'>Java &#8211; WebSockets vs Ajax call for scheduled event</a></li><li class="list-group-item"><a href='../do-i-actually-need-a-message-broker-or-are-websockets-enough/'>Do I actually need a message broker or are websockets enough</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>