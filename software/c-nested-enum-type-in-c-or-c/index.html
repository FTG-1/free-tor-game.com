<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Nested Enum type in C++ or C# &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066642 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066642" class="post-1066642 software type-software status-publish hentry category-software tag-c tag-data-structures tag-enum"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Nested Enum type in C++ or C#</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">data structures</span><span class="mr-2 badge badge-warning">enum</span></p><div class="entry-content"><p>I&#39;ve come across a recurring issue in a few of my recent projects in which I find myself using enums to represent state, or type, or something else, and I need to check against a few conditions. Some of these conditions span multiple enums, so I end up with a load of logic in <code>switch</code> and <code>if</code> blocks, which I don&#39;t like. This is a particular problem when having to cast things to and from the enum, like when the enum is being used to check an int that you&#39;re getting from a web request or a calculation.</p><p>Is there something in C++ or C# that can be used as a nested enum? Something like this:</p><pre><code>enum Animal
{
    Mammal
    {
        Cat,
        Dog,
        Bear
    },
    Bird
    {
        Pigeon,
        Hawk,
        Ostrich
    },
    Fish
    {
        Goldfish,
        Trout,
        Shark
    },
    Platypus    //srsly what is that thing
};
</code></pre><p>Obviously, it may or may not be declared like that, but you get the idea. The point is that in code you could use it like <code>Animal thisAnimal = Animal.Mammal.Cat</code> and then later check <code>if (thisAnimal.IsMember(Animal.Mammal))</code> or something like that.</p><p>I&#39;ve seen Java&#39;s EnumSet, and found them pretty useful, but I don&#39;t think they&#39;re an exact match for the functionality I&#39;m after. For this example, you&#39;d have to declare an enum with all the animals at one level, and then add them all to the relevant sets. That would mean that when using the original enum, higher-level things like <code>Mammal</code> or <code>Invertebrate</code> would appear on the same &#34;level&#34; as something very specific like <code>African Swallow</code>, which would imply that they were (to some degree) interchangeable, which isn&#39;t true. In theory, a nested structure as above might allow you to specify the level of &#34;specificness&#34; needed, so you could get this:</p><pre><code>enum Animal::Kingdom.Order.Family.Genus.Species
{ /*stuff*/ }

Organism::Kingdom.Phylum.Class.Order.Family thisThing;

thisThing = Animalia.Cordata;                               //compiler error
thisThing = Animalia.Chordata.Aves.Passeri.Hirundinidae;    //compiles OK
</code></pre><p>Does a structure like this exist anywhere? If not, how might I build one for C++ and/or C# and have it remain as generic and re-usable as possible?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I agree with others that this seems overengineered. Usually, you want either a simple enum or a complex hierarchy of classes, it&#39;s not a good idea to combine the two.</p><p>But if you really want to do this (in C#), I think it&#39;s useful to recap what exactly do you want:</p><ul><li>Separate types for the hierarchy <code>Kingdom</code>, <code>Phylum</code>, etc., which <em>do not</em> form inheritance hierarchy (otherwise, <code>Phylum</code> could be assigned to <code>Kingdom</code>). Though they could inherit from a common base class.</li><li>Each expression like <code>Animalia.Chordata.Aves</code> has to be assignable to a variable, which means we have to work with instances, not nested static types. This is especially problematic for the root type, because there are no global variables in C#. You could solve that by using a singleton. Also, I think there should be only one root, so the code above would become something like <code>Organisms.Instance.Animalia.Chordata.Aves</code>.</li><li>Each member has to be a different type, so that <code>Animalia.Chordata</code> compiled, but <code>Plantae.Chordata</code> didn&#39;t.</li><li>Each member needs to somehow know all its children, for the <code>IsMember()</code> method to work.</li></ul><p>The way I would implement these requirements is to start with a class like <code>EnumSet&lt;TChild&gt;</code> (though the name could be better), where <code>TChild</code> is the type of the children of this level in hierarchy. This class would also contain a collection of all its children (see later about filling it). We also need another type to represent leaf level of the hierarchy: non-generic <code>EnumSet</code>:</p><pre><code>abstract class EnumSet
{}

abstract class EnumSet&lt;TChild&gt; : EnumSet where TChild : EnumSet
{
    protected IEnumerable&lt;TChild&gt; Children { get; private set; }

    public bool Contains(TChild child)
    {
        return Children.Contains(child);
    }
}
</code></pre><p>Now we need to create a class for each level in the hierarchy:</p><pre><code>abstract class Root : EnumSet&lt;Kingdom&gt;
{}

abstract class Kingdom : EnumSet&lt;Phylum&gt;
{}

abstract class Phylum : EnumSet
{}
</code></pre><p>And finally some concrete classes:</p><pre><code>class Organisms : Root
{
    public static readonly Organisms Instance = new Organisms();

    private Organisms()
    {}

    public readonly Animalia Animalia = new Animalia();
    public readonly Plantae Plantae = new Plantae();
}

class Plantae : Kingdom
{
    public readonly Anthophyta Anthophyta = new Anthophyta();
}

class Anthophyta : Phylum
{}

class Animalia : Kingdom
{
    public readonly Chordata Chordata = new Chordata();
}

class Chordata : Phylum
{}
</code></pre><p>Notice that children are always fields of the parent class. What this means is that to fill the <code>Children</code> collection, we can use reflection:</p><pre><code>public EnumSet()
{
    Children = GetType().GetFields(BindingFlags.Instance | BindingFlags.Public)
                        .Select(f =&gt; f.GetValue(this))
                        .Cast&lt;TChild&gt;()
                        .ToArray();
}
</code></pre><p>One problem with this approach is that <code>Contains()</code> always works only one level down. So, you can do <code>Organisms.Instance.Contains(animalia)</code>, but not <code>.Contains(chordata)</code>. You can do that by adding overloads of <code>Contains()</code> to the specific hierarchy classes, e.g.:</p><pre><code>abstract class Root : EnumSet&lt;Kingdom&gt;
{
    public bool Contains(Phylum phylum)
    {
        return Children.Any(c =&gt; c.Contains(phylum));
    }
}
</code></pre><p>But this would be a lot of work for deep hierarchies.</p><hr/><p>After all of this, you end up with quite a lot of repetitive code. One way to fix that would be to have a text file that describes the hierarchy and use a T4 template to generate all the classes based on that.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-is-it-a-bad-practice-to-include-all-the-enums-in-one-file-and-use-it-in-multiple-classes/'>C++ &#8211; Is it a bad practice to include all the enums in one file and use it in multiple classes</a></li><li class="list-group-item"><a href='../c-using-scoped-enums-for-bit-flags-in-c/'>C++ &#8211; Using scoped enums for bit flags in C++</a></li><li class="list-group-item"><a href='../c-how-to-avoid-these-nested-repetitive-ifs/'>C# &#8211; How to avoid these nested repetitive ifs</a></li><li class="list-group-item"><a href='../c-strategy-pattern-not-sufficient-for-the-problem/'>C# &#8211; Strategy Pattern not sufficient for the problem</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>