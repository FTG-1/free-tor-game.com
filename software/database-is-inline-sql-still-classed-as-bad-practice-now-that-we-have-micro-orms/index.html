<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Database &#8211; Is inline SQL still classed as bad practice now that we have Micro ORMs &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1066448 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1066448" class="post-1066448 software type-software status-publish hentry category-software tag-database tag-orm tag-sql"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Database &#8211; Is inline SQL still classed as bad practice now that we have Micro ORMs</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database</span><span class="mr-2 badge badge-info">orm</span><span class="mr-2 badge badge-warning">sql</span></p><div class="entry-content"><p>This is a bit of an open ended question but I wanted some opinions, as I grew up in a world where inline SQL scripts were the norm, then we were all made very aware of SQL injection based issues, and how fragile the sql was when doing string manipulations all over the place.</p><p>Then came the dawn of the ORM where you were explaining the query to the ORM and letting it generate its own SQL, which in a lot of cases was not <em>optimal</em> but was safe and easy. Another good thing about ORMs or database abstraction layers were that the SQL was generated with its database engine in mind, so I could use Hibernate/Nhibernate with MSSQL, MYSQL and my code never changed it was just a configuration detail.</p><p>Now fast forward to current day, where Micro ORMs seem to be winning over more developers I was wondering why we have seemingly taken a U-Turn on the whole in-line sql subject.</p><p>I must admit I do like the idea of no ORM config files and being able to write my query in a more optimal manner but it feels like I am opening myself back up to the old vulnerabilities such as SQL injection and I am also tying myself to one database engine so if I want my software to support multiple database engines I would need to do some more string hackery which seems to then start to make code unreadable and more fragile. (Just before someone mentions it I know you can use parameter based arguments with most micro orms which offers protection in most cases from sql injection)</p><p>So what are peoples opinions on this sort of thing? I am using Dapper as my Micro ORM in this instance and NHibernate as my regular ORM in this scenario, however most in each field are quite similar.</p><p>What I term as <em>inline sql</em> is SQL strings within source code. There used to be design debates over SQL strings in source code detracting from the fundamental intent of the logic, which is why statically typed linq style queries became so popular its still just 1 language, but with lets say C# and Sql in one page you have 2 languages intermingled in your raw source code now. Just to clarify, the SQL injection is just one of the known issues with using sql strings, I already mention you can stop this from happening with parameter based queries, however I highlight other issues with having SQL queries ingrained in your source code, such as the lack of DB Vendor abstraction as well as losing any level of compile time error capturing on string based queries, these are all issues which we managed to side step with the dawn of ORMs with their higher level querying functionality, such as HQL or LINQ etc (not all of the issues but most of them).</p><p>So I am less focused on the individual highlighted issues and more the bigger picture of is it now becoming more acceptable to have SQL strings directly in your source code again, as most Micro ORMs use this mechanism.</p><p>Here is a similar question which has a few different view points, although is more about the inline sql without the micro orm context:</p><p><a href="https://stackoverflow.com/questions/5303746/is-inline-sql-hard-coding">https://stackoverflow.com/questions/5303746/is-inline-sql-hard-coding</a></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>What you are describing as &#34;Inline SQL&#34; should really be called &#34;string concatenation without parameterization,&#34; and you don&#39;t have to do that to use a Micro ORM safely.</p><p>Consider this Dapper example:</p><pre><code>string sql = &#34;SELECT * from user_profile WHERE FirstName LIKE @name;&#34;;
var result = connection.Query&lt;Profile&gt;(sql, new {name = &#34;%&#34;+name+&#34;%&#34;});
</code></pre><p>It&#39;s fully parameterized, even though string concatenation is taking place.  See the @ sign?</p><p>Or this example:</p><pre><code>var dog = connection.Query&lt;Dog&gt;(&#34;select Age = @Age, Id = @Id&#34;, 
          new { Age = (int?)null, Id = guid });
</code></pre><p>which is roughly equivalent to the following ADO.NET code:</p><pre><code>List&lt;Dog&gt; dog = new List&lt;Dog&gt;();
using(var cmd = connection.CreateCommand()) {
    cmd.CommandText = &#34;select Age = @Age, Id = @Id&#34;;
    cmd.Parameters.AddWithValue(&#34;Age&#34;, DBNull.Value);
    cmd.Parameters.AddWithValue(&#34;Id&#34;, guid);
    using(var reader = cmd.ExecuteReader()) {
        while(reader.Read()) {
            int age = reader.ReadInt32(&#34;Age&#34;);
            int id = reader.ReadInt32(&#34;Id&#34;);
            dog.Add(new Dog { Age = age, Id = id });
        }
    }
}
</code></pre><p>If you need more flexibility than this, Dapper provides SQL Templates and an <code>AddDynamicParms()</code> function.  All SQL Injection safe.</p><h3>So why use SQL strings in the first place?</h3><p>Well, for the same reasons you would use custom SQL in any other ORM.  Maybe the ORM is code-generating sub-optimal SQL, and you need to optimize it.  Maybe you want to do something that is difficult to do in the ORM natively, like UNIONs.  Or, maybe you simply want to avoid the complexity of generating all those proxy classes.</p><p>If you really don&#39;t want to write a SQL string for every <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete" rel="noreferrer">CRUD</a> method in Dapper (who does?), you can use this library:</p><p><a href="https://github.com/ericdc1/Dapper.SimpleCRUD/" rel="noreferrer">https://github.com/ericdc1/Dapper.SimpleCRUD/</a></p><p>That will get you extremely simple and straightforward CRUD, while still giving you the flexibility of hand-written SQL statements.  Remember, the ADO.NET example above was the way everyone did it before ORM&#39;s came along; Dapper is just a thin veneer over that.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-what-kind-of-web-development-projects-benefit-from-using-orm/'>Php &#8211; What kind of Web development projects benefit from using ORM</a></li><li class="list-group-item"><a href='../what-are-the-options-when-sql-generated-by-orm-needs-tuning/'>What are the options when Sql generated by ORM needs tuning</a></li><li class="list-group-item"><a href='../what-are-some-of-the-benefits-of-a-micro-orm/'>What are some of the benefits of a &#8220;Micro-ORM&#8221;</a></li><li class="list-group-item"><a href='../database-why-are-sql-databases-still-used-with-orm/'>Database &#8211; Why are SQL databases still used with ORM</a></li><li class="list-group-item"><a href='../php-how-to-design-a-model-layer-without-orm-and-when-should-i-use-it/'>Php &#8211; How to design a model layer without ORM, and when should I use it</a></li><li class="list-group-item"><a href='../database-why-do-relational-databases-only-accept-sql-queries/'>Database &#8211; Why do relational databases only accept SQL queries</a></li><li class="list-group-item"><a href='../data-layer-without-orm-how-to-work-with-it-in-efficient-way/'>Data layer without ORM &#8211; how to work with it in efficient way</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>