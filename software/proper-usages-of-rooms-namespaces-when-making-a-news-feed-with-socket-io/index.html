<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Proper usages of rooms/namespaces when making a News Feed with socket.io &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082723 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082723" class="post-1082723 software type-software status-publish hentry category-software tag-node-js tag-websockets"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Proper usages of rooms/namespaces when making a News Feed with socket.io</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">node.js</span><span class="mr-2 badge badge-info">websockets</span></p><div class="entry-content"><p>I am working on making a News Feed for a piece of software that will have data posted to different hierarchical levels within the software.  For example, the software will support multiple organizations, each of which may have multiple teams, with multiple squads under each of those.</p><p>Top level users in the organization may see content from all of the content posted to anywhere in the organization (or any of its teams or squads).  Medium level users should be able to see content posted to the entire organization, or content only within their own team (and its squads).  The lowest level users should see content posted only to the entire organization, or their team, or their specific squad.</p><p>The database will also differential between &#39;posts&#39;, which can appear on a number of people&#39;s feeds and be commented on, and &#39;notifications&#39; which are indicators for individual users that particular events happened, and must be dismissed by the user.</p><p>I should also note that at the moment, I am <em>not</em> interested in assigning different weights to posts and only making certain posts appear.  I am fine with having everyone see every post relevant to them in reverse chronological order.</p><p>Now, I am planning on using socket.io to make this feed update live.  From my understanding socket.io relies on namespaces and rooms to determine.  My question is about how to leverage these features in order to make this feed function.</p><p>From a preliminary glance at it, I can see one of two ways of tackling the problem:</p><p><strong>Option 1:</strong> Create socket.io namespaces (or perhaps rooms) for each node in the hierarchy of the organization (the organization itself, each team, each squad) and make each client join each of their relevant namespaces (top level users would join every namespace in the entire organization, bottom level users would only join the global organization namespace, their team namespace, and their squad namespace).  The user facing feed would be an aggregate of all of the namespaces they are in.</p><p>The upside of this design is that since there are multiple users per namespace, even though I am writing new posts to the database, I can push posts directly from one client to the others in that namespace.  This avoids having to do any database lookups for distributing posts to the other users that are already on the application.</p><p><strong>Option 2</strong>:  Create a socket.io namespace (or again, perhaps room) for each user.  Then just have every client periodically poll the server for new posts that are relevant to them and should be displayed on their news feed.  This option would effectively be an AJAX style solution without the overhead of actual AJAX calls to the PHP backend that this application is written in.</p><p>A sort of variation of this second option may be to still make a namespace for each user, but then when new content is posted, have the posts be pushed directly to other user namespaces.  I am not sure if/how this would be possible.</p><p>I would appreciate it if anyone could give any advice on how to proceed.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Now that it has been nearly 3 years, and the software in question has been in production with hundreds of thousands of users this entire time, I am going to answer my own question.</p><p>I went with option 2, where each user joins a single unique room. The server does the work of iterating through the connected users and sending appropriate data to each user (using Redis PUB/SUB to manage the broadcasting of new events). In hindsight, this was definitely the right approach, as it allows for the siloing of each user&#39;s data. This is both conceptually easier to think about and easier to write code for, particularly when returning to the project to add features or making other adjustments to its business logic.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-data-integrity-in-nosql-situations/'>Architecture &#8211; Data integrity in NoSQL situations</a></li><li class="list-group-item"><a href='../design-pattern-for-socket-io-and-express/'>Design pattern for socket.io and Express</a></li><li class="list-group-item"><a href='../web-development-realtime-frontend-dashboard-calling-api-every-3-seconds-reduce-cpu-loads/'>Web-development &#8211; Realtime frontend dashboard, calling api every 3 seconds, reduce cpu loads</a></li><li class="list-group-item"><a href='../do-i-actually-need-a-message-broker-or-are-websockets-enough/'>Do I actually need a message broker or are websockets enough</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>