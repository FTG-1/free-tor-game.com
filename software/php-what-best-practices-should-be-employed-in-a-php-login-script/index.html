<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Php &#8211; What best practices should be employed in a PHP login script &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1065411 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1065411" class="post-1065411 software type-software status-publish hentry category-software tag-php tag-security tag-web-development"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Php &#8211; What best practices should be employed in a PHP login script</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">PHP</span><span class="mr-2 badge badge-info">Security</span><span class="mr-2 badge badge-warning">web-development</span></p><div class="entry-content"><p>I am wanting to re-write my login scripts for clients websites to make them more secure. I want to know what best practices I can implement into this. Password protected control panels are in their abundance, but very few seem to impliment best practices in terms of code writing, speed and security.</p><p>I will be using PHP and a MYSQL database.</p><p>I used to use md5, but I see that sha256 or sha512 would be better (together with secure hash and salt).</p><p>Some login scripts log the ip address throughout the session or even the user agent, but I want to avoid that as it isn&#39;t compatible with proxy servers.</p><p>I am also a little behind the best practice in using sessions in PHP 5 (last time I read up was PHP 4) so some best practices with this would be helpful.</p><p>Thanks.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The best think is to not reinvent the wheel. But, I understand, in PHP world it may be difficult to find a high quality component which already does that (even I&#39;m pretty sure that the frameworks implement such things and their implementations are already tested, solid, code-reviewed, etc.)</p><p>If, for some reasons, you can&#39;t use a framework, here&#39;s some suggestions:</p><h2>Security related suggestions</h2><ul><li><p><strong>Use PBKDF2 or Bcrypt if you can</strong>. It&#39;s done for that.</p><p><sup>Rationale: both algorithms can make the hashing process arbitrarily slow, which is exactly what you want when hashing passwords (quicker alternatives mean easier brute force). Ideally, you should adjust the parameters so that the process becomes slower and slower over time on same hardware, while new, faster hardware is released.</sup></p></li><li><p>If you can&#39;t, at least <strong>don&#39;t use MD5/SHA1. Never. Forget about it</strong>. Use SHA512 instead, for example. Use salt too.</p><p><sup>Rationale: MD5 and SHA1 are too fast. If the attacker has access to your database containing the hashes and has a (not even particularly) powerful machine, brute-forcing a password is fast and easy. If there are no salts, the chances that the attacker finds the actual password increases (which could make additional harm if the password was reused somewhere else).</sup></p></li><li><p>In PHP 5.5.0 and later, use <a href="http://php.net/manual/en/function.password-hash.php"><code>password_hash</code></a> and <a href="http://php.net/manual/en/function.password-verify.php"><code>password_verify</code></a>.</p><p><sup>Rationale: calling a function provided by the framework is easy, so the risk of making a mistake is reduced. With those two functions, you don&#39;t have to think about different parameters such as the hash. The first function returns a <em>single</em> string which can then be stored in the database. The second function uses this string for password verification.</sup></p></li><li><p><strong>Protect yourself from brute force</strong>. If the user submits a wrong password when she already submitted another wrong password 0.01 seconds ago, it&#39;s a good reason to block it. While human beings can type fast, they probably can&#39;t be <em>that</em> fast.</p><p>Another protection would be to set a per-hour failures limit. If the user submitted 3600 wrong passwords in an hour, 1 password per second, it&#39;s hard to believe that this is a legitimate user.</p><p><sup>Rationale: if your passwords are hashed in an insecure way, brute force can be very effective. If passwords are stored safely, brute force is still wasting your server&#39;s resources and network bandwidth, causing lower performance for legitimate users. Brute force detection is not easy to develop and to get right, but for any but tiny system, it&#39;s totally worth it.</sup></p></li><li><p><strong>Don&#39;t ask your users to change their passwords every four weeks.</strong> This is extremely annoying and <strong>decreases</strong> security, since it encourages post-it-based security.</p><p><sup>Rationale: the idea that forcing passwords to change every <em>n</em> weeks protects the system from brute force is wrong. Brute force attacks are usually successful within seconds, minutes, hours or days, which makes monthly password changes irrelevant. On the other hand, users are bad at remembering passwords. If, moreover, they need to change them, they will either attempt to use very simple passwords or just note their passwords on post-its.</sup></p></li><li><p><strong>Audit everything, every time.</strong> Store logons, but never store passwords in audit log. <strong>Make sure that the audit log cannot be modified</strong> (i.e. you can add data at the end, but not modify the existing data). Make sure that audit logs are subject to regular backup. Ideally, logs should be stored on a dedicated server with very restrictive accesses: if another server is hacked, the attacker will be unable to wipe out the logs to hide his presence (and the path taken during the attack).</p></li><li><p>Don&#39;t remember user credential in cookies, unless the user asks to do it (“Remember me” check box must be unchecked by default to avoid human error).</p></li></ul><h2>Ease of use suggestions</h2><ul><li><strong>Let the user remember the password</strong> if she wants to, even if most browsers are already this feature.</li><li>Don&#39;t use Google approach when instead of asking for user name and password, the user is <strong>asked sometimes for password only</strong>, the user name being already displayed in a <code>&lt;span/&gt;</code>. Browsers can&#39;t fill the password field in this case (at least Firefox cannot do that), so it forces to logoff, then to logon with an ordinary form, filled by the browser.</li><li>Don&#39;t use <strong>JavaScript-enabled popups</strong> for logon. It breaks browsers password-remember features (and sucks in all cases).</li><li>Let the user enter <strong>either her user name or her mail address</strong>. When I register, sometimes the user name I want to enter is already taken, so I must invent a new one. I have all chances to forget this name in two hours.</li><li>Always keep <strong>a link to &#34;Forgot my password&#34;</strong> feature near the logon form. Don&#39;t display it only when the user failed to log on: the user who don&#39;t remember her password at all have no idea that she must submit a wrong one in order to see the &#34;Forgot my password&#34; link.</li><li>Don&#39;t use <a href="http://thedailywtf.com/Articles/Security-by-PostIt.aspx">security by post-it</a>.</li><li>Don&#39;t invent <strong>stupid rules related to the password in order to make it weaker</strong>. Example: &#34;Your password must start with a lowercase letter.&#34;; &#34;Your password cannot contain spaces.&#34;</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/php-is-having-sensitive-data-in-a-php-script-secure/'>Php &#8211; Is having sensitive data in a PHP script secure</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/php-best-practice-in-return-values/'>PHP best practice in return values</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/php-best-practices-php-mvc-routing/'>Php &#8211; Best Practices PHP mvc routing</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>