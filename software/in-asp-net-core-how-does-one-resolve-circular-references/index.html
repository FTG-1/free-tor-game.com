<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>In ASP.Net Core , how does one resolve circular references &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068431 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068431" class="post-1068431 software type-software status-publish hentry category-software tag-net-core tag-asp-net-core tag-logging"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">In ASP.Net Core , how does one resolve circular references</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">.net core</span><span class="mr-2 badge badge-info">asp.net-core</span><span class="mr-2 badge badge-warning">logging</span></p><div class="entry-content"><p>I was working on migrating over a project which uses a static logger, and a static email service.<br /> The email service logs emails sent, and the logger service sends an email if there are any logging issues (like DB down, etc.). If the email service fails, it can also log the issue.</p><p>If the logger fails, it tries to send an email notice, but if the email service fails (which could be why the logger was called in the first place), it just continues on and writes the issue to a log file.</p><pre><code>Email Service &lt;--statically references--&gt; Logger Service
</code></pre><p>The issue is that both &#34;services&#34; are singletons, and both would need reference to each other as a constructor parameter. My first thought was property based injection, but I quickly found that seems to be a Temporal Coupling situation that is much undesired.</p><p>The main running idea now is, at the log level, have it call the service provider to create an email service (so it will get the singleton instance), but I was really trying to keep the class library also decoupled from the .Net Core injection system. Anyone have any recommendations in case I&#39;m missing something?</p><p><em>Edit:</em> After more thought, does it make sense perhaps to create an abstracted service provider of my own (a basic one) that can have another service injected into it? Then I could perhaps just pass that around instead in such cases.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I suggest you to read a great book about the <code>C#</code> <a href="https://www.manning.com/books/dependency-injection-in-dot-net" rel="nofollow noreferrer">dependency injection</a> by Mark Seemann, with a lot of real world samples for different tasks you can do with it, even with circular dependencies similar to your case.</p><p>In general, the main design rule is <code>You can&#39;t resolve the problem on its level</code>, and in this case it&#39;s true too. You really need a <a href="https://en.wikipedia.org/wiki/Mediator_pattern" rel="nofollow noreferrer">mediator</a> here to resolve interactions between two loggers. It easily can save the state for both of them, and notify each other about changes.</p><p>For example, you can introduce some <code>Target</code> for the messages, like this:</p><pre><code>GeneralMessage // both loggers got this
EmailMessage // only email logger got this
LoggerMessage // only logger got this
</code></pre><p>So, in case of some trouble with one of your loggers, mediator send the message with corresponding type to notify other about issue.</p><p>Common approach for such cutting-edge logic is an <code>AOP</code> implementation (personally I prefer the <a href="https://www.postsharp.net/diagnostics/net-logging" rel="nofollow noreferrer"><code>PostSharp</code></a>, which provides you a general approach, even with conventional techniques to assign the aspects on your classes).</p><p>As for decoupling your code from the <code>.Net Core</code> injection system, I suggest you to examine the <code>Logger Factory</code>, which is:</p><blockquote><p>The new framework creates an abstraction layer or wrapper that enables you to use whichever logging framework you want as a provider. This ensures you have the maximum flexibility in your work as a developer. Furthermore, even though itâ€™s only available with <code>.NET Core</code>, referencing <code>.NET Core</code> NuGet packages like <a href="https://www.nuget.org/packages/Microsoft.Extensions.Logging/" rel="nofollow noreferrer"><code>Microsoft.Extensions.Logging</code></a> for a standard Visual Studio <code>.NET 4.6</code> project is no problem.</p></blockquote><p>With <code>Logger Factory</code> you can even <a href="https://www.nuget.org/packages/Microsoft.Extensions.Logging.Filter" rel="nofollow noreferrer">filter the messages</a> to notify the all loggers about problems with other ones, <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging#eventlog" rel="nofollow noreferrer">connect to OS event logs</a> and much more.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-ambient-dependency-injection-through-static-service-locator/'>C# &#8211; Ambient dependency injection through static service locator</a></li><li class="list-group-item"><a href='../asp-net-core-viewcomponent-vs-editortemplate-displaytemplate-vs-inject/'>ASP.Net Core: ViewComponent vs EditorTemplate/DisplayTemplate vs @inject</a></li><li class="list-group-item"><a href='../what-are-the-differences-between-net-framework-asp-net-net-core-asp-net-core-and-net-standard/'>What are the differences between .NET Framework, ASP.NET, .NET Core, ASP.NET Core and .NET Standard</a></li><li class="list-group-item"><a href='../domain-events-cqrs-and-dependency-resolution-in-handlers/'>Domain Events, CQRS, and dependency resolution in handlers</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>