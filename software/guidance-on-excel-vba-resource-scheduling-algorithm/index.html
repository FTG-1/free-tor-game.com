<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Guidance on Excel VBA resource scheduling algorithm &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074644 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074644" class="post-1074644 software type-software status-publish hentry category-software tag-algorithms tag-excel tag-rules-and-constraints tag-scheduling tag-vba"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Guidance on Excel VBA resource scheduling algorithm</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">excel</span><span class="mr-2 badge badge-warning">rules-and-constraints</span><span class="mr-2 badge badge-primary">scheduling</span><span class="mr-2 badge badge-danger">vba</span></p><div class="entry-content"><p>This was posted originally at StackOverflow though suggested to post here instead.</p><p>I am looking to create an Excel VBA solution that will create a rota/schedule allocating staff to service users using an algorithm. I believe there are already existing names for this kind of problem/algorithms but not entirely sure what to refer to it is.</p><p>Here is my scenario:</p><p>A colleague approached me with a problem of scheduling staff against visits required. Currently this is a manual process done every week and is labour intensive. The datasets are small, on average there would be 20 service users each requiring 2 visits a day with 5 members of staff available each day.</p><p>I have a worksheet that contains the list of staff who are available for the following week. Each row of data contains their name, gender, skill level, home postcode, day working, start time and end time. A member of staff may be listed more than once on the same day as they may be available for hours in the morning and also in the evening.</p><p>Another worksheet contains the list of service users and visits required for the following week. Each row of data contains their name, postcode, day of visit, time of visit, visit duration, gender required (i.e. must be seen by a male/female), skill level required (i.e. any, certified) and the number of staff required for that visit (i.e. 1 or 2). Again a service user may appear more than once on the same day as they may require multiple visits at different times of the day (i.e. morning and evening)</p><p>I have already created some VBA functions to deal with handling of postcodes and getting latitude/longitude co-ordinates along with a function to calculate the distance between two points as the crow flies. At present the distinct values of postcodes with there co-ordinates are being stored on a helper sheet for the VBA to reference.</p><p>What I am really looking for is guidance on how to even being creating a procedure/algorithm which will produce a suggested rota/schedule, this could be a simple table with pairings between staff and visits. The process must always make suitable pairings based on:</p><ul><li>Skill Level Required</li><li>Gender Required</li><li>Staff Availability</li></ul><p>Least important are that matches take into consideration the distance required to travel between visits. I believe this is referred to as a Genetic Algorithm?</p><p>There may be instances where there are too many service users for the available staff and vice versa. Making use of all staff isn&#39;t necessary provided all visits are dealt with, if all visits cannot be paired due to a lack of staff availability then this needs to be listed as being unmet.</p><p>I can utilize SQL Server if need be but ultimately the solution needs to be presented in Excel to the end user, as this is what they are most familiar with.</p><p>I&#39;m thinking the procedure/process would need to go something like this:</p><ol><li>For each day, sort the visits by start time</li><li>For each visit, determine which staff members meet the gender and<br /> skill level requirement and is available on that day</li><li>For each of the staff member determined above, are they available at<br /> the time requested?</li><li>For each staff member that is available calculate the distance from<br /> their current location to the where they need to be</li><li>Rank them in order of preference by distance required to travel</li><li>Once this has been done for each day, come up with a suggested<br /> allocation of staff to visits using some kind of scoring method</li></ol><p>I&#39;m no VBA expert and deal with SQL Server as my day job but I am willing to try and come up with a suitable solution, just need some guidance on how best to start.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I have some experience with the sort of scheduling problem you present, and the technical stack you&#39;re using, and so I can speak from authority and say <strong>this is a database problem and belongs in SQL Server, not Excel!</strong>.</p><p>Assuming that these are regular visits that are already scheduled and you only need to allocate your staff to the various tasks, (and staff have to return to their home office between visits), I recommend the following process:</p><ol><li>Migrate your staff list to a normalized table structure, with separate <code>Employee</code> and <code>Availability</code> tables.</li><li>Do the same to your service users, with <code>Customer</code> and <code>Visit</code> tables.  (How you populate the visits is a different question.)</li><li>Create a distinct <code>Assignment</code> table, that reflects the assignments you give your staff.  This table will include both actual shifts, and necessary non-visit assignments (such as &#34;drive across town&#34;).  Your program will generate suggestions, but you need to allow a human to revise the list.</li><li>Generate a &#34;complexity&#34; score for each <code>visit</code>, by adding all the necessary requirements together.  (&#34;Must be seen by two certified women for 3 hours&#34; may be seven points, for example.)</li><li>For the highest complexity value, make all assignments for your time period for all visits on that assignment.  Do this one row at a time, with tie-breakers based on the visit length and start-time.  Select staff who meet the needs based on availability and then some sensible sort value (seniority or &#34;times done this shift.&#34;)</li><li>Mark a travel time entry for the assigned staff between the customer&#39;s location and the employee&#39;s central location.</li><li>Repeat from #5, above, until all visits are satisfied.</li><li>Return to Excel two lists, one of <code>Customer Visits</code> that indicates the assigned employees(s), and one of <code>Employee assignments</code> that notes the times each employee will be assigned.  Include any highlight in both any unassigned items.</li></ol><p>There are professional Workforce Management systems that will much of this for you, but such require several tens of thousands of dollars to purchase and assume you&#39;ll have an employee doing much of the work manually.  If they were doing this in Excel by hand, <strong>any</strong> automation will be an aid, and you can improve as you go on.</p><p>(And take a look at .NET or Access to replace Excel in some instances; round-tripping data from Excel back to SQL Server is significantly harder than just making a form for a SQL server table in Access.)</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-an-algorithm-for-finding-subset-matching-criteria/'>Database &#8211; An algorithm for finding subset matching criteria</a></li><li class="list-group-item"><a href='../need-help-identifying-a-league-scheduling-algorithm/'>Need help identifying a league scheduling algorithm</a></li><li class="list-group-item"><a href='../managing-sets-of-configuration-data-for-an-excel-vba-program/'>Managing sets of configuration data for an Excel/VBA program</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>