<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Generating reports from large datasets &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1078021 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1078021" class="post-1078021 software type-software status-publish hentry category-software tag-c tag-database tag-reporting tag-sql-server tag-stored-procedures"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Generating reports from large datasets</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">database</span><span class="mr-2 badge badge-warning">reporting</span><span class="mr-2 badge badge-primary">sql server</span><span class="mr-2 badge badge-danger">stored-procedures</span></p><div class="entry-content"><p>I&#39;m working on an CRM type application(.NET, SQL Server) that needs to generate reports from large datasets, millions of database rows in a dozen different tables with a lot of aggregation and logic.  The reports are currently generated by long, complicated stored procedures with lots of joins, temp tables and logic.  These reports have to follow a third party specification, and the way they are currently written often produce incorrect data. There are also performance issues as the reports take about 10 times longer to run than they should.  I&#39;m faced with either re-writing the stored procedures or finding another way of generating the reports.  I have two main requirements, speed and accuracy.</p><p>SQL seems like the best choice for speed.  The data is relational and it already exists in a database.  The downside of SQL is that the reports are very complex and having it all in one/several giant queries makes it hard to test different pieces of the logic.</p><p>Doing the calculations in C# seems like a better choice for testability/accuracy, but I don&#39;t think it would perform very well due to the memory requirements and the slow nature of procedural code.</p><p>What makes me lean towards a non SQL solution is that sometimes our customers think the reports are wrong when it&#39;s really their own bad data.  Customers will often expect a person record to show up on a  report, but according to the rules of the report that record should not be included based on the values of certain columns.  Because the logic is so complex and our reports are written so badly we usually can&#39;t tell customers that their data is bad and why until we spend a day or two tracing that record through the logic of the report query.  It would be nice if we had a rules engine that we could run on any given record to see exactly what data columns are causing it to be filtered out of the report.  I&#39;d rather not implement the report logic twice, once in the report query and again in a validation engine.</p><p>What is the best choice here? Are there rules engines that can operate on large datasets?  I don&#39;t know much about big data, but I&#39;ve heard about map/reduce and Hadoop.  Would something like that help?  What about a functional language like F#?  Any other options?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I deal with a very similar situation where we take a large amount of relational data, filter and scrub it down to a smaller subset, and then create the highest level aggregates we can to output data that is both fast and &#34;accurate&#34;. Being accurate is only as good as what goes in. Unless you filter out and identify the bad data going in, the chances of bad data coming out are pretty high.</p><p>We also use SQL as the heavy lifter and this is where we run large data / aggrgate builds with stored procedures weekly or nightly. This makes it easier to return fast reports via our web portal or email subscription service.</p><p>There is a lot of things you can do while still using SQL and not completely up rooting everything.</p><p><strong>Suggestions While Using SQL:</strong></p><ol><li>Identify data subsets that can be pulled for a particular client (Filter the Data Well)</li><li>Make sure your indexes are optimized and configured correctly (one bad index can ruin everything)</li><li>Take advantage of your version of SQL and the machine hardware (make sure to use sql parallelism and try running multiple modules at the same time to increase throughput)</li><li>If all else fails, make sure that any query hitting a table that is being written too uses a with(nolock)</li><li>If you have to redo the process, modularize each calculation required to the highest aggregate required and store this information separately so that you can pull in each of the required aggregates to produce the final results</li><li>Think in steps and try to create a low-level aggregate that can be used to create the next level and so on.</li></ol><p>SQL server is fast and nowadays can perform a lot of the functions you would normally try in a standalone application. So unless you have very little hardware running SQL and there is no room for expansion, I would just use SQL for the calculations. The biggest benefit to a standalone application doing the calculations is that it will be better to maintain code wise and you can potentially run multithreaded processes on one or more machines. You also do not need to get more SQL licenses.</p><p>I can definitely say that if your data is already relational, putting it into non-relational database structure will just make things harder. Another option besides scaling out your SQL instances is to scale out with another relational database. Postgres is extremely powerful and can compete with MSSQL when it comes to processing speed. My company has started converting over from SQL and we have been spreading some of the processing power across different compute nodes using <a href="https://www.postgres-xl.org/" rel="nofollow noreferrer">Postgres-XL</a>.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-how-to-suggest-using-an-orm-instead-of-stored-procedures/'>C# &#8211; How to suggest using an ORM instead of stored procedures</a></li><li class="list-group-item"><a href='../design-when-should-i-use-stored-procedures/'>Design &#8211; When should I use stored procedures</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>