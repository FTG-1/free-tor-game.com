<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>How to estimate the entropy of a password &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070739 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070739" class="post-1070739 software type-software status-publish hentry category-software tag-algorithms tag-passwords"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">How to estimate the entropy of a password</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">algorithms</span><span class="mr-2 badge badge-info">passwords</span></p><div class="entry-content"><p>Having read <a href="http://xkcd.com/936/" rel="noreferrer">various resources</a> about password strength I&#39;m trying to create an algorithm that will provide a rough estimation of how much entropy a password has.</p><p>I&#39;m trying to create an algorithm that&#39;s as comprehensive as possible.  At this point I only have pseudocode, but the algorithm covers the following:</p><ul><li>password length</li><li>repeated characters</li><li>patterns (logical)</li><li>different character spaces (LC, UC, Numeric, Special, Extended)</li><li>dictionary attacks</li></ul><p>It does NOT cover the following, and SHOULD cover it WELL (though not perfectly):</p><ul><li>ordering (passwords can be strictly ordered by output of this algorithm)</li><li>patterns (spatial)</li></ul><p>Can anyone provide some insight on what this algorithm might be weak to?  Specifically, can anyone think of situations where feeding a password to the algorithm would <strong>OVERESTIMATE</strong> its strength?  Underestimations are less of an issue.</p><h1>The algorithm:</h1><pre><code>// the password to test
password = ?
length = length(password)

// unique character counts from password (duplicates discarded)
uqlca = number of unique lowercase alphabetic characters in password
uquca = number of uppercase alphabetic characters
uqd   = number of unique digits
uqsp  = number of unique special characters (anything with a key on the keyboard)
uqxc  = number of unique special special characters (alt codes, extended-ascii stuff)

// algorithm parameters, total sizes of alphabet spaces
Nlca = total possible number of lowercase letters (26)
Nuca = total uppercase letters (26)
Nd   = total digits (10)
Nsp  = total special characters (32 or something)
Nxc  = total extended ascii characters that dont fit into other categorys (idk, 50?)

// algorithm parameters, pw strength growth rates as percentages (per character)
flca = entropy growth factor for lowercase letters (.25 is probably a good value)
fuca = EGF for uppercase letters (.4 is probably good)
fd   = EGF for digits (.4 is probably good)
fsp  = EGF for special chars (.5 is probably good)
fxc  = EGF for extended ascii chars (.75 is probably good)

// repetition factors.  few unique letters == low factor, many unique == high
rflca = (1 - (1 - flca) ^ uqlca)
rfuca = (1 - (1 - fuca) ^ uquca)
rfd   = (1 - (1 - fd  ) ^ uqd  )
rfsp  = (1 - (1 - fsp ) ^ uqsp )
rfxc  = (1 - (1 - fxc ) ^ uqxc )

// digit strengths
strength =
( rflca * Nlca + 
  rfuca * Nuca +
  rfd   * Nd   +
  rfsp  * Nsp  +
  rfxc  * Nxc    ) ^ length

entropybits = log_base_2(strength)
</code></pre><p>A few inputs and their desired and actual entropy_bits outputs:</p><pre><code>INPUT           DESIRED        ACTUAL
aaa             very pathetic  8.1
aaaaaaaaa       pathetic       24.7
abcdefghi       weak           31.2
H0ley$Mol3y_    strong         72.2
s^fU¬5ü;y34G&lt;   wtf            88.9
[a^36]*         pathetic       97.2
[a^20]A[a^15]*  strong         146.8
xkcd1**         medium         79.3
xkcd2**         wtf            160.5

* these 2 passwords use shortened notation, where [a^N] expands to N a&#39;s.
** xkcd1 = &#34;Tr0ub4dor&amp;3&#34;, xkcd2 = &#34;correct horse battery staple&#34;
</code></pre><p>The algorithm does realize (correctly) that increasing the alphabet size (even by one digit) vastly strengthens long passwords, as shown by the difference in entropy_bits for the 6th and 7th passwords, which both consist of 36 a&#39;s, but the second&#39;s 21st a is capitalized.  However, they do not account for the fact that having a password of 36 a&#39;s is not a good idea, it&#39;s easily broken with a weak password cracker (and anyone who watches you type it will see it) and the algorithm doesn&#39;t reflect that.</p><p>It does, however, reflect the fact that xkcd1 is a weak password compared to xkcd2, despite having greater complexity density (is this even a thing?).</p><p>How can I improve this algorithm?</p><h1>Addendum 1</h1><p>Dictionary attacks and pattern based attacks seem to be the big thing, so I&#39;ll take a stab at addressing those.</p><p>I could perform a comprehensive search through the password for words from a word list and replace words with tokens unique to the words they represent.  Word-tokens would then be treated as characters and have their own weight system, and would add their own weights to the password.  I&#39;d need a few new algorithm parameters (I&#39;ll call them lw, Nw ~= 2^11, fw ~= .5, and rfw) and I&#39;d factor the weight into the password as I would any of the other weights.</p><p>This word search could be specially modified to match both lowercase and uppercase letters as well as common character substitutions, like that of E with 3.  If I didn&#39;t add extra weight to such matched words, the algorithm would underestimate their strength by a bit or two per word, which is OK.  Otherwise, a general rule would be, for each non-perfect character match, give the word a bonus bit.</p><p>I could then perform simple pattern checks, such as searches for runs of repeated characters and derivative tests (take the difference between each character), which would identify patterns such as &#39;aaaaa&#39; and &#39;12345&#39;, and replace each detected pattern with a pattern token, unique to the pattern and length.  The algorithmic parameters (specifically, entropy per pattern) could be generated on the fly based on the pattern.</p><p>At this point, I&#39;d take the length of the password.  Each word token and pattern token would count as one character; each token would replace the characters they symbolically represented.</p><p>I made up some sort of pattern notation, but it includes the pattern length l, the pattern order o, and the base element b.  This information could be used to compute some arbitrary weight for each pattern.  I&#39;d do something better in actual code.</p><h1>Modified Example:</h1><pre><code>Password:          1234kitty$$$$$herpderp
Tokenized:         1 2 3 4 k i t t y $ $ $ $ $ h e r p d e r p
Words Filtered:    1 2 3 4 @W5783 $ $ $ $ $ @W9001 @W9002
Patterns Filtered: @P[l=4,o=1,b=&#39;1&#39;] @W5783 @P[l=5,o=0,b=&#39;$&#39;] @W9001 @W9002

Breakdown:         3 small, unique words and 2 patterns
Entropy:           about 45 bits, as per modified algorithm

Password:          correcthorsebatterystaple
Tokenized:         c o r r e c t h o r s e b a t t e r y s t a p l e
Words Filtered:    @W6783 @W7923 @W1535 @W2285

Breakdown:         4 small, unique words and no patterns
Entropy:           43 bits, as per modified algorithm
</code></pre><p>The exact semantics of how entropy is calculated from patterns is up for discussion.  I was thinking something like:</p><pre><code>entropy(b) * l * (o + 1) // o will be either zero or one
</code></pre><p>The modified algorithm would find flaws with and reduce the strength of each password in the original table, with the exception of <code>s^fU¬5ü;y34G&lt;</code>, which contains no words or patterns.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Appendix A on p46 of <a href="http://csrc.nist.gov/publications/nistpubs/800-63/SP800-63V1_0_2.pdf">NIST SP 800-63</a> talks about the work of <a href="http://en.wikipedia.org/wiki/Claude_Shannon">Claude Shannon</a>, who estimates password entropy using a number of bits. Indeed, this is the document that the XKCD cartoon uses to calculate the entropy bits. Specifically:</p><blockquote><ul><li>the entropy of the first character is taken to be 4 bits;</li><li>the entropy of the next 7 characters are 2 bits per character; this is roughly consistent with Shannon’s estimate that “when statistical
 effects extending over not more than 8 letters are considered the
 entropy is roughly 2.3 bits per character;”</li><li>for the 9th through the 20th character the entropy is taken to be 1.5 bits per character;</li><li>for characters 21 and above the entropy is taken to be 1 bit per character;</li><li>A “bonus” of 6 bits of entropy is assigned for a composition rule that requires both
 upper case and non-alphabetic characters. This
 forces the use of these characters, but in many cases thee characters
 will occur only at the beginning or the end of the password, and it
 reduces the total search space somewhat, so the benefit is probably
 modest and nearly independent of the length of the password;</li><li>A bonus of up to 6 bits of entropy is added for an extensive dictionary check. If the 
 attacker knows the dictionary, he can avoid
 testing those passwords, and will in any event, be able to guess much
 of the dictionary, which will, however, be the most likely selected
 passwords in the absence of a dictionary rule. The assumption is that
 most of the guessing entropy benefits for a dictionary test accrue to
 relatively short passwords, because any long password that can be
 remembered must necessarily be a “pass-phrase” composed of dictionary
 words, so the bonus declines to zero at 20 characters.</li></ul></blockquote><p>The idea is that an authentication system would pick certain entropy levels as thresholds. For example, 10 bits may be weak, 20 medium and 30 strong (numbers picked arbitrarily as an example, not a recommendation). Unfortunately, the document does not recommend such thresholds, probably because the computational power available to brute force or guess passwords increases over time:</p><blockquote><p>As an alternative to imposing some arbitrary specific set of rules, an
 authentication system might grade user passwords, using the rules
 stated above, and accept any that meet some minimum entropy standard.
 For example, suppose passwords with at least 24-bits of entropy were
 required. We can calculate the entropy estimate of
 “IamtheCapitanofthePina4” by observing that the string has 23
 characters and would satisfy a composition rule requiring upper case
 and non-alphabetic characters.</p></blockquote><p>This may or may not be what you are looking for but is not a bad reference point, if nothing else.</p><p>[Edit: Added the following.]</p><p>The paper <a href="http://goo.gl/YxRk">Testing Metrics for Password Creation Policies
by Attacking Large Sets of Revealed Passwords</a> (by Matt Weir, Sudhir Aggarwal, Michael Collins and Henry Stern) demonstrated the Shannon model, described above, is not an accurate model of entropy for human generated passwords. I would recommend looking at &#34;Section 5 Generating New Password Creation Policies&#34; for more accurate proposals.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../a-reasonable-and-secure-password-requirement-for-user-registration/'>A reasonable and secure password requirement for user registration</a></li><li class="list-group-item"><a href='../how-to-implement-a-safe-password-history/'>How to implement a safe password history</a></li><li class="list-group-item"><a href='../merge-directed-acyclic-graphs-minimizing-number-of-nodes/'>Merge directed acyclic graphs minimizing number of nodes</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>