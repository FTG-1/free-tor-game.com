<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C++ &#8211; Using a macro for a libraries namespace &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074736 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074736" class="post-1074736 software type-software status-publish hentry category-software tag-c tag-libraries tag-macros tag-namespace"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C++ &#8211; Using a macro for a libraries namespace</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">libraries</span><span class="mr-2 badge badge-warning">macros</span><span class="mr-2 badge badge-primary">namespace</span></p><div class="entry-content"><p>In some code bases (such as hydra, and thrust&#39;s tuple implementation) I see namespaces defined entirely with macros.   It appears the reason for this is so that you can configure the namespace to your liking.  Is this the only use case for this practice? Even so why shouldn&#39;t all libraries define a macro for the namespace?  Would it not be better to just do the following:</p><pre><code>#ifndef LIB_NS
#define LIB_NS default_namespace
#endif

namespace LIB_NS{
...
}

LIB_NS::foo(...);
</code></pre><p>for every library I make? <code>ifndef</code> is used so that I could define the name of the symbol as a compiler option or somewhere outside of the include before hand.</p><p><strong>Here are the examples:</strong></p><p><a href="https://github.com/jaredhoberock/tuple/blob/master/include/tuple.hpp" rel="nofollow noreferrer">Thrust example</a></p><p><a href="https://github.com/MultithreadCorner/Hydra" rel="nofollow noreferrer">Hydra repository</a> (can&#39;t find where they define it, but its used a lot)</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>This technique is sometimes used to handle transitive dependencies on header only libraries. It is not generally a best practice.</p><p>The problem: I am writing a C++ library. I put all of my declarations into a <code>namespace foo { ... }</code>. So users of my library can avoid that namespace. But what happens when I want to use another library in my library? Let&#39;s call the second library <code>bar</code>. If I use the bar library normally, I am exposing both the <code>foo</code> and <code>bar</code> namespaces to the users. My dependency is not invisible, and could break code of my users.</p><p>If the <code>bar</code> library makes its namespace configurable, I can avoid that by moving it into a <code>foo::detail::bar</code> namespace.</p><p>At first, it might seem like I could simply include a header within a namespace:</p><pre><code>namespace foo { namespace detail {
#include &lt;bar.h&gt;
} }
</code></pre><p>However, headers are generally written to assume that they are included at the top-level. In particular, expect this to break the standard library as used through that header. This will also fail if bar is not a header-only library, because the object code will be compiled into a different namespace.</p><p>Using macros is the preferable solution. A single namespace macro that takes values such as <code>foo::detail</code> is insufficient prior to C++17, so that separate macros for declaration start/end and the actual namespace are necessary. E.g. see <a href="https://github.com/MultithreadCorner/Hydra/blob/v2.1.0/hydra/detail/external/thrust/detail/config.h" rel="nofollow noreferrer">this example in Hydra</a>.</p><p>However, these techniques suffer from various problems and restrictions.</p><ul><li><p>The header files typically still contain include guards, so that each compilation unit can import a library under at most one namespace. In practice, this is not a big restriction.</p></li><li><p>If a library is imported under multiple namespaces, any objects declared by that library are duplicated. This may or may not be desired.</p></li><li><p>If the library with variable namespaces is not a header-only library, then the object code for that library must also be compiled into the correct namespace. This requires you to define the necessary macros in your build system.</p></li></ul><p>The core problem that these macros are trying to solve is that C++ does not have a proper module system. How are other languages addressing potentially clashing namespaces?</p><ul><li><p>Java has a package naming convention based on domain names, so no name clashes between organizations should arise. E.g. If you hold <code>example.com</code>, then you should put the foo library into the <code>com.example.foo</code> namespace.</p></li><li><p>Rust and Perl have one central library index (Crates and CPAN, respectively). Just don&#39;t use any namespaces that could be reserved there. Additionally, Rust does not make the namespace of a crate visible unless you import it, whereas the C++ one-definition-rule is global.</p></li><li><p>Python has relative imports. A well-written module does not need to know its absolute location.</p></li></ul><p>Hopefully, C++ modules will adopt a reasonable solution when they finally arrive.</p><p>The tuple example you linked to is fundamentally different: the purpose of that library is to patch the standard library if it doesn&#39;t provide a tuple of its own. Here, the namespace configurability is only provided to optionally place the tuple into a different namespace.</p><p>To summarize: configurable namespaces have legitimate uses when building libraries for libraries. Most C++ code should not bother with this, especially not application code.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/using-macro-as-an-abstraction-layer/'>Using macro as an abstraction layer</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-is-it-a-good-idea-to-define-me-this/'>C++ &#8211; Is it a good idea to &#8220;#define me (*this)&#8221;</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/php-best-practice-for-using-namespaces-in-the-php-libraries/'>Php &#8211; Best practice for using namespaces in the PHP libraries</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-importing-namespaces-inside-another-namespace/'>C++ &#8211; Importing namespaces inside another namespace</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-using-a-domain-name-as-c-namespace/'>C++ &#8211; Using a domain name as C++ namespace</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-namespace-and-class-naming-convention-for-libraries/'>C# namespace and class naming convention for libraries</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>