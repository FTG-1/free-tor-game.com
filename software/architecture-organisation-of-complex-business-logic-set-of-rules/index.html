<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Architecture &#8211; Organisation of complex business-logic (set of rules) &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1083093 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1083093" class="post-1083093 software type-software status-publish hentry category-software tag-architecture tag-business-logic tag-orm"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Architecture &#8211; Organisation of complex business-logic (set of rules)</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">business-logic</span><span class="mr-2 badge badge-warning">orm</span></p><div class="entry-content"><p>I have 20 <code>entities</code> and 50 <code>user requests</code>. And i have very complex business-logic (set of rules). How can i make my architecture so I&#39;m not confused when adding new rules.</p><p>Now if i add property &#34;InTheBattle&#34; to fleet, i must consider this in 5 <code>requestDispatchers</code> and 3 methods in <code>Verifications classes</code>.<br /> What will happen when i will have 100 <code>entities</code> and 500 <code>user requests</code>?</p><p>Maybe i must use some pattern or tool like excel? How can i contain all rules in my head? ðŸ™‚</p><p><em>Entity = orm model class</em></p><p>Sample of one request dispatcher:</p><pre><code>public class CreateShipRequestHandler : IRequestHandler
{
    private RepoContainer Repo;

    private int mFleetId;
    private int mShipDesignId;

    public void CreateShipHandler(RepoContainer repo, int fleetId, int shipDesignId)
    {
        this.Repo = repo;

        this.mFleetId = fleetId;
        this.mShipDesignId = shipDesignId;
    }

    public bool Dispatch(out string message)
    {
        //INTERESTING PLACE:

        message = string.Empty;

        var fleet = Repo.FleetRepo.GetById(mFleetId);
        var shipDesign = Repo.ShipDesignRepository.GetById(mShipDesignId);

        if(fleet == null || shipDesign == null)
        {
            message = &#34;VerificationError&#34;;
            return false;
        }

        var userResearchedScience = Repo.UserResearchedScienceRepo.GetByUserAndScience(fleet.UserId, shipDesign.RequiredScienceId);

        //I am using ShipVerification on the client too (for activate buttons)
        if(!ShipVerification.IsCanCreateShip(fleet, userResearchedScience, out message))
        {
            return false;
        }

        var newShip = new Ship(mFleetId, mShipDesignId);
        Repo.ShipRepo.AddOrUpdate(newShip);

        return true;
    }
}
</code></pre></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You are worried about the combinatorial explosion, that could make your design difficult to maintain.</p><p><strong>Combinatorial explosion</strong></p><p>It&#39;s difficult to maintain all the relationships and dependencies between all these entities.  The <a href="http://www.oodesign.com/mediator-pattern.html" rel="nofollow noreferrer"><strong>mediator pattern</strong></a> can help to sort this out: <code>Entities</code>, <code>Requests</code>, perhaps even <code>Rules</code> are colleagues, and the mediator encapsulates the interactions.</p><p><strong>Rule engine</strong></p><p>You have many business rules, and rules evolve often.  The best approach is to adopt an architecture implementing a <a href="https://en.wikipedia.org/wiki/Business_rules_engine" rel="nofollow noreferrer">rule engine</a>.</p><p>There are different ways to implement this. One way could be to use a <strong><a href="http://www.oodesign.com/chain-of-responsibility-pattern.html" rel="nofollow noreferrer">chain of responsibility</a></strong> .  You can find some examples of implementation on <a href="https://en.wikipedia.org/wiki/Chain-of-responsibility_pattern" rel="nofollow noreferrer">wikipedia</a>.</p><p>Another way to implement the rule engine could be to use an event processor. An event (e.g. new entity is created) is first inserted in an event queue.  The rule engine fires all the rules relevant for this event, and removes the event.  Each rule could fire other events that are inserted in the event loop.  Once the event queue is empty, all rules and their consequences are processed.   Of course, a rule engine requires a little bit more intelligence (for example identify if rules are cylcing, tigerring each other endlessly).  But it&#39;s already a good start.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../business-rules-business-logic-input-validation/'>Business rules, business logic, input validation</a></li><li class="list-group-item"><a href='../how-to-tackle-complex-business-rule-and-logic/'>How to tackle complex business rule and logic</a></li><li class="list-group-item"><a href='../thick-models-vs-business-logic-where-do-you-draw-the-distinction/'>Thick models Vs. Business Logic, Where do you draw the distinction</a></li><li class="list-group-item"><a href='../mvc-business-logic-layer-in-mvc-application/'>Mvc &#8211; Business Logic Layer in MVC Application</a></li><li class="list-group-item"><a href='../business-rules-business-proceses-and-business-logic/'>Business rules, business proceses and business logic</a></li><li class="list-group-item"><a href='../architecture-business-layer-in-database-logic-system/'>Architecture &#8211; Business Layer in Database logic system</a></li><li class="list-group-item"><a href='../architecture-how-to-structure-business-layer-logic-app-with-much-complicated-business-layer-logic-calculations-etc/'>Architecture &#8211; How to structure business layer logic (app with much complicated business layer logic, calculations etc.)</a></li><li class="list-group-item"><a href='../architecture-where-should-business-logic-sit-in-microservice-architecture/'>Architecture &#8211; Where should business logic sit in microservice architecture</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>