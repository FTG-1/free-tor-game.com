<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Database &#8211; Why don&#8217;t relational databases support returning information in a nested format &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1072833 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1072833" class="post-1072833 software type-software status-publish hentry category-software tag-database tag-query tag-rdbms tag-sql"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Database &#8211; Why don&#8217;t relational databases support returning information in a nested format</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database</span><span class="mr-2 badge badge-info">query</span><span class="mr-2 badge badge-warning">rdbms</span><span class="mr-2 badge badge-primary">sql</span></p><div class="entry-content"><p>Suppose I&#39;m building a blog that I want to have posts and comments. So I create two tables, a &#39;posts&#39; table with an autoincrementing integer &#39;id&#39; column, and a &#39;comments&#39; table that has a foreign key &#39;post_id&#39;.</p><p>Then I want to run what will probably be my most common query, which is to retrieve a post and all of its comments. Being rather new to relational databases, the approach that appears most obvious to me is to write a query that would look something like:</p><pre><code>SELECT id, content, (SELECT * FROM comments WHERE post_id = 7) AS comments
FROM posts
WHERE id = 7
</code></pre><p>Which would give me the id and content of the post that I want, along with all the relevant comment rows packaged neatly in an array (a nested representation like you&#39;d use in JSON). Of course, SQL and relational databases don&#39;t work like this, and the closest they can get is to do a join between &#39;posts&#39; and &#39;comments&#39; that will return a lot of unnecessary duplication of data (with the same post information repeated in every row), which means processing time is spent both on the database to put it all together and on my ORM to parse and undo it all.</p><p>Even if I instruct my ORM to eagerly load the post&#39;s comments, the best it&#39;ll do is to dispatch one query for the post, and then a second query to retrieve all of the comments, and then put them together client-side, which is also inefficient.</p><p>I understand that relational databases are proven technology (hell, they&#39;re older than I am), and that there&#39;s been a ton of research put into them over the decades, and I&#39;m sure there&#39;s a really good reason why they (and the SQL standard) are designed to function the way they do, but I&#39;m not sure why the approach I outlined above isn&#39;t possible. It seems to me to be the most simple and obvious way to implement one of the most basic relationships between records. Why don&#39;t relational databases offer something like this?</p><p>(Disclaimer: I mostly write webapps using Rails and NoSQL datastores, but recently I&#39;ve been trying out Postgres, and I actually like it a lot. I don&#39;t mean to attack relational databases, I&#39;m just perplexed.)</p><p>I&#39;m not asking how to optimize a Rails app, or how to hack my way around this problem in a particular database. I&#39;m asking why the SQL standard works this way when it seems counterintuitive and wasteful to me. There must be some historical reason why the original designers of SQL wanted their results to look like this.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>C. J. Date goes into detail about this in Chapter 7 and Appendix B of <a href="http://rads.stackoverflow.com/amzn/click/0596523068">SQL and Relational Theory</a>.  You&#39;re right, there&#39;s nothing in relational theory that prohibits an attribute&#39;s data type from being a relation itself, as long as it&#39;s the <em>same</em> relation type on every row.  Your example would qualify.</p><p>But Date says structures like this are &#34;usually--but not invariably--contraindicated&#34; (i.e. a Bad Idea) because hierarchies of relations are <em>asymmetric</em>.  For example, a transformation from nested structure to a familiar &#34;flat&#34; structure cannot always be reversed to recreate the nesting.</p><p>Queries, constraints, and updates are more complex, harder to write, and harder for the RDBMS to support if you allow relation-valued attributes (RVA&#39;s).</p><p>It also muddies database design principles, because the <em>best</em> hierarchy of relations isn&#39;t so clear.  Should we design a relation of Suppliers with a nested RVA for parts supplied by a given Supplier?  Or a relation of Parts with a nested RVA for suppliers who supply a given Part?  Or store both, to make it easy to run different types of queries?</p><p>This is the same dilemma that results from the <a href="http://en.wikipedia.org/wiki/Hierarchical_database_model">hierarchical database</a> and the <a href="http://en.wikipedia.org/wiki/Document-oriented_database">document-oriented database</a> models.  Eventually, the complexity and cost of accessing nested data structures drives designers to store data redundantly for easier lookup by different queries.  The relational model discourages redundancy, so RVA&#39;s can work against the goals of relational modeling.</p><p>From what I understand (I have not used them), <a href="http://dbappbuilder.sourceforge.net/Rel.php">Rel</a> and <a href="http://www.dataphor.org/">Dataphor</a> are RDBMS projects that support relation-valued attributes.</p><hr/><p>Re comment from @dportas:</p><p><em>Structured types</em> are part of SQL-99, and Oracle supports these.  But they don&#39;t store multiple tuples in the nested table per row of the base table.  The common example is an &#34;address&#34; attribute which appears to be a single column of the base table, but has further sub-columns for street, city, postal code, etc.</p><p><a href="http://www.databasejournal.com/features/oracle/article.php/3788331/So-what-is-an-Oracle-Nested-Table.htm"><em>Nested tables</em></a> are also supported by Oracle, and these do allow multiple tuples per row of the base table.  But I am not aware that this is part of standard SQL.  And keep in mind the <a href="http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:8135488196597">conclusion</a> of one blog: &#34;I&#39;ll never use a nested table in a CREATE TABLE statement.  You spend all of your time UN-NESTING them to make them useful again!&#34;</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../database-why-dont-databases-have-good-full-text-indexes/'>Database &#8211; Why don&#8217;t databases have good full text indexes</a></li><li class="list-group-item"><a href='../why-is-the-unit-of-work-pattern-considered-fast-and-efficient-when-working-with-an-orm/'>Why is the Unit of Work pattern considered fast and efficient when working with an ORM</a></li><li class="list-group-item"><a href='../database-should-we-have-a-database-independent-sql-like-query-language-in-django/'>Database &#8211; Should we have a database independent SQL like query language in Django</a></li><li class="list-group-item"><a href='../database-why-do-relational-databases-only-accept-sql-queries/'>Database &#8211; Why do relational databases only accept SQL queries</a></li><li class="list-group-item"><a href='../design-why-dont-rdbmses-return-joined-tables-in-a-nested-format/'>Design &#8211; Why don&#8217;t RDBMSes return joined tables in a nested format</a></li><li class="list-group-item"><a href='../database-why-dont-windows-linux-use-relational-databases-rdbms/'>Database &#8211; Why don&#8217;t Windows/Linux use relational Databases (RDBMS)</a></li><li class="list-group-item"><a href='../database-do-i-store-blog-posts-in-a-database-and-how-to-continue-to-make-posts/'>Database &#8211; Do I store blog posts in a database? And how to continue to make posts</a></li><li class="list-group-item"><a href='../data-layer-without-orm-how-to-work-with-it-in-efficient-way/'>Data layer without ORM &#8211; how to work with it in efficient way</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>