<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Is this a good practice or not &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074275 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074275" class="post-1074275 software type-software status-publish hentry category-software tag-asp-net-mvc tag-c tag-design tag-design-patterns tag-separation-of-concerns"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Is this a good practice or not</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">asp.net-mvc</span><span class="mr-2 badge badge-info">c</span><span class="mr-2 badge badge-warning">design</span><span class="mr-2 badge badge-primary">design-patterns</span><span class="mr-2 badge badge-danger">separation-of-concerns</span></p><div class="entry-content"><p>I have a colleague who has come up with a way of &#39;genericizing&#39; information from a database so that all his web application&#39;s drop-down lists can share the same object in his MVC.NET C# code and Views, which can contain different data depending on what tables it is being used against.</p><p>We work for a government agency, and we have facilities divided up into areas called &#34;Regions&#34;, which contain further subdivided areas called VISNs, which each contain &#34;Sites&#34; or &#34;Facilities&#34;. My colleague has developed a very complex security scheme whereby people can be granted access to data based on their permission level which can be assigned by Region, VISN, Site, or any mixture of the three. It&#39;s a nice scheme and very clever. However, he has stored procedures that return lists of Regions, VISNs, and Sites based on a person&#39;s User Id, and he is returning &#34;generic&#34; values like <code>TextFieldID</code>, <code>TextField</code>, and <code>TextParentID</code>. My first problem with this, is that looking at this data coming out of the database, I would not know what the data is. I feel that fields coming from a query or stored procedure should be descriptive of the data they are delivering. What does everyone else think? The deeper issue for me however is that he is taking some of the data, concatenating it in his stored procedure like this</p><pre class="lang-sql prettyprint-override"><code>SELECT DISTINCT
    t.VisnID,
    NULL,
    t.StationID,
    &#39;V&#39; + CAST(t.VisnID as varchar) + &#39;: &#39; + t.Station3N + &#39;: &#39; + t.StationName,
    t.Inactive
FROM Stations t 
</code></pre><p>and sending it back in a &#34;TextField&#34; property, instead of sending back the discrete data separately (<code>Station3N</code>, <code>StationName</code>) and concatenating it in the View, which would allow for different concatenation depending on what device what accessing the application (perhaps mobile and desktop). His justification is that he can send all his various drop down data and capture them all, regardless of content, in the same C# object named &#34;LookupValue.&#34;</p><pre><code>public partial class LookupValue : IEquatable&lt;LookupValue&gt;
{
    public LookupValue(string textFieldId, string textField, bool inactive)
    {
        TextFieldID = textFieldId;
        TextField = textField;
        Inactive = inactive;
    }

    public LookupValue(string textParentId, string textFieldId, string textField, bool inactive)
    {
        TextParentID = textParentId;
        TextFieldID = textFieldId;
        TextField = textField;
        Inactive = inactive;
    }

    public LookupValue(string textParentId, string textSelfParentId, string textFieldId, string textField, bool inactive)
    {
        TextParentID = textParentId;
        TextSelfParentID = textSelfParentId;
        TextFieldID = textFieldId;
        TextField = textField;
        Inactive = inactive;
    }

    /// &lt;summary&gt;
    /// Returns a custom string identifier if the Inactive property is true.
    /// &lt;/summary&gt;
    public string GetInactiveString()
    {
        string value = &#34;&#34;;
        if (Inactive)
        {
            value = &#34;[I]&#34;;
        }

        return value;
    }

    /// &lt;summary&gt;
    /// Returns a custom text label that concatenates the TextField property with the custom string identifier of the Inactive property.
    /// &lt;/summary&gt;
    public string GetDisplayNameWithInactiveString
    {
        get { return TextField + &#34; &#34; + GetInactiveString(); }
    }

    public bool Equals(LookupValue other)
    {
        //Check whether the compared object is null.  
        if (Object.ReferenceEquals(other, null)) return false;

        //Check whether the compared object references the same data.  
        if (Object.ReferenceEquals(this, other)) return true;

        //Check whether the products&#39; properties are equal.  
        return TextFieldID.Equals(other.TextFieldID) &amp;&amp; TextField.Equals(other.TextField);
    }

    // If Equals() returns true for a pair of objects
    // then GetHashCode() must return the same value for these objects.
    public override int GetHashCode()
    {
        //Get hash code for the TextFieldID field if it is not null.  
        int hashTextFieldId = TextFieldID == null ? 0 : TextFieldID.GetHashCode();

        //Get hash code for the Code field.  
        int hashTextField = TextField.GetHashCode();

        //Calculate the hash code for the product.  
        return hashTextFieldId ^ hashTextField;
    }
}
</code></pre><p>He believes the re-usability of this object is worth the violation of Separation of Concerns and possible future difficulties in handling more than one display variation for a drop-down. I should point out that this object is contained in his Data project namespace (our projects are separated into Data, Web, Services, etc.) instead of the Web project namespace and he also returns this object to the Web layer via his Repository queries which call the stored procedures that I described earlier,  which is gross violation of Separation of Concerns in my opinion.</p><p>I am just looking for some confirmation from other programmers that this is in fact a bad practice, and also looking for ideas I can present him on better ways to do what he is attempting. I have my own ideas, but again I&#39;m just looking for other&#39;s ideas so I have more options to present to him.</p><p>&#8211;Edit &#8212; I forgot to mention that we are using Entity Framework as an ORM, and his Repository classes in his DAL are dumping the data from the stored procs into this LookupValue object.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m going to start flat out by saying after more than 30 years experience writing software and working in I.T in general, I have NEVER, EVER yet found a good reason for concatenating data coming out of a database.</p><p>You could be putting 90% of your application code in the DB infrastructure, and doing all sorts of magic things with it, and I still would not be persuaded that it&#39;s ever a good idea.</p><p>As has been hinted already, databases are designed for one specific task, and one specific task only, storing, searching, retrieving and general management of data.</p><p>The meta data, indexes, clusters and everything else a DBMS does well are there to ensure that it does its job with the best efficiency possible, and if you try to circumvent that, you&#39;re gonna land yourself in a whole heap of trouble.</p><p>Look at it this way - would you attempt to take your own C# code, and compile it by hand, to get better results than the compiler? Could you even get better results? I doubt it, in the same token creating your own data scheme is reckless and irresponsible IMHO.</p><p>That said, maybe your colleague has his reasons. There may, as others have said, be factors you&#39;re not privy to.</p><p>What he needs to consider is not only the ramifications of his en-devour on current affairs, but what it holds for the future.</p><p>Things like:</p><ul><li><p>1) Future maintenance.  Will he be still there in 10 years, or even 1 year for that matter?  If not, who&#39;s going to maintain it?</p></li><li><p>2) If he does leave, and he leaves under bad circumstances, will someone get trained in how his system works?  Or will upper management just assume that everyone who worked with him understands this code? (Take it from me, I&#39;ve been in this position quite a few times, it&#39;s not funny when you don&#39;t have the first clue what you&#39;re looking at.)</p></li><li><p>3) What happens if the HTML spec changes in such a way that his concatenation breaks future revisions (because he concatenates using some protected character sequence for example), or what if future spec changes break his concatenation? (This scenario has already happened more times than you might realize.)</p></li><li><p>4) If your database server goes down in a ball of flames, which is easier to recover? A standards compliant database structure that everyone understands, or a hideously obfuscated 3 headed mess of stored procs and custom data schemes? (I know which I&#39;d pick.)</p></li></ul><p>I could sit here and give you a dozen more reasons easily, but I&#39;m not going to.</p><p>Instead, I&#39;m going to propose what just might be way out, that keeps you both happy.</p><p>He might be doing things this way because he doesn&#39;t know better.</p><p>You mention he&#39;s more of a DBA than a DEV, and that&#39;s fine, I&#39;ve worked with many guys who are amazing DBA&#39;s but put a compiler in front of them and they&#39;ll curl up a ball and start to cry, and will happily admit their lack of knowledge.</p><p>Likewise, I&#39;ve worked with DBA&#39;s who are so utterly stubborn and blind to their way of doing things for whatever reason, that they&#39;ll enforce that structure all the way down the line, often because they don&#39;t really understand what&#39;s happening beyond the DBA, but like many of us don&#39;t want to admit it (Human nature, is what it is...)</p><p>Whichever way you look at it, he&#39;s not going to budge, and you&#39;re not going to be happy until your &#34;do it correctly, inner dev&#34; is pacified.</p><p>What you need is a compromise.</p><p>In my mind, you can easily achieve this compromise using views.</p><p>See if you can get him to put all his logic into a set of views, then the code that needs this approach can query those, just as easily as it queries existing tables and/or stored procs.</p><p>This way, the actual table definitions, remain in a pristine condition with separate columns, so you can write standard, compliant ORM based code against them.</p><p>I&#39;ve used this approach very successfully in the past for a not too dissimilar scenario, where I was tasked with creating an application to process some geographic data.</p><p>In my particular case, I needed to get some data back from a DB table, but this table had already been pre-processed in the back-end to return the data in a format suitable for another app.  My solution here was to transform that data back to what was needed for my task, using a view.</p><p>Doing this, kept the original interface, and program code working, but it gave me the flexibility to change things for the better in the slice of the work I needed to do.</p><p>If you can&#39;t take this approach at the DB level, because for example he controls the DB and its access, then you may have to resort to other tricks.</p><p>If you&#39;re working in C# as you say you are, then it&#39;s not difficult to hook the code in different modules.</p><p>.NET code, whatever language it&#39;s written in, is compiled down to simple MSIL, and there are dozens of ways of injecting your own code in there to replace anything that&#39;s already running.</p><p>Robert Harvey above mentioned using a product like Automapper.</p><p>This is a quite reasonable suggestion, but one you&#39;ll want to give some thought to.</p><p>I use Automapper all the time, and it&#39;s good at the job it&#39;s designed for.  That job is passing and matching DTO&#39;s between layers in your N-Tier design.</p><p>Automapper is typically used to flatten and combine multiple DTO&#39;s into a single level view model, typically for use in a presentation layer driven pattern such as MVC or MVVM.</p><p>In this particular case however, I don&#39;t quite see how Automapper might help you. AM is conventions based.  This means that if you have, say, an EF object on one side that looks like this:</p><pre><code>public class EFobject
{
  public string name { get; set; }
  public string email { get; set; }
  public string dept { get; set; }
}
</code></pre><p>and a regular POCO on the other side that looks like this:</p><pre><code>public class RegularPoco
{
  public string name { get; set; }
  public string email { get; set; }
}
</code></pre><p>Automapper will ensure that the name and email fields get copied across, but will ignore the dept field.</p><p>If you were concatenating the strings at the code level, then you could easily use Automapper to produce the same result your colleague is generating, by specifying mapping rules that took those three columns, and pushed them into one column with the &#39;:&#39; symbol between each. Breaking them apart, however, AM is the wrong tool for the job.</p><p>Another option you have, is to handle this in your business layer.</p><p>If you&#39;re following good N-Tier architecture and design principles, then at an absolute minimum, you should have &#39;Presentation&#39;, &#39;Business Rules&#39; and &#39;Data&#39; layers.</p><p>Myself personally, I usually separate my DTO&#39;s and View models out into distinct layers too, but that&#39;s just to aid the way I work in Visual Studio.</p><p>With a business rules layer, nothing makes it to the presentation layer without first going through that layer, and at that point you have the entire .NET eco-sphere at your disposal to break that string apart again.</p><p>However, as you point out, that&#39;s no help when you don&#39;t know what the original data was, so you have one other possible approach to dealing with this.</p><p>If you can&#39;t break him of his habit, and he resists change, then use &#34;Praise based change&#34;.</p><p>Praise him on his approach, and appear to be helpful, suggest &#34;Improving&#34; on his way of doing things by adding in data you can digest at the Business rules layer. For example, get him to change the output from something like:</p><pre><code>1234:station1:fred
</code></pre><p>to</p><pre><code>1234(stationid,int):station1(stationref,string):fred(stationname,string)
</code></pre><p>in his select driven obsession he can then simply pass things through a simple search and replace that removes anything in the brackets including said brackets, but... gives you all the information you need to de-serialize this thing back into a regular POCO.</p><p>Out of everything I&#39;ve outlined here, I really wouldn&#39;t recommend going this route however, but sometimes you just have no choice but to go with the flow, and improvements for the greater good of your task are sometimes the only effective weapon you have.</p><p><strong><em>In summary:</em></strong></p><p>Standards and patterns &amp; practices exist for a reason, and that reason extends way beyond initial development into the ALM Cycle until the product is eventually replaced.</p><p>I&#39;ve come across so many DBA&#39;s (and devs for that matter) over the years who just can&#39;t see this bigger picture beyond finishing the list of tickets they have to work on, that it scares the living daylights out of me.</p><p>Team members should never be looking for ways to do things bigger &amp; better than everyone else. Instead, you should always be looking for common ground, and common sense.</p><p>As one of the other posters above put it: <strong>simplicity is always the best option</strong> , never forget what KISS stands for, because one fine day when the S**t hits the fan, it might just be KISS that saved you from getting well and truly roasted.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-design-many-properties-complex-constructor-and-equality/'>C# Design, many properties, complex constructor and equality</a></li><li class="list-group-item"><a href='../c-design-pattern-to-solve-this-problem/'>C# &#8211;  design pattern to solve this problem</a></li><li class="list-group-item"><a href='../c-best-way-of-validating-class-properties/'>C# &#8211; Best way of validating Class properties</a></li><li class="list-group-item"><a href='../c-what-to-return-with-async-crud-methods/'>C# &#8211; What to Return with Async CRUD methods</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>