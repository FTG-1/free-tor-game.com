<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Database &#8211;  the proper way to synchronize data across microservices &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064850 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064850" class="post-1064850 software type-software status-publish hentry category-software tag-database tag-microservices"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Database &#8211;  the proper way to synchronize data across microservices</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database</span><span class="mr-2 badge badge-info">microservices</span></p><div class="entry-content"><p>I am relatively new to microservice architecture. We have a moderately sized web application and I am weighing the pros and cons of breaking it out into microservices instead of a monolithic system we have now moving forward.</p><p>As far as I understand it, consider microservices <code>A</code> and <code>B</code> each of which rely on a subset of data that the other has. If a message is posted by <code>A</code> saying that something has changed, <code>B</code> can consume that message and replicate a local copy of <code>A</code>&#39;s info and use that to do whatever <code>B</code> needs to do.</p><p>However, what if <code>B</code> goes down/fails and after a while, comes back up again. During that down time, <code>A</code> has published two more messages.  How does <code>B</code> know how to update its local copy of <code>A</code>&#39;s info?</p><p>Granted, if <code>B</code> is the only consumer of <code>A</code>&#39;s queue, then it can start reading it once it comes back online but what if there are other consumers of that queue and those messages are consumed?</p><p>As a more concrete example, if a <code>Users</code> service has its email address updated while a <code>Billing</code> microservice is down, if the <code>Billing</code> microservice comes back up again, how does it know that the email has been updated?</p><p>When microservices come back up, does it do a broadcast saying &#34;Hey I&#39;m back up, give me all your current info?&#34;</p><p>In general what would be the best industry practices for data synchronization?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>After doing a bit more research, I stumbled upon <a href="https://hackernoon.com/migrating-to-microservices-and-event-sourcing-the-dos-and-donts-195153c7487d" rel="noreferrer">this</a> article from which I&#39;ve pulled some quotes out that I think is helpful for what I want to accomplish (and for any future readers). This offers a way to adopt a reactive programming model over an imperative programming model.</p><p><strong>Event-sourcing</strong></p><blockquote><p>The idea here is to represent every application’s state transition in
 a form of an immutable event. Events are then stored in a log or
 journal form as they occur (also referred to as ‘event store’). They
 can also be queried and stored indefinitely, aiming to represent how
 the application’s state, as a whole, evolved over time.</p></blockquote><p>What this helps accomplish is that if a microservice goes down yet other events pertinent to it are being published <em>and</em> events are consumed by, say, other instances of that microservice, when that microservice comes back up, it can refer to this <code>event store</code> to retrieve all the events that it missed during the period it went down.</p><p><strong>Apache Kafka as Event Broker</strong></p><p>Consider the use of Apache Kafka which can store and dispatch thousands of events per second and has built-in replication and fault-tolerance mechanisms. It has a persistent store of events which can be stored on disk indefinitely and consumed at any time (but not removed) from the Topic (Kafka&#39;s fancy queue) were delivered to.</p><blockquote><p>The events are then assigned offsets that univocally identify them
 within the Topic — Kafka can manage the offsets itself, easily
 providing “at most once” or “at least once” delivery semantics, but
 they can also be negotiated when an event consumer joins a Topic,
 allowing microservices to start consuming events from any arbitrary
 place in time — usually from where the consumer left off. If the last
 consumed event offset is transactionally persisted in the services’s
 local storage when the usecases ‘successfully complete’, that offset
 can easily be used to achieve an “exactly once” event delivery
 semantics.</p></blockquote><p>In fact, when consumers identify themselves to Kafka, Kafka will record which messages were delivered to which consumer so that it doesn&#39;t serve it up again.</p><p><strong>Sagas</strong></p><blockquote><p>For more complex usecases where the communication among different
 services is indeed necessary, the responsibility of finishing the
 usecase must be well recognized — the usecase is decentralized and
 only finishes when all the services involved acknowledge their task as
 successfully completed, otherwise the whole usecase must fail and
 corrective measures must be triggered to rollback any invalid local
 state.</p></blockquote><p>This is when saga comes into play. A saga is a sequence of local transactions. Each local transaction updates the database and publishes a message or event to trigger the next local transaction in the saga. If a local transaction fails because it violates a business rule then the saga executes a series of compensating transactions that undo the changes that were made by the preceding local transactions. Read <a href="http://microservices.io/patterns/data/saga.html" rel="noreferrer">this</a> for more info.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../a-canonical-schema-in-a-context-of-microservices-architecture/'>A canonical schema in a context of microservices architecture</a></li><li class="list-group-item"><a href='../messaging-between-microservices-on-aws/'>Messaging between microservices on AWS</a></li><li class="list-group-item"><a href='../architecture-net-core-microservice-messaging-with-amazon-sns-and-sqs/'>Architecture &#8211; .NET Core Microservice messaging with Amazon SNS and SQS</a></li><li class="list-group-item"><a href='../architecture-data-replication-in-microservices/'>Architecture &#8211; Data replication in microservices</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>