<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Architecture &#8211;  form inheritance be avoided &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069099 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069099" class="post-1069099 software type-software status-publish hentry category-software tag-architecture tag-designer tag-winforms"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Architecture &#8211;  form inheritance be avoided</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">designer</span><span class="mr-2 badge badge-warning">winforms</span></p><div class="entry-content"><p>I remember learning VB4 and dragging a button onto a form, double-clicking on that button, and typing code into that event handler I had just been magically blessed with. Coming from QBASIC I was thrilled with the &#34;V&#34; in &#34;VB&#34;, the visual designer was literally the best thing since sliced bread.</p><p>Of course you could do all that programmatically but the magic of the &#34;V&#34; was so appealing you just couldn&#39;t help but drag that button. We were encouraged to take that route.</p><p>But then a few years ago I started learning about C# and the .net framework and was fascinated by the way everything I thought I knew had just gone out the window. There&#39;s a lot of <em>magic</em> going on in VB6 that&#39;s completely unveiled in .net: take constructors and the <code>InitializeComponents</code> method for example. In the latter you&#39;d find all the control instances you&#39;ve dragged from the toolbox, all the events you&#39;ve registered and the properties you&#39;ve set in the designer.</p><p>And that&#39;s fine&#8230; I guess. It&#39;s just, I feel like I don&#39;t &#34;own&#34; what&#39;s going on, this code that I can only modify via the designer annoys the heck out of me. Every time you copy a button that says &#34;Ok&#34; from one form to another (sometimes along with its brother &#34;Cancel&#34;), you are actually duplicating code, and that&#39;s a <em>sin</em> isn&#39;t it? DRY, don&#39;t repeat yourself, says the <em>Pope</em>.</p><p>Religions and schools of thought aside, in all objectivity, shouldn&#39;t we derive forms from base forms instead, and have the &#34;Ok&#34; button (and all of its friends) live on the base form? Something like a <code>FormBase</code> from which derives a <code>DialogFormBase</code>; all classes created in no time&#8230; by typing code. The buttons are created depending on how the class is instanciated (i.e. a constructor enum argument determines which buttons are to be created), controls are laid out inside an arrangement of split panels and flow layout panels, injected into the form as <code>Content</code> that fits into the main content panel. Isn&#39;t this what ASP.net does with master pages and content placeholders? I&#39;d derive a form when I need a new &#34;master page&#34;, but this new &#34;master page&#34; still derives from a base form class so the visuals are consistent across the entire application.</p><p>To me that&#39;s <em>much</em> more code reuse than anything else I&#39;ve ever done with the designer in WinForms, and it wasn&#39;t even hard, and code isn&#39;t cluttered with a 200-lines method that I have no control over, I can put comments where I like, they won&#39;t get overwritten by a designer. I guess it&#39;s just a matter of patterns and architecture, which is what brought me to this link: <a href="https://softwareengineering.stackexchange.com/questions/124551/best-design-for-windows-forms-that-will-share-common-functionality">Best design for Windows forms that will share common functionality</a>, where I realized I was spot on, except <strong>the answer there, suggests exactly what I&#39;m doing, but it&#39;s advising <em>against</em> form inheritance <em>because</em> of designer considerations. That&#39;s the part I don&#39;t get</strong>. I would rather advise <em>against</em> using the designer <em>because</em> of code structure considerations, especially in regards with form and control inheritance, which I see no reason to avoid other than <em>well it breaks the designer</em>.</p><p>We can&#39;t all be just lazy, so what part am I missing?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m gonna oppose you with different paradigm : Favor composition over inheritance.</p><p>Even when you start writing GUI code by hand and use inheritance to share behavior and visuals between forms, you will hit same problem as normal OOP design. Lets say you have DialogForm, that has OK/Cancel buttons and GridForm, that has grid. You derive all dialogs from DialogForm and all forms with Grid from GridForm. And then you find out you want form with both. How would you solve it? If you are using form inheritance, then there is no way solve it. On the other side, if you are using UserControls, then you can simply put GridControl on your form and be done with it. And you can still use designer with UserControls, so you don&#39;t have to waste time writing tedious GUI code.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-best-design-for-windows-forms-that-will-share-common-functionality/'>C# &#8211; Best design for Windows forms that will share common functionality</a></li><li class="list-group-item"><a href='../how-to-properly-structure-a-project-in-winform/'>How to properly structure a project in winform</a></li><li class="list-group-item"><a href='../c-a-proper-way-of-building-winform-apps-with-multiple-screens/'>C# &#8211;  a proper way of building Winform apps with multiple &#8220;screens&#8221;</a></li><li class="list-group-item"><a href='../c-pattern-for-communicating-between-nested-usercontrols-and-parent-form-c-winforms/'>C# &#8211; Pattern for communicating between nested usercontrols and parent form (C# / Winforms)</a></li><li class="list-group-item"><a href='../c-i-have-a-few-questions-about-the-mvp-pattern-in-a-winforms-project/'>C# &#8211; I have a few questions about the MVP pattern in a WinForms project</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>