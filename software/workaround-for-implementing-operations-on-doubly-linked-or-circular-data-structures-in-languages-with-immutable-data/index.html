<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Workaround for implementing operations on doubly linked or circular data structures in languages with immutable data &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087940 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087940" class="post-1087940 software type-software status-publish hentry category-software tag-data-structures tag-functional-programming tag-graph tag-immutability"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Workaround for implementing operations on doubly linked or circular data structures in languages with immutable data</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">data structures</span><span class="mr-2 badge badge-info">functional programming</span><span class="mr-2 badge badge-warning">graph</span><span class="mr-2 badge badge-primary">immutability</span></p><div class="entry-content"><p>I would like to learn how to make graphs and perform some local operations on them in Haskell, but the question is not specific to Haskell, and instead of graphs we may consider doubly linked lists.</p><p><strong>Question:</strong> <em>What would be an idiomatic or recommended way to implement a doubly linked list (or other doubly linked or circular data structure) and operations on it in a language that mainly supports and advocates for immutable data structures (Haskell, Clojure, etc.)?  In particular, how to use in-place updates, which are formally forbidden by the language?</em></p><p>I can easily imagine that if some local operation is performed on a doubly linked list (if an item is inserted, for example), there may be no need to copy the entire list immediately due to the laziness of the language.  However, since the list is doubly linked, if it is modified in one place, none of the old nodes can be used in the new version of the list, and they would need to be somehow marked, copied, garbage-collected sooner or later.  Obviously these are redundant operations if only the updated copy of the list shall be used, but they would add an &#34;overhead&#34; proportional to the size of the list.</p><p>Does this mean that for such tasks immutable data is simply inappropriate, and functional declarative languages without &#34;native&#34; support for mutable data are not as good as imperative ones?  Or, is there some tricky workaround?</p><p>P.S. I have found some articles and presentations on this subject in the Internet but had hard time following them, while i think that the answer to this question should not take more than one paragraph and maybe a diagram&#8230;  I mean, if there is no &#34;functional&#34; solution to this problem, the answer probably is &#34;use C&#34;.  If there is one, then how complicated can it be?</p><hr/><h3>Related questions</h3><ul><li><p><a href="https://softwareengineering.stackexchange.com/q/140660/">&#34;Data structures in functional programming&#34;</a>.<br /> My specific question about using in-place updates instead of inefficient alternatives is not discussed there.</p></li><li><p><a href="https://softwareengineering.stackexchange.com/q/167784/">&#34;Internal Mutation of Persistent Data Structures&#34;</a>.<br /> There the emphasis seems to be on low-level implementation in an unspecified language, while my question is about the right choice of a language (functional or otherwise) and about possible idiomatic solutions in functional languages.</p></li></ul><hr/><h3>Relevant quotations</h3><blockquote><p>Purely functional programming languages allow many algorithms to be expressed very concisely, but there are a few algorithms in which in-place updatable state seems to play a crucial role.  For these algorithms, purely-functional languages, which lack updatable state, appear to be inherently inefficient (<a href="http://dl.acm.org/citation.cfm?doid=44546.44559" rel="nofollow noreferrer">[Ponder, McGeer and Ng, 1988]</a>).</p></blockquote><p>&#8212; John Launchbury and Simon Peyton Jones, <a href="http://dl.acm.org/citation.cfm?doid=178243.178246" rel="nofollow noreferrer"><em>Lazy functional state threads</em></a> (1994), also John Launchbury and Simon Peyton Jones, <a href="http://link.springer.com/article/10.1007/BF01018827" rel="nofollow noreferrer"><em>State in Haskell</em></a> (1995).  These papers introduce <a href="https://hackage.haskell.org/package/base/docs/Control-Monad-ST.html" rel="nofollow noreferrer"><code>ST</code></a> monadic type constructor in Haskell.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>There could be other efficient immutable data structures that fit your particular task, but are not as general as a doubly-linked list (which is unfortunately <a href="http://blog.nativeflow.com/escalating-futex" rel="nofollow noreferrer">prone to concurrent modification bugs</a> due to its mutability). If you specify your problem more narrowly, such a structure can probably be found.</p><p>The general answer for (relatively) economic traversing of immutable structures is <strong>lenses.</strong> The idea is that you can keep just enough information to reconstruct a modified immutable structure from its unmodified parts and the currently modified piece, and navigate over it to a neighboring node.</p><p>Another useful structure is a <a href="https://en.wikipedia.org/wiki/Zipper_(data_structure)" rel="nofollow noreferrer">zipper</a>. (The funny part is that the type signature for a <s>lens</s> zipper is a school-math derivative of a type signature of the structure.)</p><p>Here are a few links.</p><ul><li><a href="https://stackoverflow.com/questions/380438/what-is-the-zipper-data-structure-and-should-i-be-using-it">A simple explanation of zippers</a></li><li><p><a href="http://learnyouahaskell.com/zippers" rel="nofollow noreferrer">A chapter on zippers from from &#34;Learn you a Haskell&#34;</a></p></li><li><p><a href="http://www.slideshare.net/knoldus/scala-lens-an-introduction" rel="nofollow noreferrer">Introduction to lenses in Scala (slides)</a></p></li><li><a href="https://www.fpcomplete.com/school/to-infinity-and-beyond/pick-of-the-week/basic-lensing" rel="nofollow noreferrer">Basic Lensing</a></li><li><a href="https://www21.in.tum.de/teaching/fp/SS15/papers/17.pdf" rel="nofollow noreferrer">Lenses in Functional Programming</a></li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../critique-of-the-io-monad-being-viewed-as-a-state-monad-operating-on-the-world/'>Critique of the IO monad being viewed as a state monad operating on the world</a></li><li class="list-group-item"><a href='../languages-with-graph-data-structures-and-algorithms-in-standard-library/'>Languages with graph data structures and algorithms in standard library</a></li><li class="list-group-item"><a href='../uses-of-persistent-data-structures-in-non-functional-languages/'>Uses of persistent data structures in non-functional languages</a></li><li class="list-group-item"><a href='../data-structure-for-two-dimensional-board-games-in-functional-languages/'>Data structure for two-dimensional board games in Functional languages</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>