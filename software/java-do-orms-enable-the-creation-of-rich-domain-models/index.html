<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Do ORMs enable the creation of rich domain models &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074763 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074763" class="post-1074763 software type-software status-publish hentry category-software tag-design tag-domain-driven-design tag-java tag-orm tag-stored-procedures"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Do ORMs enable the creation of rich domain models</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">domain-driven-design</span><span class="mr-2 badge badge-warning">java</span><span class="mr-2 badge badge-primary">orm</span><span class="mr-2 badge badge-danger">stored-procedures</span></p><div class="entry-content"><p>After using Hibernate on most of my projects for about 8 years, I&#39;ve landed on a company that discourages its use and wants applications to only interact with the DB through stored procedures.</p><p>After doing this for a couple of weeks, I haven&#39;t been able to create a rich domain model of the application I&#39;m starting to build, and the application just looks like a (horrible) transactional script.</p><p>Some of the issues I&#39;ve found are:</p><ul><li>Cannot navigate object graph as the stored procedures just load the minimum amount of data, which means that sometimes we have similar objects with different fields. One example is: we have a stored procedure to retrieve all the data  from a customer, and another to retrieve account information plus a few fields from the customer.</li><li>Lots of the logic ends up in helper classes, so the code becomes more structured (with entities used as old C structs).</li><li>More boring scaffolding code, as there&#39;s no framework that extracts result sets from a stored procedure and puts it in an entity.</li></ul><p>My questions are:</p><ul><li>has anyone been in a similar situation and didn&#39;t agree with the store procedure approach? what did you do?</li><li>Is there an actual benefit of using stored procedures? apart from the silly point of &#34;no one can issue a drop table&#34;.</li><li>Is there a way to create a rich domain using stored procedures? I know that there&#39;s the possibility of using AOP to inject DAOs/Repositories into entities to be able to navigate the object graph. I don&#39;t like this option as it&#39;s very close to voodoo.</li></ul><hr/><h2>Conclusion</h2><p>First, thank you all for your answers. The conclusion that I&#39;ve arrived is that ORMs don&#39;t enable the creation of Rich Domain models (as some people mentioned), but it does simplify the the amount of (often repetitive) work. The following is a more detailed explanation of the conclusion, but is not based on any hard data.</p><p>Most applications request and send information to other systems. To do this, we create an abstraction in the model terms (e.g. a business event) and the domain model sends or receives the event. The event usually needs a small subset of information from the model, but not the whole model. For example in a online shop, a payment gateway requests some user information and the total to charge a user, but doesn&#39;t require the purchase history, available products, and all the customer base. So the event has a small and specific set of data.</p><p>If we take the database of an application as an external system, then we need to create an abstraction that allows us to map the Domain Model entities to the database (<a href="https://softwareengineering.stackexchange.com/a/140827/31260">as NimChimpsky mentioned</a>, using a data-mapper). The obvious difference, is that now we need to handcraft a mapping for each model entity to the database (either a legacy schema or stored procedures), with the extra pain that, since the two are not in sync, one domain entity might map partially to a database entity (e.g a UserCredentials class that only contains username and password is mapped to a Users table that has other columns), or one domain model entity might map to more than one database entity (for example if there&#39;s a one-to-one mapping on the table, but we want all the data in just one class).</p><p>In an application with a few entities, the amount of extra work might be small if there&#39;s no need to transverse the entities, but it increases when there&#39;s a conditional need to transverse the entities (and thus we might want to implement some kind of &#39;lazy loading&#39;). As an application grows to have more entities, this work just increases (and I have the feeling that it increases non-linearly). My assumption here, is that we don&#39;t try to reinvent an ORM.</p><p>One benefit of treating the DB as an external system, is that we can code around situations in which we want 2 different versions of an application running, in which each application has a different mapping. This becomes more interesting in the scenario of continuous deliveries to production&#8230; but I think this is also possible with ORMs to a lesser extent.</p><p>I&#39;m going to dismiss the security aspect, on the basis that a developer, even if he doesn&#39;t have access to the database, can obtain most if not all the information stored in a system, just by injecting malicious code (eg. <em>I can&#39;t believe I forgot to remove the line that logs the credit card details of the customers, dear lord!</em>).</p><hr/><h3>Small update (6/6/2012)</h3><p>Stored procedures (at least in Oracle) prevent doing anything like continuous delivery with Zero downtime, as any change to the structure of the tables will invalidate the procedures and triggers. So during the time that the DB is being updated, the application will be down too.<br /> Oracle provides a <em>solution</em> for this called <a href="http://docs.oracle.com/cd/E14072_01/appdev.112/e10471/adfns_editions.htm" rel="noreferrer">Edition-Based Redefinition</a>, but the few DBAs I&#39;ve asked about this feature mentioned that it was poorly implmented and they wouldn&#39;t put it in a production DB.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Your application should still be modelled from domain driven design principles.  Whether you use an ORM, straight JDBC, calling SPs (or whatever) <strong>should not matter</strong>. Hopefully a thin layer abstracting your model from the SPs should do the trick in this case. As <a href="https://softwareengineering.stackexchange.com/a/140828/31260">another poster stated</a>, you should view the SPs and their results as a service and map the results to your domain model.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../what-are-some-of-the-benefits-of-a-micro-orm/'>What are some of the benefits of a &#8220;Micro-ORM&#8221;</a></li><li class="list-group-item"><a href='../c-rich-domain-models-how-exactly-does-behavior-fit-in/'>C# &#8211; Rich Domain Models &#8212; how, exactly, does behavior fit in</a></li><li class="list-group-item"><a href='../design-when-should-i-use-stored-procedures/'>Design &#8211; When should I use stored procedures</a></li><li class="list-group-item"><a href='../architecture-rich-domain-model-vs-strategy-pattern-in-ddd/'>Architecture &#8211; Rich domain model vs strategy pattern in DDD</a></li><li class="list-group-item"><a href='../c-separating-domain-object-and-data-models/'>C# &#8211; Separating Domain Object and Data Models</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>