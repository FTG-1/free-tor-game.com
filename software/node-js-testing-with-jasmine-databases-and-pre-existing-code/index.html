<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Node.JS testing with Jasmine, databases, and pre-existing code &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1082629 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1082629" class="post-1082629 software type-software status-publish hentry category-software tag-bdd tag-node-js tag-tdd tag-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Node.JS testing with Jasmine, databases, and pre-existing code</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">bdd</span><span class="mr-2 badge badge-info">node.js</span><span class="mr-2 badge badge-warning">tdd</span><span class="mr-2 badge badge-primary">testing</span></p><div class="entry-content"><p>I&#39;ve recently built the start of a core system which is likely going turn into a monster product.  I&#39;m building the system with node.js, and decided after I got a small base built, that It&#39;d be a great idea to start using some sort of automated test suite to test the application.</p><p>I decided to use jasmine, as it seems pretty solid and has a lot of features for stubbing spying and mocking methods and classes.  The application has a lot of external data stores and api access (kestrel, mysql, mongodb, facebook, and more).</p><p>My issue is, I&#39;ve got a good amount of code written that I want to start testing &#8211; as it represents the underpinnings of the application.  What are the best practices for testing methods/classes that access external APIs that I may or may not have control over?</p><p>As an example, I have a data structure that fetches a bunch of data from a MySQL database.  I want to test the method that retrieves the data; and I&#39;m not sure how to go about it.  I could test the <code>fetch</code> method which is supposed to return an array of objects, but to isolate the method from the database, I need to define my own fixture data.  So what I end up doing is stubbing the mysql execution, and returning a static dataset.  So, I end up writing a function that returns the dataset that makes my test pass.  That doesn&#39;t seem to actually test the code, other than verifying a method is being called.</p><p>I know this is kind of abstract and vague, it seems that the idea of testing is very much abstract though, so hopefully someone has some experience and can guide me in the right direction.</p><p>Any advice, or reading I can do is more than welcomed.</p><p>Thanks in advance.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I&#39;m definitely not an expert on testing, but I think you&#39;re on the right track, what you need are more tests: you should have a test for every type of thing that the database can return (eventually; you don&#39;t need to come up with all of them right away). Mock out a different type of return value you could expect from the database (returned one result row, returned multiple, no results, for example) for each test and make sure that your method returns the correct values.</p><p>This way your first implementation can just return the results that you&#39;d expect from your test, but as you add more tests you keep revising the implementation until it&#39;s as complete as needed.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-good-practice-for-unit-testing-with-large-or-complex-fixtures/'>Unit-testing &#8211; Good practice for unit testing with large or complex fixtures</a></li><li class="list-group-item"><a href='../best-practices-for-testing-backbone-js-apps-with-jasmine/'>Best practices for testing backbone.js apps with jasmine</a></li><li class="list-group-item"><a href='../unit-testing-do-we-need-test-data-or-can-we-rely-on-unit-tests-and-manual-testing/'>Unit-testing &#8211; Do we need test data or can we rely on unit tests and manual testing</a></li><li class="list-group-item"><a href='../use-of-fixtures-in-unit-testing/'>Use of fixtures in unit testing</a></li><li class="list-group-item"><a href='../working-with-legacy-code-introducing-an-external-bdd-integration-test-harness/'>Working with legacy code &#8211; introducing an external BDD integration test harness</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>