<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>If nulls are evil, what should be used when a value can be meaningfully absent &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1072728 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1072728" class="post-1072728 software type-software status-publish hentry category-software tag-anti-patterns tag-null"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">If nulls are evil, what should be used when a value can be meaningfully absent</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">anti-patterns</span><span class="mr-2 badge badge-info">null</span></p><div class="entry-content"><p>This is one of the rules that are beaing repeated over and over and that perplex me.</p><p><a href="https://softwareengineering.stackexchange.com/questions/12777/are-null-references-really-a-bad-thing/12836">Nulls are evil and should be avoided whenever possible</a>.</p><p>But, but &#8211; from my naivety, let me scream &#8211; sometimes a value CAN be meaningfully absent!</p><p>Please let me ask this on an example that comes from <a href="https://softwareengineering.stackexchange.com/questions/371977/write-some-code-and-plague-it-with-anti-patterns-or-not-write-it-at-all-any-esc">this anti-pattern ridden horrible code I&#39;m working on at the moment</a>. This is, at its core, a multiplayer web turn based game, where both players&#39; turns are run simultaneously (like in Pokemon, and oppositely to Chess).</p><p>After each turn the server broadcasts a list of updates to client side JS code. The Update class:</p><pre><code>public class GameUpdate
{
    public Player player;
    // other stuff
}
</code></pre><p>This class is serialized to JSON and sent to connected players.</p><p>Most updates naturally have a Player associated with them &#8211; after all, it is necessary to know which player made which move this turn. However, some updates can&#39;t have a Player meaningfully associated with them. Example: The game has been force tied because the turn limit without actions have been exceeded. For such updates, I think, it is meaningful to have the player nulled.</p><p>Of course, I could &#34;fix&#34; this code by utilizing inheritance:</p><pre><code>public class GameUpdate
{
    // stuff
}

public class GamePlayerUpdate : GameUpdate
{
    public Player player;
    // other stuff
}
</code></pre><p>However, I fail to see how this is of any improvement, for two reasons:</p><ul><li>The JS code will now simply receive an object without Player as a defined property, which is the same as if it was null since both cases require checking if the value is present or absent;</li><li>Should another nullable field be added to the GameUpdate class, I would have to be able to use multiple inheritance to continue with this desing &#8211; but MI is evil in its own right (according to more experienced programmers) and more importantly, C# doesn&#39;t have it so I can&#39;t use it.</li></ul><p>I have an inkling that this piece of this code is one of the very many where an experienced, good programmer would scream in horror. At the same time I can&#39;t see how, in this place, is this null hurting anything and what should be done instead.</p><p>Could you explain this issue to me?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Lots of things are better to return than null.</p><ul><li>An empty string (&#34;&#34;)</li><li>An empty collection</li><li>An &#34;optional&#34; or &#34;maybe&#34; monad</li><li>A function that quietly does nothing</li><li>An object full of methods that quietly do nothing</li><li>A meaningful value that rejects the incorrect premise of the question<br/> <sub>(which is what made you consider null in the first place)</sub></li></ul><p>The trick is realizing when to do this. Null is really good at blowing up in your face but only when you dot off it without checking for it. It&#39;s not good at explaining why.</p><p>When you don&#39;t need to blow up, and you don&#39;t want to check for null, use one of these alternatives. It may seem weird to return a collection if it only ever has 0 or 1 elements but it&#39;s really good at letting you silently deal with missing values.</p><p>Monads sound fancy but here all they&#39;re doing is letting you make it obvious that the valid sizes for the collection are 0 and 1. If you have them, consider them.</p><p>Any of these do a better job of making your intent clear than null does. That&#39;s the most important difference.</p><p>It may help to understand why you are returning at all rather than simply throwing an exception. Exceptions are essentially a way to reject an assumption (they are not the only way). When you ask for the point where two lines intersect you are assuming they intersect. They might be parallel. Should you throw a &#34;parallel lines&#34; exception?  Well you could but now you have to handle that exception elsewhere or let it halt the system.</p><p>If you&#39;d rather stay where you are you can bake the rejection of that assumption into a kind of value that can express either results or rejections. It&#39;s not that weird. We do it in <a href="https://math.stackexchange.com/a/1696269/151778">algebra</a> all the time. The trick is to make that value meaningful so we can understand what happened.</p><p>If the returned value can express results and rejections it needs to be sent to code that can handle both. Polymorphism is really powerful to use here. Rather than simply trading null checks for <a href="http://www.oracle.com/technetwork/articles/java/java8-optional-2175753.html" rel="noreferrer"><code>isPresent()</code></a> checks you can write code that behaves well in either case. Either by replacing empty values with default values or by silently doing nothing.</p><p>The problem with null is it can mean far too many things. So it just ends up destroying information.</p><hr/><p>In my favorite null thought experiment I ask you to imagine a complex <a href="https://www.google.com/search?q=rube+goldberg&amp;client=firefox-b-1&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=0ahUKEwjsosuRppLcAhXrtlkKHYy1CTgQ_AUICygC&amp;biw=1080&amp;bih=1756" rel="noreferrer">Rube Goldbergian</a> machine that signals encoded messages using colored light by picking up colored light bulbs off a conveyor belt, screwing them into a socket, and powering them up. The signal is controlled by the different colors of the bulbs that are placed on the conveyor belt.</p><p>You&#39;ve been asked to make this hideously expensive thing compliant with RFC3.14159 which states that there should be a marker between messages. The marker should be no light at all. It should last for exactly one pulse. The same amount of time that a single colored light normally shines.</p><p>You can&#39;t just leave spaces between the messages because the contraption sets off alarms and halts if it can&#39;t find a bulb to put in the socket.</p><p>Everyone familiar with this project shudders at the thought of touching the machinery or it&#39;s control code. It is not easy to change. What do you do? Well you can dive in and start breaking things. Maybe update this things hideous design. Yeah you could make it so much better.  Or you could talk to the janitor and start collecting burned out bulbs.</p><p>That&#39;s the polymorphic solution. The system doesn&#39;t even need to know anything has changed.</p><hr/><p>It&#39;s really nice if you can pull that off. By encoding a meaningful rejection of an assumption into a value you don&#39;t have to force the question to change.</p><p>How many apples will you owe me if I give you 1 apple? -1. Because I owed you 2 apples from yesterday. Here the assumption of the question, &#34;you will owe me&#34;, is rejected with a negative number. Even though the question was wrong, meaningful info is encoded in this answer. By rejecting it in a meaningful way the question isn&#39;t forced to change.</p><p>However, sometimes changing the question actually is the way to go. If the assumption can be made more reliable, while still useful, consider doing that.</p><p>Your problem is that, normally, updates come from players. But you&#39;ve discovered a need for an update that doesn&#39;t come from player 1 or player 2. You need an update that says time has expired. Neither player is saying this so what should you do? Leaving player null seems so tempting. But it destroys information. You&#39;re trying to encode knowledge in a black hole.</p><p>The player field doesn&#39;t tell you who just moved. You think it does but this problem proves that&#39;s a lie. The player field tells you where the update came from. Your time expired update is coming from the game clock. My recommendation is give the clock the credit it deserves and change the name of the <code>player</code> field to something like <code>source</code>. Then the value can be <code>player 1</code>, <code>player 2</code>, or <code>clock</code>.</p><p>This way if the server is shutting down and has to suspend the game it can send out an update that reports what&#39;s happening and lists itself as the source of the update.</p><p>Does this mean that you should never just leave something out? No. But you need to consider how well <em>nothing</em> can be assumed to really mean a single well known good default value. <em>Nothing</em> is really easy to over use. So be careful when you use it. There is a school of thought that embraces favoring <em>nothing</em>. It&#39;s called <a href="https://en.wikipedia.org/wiki/Convention_over_configuration" rel="noreferrer">convention over configuration</a>.</p><p>I like that myself but only when the convention is clearly communicated in some way. It should not be a way to haze the newbies. But even if you&#39;re using that, null is still not the best way to do it. Null is a dangerous <em>nothing</em>. Null pretends to be something you can use right up until you use it, then it blows a hole in the universe (breaks your semantic model). Unless blowing a hole in the universe is the behavior you need why are you messing with this? Use something else.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-what-alternatives-to-a-singleton-are-there-for-a-class-which-only-can-have-one-instance/'>Object-oriented &#8211; What alternatives to a singleton are there for a class which only can have one instance</a></li><li class="list-group-item"><a href='../java-how-to-use-for-nullable-if-i-used-the-lombok-nonnull/'>Java &#8211; How to use for @Nullable if I used the lombok @NonNull</a></li><li class="list-group-item"><a href='../is-a-new-boolean-field-better-than-a-null-reference-when-a-value-can-be-meaningfully-absent/'>Is a new Boolean field better than a null reference when a value can be meaningfully absent</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>