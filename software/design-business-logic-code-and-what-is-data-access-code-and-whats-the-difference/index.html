<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211;  business logic code and what is data access code, and what&#8217;s the difference &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1074640 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1074640" class="post-1074640 software type-software status-publish hentry category-software tag-design tag-domain-driven-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211;  business logic code and what is data access code, and what&#8217;s the difference</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">domain-driven-design</span></p><div class="entry-content"><p>I ask this because it seems people usually consider the code that goes into a DAO or Repository implementation as &#34;data access code&#34;, while the code that directly uses these DAOs/Repositories as &#34;business logic code&#34;.</p><p>However, this doesn&#39;t seem to make logical sense.</p><p>Consider a business service method with code like the following (using Java, but it would be similar in C#, etc.):</p><pre><code>public BigDecimal computeCustomerTotal(Customer customer) {
    List&lt;Order&gt; orders = orderRepository.findByCustomer(customer);

    BigDecimal total = orders.stream()
        .filter(Order::isActive).map(Order::getTotal).reduce(ZERO, BigDecimal::add);

    return total;
}
</code></pre><p>Sure, the above implementation doesn&#39;t make &#34;proper&#34; use of a database&#39;s capabilities, but bear with me. The point here is that, I assume, everyone agrees it contains only business logic code, with <code>Customer</code> and <code>Order</code> being <em>domain</em> entities (ie, they are not &#34;data&#34; objects).</p><p>So, what if I want to make it right, by moving the whole computation to the database, instead of executing in the client program? If I follow &#34;conventional wisdom&#34;, I would create a new method in the repository:</p><pre><code>public BigDecimal getCustomerTotal(Customer customer) {
    BigDecimal total = performQuery(
        &#34;select sum(o.total) from Order o where o.customer = ?1 and o.active&#34;,
        customer);

    return total;
}
</code></pre><p>(Assume <code>performQuery</code> is a JPA-based utility method which takes a JPA-QL<br /> sentence with optional arguments.)</p><p>The second implementation is obviously better than the first, as it probably performs better, and makes proper use of the underlying technologies (JPA/Hibernate, and a relational database).</p><p>The problem, though, is that business logic (the rule that only active orders should be considered) has been moved from a business service method to a (supposed) data access method, through a simple <em>implementation</em> change.<br /> Also, this code which is now in the DAO/Repository does <em>not</em> actually know about data access concerns, such as the mapping from entity types and attributes to tables and columns, or about the actual SQL code that gets generated and sent to the DB engine.</p><p>Wouldn&#39;t it be more logical to regard <em>both</em> methods as containing only <em>business logic</em> code, and just get rid of the DAO/Repository/DAL altogether?</p><p>Personally, I don&#39;t see any data access code there, and to me things like DAOs, Repositories, or &#34;data access layers&#34; (DAL) are in reality anti-patterns. Note that even when using JDBC + SQL in a DAO/Repository implementation, it will inevitably contain business logic, typically in the form of &#34;where&#34; clauses.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The database layer is intended to isolate the rest of the application from the details of the database -- how to make a connection, the syntax used to talk to the db engine, etc.</p><p>The .Net Entity Framework version of your code would be:</p><pre><code>var id = customer.id;
var customerOrdersTotal = db.Orders.
                          Where(o =&gt; o.CustomerId == id &amp;&amp; o.Active).
                          Sum(o =&gt; o.Total);
</code></pre><p>Note that this would get translated into the sql your JPA version would use, but the exact same thing could be done without involving sql at all.</p><p>If you have a Customer that has Orders, then it would be:</p><pre><code>var customerOrdersTotal = customer.Orders.
                          Where(o =&gt; o.Active).Sum(o =&gt; o.Total);
</code></pre><p>And this version could be written regardless of whether Orders is a virtual list or an actual list of orders.</p><p>The business doesn&#39;t care where the data is kept or how it is retrieved.  The point of a DAL is to abstract away the &#34;how is this bit of data retrieved&#34; and turn it into just the necessary (i.e. unavoidable) &#34;how to request the data I want&#34;.  Without a DAL you have to mix the two functions together, which means you can&#39;t change one without changing the other.</p><p>Note that about half the time, you don&#39;t ever end up making any changes...but when you do it&#39;s a real pain if they are mixed together.</p><p>Edit: I&#39;ll add that your implication that &#34;where&#34; clauses in the data access code is a business concern is incorrect.  The data layer exists to serve business needs.  The data can be carved up and served in an infinite number of ways, some more useful than others.  Moving a condition from the business layer to the data layer simply means that the request is common enough to be included in the ways that are usefully provided out of the box. Preventing new orders when existing active orders exceeds $X is a business decision.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../c-abstract-dal-use-interface-with-internal-class/'>C# &#8211; Abstract DAL &#8211; Use Interface with Internal Class</a></li><li class="list-group-item"><a href='../how-to-avoid-duplication-of-code-related-to-shared-entities-in-the-repository-pattern/'>How to avoid duplication of code related to shared entities in the repository pattern</a></li><li class="list-group-item"><a href='../how-domain-repository-and-service-layers-works-vs-original-dao-pattern/'>How Domain, repository and service layers works VS original DAO pattern</a></li><li class="list-group-item"><a href='../architecture-dataaccess-layer-coupling-with-domain-layer/'>Architecture &#8211; DataAccess Layer coupling with Domain Layer</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>