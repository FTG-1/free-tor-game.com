<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Php &#8211; Displaying items with a countdown timer &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1085427 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1085427" class="post-1085427 software type-software status-publish hentry category-software tag-ajax tag-mysql tag-php"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Php &#8211; Displaying items with a countdown timer</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">ajax</span><span class="mr-2 badge badge-info">MySQL</span><span class="mr-2 badge badge-warning">PHP</span></p><div class="entry-content"><p>I am creating a widget for rotating topics. The functionality is as follows:</p><ul><li>Each topic is displayed one by one on the homepage and has a duration of 30 seconds.</li><li>A countdown timer is displayed on the page. When it reaches zero the current topic gets marked as &#34;shown&#34; and the next topic is displayed.</li><li>Users can choose to &#34;like&#34; topics, in which case the topic gets an additional 5 seconds duration (the countdown timer needs to update itself at this point).</li><li>The countdown timer always needs to display the current allocated duration for the topic, so for example if a user &#34;likes&#34; a topic then people accessing the site should instantly see the updated duration for that topic. Basically everything needs to be shown in &#34;realtime&#34;.<br /> The topics are stored in a MySQL database. I am having trouble with the last two points in the above.</li></ul><p>The way I have tried to do it so far is to have an AJAX request which is sent every second to deduct 1 second from the current topic duration. The request response is the current topic duration.</p><p>The problem with this is that it will only work so long as somebody is accessing the site. I know I can probably create a CRON script to run this process in the background, but for it to run every second would be a bit crazy. There has got to a be a much simpler solution to this problem. What would be the most efficient way to go about this?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>If every user will be calling your website every second you&#39;re in for trouble. It&#39;s not really a scaleable solution and I assume you want this site to be big and famous with thousands of users.</p><p>My suggestion is as follows:</p><ul><li>The topic table should store information on until what time a given topic is the current topic, named <strong>expire_time</strong> or something.</li><li>When a user requests a page, send the page together with the number of seconds that are left until the page expires and a new one has to be loaded. Since the time can&#39;t be shorter (just longer) there&#39;s no idea to make a check every second. You did mention that you wanted remaining time to be &#34;realtime&#34; but I suggest you &#34;fake&#34; that by only making a request every 5-10 seconds or something. You can still have a countdown timer. And since the <strong>Like</strong> adds 5 seconds there is no point in having greater accuracy than that in your &#34;realtime&#34;.</li><li>When someone presses the like button you just add 5 seconds to the <strong>expire_time</strong> column.</li><li>When a user&#39;s page times out (or every 5-10 seconds) a request is made to the server with the current viewed topic id as argument. If someone has pressed <strong>Like</strong> then an <strong>Extended timeout</strong> response can be given with the extended amount of seconds that the topic is to be shown. You don&#39;t need to pass the topic text again because the user already has it. If no one has pressed like, and the topic has expired, then the next topic is returned and shown and the user page starts a new 30 sec countdown.</li><li>If no user is online then there is no need to be rotating topics so I don&#39;t see the need of a cron job. Instead, when the first user comes and there is no active topic, the server just selects a new topic as active and sets a 30 sec expiration on it.</li></ul><p>I would also suggest:</p><ul><li>Set a maximum allowed amount of likes for a certain topic. If 1000 people likes a topic it&#39;ll be shown for almost 1,5 hours and for those that want to see the next topic that might be boring. Maybe you can have steps in time added, so the first likes add 5 sec but when you have 10 likes it only add 4 sec, after 50 likes only 3 sec, after 200 likes only 2 sec and so on.</li><li>You probably also need some kind of IP or cookie registration per topic id so not one user makes a script that spams you with likes and then one topic is shown forever.</li><li>Realtime is nice but also very heavy for the server when you have many users. My suggestion is at least to have a parameter in your code where you can switch in-between refreshing every 5-10 seconds and to wait all the way down to expiry time before making a new refresh. This way you have a <strong>turbo injection</strong> for your program in case you get too many users and temporarily need extra speed on the server.</li></ul><p>Good luck with your project!</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../javascript-how-safe-are-hidden-ajax-requests-that-fake-performance/'>Javascript &#8211; How safe are hidden AJAX requests that fake performance</a></li><li class="list-group-item"><a href='../php-application-logic-business-logic-models-controllers-where-to-put-the-applications-brains/'>Php &#8211; application logic, business logic, models, controllers &#8211; where to put the application&#8217;s brains</a></li><li class="list-group-item"><a href='../php-penny-auction-concept-and-how-the-timer-works/'>Php &#8211; Penny auction concept and how the timer works</a></li><li class="list-group-item"><a href='../php-package-management-with-without-composer/'>PHP package management with/without Composer</a></li><li class="list-group-item"><a href='../php-multiple-items-in-a-single-column-sql/'>Php &#8211; Multiple items in a single column SQL</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>