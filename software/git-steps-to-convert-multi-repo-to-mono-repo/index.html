<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Git &#8211; Steps to convert multi-repo to mono-repo &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073639 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073639" class="post-1073639 software type-software status-publish hentry category-software tag-git"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Git &#8211; Steps to convert multi-repo to mono-repo</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">git</span></p><div class="entry-content"><p>What are the best steps to convert multi-repos to a mono-repo?</p><p>This is what I have so far:</p><ol><li>for each repo, check out the most recent branch (integration branch, usually)</li><li>for each repo, copy the repo folder to the new git repo (the mono repo)</li><li>for each folder, delete the old .git folder</li><li>Stage all the files, commit, and push the new mono-repo</li></ol><p>My only question at the moment &#8211; will the existing .gitignore files work properly for the subfolders in the new mono-repo?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Don&#39;t copy the files, merge the repositories instead. Git doesn&#39;t make a big difference between “different repository” and “different branch”. More precisely, a repository is a collection of tags and branches. I&#39;ll assume that you want to merge the master branch of all repos.</p><p>General approach (but see discussion of git-subtree below):</p><ol><li><p>Think about the layout of your monorepo. I&#39;ll assume that for the start, you&#39;ll have each current repository as a sub-folder of the monorepo in order to avoid conflicts.</p></li><li><p>For each current repository, move the repository contents into a subfolder and commit the change. You can use the <code>git mv</code> command to do this easily.</p><p>E.g. if your component is called <code>libfoo</code> and you currently have this repository layout:</p><pre><code>Makefile
README.txt
src/
  ...
include/
  ...
</code></pre><p>Then we might move it into a <code>libfoo/</code> folder:</p><pre><code>libfoo/
  Makefile
  README.txt
  src/
    ...
  include/
    ...
</code></pre></li><li><p>Create a new repository for your monorepo, and add all existing repos as a “remote”. Despite its name, a remote repository can be a path to some directory on the same file system. Then <code>git fetch --all</code> remotes to load their history into the monorepo&#39;s git database. Afterwards, you can list all branches with <code>git branch --all</code>. This will look like:</p><pre><code>* master
  remotes/libfoo/master
  remotes/libbar/master
  ...
</code></pre></li><li><p>For each remote, merge it&#39;s master branch. There should be no conflicts because everything is in a separate directory.</p></li><li><p>Now you&#39;re done, and you have a monorepo without loss of history. You can remove the remotes.</p></li></ol><p>But careful: you can only merge one branch of each repo. If one of the original repositories has multiple branches, they can no longer be merged without excessive conflicts. Consider rebasing them after you move the repository contents into one folder, but before merging everything into the monorepo.</p><p>In practice, you can use <code>git subtree</code> to automate most of these steps. The subtree command allows you to merge a specific branch into a specific directory.</p><ol><li>initialize the monorepo and make at least one commit</li><li><p>for each existing repo, add it as a subtree, e.g.:</p><pre><code>git subtree add -P libfoo/ ../path/to/libfoorepo master
</code></pre><p>The <code>-P</code>/<code>--prefix</code> is the directory under which the repository contents should be added. In place of the path to a repo, any repository URL can be used. By default this will add the complete history, alternatively you can <code>--squash</code> the history into a single commit.</p></li></ol><p>Git-subtree is an extremely powerful tool for manipulating monorepos. You can also extract a directory into a separate repository (<code>git subtree push</code>) or merge updates from the original repo (<code>git subtree pull</code>). For example, you might use this to translate different branches.</p><ul><li>To translate a <code>feature</code> branch:</li><li>Create a new branch in the monorepo: <code>git checkout -b feature</code></li><li>Pull the changes from libfoo&#39;s <code>feature</code> into the correct directory of the monorepo: <code>git subtree pull -P libfoo/ ../path/to/libfoorepo feature</code>.</li><li>Optional: rebase the branch onto master to simplify the history graph.</li></ul><p>But consider whether a monorepo is really appropriate for your use case. It may still be desirable to have different repos available independently. The main contender is git submodules, where one repository is mounted as a sub-directory of another. However, the experience is not seamless. The branch history is not shared with the submodule. If you edit code in a submodule you have to commit that work separately. Git submodules are most useful for “vendoring“ external dependencies that are pinned to a specific version, not for combined development.</p><p>Whatever approach you use, gitignore files will continue to work because any patterns are matched relative to the gitignore file. A repository can contain multiple gitignore files.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/git-good-practice-to-separate-git-repo-from-published-repo/'>Git &#8211; Good practice to separate Git Repo from published Repo</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/git-two-or-one-git-repo-for-android-app-web-service-backend/'>Git &#8211; Two or one git repo for Android app + web service backend</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/git-whats-the-best-way-to-undo-a-git-merge-that-wipes-files-out-of-the-repo/'>Git &#8211; What&#8217;s the best way to undo a Git merge that wipes files out of the repo</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/git-optimize-a-git-repo-containing-large-binary-files/'>Git &#8211; Optimize a git repo, containing large binary files</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/java-working-with-maven-and-multiple-git-repositories/'>Java &#8211; Working with maven and multiple git repositories</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>