<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; Java Design for Data enrichment based on logic defined in a database &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1085913 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1085913" class="post-1085913 software type-software status-publish hentry category-software tag-design tag-design-patterns"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; Java Design for Data enrichment based on logic defined in a database</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">design</span><span class="mr-2 badge badge-info">design-patterns</span></p><div class="entry-content"><p>I have the following requirement.</p><p>Read data from a messaging Queue and process each message to enrich the message and then finally send the enriched message to a different system.<br /> The enrichment logic is in DB and it is based on message type and each logic can be of different language. Each message will have some type like, bank, insurance, &#8230;</p><p>Sample enrichment logic data in Mongo DB,</p><pre><code>{
  type : &#34;Bank&#34;,
  logics : [
    {
      &#34;key&#34; : &#34;location.phone&#34;,
      &#34;type&#34; : &#34;javascript&#34;,
      &#34;logic&#34; : &#34;function getPhone() { return &#39;888-888-8888&#39;;}&#34;
    },
    {
      &#34;key&#34; : &#34;location.zip&#34;,
      &#34;type&#34; : &#34;groovy&#34;,
      &#34;logic&#34; : &#34;function getZip() { return &#39;56781&#39;;}&#34;
    },
    {
      &#34;key&#34; : &#34;location.address&#34;,
      &#34;type&#34; : &#34;groovy&#34;,
      &#34;logic&#34; : &#34;function getAddress() { return &#39;1234 new address&#39;;}&#34;
    },
  ]
}
</code></pre><p>Now on receiving each message from the Queue, Check the type and enrich the data based on the logics for that type.</p><p>This is a spring boot based non-web Java Application.</p><p>My executing would start from the below run method.</p><pre><code>public class AppRunner implements ApplicationRunner {

  // Other Bean injection is here


    @Override
    public void run(final ApplicationArguments args) throws Exception {
       // Application starts here ...
    }
}
</code></pre><p>I defined EnrichmentLogicDAO to load the logic from the DB and have a EnrichmentDBService for the DAO.<br /> Have an interface with a method exeucte( Command pattern ). There are 2 implementors. 1. Javascript, 2. Groovy</p><p>In Javascript executor,</p><pre><code>ScriptEngine engine = new ScriptEngineManager().getEngineByName(&#34;JavaScript&#34;);
</code></pre><p>In Groovy executor,</p><pre><code>ScriptEngine engine = new ScriptEngineManager().getEngineByName(&#34;groovy&#34;);
</code></pre><p>In both,</p><pre><code>engine.eval(logic1);
engine.eval(logic2);
....
</code></pre><p>Load all the logic from DB. Javascript based logic should be loaded in JavaScriptExecutor engine and groovy based logic should be loaded in GroovyExecutor engine.</p><p>Question 1 :-</p><p>How to load all the logics to the corresponding engine?</p><p>Currently, I have my code to load the logic inside the AppRunner&#39;s run method and call the corresponding Executor class static method based on the type from DB to load the logics into the engine.</p><p>Question 2 :-</p><p>The code to execute the enrichment logic remain same for both the engine. Only the engine will be different based on the logic type.</p><p>I need some help on Loading the logics to the corresponding engine and invoke the logic on each message.</p><p>Also, I thought of using the Chain of responsibility pattern, so that the input message would be passed to the series of engines and the message will be enriched based on the logics loaded in each engine.  Is there any other better approach.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>To start things off simple, you should create a simple loop taking each &#34;logic&#34; and performing each operation from start to finish.  So have add a dependency for your EnrichmentDBService and directly request the logics for your input.</p><p>Then for each logics, you apply the change.  To apply each change, you should use an enum or some sort of direct mapping between the type &#34;javascript&#34; or &#34;groovy&#34; and the appropiate ScriptEngine instance pertaining to that particular language.</p><p>Using this mapping, grab the correct ScriptEngine instance and execute its code.  What gets returned you must set to an object using &#34;key&#34; value presumably.</p><p>Once you&#39;ve finished all logics in this way you&#39;re done!  Return the finished object.</p><p>If order is not crucial and there are many logics, you could consider using a thread pool to handle the tasks.  I wouldn&#39;t suggest Chain of Responsibility because it seems like the actual work being done is the same here.  However, I fear that what they want from you is that you interpret the values returned as a sort of mask for you to apply to the actual data.</p><p>If, for instance, &#39;888-888-8888&#39; is a mask for applying a number, then you&#39;d need some sort of baseline rule for this.  Does this mean whenever you see &#39;8&#39;, you represent this as a digit?  What about &#39;1234 new address&#39;?  Is &#39;1234&#39; supposed to be replaced with the street number?  Why wouldn&#39;t you interpret this as a literal &#39;1234&#39;?</p><p>These questions you <em>cannot</em> answer yourself.  The one providing the specifications should tell you this, and you need to look for potential inconsistencies and bring them to the attention of the one performing the analysis.  Do this until all cases are covered and there are no inconsistencies <em>before</em> you begin coding.</p><p>Good luck!</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../design-pattern-for-complex-data-modeling/'>Design Pattern for Complex Data Modeling</a></li><li class="list-group-item"><a href='../design-does-this-data-processing-pipeline-design-need-to-be-so-complex/'>Design &#8211; Does this data processing pipeline design need to be so complex</a></li><li class="list-group-item"><a href='../java-designing-generic-type-inheritance-hierarchy/'>Java &#8211; Designing generic type inheritance hierarchy</a></li><li class="list-group-item"><a href='../web-development-handling-of-user-session-expiration-in-mvc-based-web-application/'>Web-development &#8211; Handling of user session expiration in MVC-based web application</a></li><li class="list-group-item"><a href='../mvc-in-mvc-soa-architecture-what-is-the-rationale-for-placing-business-logic-in-models/'>Mvc &#8211; In MVC + SOA Architecture, What is the Rationale for Placing Business Logic in Models</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>