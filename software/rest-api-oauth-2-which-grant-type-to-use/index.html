<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>REST API Oauth 2 &#8211; Which grant type to use &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1085157 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1085157" class="post-1085157 software type-software status-publish hentry category-software tag-api tag-api-design tag-authorization tag-oauth2 tag-rest"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">REST API Oauth 2 &#8211; Which grant type to use</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">api</span><span class="mr-2 badge badge-info">api-design</span><span class="mr-2 badge badge-warning">authorization</span><span class="mr-2 badge badge-primary">oauth2</span><span class="mr-2 badge badge-danger">rest</span></p><div class="entry-content"><p>I have an application which basically inserts some rows from the current front end web application.</p><p>All the calls before the service layer checks/validates if the user is allowed to insert data or not (This is where I am stuck with my current approach outlined below).</p><p>I have to create a REST API which will allow other third party users/developers (let&#39;s say Developer A) to insert some data automatically via some HTTP calls.</p><p>There are two scenarios for above scenario.</p><ol><li><p>Insert data on behalf of user &#8211; Users on Developer A systems does something. Developer A then makes a HTTP REST endpoint to insert some data into our system.</p></li><li><p>Insert data on behalf of system &#8211; Developer A wants to insert some data directly into our system without any user interaction(Like a batch upload data where there will be no user interaction on Developer A site).</p></li></ol><p>Now I have created a REST API which uses Oauth 2.0 and I am allowing <code>Authorisation Code</code> and <code>Client Credentials</code> grant types.</p><p><code>Authorisation Code</code> solves my first scenario, where Developer A redirects user to my site for authentication and authorisation, so when I create the access token, I maintain link between user and the access token (which I use later on to establish which user created the token and then check if the user is allowed to insert data or not).</p><p>Now for the second scenario, I am using <code>Client Credentials</code> where Developer A can straight away get the access token without user interaction.</p><p>So in this scenario, when my code tries to validate the call from this REST call, <strong>it basically fails as the access token is not created for a particular user</strong>.</p><p>How should I solve this problem? Am I going in some wrong direction?</p><p>Should I refactor my validation logic, (to ignore the validation as the access token by Client Credentials can only be obtained by a trusted client)? Or create a dummy/anonymous user to be associated with access token for Client Credentials?</p><p><strong>UPDATE:</strong></p><p>Just some more clarification and my further approach.</p><p>The validation mentioned above is not username/password validation, it&#39;s custom business logic which depends on internal user id to check permission for a user.</p><p>I get this user id as the one which who authorised using Authorisation Code grant type.</p><p>But for Client Credentials, my subject is not a user, it&#39;s an application, which is not the same as user id.</p><p>I am thinking to associate to tackle this as below:</p><p>An admin user let&#39;s say <code>User1</code> will register the application(creating client id/secret) in my system to use API. I will make a note of this user&#39;s id in my system along with other Oauth related details (client id/secret/app name, etc.). So when the developer uses Client Credentials, which identifies the application (not a specific user), I will query the database and get the user id of the <code>User1</code> who registered the application. Then I will use this user id to continue all business logic validation (and it would pass this time, because this user <code>User1</code> will have access to all resources in the system, since it&#39;s an Admin user).</p><p>Let me your thoughts/comments with this approach of mine.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Your business logic assumes that an end user is the only type of identity which can perform actions (e.g. Inserting records). It turns out that assumption is false, and you have a second sort of identity - a client application. I can see a couple of options:</p><p>Create a fake / pseudo user to represent the client application, i.e. a service account. Give the user whatever settings needed to have the system behave as expected, but make sure that it&#39;s not possible for real users to log in as this pseudo-user, and maybe hide the user from management screens. You can then either put this user&#39;s details in your access token, or have the api look up this user&#39;s details when it gets an access token.</p><p>What you probably want though is for your business logic to recognize both users and client applications as valid identity types - if we squint a little and rename the users table to &#34;identities&#34;, that&#39;s sort of what we did with by creating fake / pseudo users. Depending on your code / database structure however you may find it easier to update your code and leave your users table as-is.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../rest-how-should-an-api-use-http-basic-authentication/'>Rest &#8211; How should an API use http basic authentication</a></li><li class="list-group-item"><a href='../how-to-use-oauth-2-0-roles-and-scopes-to-secure-services/'>How to use OAuth 2.0 roles and scopes to secure services</a></li><li class="list-group-item"><a href='../rest-api-security-stored-token-vs-jwt-vs-oauth/'>REST API security Stored token vs JWT vs OAuth</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>