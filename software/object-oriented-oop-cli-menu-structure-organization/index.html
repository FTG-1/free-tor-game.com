<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; OOP CLI menu structure organization &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076280 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076280" class="post-1076280 software type-software status-publish hentry category-software tag-c tag-cli tag-command-line tag-design tag-object-oriented"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; OOP CLI menu structure organization</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">cli</span><span class="mr-2 badge badge-warning">command line</span><span class="mr-2 badge badge-primary">design</span><span class="mr-2 badge badge-danger">object-oriented</span></p><div class="entry-content"><p>This problem has kept me from pursuing a project I&#39;m working on because it influences the entire structure of the application. This question has been briefly touched on <a href="https://softwareengineering.stackexchange.com/questions/192098/best-way-to-build-a-hierarchy-cli-menu">here</a>, but I feel that it wasn&#39;t seen by many people and therefore wasn&#39;t very well answered.</p><p>I&#39;m working on an application in charge of navigating and manipulating a binary search tree. This application is controlled through a selection menu, with some options leading to submenus. The most hack-ish approach to this problem is something like this:</p><pre><code>int main(int argc, char *argv[])
{
    // Create the object using the data in the file at path argv[1].
    BinarySearchTree tree(argv[1]);

    bool exit = false;
    while (!exit) {
        // Print the menu out here with std::cout statements.
        // This always adds several lines that don&#39;t do much.

        // Store the users input in a variable here.
        // Coding a way that ensures something valid is input adds
        // many more lines of clutter.

        // If-elseif-else or switch statement here. More complexity with more
        // submenus that look exactly like this here. You get how complex
        // this will get.
    }
}
</code></pre><p>Anyone who wants to type good code doesn&#39;t want their main function to be this long and messy. Breaking it into other functions sitting in my main file doesn&#39;t really help much either, it&#39;s still messy and not very object-oriented. A possible solution would be to put each menu into their own class like this.</p><pre><code>int main(int argc, char *argv[])
{
    BinarySearchTree tree(argv[1]);
    MainMenu main_menu;
    main_menu.run();
}
</code></pre><p>Definitely the cleanest main method, but not a viable option since my tree object can no longer be accessed from within the MainMenu methods, and I definitely don&#39;t want to pass it around endlessly within my class methods since that&#39;d be terrible style. So finally some middle ground I came up with was like this.</p><pre><code>int main(int argc, char *argv[])
{
    BinarySearchTree tree(argv[1]);

    MainMenu main_menu();
    bool exit = false;
    while (!exit) {
        unsigned long prompt = main_menu.prompt();

        // The switch statement here. Still a lot of complexity I don&#39;t like
        // because this can go on for quite a while depending on how deep my
        // submenus go or how much I need to do for specific commands.
    }
}
</code></pre><p>Ok, all my sample code is out of the way. I don&#39;t like any of them, and I haven&#39;t found any truly better solutions on the internet. I&#39;m an undergrad, so I don&#39;t have any practical experience in this. Is there some widely accepted best-practice in the industry that I don&#39;t know about? How would you approach this personally? Remember, this is being implemented in C++ so I&#39;m trying to be as object-oriented as possible. However, if there&#39;s a functional way you know of that works really well that you&#39;d like to share, I&#39;d be open to it.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>First off, there is absolutely nothing about C++ which forces (or even encourages) you to use OOP. This is a common misunderstanding. Other languages lend themselves to OOP much better than C++, and while C++ supports OOP, it supports other paradigms much better.</p><p>That said, your problem is classic, and lends itself well to the <a href="http://en.wikipedia.org/wiki/Command_pattern" rel="nofollow noreferrer">command pattern</a>. It’s worth noting that this can also be implemented without the use of a subclass hierarchy but let’s stick to the “classical” OOP implementation here.</p><p>A command is a subclass of the general <code>command</code> base class:</p><pre><code>struct command {
    virtual std::string description() const = 0;
    virtual void run(context&amp;) = 0;
    virtual ~command() = default;
};

using command_ptr = std::unique_ptr&lt;command&gt;;
</code></pre><p>The <code>context</code> object contains the necessary information to fulfil the command. In your case, this could be the <code>BinarySearchTree</code>. So yes, you <em>do</em> need to pass this around. There’s no clean way around this. In fact, this is not a bad thing: it’s certainly not “terrible style” as you claim – <a href="https://softwareengineering.stackexchange.com/q/157526/2366">quite the opposite!</a></p><p>Here is a simple command implementing this:</p><pre><code>struct open_command : command {
    std::string description() const override {
        return &#34;Open a file&#34;;
    }

    void run(context&amp; context) override {
        // TODO implement.
    }
};
</code></pre><p>Now your menu structure would contain a list of commands and show them in a loop. Simplified:</p><pre><code>struct menu {
    menu(context&amp; context, std::vector&lt;command&gt;&amp; commands)
        : context{context}, commands{commands} {}

    void show() {
        for (int i{}; i &lt; commands.length(); ++i)
            show(i, commands[i].description());

        show(0, &#34;Exit&#34;);

        int choice{};
        for (;;) {
            choice = input();
            if (choice == 0) return;
            if (choice &gt; 0 and choice &lt;= commands.length())
                break;
        }

        commands[choice - 1].run(context);
        // Don’t leave the menu:
        show();
    }

    // TODO:
    int choice() const;
    void show(int, std::string) const;

private:
    context&amp; context;
    std::vector&lt;command_ptr&gt; commands;
};
</code></pre><p>Now the interesting thing is this: A <em>submenu</em> would also be a subclass of <code>command</code>, and could wrap the <code>menu</code> class. That way, you can elegantly nest command menus arbitrarily deeply.</p><p>Finally, to use this menu, you’d initialise it thusly:</p><pre><code>std::vector&lt;command_ptr&gt; cmds {
    make_unique&lt;open_command&gt;(),
    make_unique&lt;save_command&gt;(),
    make_unique&lt;edit_submenu&gt;(
        bst,
        std::vector&lt;command_ptr&gt;{
            make_unique&lt;edit_delete_command&gt;(),
            make_unique&lt;edit_insert_command&gt;(),
            …
        }
    ),
    …
};
menu menu{bst, cmds};
menu.show();
</code></pre><p>This creates some commands, of which one (<code>edit_submenu</code>) is a submenu, initialises a <code>menu</code> and <code>show</code>s it.</p><p>That’s it, in a nutshell. The above code requires C++14 (actually, just C++11 + <a href="http://en.cppreference.com/w/cpp/memory/unique_ptr/make_unique" rel="nofollow noreferrer"><code>std::make_unique</code></a>). It can easily be rewritten to run on C++03 but C++11 is just less painful.</p><p>Two tangential remarks:</p><ol><li><p><code>iostream</code>s are not designed for interactive input and output. Using them to implement such an interactive menu works badly, since they cannot cope well with the peculiarities of user input. Unfortunately there is no good CLI library for C++ that I know of. The de-facto standard for CLI in the Unix world is the <a href="http://cnswww.cns.cwru.edu/php/chet/readline/rltop.html" rel="nofollow noreferrer">GNU <code>readline</code> library</a> but (a) it only has a C API, and (b) its license forbids its use in anything but GNU licensed software.</p><p>There is no really good solution for this. However, most command line applications would eschew an interactive CLI in favour of command line options and commands, so that each invocation of your program would execute one command (or a combination of several), controlled by command line arguments:</p><pre><code>bst add entry my_database.file
bst add another-entry my_database.file
bst lookup entry my_database.file &gt; output.file.
</code></pre><p>This is the conventional workflow of command line applications, and it’s in most regards superior, since it’s trivially scriptable and can be combined with other command line tools.</p></li><li><p>It is worth noting that, for the case of static menus (i.e. where the number of submenu items doesn’t change at runtime) the <a href="http://www.boost.org/doc/libs/1_57_0/doc/html/variant.html" rel="nofollow noreferrer">Boost.Variant library</a> offers a superior alternative to the above class hierarchy. Each menu would be a <code>boost::variant</code> of the relevant commands. However, the general idea remains the same.</p></li></ol></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/object-oriented-best-way-to-build-a-hierarchy-cli-menu/'>Object-oriented &#8211; Best way to build a hierarchy CLI menu</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/object-oriented-martin-fowlers-refactoring-book-switch-statement-is-using-other-objects-data-why-is-that-bad-a-deeper-explanation-is-sought-for/'>Object-oriented &#8211; Martin Fowler&#8217;s Refactoring book: switch statement is using other object&#8217;s data, why is that bad ? A deeper explanation is sought for.</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-force-derived-class-to-implement-static-method-c/'>C# &#8211; Force Derived Class to Implement Static Method C#</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/object-oriented-implementation-of-object-state-in-an-oo-language/'>Object-oriented &#8211; Implementation of object state in an OO language</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/java-design-a-java-based-menu-so-that-its-easier-to-add-new-options/'>Java &#8211; Design a java based menu so that it&#8217;s easier to add new options</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>