<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Java &#8211; Is the C# async/Task construct equivalent to Java&#8217;s Executor/Future &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1073260 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1073260" class="post-1073260 software type-software status-publish hentry category-software tag-async tag-asynchronous-programming tag-c tag-java"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Java &#8211; Is the C# async/Task construct equivalent to Java&#8217;s Executor/Future</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">async</span><span class="mr-2 badge badge-info">asynchronous-programming</span><span class="mr-2 badge badge-warning">c</span><span class="mr-2 badge badge-primary">java</span></p><div class="entry-content"><p>I&#39;m a long time Java developer, but with so little traffic on SE, I don&#39;t limit my viewing to any single tags. I&#39;ve noticed that C# questions with async/await come up a lot, and as far as I&#39;ve read it&#39;s the standard (but somewhat recent) asynchronous programming mechanism in C#, which would make it equivalent to Java&#39;s <code>Executor</code>, <code>Future</code> or perhaps more accurately <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html" rel="noreferrer">CompatibleFuture</a> constructs (or even <code>wait()/notify()</code> for very old code).</p><p>Now async / await seems like a handy tool, quick to write and easy to understand, but the questions give me the feeling that people are trying to make <em>everything</em> async, and that this isn&#39;t even a bad thing.</p><p>In Java, code that would attempt to offload work to different threads as often as possible would seem very odd, and real performance advantages come from specific well thought out places where work is divided to different threads.</p><p>Is the discrepancy because of a different threading model? Because C# is often desktop code with a well known platform under it, whereas Java is mainly server side these days? Or have I just gotten a skewed image of its relevancy?</p><p>From <a href="https://markheath.net/post/async-antipatterns" rel="noreferrer">https://markheath.net/post/async-antipatterns</a> we have:</p><pre><code>foreach(var c in customers)
{
    await SendEmailAsync(c);
}
</code></pre><p>as an example of acceptable code, but this seems to suggest &#34;make everything asynchronous, you can always use <code>await</code> to synchronize&#34;. Is it because the <code>await</code> already indicates that there&#39;s actually no reason to switch threads, whereas in Java</p><pre><code>for(Customer c : customer) {
    Future&lt;Result&gt; res = sendEmailAsync(c);
    res.get();
}
</code></pre><p>would actually perform the work in a different thread, but <code>get()</code> would block, so it would be sequential work, but using 2 threads?</p><p>Of course with Java, the standard idiom would be to let the caller decide whether something needs to be async, rather than having the implementation decide it in advance E.g.</p><pre><code>for(Customer c : customer) {
    CompletableFuture&lt;Void&gt; cf = CompletableFuture.runAsync(() -&gt; sendEmailSync(c));
    // cf can be further used for chaining, exception handling, etc.
}
</code></pre></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>C#&#39;s <code>Task</code> is somewhere halfway between Java&#39;s <code>Future</code> and <code>CompletableFuture</code>. The <code>Result</code> property is equivalent to calling <code>get()</code>, <code>ContinueWith()</code> does the things the massive array of continuation functions on <code>CompletableFuture</code> does (add some <code>Task.WhenAny</code> and <code>Task.WhenAll</code> in there). But <code>complete(T)</code> has no equivalent (use a <code>TaskCompletionSource</code>), nor does <code>cancel()</code> (pass explicit <code>CancellationToken</code>s).</p><p>Java&#39;s <code>Executor</code> is mostly hidden in C#. There&#39;s a global thread pool equivalent to a <code>ForkJoinPool</code> that is automatically used by <code>Task.Run</code>. There&#39;s <code>TaskScheduler</code> if you really want to control execution, but you very rarely use it.</p><p><code>async</code>/<code>await</code>, though, has no equivalent in Java. The key point here is that <code>await someTask</code> is <strong>not</strong> the same as <code>someFuture.get()</code>. The latter <em>blocks the executing thread</em> until the future is complete.</p><p>The former does something completely different. Conceptually, it implements something like coroutines. If the task is not complete, it suspends execution of the current function, but <em>frees the thread up</em> to continue working on other things. Only once the task is complete does execution continue from the point of the <code>await</code>.</p><p>In practical terms, it&#39;s a compiler transformation. The compiler divides an <code>async</code> function into pieces. When you call the function, the first piece executes, until it reaches an <code>await</code>. If the task is done, it simply executes the next piece. Otherwise, it uses <code>ContinueWith</code> to schedule the next piece to run once the task completes.</p><p>This is an important distinction, because it means that if the thing you&#39;re awaiting is blocked on network access, you&#39;re not eating up a thread of the pool; instead the thread can work on other tasks.</p><p>(The above description is simplified. The compiler doesn&#39;t actually split the function, it turns it into a state machine. And it doesn&#39;t use <code>ContinueWith</code>, but <code>GetAwaiter().UnsafeOnCompleted</code>.)</p><p>This means you get the efficiency of continuations, but with the convenient programming model of normal functions.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../benchmark-of-asynchronous-code/'>Benchmark of asynchronous code</a></li><li class="list-group-item"><a href='../c-blurring-the-lines-between-async-and-regular-functions-in-c-5-0/'>C# &#8211; Blurring the lines between async and regular functions in C# 5.0</a></li><li class="list-group-item"><a href='../c-efficient-mixing-of-sync-and-async-methods-within-a-single-method/'>C# &#8211; Efficient mixing of sync and async methods within a single method</a></li><li class="list-group-item"><a href='../async-controllers-in-asp-net-mvc-real-advantages-how-achieved/'>Async Controllers in ASP.NET MVC: Real Advantages / How Achieved</a></li><li class="list-group-item"><a href='../c-async-await-pedantry-vs-the-debugger/'>C# async/await: Pedantry vs. the Debugger</a></li><li class="list-group-item"><a href='../c-problem-with-async-await-pattern-in-c-and-javascript-how-to-return-sync-value/'>C# &#8211; Problem with async/await pattern &#8212; in C# and JavaScript &#8212; how to return sync value</a></li><li class="list-group-item"><a href='../c-arent-the-guidelines-of-async-await-usage-in-c-contradicting-the-concepts-of-good-architecture-and-abstraction-layering/'>C# &#8211; Aren&#8217;t the guidelines of async/await usage in C# contradicting the concepts of good architecture and abstraction layering</a></li><li class="list-group-item"><a href='../c-why-is-it-necessary-for-every-new-api-to-be-async/'>C# &#8211; Why is it necessary for every new api to be async</a></li><li class="list-group-item"><a href='../c-is-it-good-approach-to-await-async-tasks-in-object-destructor/'>C++ &#8211; Is it good approach to await async tasks in object destructor</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>