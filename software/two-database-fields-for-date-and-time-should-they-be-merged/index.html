<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Two database fields for date and time &#8211; should they be merged &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1071254 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1071254" class="post-1071254 software type-software status-publish hentry category-software tag-database-design tag-design-patterns tag-sql"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Two database fields for date and time &#8211; should they be merged</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database-design</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">sql</span></p><div class="entry-content"><p>In the following question, field and table names have been changed to protect their identities.</p><p>If I have two database columns:</p><pre><code>MONKEY_DATE DATETIME NULL (with data e.g. 2012-05-14 00:00:00.000)
MONKEY_TIME DATETIME NULL (with data e.g. 1753-01-01 16:30:53.025)
</code></pre><p><em>The date component of the time field is <strong>mostly</strong> set to 1st Jan 1753&#8230; but some data has 1st Jan 1899 and some has 1st Jan 1900.</em></p><p>I find that maintaining the code to query and report on these columns causes me (and our team) a headache that could easily be solved by merging the two columns.  However, experience (and <a href="http://www.goodreads.com/quotes/76667-nothing-is-ever-easy" rel="nofollow" title="Nothing is ever easy - Goodreads">Terry Goodkind</a>) has taught me that nothing is ever easy.  See below some examples of why this is a headache.</p><p><strong>My Approach</strong></p><p>I&#39;m thinking the following approach will have the desired effect of merging the two columns:</p><ol><li>Use SQL to update the data, setting the value for the date field and the value for the time field both to the same value, which is a mix of the date component from the date field and the time component from the time field</li><li>Write any new code only using the MONKEY_DATE field</li><li>Eventually phase out the MONKEY_TIME field and any of the date/time component SQL (see examples)</li><li>Drop MONKEY_TIME</li></ol><p>This will mean we don&#39;t immediately have to go and make retrospective changes to the whole system&#8230; all existing code will continue to work&#8230; and we can begin to do things The Right Way.</p><p>SQL for #1 might be (Oracle):</p><pre><code>UPDATE MONKEY SET 
    MONKEY_DATE = TO_DATE(TO_CHAR(MONKEY_DATE, &#39;MM/DD/YYYY &#39;) || 
                      TO_CHAR(MONKEY_TIME, &#39;HH24:MI:SS&#39;), 
                      &#39;MM/DD/YYYY HH24:MI:SS&#39;)
    MONKEY_TIME = TO_DATE(TO_CHAR(MONKEY_DATE, &#39;MM/DD/YYYY &#39;) || 
                      TO_CHAR(MONKEY_TIME, &#39;HH24:MI:SS&#39;), 
                      &#39;MM/DD/YYYY HH24:MI:SS&#39;)
</code></pre><p><strong>The Question</strong></p><p>My questions to you are:</p><ul><li>Should these fields be merged?</li><li>Is my approach reasonable to merge these two columns?</li><li>Do you think it would be better to skip steps two and three?</li><li>Do you have any other (constructive) comments or suggestions?</li></ul><p><strong>Examples</strong></p><p>For example, to select all my monkey dates and times and order them by date and time, I need to do something like this (SQL Server):</p><pre><code>SELECT 
      CONVERT(DATETIME, CONVERT(VARCHAR, MONKEY_DATE, 101), 101) AS MONKEY_DATE
    , CONVERT(DATETIME, CONVERT(VARCHAR, MONKEY_TIME, 108), 108) AS MONKEY_TIME 
FROM MONKEY 
ORDER BY
      CONVERT(DATETIME, CONVERT(VARCHAR, MONKEY_DATE, 101), 101) DESC
    , CONVERT(DATETIME, CONVERT(VARCHAR, MONKEY_TIME, 108), 108) DESC
</code></pre><p>or this (Oracle &#8211; slightly more explicit):</p><pre><code>SELECT
      TO_DATE(TO_CHAR(MONKEY_DATE, &#39;MM/DD/YYYY&#39;), &#39;MM/DD/YYYY&#39;) AS MONKEY_DATE
    , TO_DATE(TO_CHAR(MONKEY_TIME, &#39;HH24:MI:SS&#39;), &#39;HH24:MI:SS&#39;) AS MONKEY_TIME
FROM MONKEY
ORDER BY
      TO_DATE(TO_CHAR(MONKEY_DATE, &#39;MM/DD/YYYY&#39;), &#39;MM/DD/YYYY&#39;) DESC
    , TO_DATE(TO_CHAR(MONKEY_TIME, &#39;HH24:MI:SS&#39;), &#39;HH24:MI:SS&#39;) DESC
</code></pre><p>I also often find myself selecting a merged date/time column (Oracle):</p><pre><code>SELECT 
    TO_DATE(TO_CHAR(MONKEY_DATE, &#39;MM/DD/YYYY &#39;) || 
            TO_CHAR(MONKEY_TIME, &#39;HH24:MI:SS&#39;), 
        &#39;MM/DD/YYYY HH24:MI:SS&#39;) AS MONKEY_DATE_TIME 
FROM MONKEY
</code></pre><p>Because, almost all the time, we want to know the date and time of the monkey.</p><p>The above SQL could be easily altered to:</p><pre><code>SELECT MONKEY_DATE_TIME FROM MONKEY ORDER BY MONKEY_DATE_TIME
</code></pre><p>&#8230; If only we had merged columns.</p><p><strong>Background</strong></p><p>I&#39;ve inherited an old ASP system that stores dates and times in separate columns in the database.  I&#39;ve been told this is probably because the application started out in an early version of Access, where it was not possible to store both date and time in the same column.  The whys and hows aren&#39;t really part of this question, but some people like to know.</p><p><strong>P.S.</strong></p><p>I really nearly posted this in SO.SE, so my apologies if I got the wrong site.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>One minor point: WHEN you merge the two columns, you might want to do the merge into a new &#34;MONKEY_DATE_2&#34; column instead of overwriting the existing one. That leaves your current columns unchanged, and you can find all the code that hasn&#39;t been updated to work with the new structure with grep.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../how-to-model-the-database-tables-for-calculating-on-peak-and-off-peak-usage-data/'>How to model the database tables for calculating on peak and off peak usage data</a></li><li class="list-group-item"><a href='../sql-algorithm-for-most-overlapping-events/'>SQL algorithm for most overlapping events</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>