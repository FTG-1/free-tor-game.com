<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; What does the author mean by casting the interface reference to any implementation &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1068935 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1068935" class="post-1068935 software type-software status-publish hentry category-software tag-c tag-implementations tag-interfaces"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; What does the author mean by casting the interface reference to any implementation</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">implementations</span><span class="mr-2 badge badge-warning">interfaces</span></p><div class="entry-content"><p>I am currently in the process of trying to master C#, so I am reading <strong>Adaptive Code via C#</strong> by <em>Gary McLean Hall</em>.</p><p>He writes about patterns and anti-patterns. In the implementations versus interfaces part he writes the following:</p><blockquote><p>Developers who are new to the concept of programming to interfaces often have difficulty letting go of what is behind the interface.</p><p>At compile time, any client of an interface should have no idea which implementation of the interface it is using. Such knowledge can lead to incorrect assumptions that couple the client to a specific implementation of the interface.</p><p>Imagine the common example in which a class needs to save a record in persistent storage. To do so, it rightly delegates to an interface, which hides the details of the persistent storage mechanism used. However, it would not be right to make any assumptions about which implementation of the interface is being used at run time. For example, <strong>casting the interface reference to any implementation is <em>always</em> a bad idea.</strong></p></blockquote><p>It might be the language barrier, or my lack of experience, but I don&#39;t quite understand what that means. Here is what I understand:</p><p>I have a free time fun project to practice C#. There I have a class:</p><pre><code>public class SomeClass...
</code></pre><p>This class is used in a lot of places. While learning C#, I read that it is better to abstract with an interface, so I made the following</p><pre><code>public interface ISomeClass &lt;- Here I made a &#34;contract&#34; of all the public methods and properties SomeClass needs to have.

public class SomeClass : ISomeClass &lt;- Same as before. All implementation here.
</code></pre><p>So I went into all some class references and replaced them with ISomeClass.</p><p>Except in the construction, where I wrote:</p><pre><code>ISomeClass myClass = new SomeClass();
</code></pre><p>Am I understanding correctly that this is wrong? If yes, why so, and what should I do instead?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>Abstracting your class into an interface is something you should consider if and only if you intend on writing other implementations of said interface or the strong possibility of doing so in the future exists.</p><p>So perhaps <code>SomeClass</code> and <code>ISomeClass</code> is a bad example, because it would be like having a <code>OracleObjectSerializer</code> class and a <code>IOracleObjectSerializer</code> interface.</p><p>A more accurate example would be something like <code>OracleObjectSerializer</code> and a <code>IObjectSerializer</code>.  The only place in your program where you care what implementation to use is when the instance is created.  Sometimes this is further decoupled by using a factory pattern.</p><p>Everywhere else in your program should use <code>IObjectSerializer</code> not caring how it works.  Lets suppose for a second now that you also have a <code>SQLServerObjectSerializer</code> implementation in addition to <code>OracleObjectSerializer</code>.  Now suppose you need to set some special property to set and that method is only present in OracleObjectSerializer and not SQLServerObjectSerializer.</p><p>There are two ways to go about it: the incorrect way and the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle" rel="noreferrer">Liskov substitution principle</a> approach.</p><h2>The incorrect way</h2><p>The incorrect way, and the very instance referred to in your book, would be to take an instance of <code>IObjectSerializer</code> and cast it to <code>OracleObjectSerializer</code> and then call the method <code>setProperty</code> available only on <code>OracleObjectSerializer</code>.  This is bad because <em>even though</em> you may know an instance to be an <code>OracleObjectSerializer</code>, you&#39;re introducing yet another point in your program where you care to know what implementation it is.  When that implementation changes, and presumably it will sooner or later if you have multiple implementations, best case scenario, you will need to find all these places and make the correct adjustments.  Worst case scenario, you cast a <code>IObjectSerializer</code> instance to a <code>OracleObjectSerializer</code> and you receive a runtime failure in production.</p><h2>Liskov Substitution Principle approach</h2><p>Liskov said that you should never need methods like <code>setProperty</code> in the implementation class as in the case of my <code>OracleObjectSerializer</code> if done properly.  If you abstract a class <code>OracleObjectSerializer</code> to <code>IObjectSerializer</code>, you should encompass all the methods necessary to use that class, and if you can&#39;t, then something is wrong with your abstraction (trying to make a <code>Dog</code> class work as a <code>IPerson</code> implementation for instance).</p><p>The correct approach would be to provide a <code>setProperty</code> method to <code>IObjectSerializer</code>.  Similar methods in <code>SQLServerObjectSerializer</code> would ideally work through this <code>setProperty</code> method.  Better still, you standardize property names through an <code>Enum</code> where each implementation translates that enum to the equivalent for its own database terminology.</p><p>Put simply, using an <code>ISomeClass</code> is only half of it. You should never need to cast it outside the method that is responsible for its creation.  To do so is almost certainly a serious design mistake.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/object-oriented-when-to-use-interfaces-unit-testing-ioc/'>Object-oriented &#8211; When to use interfaces (unit testing, IoC?)</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-is-using-protected-inheritance-to-hide-but-exploit-implemented-interface-from-the-public-ok/'>C++ &#8211; Is using protected inheritance to hide (but exploit) implemented interface from the public ok</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-interface-extension-method-returning-the-interface-type-in-c/'>C# &#8211; Interface extension method returning the interface type in C#</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-is-an-interface-exposing-async-functions-a-leaky-abstraction/'>C# &#8211; Is an interface exposing async functions a leaky abstraction</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>