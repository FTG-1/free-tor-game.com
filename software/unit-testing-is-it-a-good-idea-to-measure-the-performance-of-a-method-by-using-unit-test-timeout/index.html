<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Unit-testing &#8211; Is it a good idea to measure the performance of a method by using unit test timeout &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1072618 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1072618" class="post-1072618 software type-software status-publish hentry category-software tag-performance tag-project-management tag-requirements tag-unit-testing"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Unit-testing &#8211; Is it a good idea to measure the performance of a method by using unit test timeout</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">performance</span><span class="mr-2 badge badge-info">project-management</span><span class="mr-2 badge badge-warning">Requirements</span><span class="mr-2 badge badge-primary">unit testing</span></p><div class="entry-content"><p>In a project where there are <a href="https://softwareengineering.stackexchange.com/questions/118376/">non-functional requirements</a> which specify the maximum execution time for a specific action, QA must check the performance of this action on a dedicated machine using precise hardware under precise load, both hardware and load being specified in the requirements.</p><p>On the other hand, some erroneous changes to the source code may severely impact the performance. <strong>Noticing this negative impact early</strong>, <em>before</em> the source code reaches source control and is verified by QA department, could be beneficial in terms of time lost by QA department reporting the issue, and by the developer fixing it several commits later.</p><p>To do this, is it a good idea:</p><ul><li><p>To use unit tests to have an idea of the time spent executing the same action² <em>n</em> times,</p></li><li><p>To use <a href="http://msdn.microsoft.com/en-us/library/ms243175.aspx" rel="nofollow noreferrer">per-test timeout</a> through <code>[TestMethod, Timeout(200)]</code> attribute in C#?</p></li></ul><p>I expect several problems with this approach:</p><ul><li><p><em>Conceptually</em>, unit tests are not really for that: they are expected to test a small part of a code, nothing more: neither the check of a functional requirement, nor an integration test, nor a performance test.</p></li><li><p>Does unit test timeout in Visual Studio measure really what is expected to be measured, taking in account that initialization and cleanup are nonexistent for those tests or are too short to affect the results?</p></li><li><p>Measuring performance this way is ugly. Running a benchmark on any machine¹ independently of the hardware, load, etc. is <a href="https://softwareengineering.stackexchange.com/a/127827/6605">like doing a benchmark</a> that shows that one database product is always faster than another. On the other hand, <strong>I don&#39;t expect those unit tests to be a definitive result, nor something which is used by the QA department</strong>. Those unit tests will be used just <strong>to give a general idea</strong> about the expected performance, and essentially <strong>to alert the developer that his last modification broke something, severely affecting performance</strong>.</p></li><li><p><a href="https://en.wikipedia.org/wiki/Test-driven_development" rel="nofollow noreferrer">Test Driven Development (TDD)</a> is impossible for those tests. How would it fail, in the first place, before starting to implement code?</p></li><li><p>Too many performance tests will affect the time required to run the tests, so this approach is limited to short actions only.</p></li></ul><p>Taking in account those problems, I still find it interesting to use such unit tests if combined with the real performance metrics by QA department.</p><p>Am I wrong? Are there other problems which makes it totally unacceptable to use unit tests for this?</p><p>If I&#39;m wrong, <strong>what is the correct way</strong> to alert the developer that a change in source code severely affected performance, before the source code reaches source control and is verified by QA department?</p><hr/><p><sup>¹ Actually, the unit tests are expected to run only on developer PCs having comparable hardware performance, which reduces the gap between the fastest machines which will never be able to fail the performance test, and the slowest machines which will never succeed at passing it.</sup></p><p><sup>² By action, I mean a rather short piece of code which spends a few milliseconds to run.</sup></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>We are using this approach as well, i.e. we have tests that measure runtime under some defined load scenario on a given machine. It may be important to point out, that we do not include these in the normal unit tests. Unit tests are basically executed by each developer on a developer machine before commiting the changes. See below for why this doesn&#39;t make any sense for performance tests (at least in our case). Instead we run performance tests as part of integration tests.</p><p>You correctly pointed out, that this should not rule out verification. We do not assume our test to be a test of the non-functional requirement. Instead, we consider it a mere potential-problem-indicator.</p><p>I am not sure about your product, but in our case, if performance is insufficient, it means a lot of work is required to &#34;fix&#34; that. So the turn-around time, when we leave this entirely to QA is horrible. Additionally, the performance fixes will have severe impacts on a large part of the code-base, which renders previous QA work void. All in all, a very inefficient and unsatisfying workflow.</p><p>That being said, here are some points to your respective issues:</p><ul><li><p>conceptually: it is true, that this is not what unit tests are about. But as long as everyone&#39;s aware, that the test is not supposed to verify anything that QA should do, it&#39;s fine.</p></li><li><p>Visual Studio: can&#39;t say anything about that, as we do not use the unit test framework from VS.</p></li><li><p>Machine: Depends on the product. If your product is something developed for end-users with custom individual desktop machines, then it is in fact more realistic to execute the tests on different developers&#39; machines. In our case, we deliver the product for a machine with a given spec and we execute these performance tests only on such a machine. Indeed, there is not much point in measuring performance on your dual-core developer machine, when the client ultimately will run 16 cores or more.</p></li><li><p>TDD: While initial failure is typical, it&#39;s not a must. In fact, writing these tests early makes it serve more as a regression test rather than a traditional unit test. That the test succeeds early on is no problem. But you do get the advantage, that whenever a developer adds functionality that slows down things, because s/he was not aware of the non-functional performance requirement, this TDD test will spot it. Happens a lot, and it is awesome feedback. Imagine that in your daily work: you write code, you commit it, you go to lunch and when you&#39;re back, the build system tells you that this code when executed in a heavy load environment is too slow. That&#39;s nice enough for me to accept, that the TDD test is not initially failed.</p></li><li><p>Run-time: As mentioned, we do not run these tests on developer machines, but rather as part of the build system in a kind of integration test.</p></li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../unit-testing-how-to-unit-test-that-the-correct-implementation-of-an-interface-is-used/'>Unit-testing &#8211; How to unit test that the correct implementation of an interface is used</a></li><li class="list-group-item"><a href='../php-unit-testing-method-per-test-versus-data-provider/'>Php &#8211; Unit Testing: Method per test versus data provider</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>