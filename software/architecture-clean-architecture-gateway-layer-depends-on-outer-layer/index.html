<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Architecture &#8211; Clean Architecture Gateway layer depends on outer layer &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1079970 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1079970" class="post-1079970 software type-software status-publish hentry category-software tag-architecture tag-clean-architecture tag-dependency-inversion"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Architecture &#8211; Clean Architecture Gateway layer depends on outer layer</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">clean-architecture</span><span class="mr-2 badge badge-warning">dependency-inversion</span></p><div class="entry-content"><p>Looking at the clean architecture layers and flow diagrams, and implemented it my self in my applications, I&#39;ve always wondered which layer is supposed to contain the DB, or any 3rd Party service or SDK.</p><p>Looking at both of these images raises the question if there isn&#39;t violation in the outer layers.</p><p><a href="../../../i.stack.imgur.com/32gQH.jpg" rel="noreferrer"><img src="../../../i.stack.imgur.com/32gQH.jpg" alt="enter image description here"/></a></p><p><a href="../../../i.stack.imgur.com/jegxH.jpg" rel="noreferrer"><img src="../../../i.stack.imgur.com/jegxH.jpg" alt="enter image description here"/></a></p><p> I&#39;ve imagined the layers division like this:</p><p><a href="../../../i.stack.imgur.com/BFSnq.png" rel="noreferrer"><img src="../../../i.stack.imgur.com/BFSnq.png" alt="enter image description here"/></a></p><p>But this means that there is a violation of the dependancy rule. Since the gateway always knows about both the external service, and the application it self, the entities.</p><p>Is there a correct way to draw these layers? I&#39;ve read a couple of resources asking this question, but didn&#39;t really get a full answers to what I need. For example: <a href="https://groups.google.com/g/clean-code-discussion/c/oUrgGi2r3Fk?pli=1" rel="noreferrer">https://groups.google.com/g/clean-code-discussion/c/oUrgGi2r3Fk?pli=1</a>, <a href="https://softwareengineering.stackexchange.com/questions/388520/doesnt-repository-pattern-in-clean-architecture-violate-dependency-inversion-pr">Doesn&#39;t repository pattern in clean architecture violate Dependency inversion principle?</a></p><p>I get it that the meaning of clean architecture is kept, and the inner layers, the entities and the use case, aren&#39;t affected by a change in the DB and the gateway, but was just wondering if maybe this is more accurate:</p><p><a href="../../../i.stack.imgur.com/tNffz.jpg" rel="noreferrer"><img src="../../../i.stack.imgur.com/tNffz.jpg" alt="enter image description here"/></a></p><p><strong>edit:</strong></p><p>From the book:</p><blockquote><p>Recall that we do not allow SQL in the use cases layer; instead, we use gateway interfaces that have appropriate methods. Those gateways are implemented by classes in the database layer.</p></blockquote><p>So I guess this means that the data access is really in the most outer layer:</p><p><a href="../../../i.stack.imgur.com/1sq0k.png" rel="noreferrer"><img src="../../../i.stack.imgur.com/1sq0k.png" alt="enter image description here"/></a></p><p>Maybe for this specific example, there is no real use for the interface adapters layer?</p><p>But also from the book about interface adapters layer:</p><blockquote><p>Similarly, data is converted, in this layer, from the form most convenient for entities and use cases, to the form most convenient for whatever persistence framework is being used (i.e., the database). No code inward of this circle should know anything at all about the database. If the database is a SQL database, then all SQL should be restricted to this layer—and in particular to the parts of this layer that have to do with the database.</p><p>Also in this layer is any other adapter necessary to convert data from<br /> some external form, such as an external service, to the internal form<br /> used by the use cases and entities.</p></blockquote><p>So it kinda contradicts that the data access is in the database layer, since this is what it does, converts from the DB, for example SQL rows, into the application&#39;s entities. Are these layers not really separated? I&#39;m confused.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><blockquote><p>Frameworks and Drivers.
The outermost layer is generally composed of frameworks and tools such as the Database, the Web Framework, etc. Generally you don’t write much code in this layer other than glue code that communicates to the next circle inwards.</p><p>This layer is where all the details go. The Web is a detail. The database is a detail. We keep these things on the outside where they can do little harm.</p><p><a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html" rel="nofollow noreferrer">cleancoder.com - the clean architecture</a></p></blockquote><p>So you do, in fact, write code in the blue layer. The the DB aware code goes where it says DB. Across the boundary though, what DB?</p><p>And that means, no, you do not run dependencies both ways across a boundary.</p><blockquote><p>I&#39;d put it in a different way. Think of your gateway as a contract (like
Java interface). User of this contract, something sitting in more inner
ring is defining what is needed. And on contract level there should be
nothing that would require a specific technology or any implementation
details. Of course, there needs to be an implementation of this
contract, where you can put all the details like those DB structure or
SQL queries.</p><p><a href="https://groups.google.com/g/clean-code-discussion/c/oUrgGi2r3Fk?pli=1" rel="nofollow noreferrer">Jacek Bilski - clean-code-discussion</a></p></blockquote><p>So the gateway doesn&#39;t know it&#39;s talking to a DB. But it knows the needs of the application.</p><p>When I see &#34;DB&#34; in the outer ring of the clean architecture diagram I don&#39;t imagine the actual DB. I imagine the only DB aware code. After all, this is a diagram of an object graph. Not a system architecture.</p><p>Done this way, so long as whatever is plugged into your gateway can support its needs it doesn&#39;t matter if it&#39;s a DB, a file system, or system ram.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../architecture-should-i-use-a-layer-between-service-and-repository-for-a-clean-architecture-spring/'>Architecture &#8211; Should I use a layer between service and repository for a clean architecture &#8211; Spring</a></li><li class="list-group-item"><a href='../architecture-clean-architecture-use-case-containing-the-presenter-or-returning-data/'>Architecture &#8211; Clean Architecture: Use case containing the presenter or returning data</a></li><li class="list-group-item"><a href='../c-implementing-clean-architecture/'>C# &#8211; Implementing clean architecture</a></li><li class="list-group-item"><a href='../unit-testing-clean-architecture-use-case-testing/'>Unit-testing &#8211; Clean Architecture use case testing</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>