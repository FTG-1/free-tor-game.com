<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Architecture &#8211; Validation and data persistence in a domain model &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1076587 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1076587" class="post-1076587 software type-software status-publish hentry category-software tag-architecture tag-design-patterns tag-domain-model tag-net tag-validation"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Architecture &#8211; Validation and data persistence in a domain model</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">Architecture</span><span class="mr-2 badge badge-info">design-patterns</span><span class="mr-2 badge badge-warning">domain-model</span><span class="mr-2 badge badge-primary">net</span><span class="mr-2 badge badge-danger">validation</span></p><div class="entry-content"><p>My (first and current) workplace (a .NET shop) suffers from an over-abundance of <a href="http://martinfowler.com/bliki/AnemicDomainModel.html" rel="noreferrer">anemic domain models</a>, to the extent that I don&#39;t really know how validation and data persistence should be handled in a proper domain model.</p><h3>Data Persistence</h3><p>One option would be to give the domain model a way to do persistence itself. You could, for example, inject an <a href="http://martinfowler.com/eaaCatalog/repository.html" rel="noreferrer"><code>IFooRepository</code></a> via constructor injection, and have that resolved by an IoC container to ensure you don&#39;t create a dependency on it (Ã  la <a href="http://jeffreypalermo.com/blog/the-onion-architecture-part-1/" rel="noreferrer">onion architecture</a>). But I&#39;m not sure if the code that uses the domain model should be responsible for calling methods to save the data, etc., or if it should be done implicitly behind the scenes on a background thread. Perhaps this breaks that purity of the domain model and is more along the lines of the <a href="http://martinfowler.com/eaaCatalog/activeRecord.html" rel="noreferrer">active record</a> pattern.</p><p>The other option I see is to not tie the domain model to data persistence at all and instead have a coordinating <a href="http://martinfowler.com/eaaCatalog/serviceLayer.html" rel="noreferrer">service layer</a> responsible for that aspect.</p><p>What are the best practices for data persistence in the domain model pattern?</p><h3>Validation</h3><p>Another problem I don&#39;t know how to solve with a proper domain model is how to indicate to the UI <em>why</em> the current model state is invalid without coupling to (or at least catering to) the UI. For example, let&#39;s say I have a form an user fills out with various fields. We want to validate that input, and if something is wrong, indicate an error on that specific field with a message.</p><p>How would we handle validation with that level of granularity without adding significant complexity to the domain model, or doing hack-ish stringly-typed things (like throwing an validation exception with the property&#39;s name and a message)?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I could be mistaken in my understanding, but I believe your trying to redesign your <em>Domain Model</em> so that it isn&#39;t riddled with <strong>anemia</strong>.  A couple of really, really great books on the matter are:</p><ul><li>Martin Fowler - Patterns of Enterprise Application Architecture</li><li>Eric Evans: Domain-Driven Design: Tackling Complexity in the Heart Of Software</li><li>Vaughn Vernon: Implementing Domain Driven Design</li></ul><p>They have a lot of content which answers quite a few questions on your goal.  One of which is:</p><blockquote><p>A rich Domain Model can look different from the database design, with
 inheritance, strategies, and other Gang of Four patterns, and complex
 webs of small interconnected objects.  A rich Domain model is better
 for more complex logic, but is harder to map to the database.</p><p>A simple Domain Model can use Active Record, whereas a rich Domain
 Model requires a Data Mapper.  Since the behavior of the business
 subject to alot of change, it&#39;s important to be able to modify, build,
 and test this layer easily.</p></blockquote><p>That is an excerpt from Fowler.  He will go into details about the model being anemic and bloated models as well.  The scope of the question to me appears quite large; so I&#39;m not sure I could delve far into it.  Those books should point you in the right direction; also will allow you to gauge your current project and implementation to refactor it quickly.</p><p>From a relatively basic understanding:</p><p>You should be able to abstract your model, which will allow a brief overlay of the <em>UI</em> and <em>Data Access</em> into your <em>Domain Model</em>.  But otherwise the model should allow a clear, clean, concise implementation which will help separate responsibility.</p><p>Sorry I couldn&#39;t be more help.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../php-anemic-domain-model-business-logic-and-datamapper-php/'>Php &#8211; Anemic Domain Model, Business Logic and DataMapper (PHP)</a></li><li class="list-group-item"><a href='../domain-model-and-querying/'>Domain Model and Querying</a></li><li class="list-group-item"><a href='../architecture-where-to-validate-domain-model-rules-that-depend-on-database-content/'>Architecture &#8211; Where to validate domain model rules that depend on database content</a></li><li class="list-group-item"><a href='../java-how-to-present-domain-model-exceptions-thrown-through-validation/'>Java &#8211; How to present domain model exceptions thrown through validation</a></li><li class="list-group-item"><a href='../where-to-put-format-validation-in-a-cqrs-stylish-domain-model/'>Where to put format validation in a CQRS âstylishâ domain model</a></li><li class="list-group-item"><a href='../clean-architecture-validation-in-domain-vs-data-persistence-layer/'>Clean architecture validation in domain vs data persistence layer</a></li><li class="list-group-item"><a href='../architecture-domain-model-design-best-practices-for-robust-fluency-encapsulation-and-extensibility/'>Architecture &#8211; Domain Model Design &#8211; Best Practices for Robust Fluency, Encapsulation, and Extensibility</a></li><li class="list-group-item"><a href='../is-domain-persistence-model-isolation-usually-this-awkward/'>Is domain/persistence model isolation usually this awkward</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>