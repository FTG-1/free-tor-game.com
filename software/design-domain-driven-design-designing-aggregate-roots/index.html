<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; Domain Driven Design &#8211; designing Aggregate Roots &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1085792 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1085792" class="post-1085792 software type-software status-publish hentry category-software tag-cqrs tag-design tag-domain-driven-design"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; Domain Driven Design &#8211; designing Aggregate Roots</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">cqrs</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">domain-driven-design</span></p><div class="entry-content"><p>Imagine you&#39;re designing an application for organizing Workshops.<br /> Workshop itself is quite complicated &#8211; it acts as a state machine with multiple possible states and transitions between them.</p><p>We&#39;re using DDD, CQRS and Event Sourcing.</p><p><strong>And now, the use cases:</strong></p><p>1) one should be able to assign TodoItems to a Workshop and perform CRUD operations on them</p><p>2) one should be able to submit additional Resources for a given Workshop (slides, photos, zip/tar.gz archives etc.) and also perform CRUD operations on them</p><p>3) one should be able to add a PossibleTerm (with a Lecturer, Date and Room specified) to a Workshop. Also, there should be a way to modify/delete them.</p><p>Later on there is a Voting on those terms, system tries to book room for few terms (let&#39;s say, for two terms) that won Voting and Users should be split between those Terms.</p><p><strong>Here I have following solutions:</strong></p><p>1) Model TodoItems, Resources and PossibleTerms as a part of a Workshop.</p><p>Pros:</p><ul><li>everything is where it conceptually belongs to</li><li>no eventual consistency (not a big problem probably&#8230;)</li></ul><p>Cons:</p><ul><li>Workshop aggregate is cluttered with all those CRUD methods for all stuff.</li><li>According to Implementing Domain Driven Design by Vaughn Vernon, creating huge  aggregate roots is an antipattern</li></ul><p>2) Create aggregate roots for holding all those &#34;items&#34; (e.g. TodoItemList, PossibleTermList, Resources or whatever you&#39;re gonna call them).</p><p>Pros:</p><ul><li>Workshop aggregate is smaller, it&#39;s not related with those Lists at all (the only connection would be that for example PossibleTermList holds a reference to WorkshopId)</li></ul><p>Cons:</p><ul><li>when CreateWorkshopCommand arrives, you&#39;re forced to create not only a Workshop, but also additional aggregates as they need to exist after Workshop creation. To avoid this, there could be some kind of CreationalSaga, listening for WorkshopCreatedEvent and producing proper commands to create relatives, but I don&#39;t think this is a good idea.</li></ul><p>3) Model PossibleTerms, Resource, TodoItem as aggregate roots itself</p><p>Pros:</p><ul><li>no need for creating &#39;aggregate wrappers&#39; (as in 2))</li></ul><p>Cons:</p><ul><li>again, you&#39;re cluttering Workshop with at least factory methods</li><li>it is hard for me to implement term-choosing feature &#8211; for counting votes and later on assigning User to a particular Term you need to query your repository for all Terms matching your Workshop ID and so on &#8211; this leads to operations on multiple aggregates within one transaction.</li></ul><p><strong>Question: which solution sound best for you? Maybe you have differents ideas?</strong></p><p>(Bonus question: I need to perform CRUD operations on individual Resources/TodoItem. I&#39;d rather model then as value objects, but how are they then identified?)</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I think you&#39;re missing the transactional analysis. Which entities will be modified by each of your use cases ? Will some of them impact more than one entity ?</p><p>What are your invariants ? Do some of them span multiple entities (e.g., two <code>Term</code>s can&#39;t use the same <code>Room</code> at the same date/time) ? Are they true invariants or could eventual consistency be sufficient ?</p><p>Vaughn Vernon has a good step by step approach to aggregate modelling here : <a href="https://vaughnvernon.co/?p=926" rel="nofollow">https://vaughnvernon.co/?p=926</a></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../does-reference-by-id-between-aggregates-lead-to-an-anemic-domain-model/'>Does reference by ID between Aggregates lead to an Anemic Domain Model</a></li><li class="list-group-item"><a href='../a-problem-with-understanding-aggregates-and-aggregate-roots-in-domain-driven-design-ddd/'>A problem with understanding aggregates and aggregate roots in Domain Driven Design (DDD)</a></li><li class="list-group-item"><a href='../architecture-aggregate-root-being-created-by-multiple-other-aggregate-roots/'>Architecture &#8211; Aggregate root being created by multiple other aggregate roots</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>