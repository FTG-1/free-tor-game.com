<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Object-oriented &#8211; Interface Segregation Principle: What to do if interfaces have significant overlap &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1084436 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1084436" class="post-1084436 software type-software status-publish hentry category-software tag-c tag-design tag-interfaces tag-object-oriented tag-solid"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Object-oriented &#8211; Interface Segregation Principle: What to do if interfaces have significant overlap</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">interfaces</span><span class="mr-2 badge badge-primary">object-oriented</span><span class="mr-2 badge badge-danger">solid</span></p><div class="entry-content"><p>From <a href="http://amzn.com/B00IZ0G6YG" rel="nofollow">Agile Software Development, Principles, Patterns, and Practices: Pearson New International Edition</a>:</p><blockquote><p>Sometimes, the methods invoked by different groups of clients will overlap. If the overlap is small, then the<br /> interfaces for the groups should remain separate. The common functions should be declared in all the overlapping<br /> interfaces. The server class will inherit the common functions from each of those interfaces, but it will implement<br /> them only once.</p></blockquote><p>Uncle Bob, talks about the case when there is minor overlap.</p><p>What should we do if there is significant overlap?</p><p>Say we have</p><pre><code>Class UiInterface1;
Class UiInterface2;
Class UiInterface3;

Class UiIterface : public UiInterface1, public UiInterface2, public UiInterface3{};
</code></pre><p>What should we do if there is significant overlap between <code>UiInterface1</code> and <code>UiInterface2</code>?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p><strong>Casting</strong></p><p>This is almost certainly going to be a complete tangent to the cited book&#39;s approach, but one way to conform better to ISP is to embrace a casting mindset at one central area of your codebase using a <code>QueryInterface</code> COM-style approach.</p><p>A lot of the temptations to design overlapping interfaces in a pure interface context often comes from the desire to make interfaces &#34;self-sufficient&#34; more than performing one precise, sniper-like responsibility.</p><p>For example, it might seem odd to design client functions like this:</p><pre><code>// Returns the absolute position of an entity as the sum
// of its own position and the position of its ancestors.
// `position` and `parenting` parameters should point to the 
// same object.
Vec2i abs_position(IPosition* position, IParenting* parenting)
{
     const Vec2i xy = position-&gt;xy();
     auto parent = parenting-&gt;parent();
     if (parent)
     {
         // If the entity has a parent, return the sum of the
         // parent position and the entity&#39;s local position.
         return xy + abs_position(dynamic_cast&lt;IPosition*&gt;(parent),
                                  dynamic_cast&lt;IParenting*&gt;(parent));
     }
     return xy;
}
</code></pre><p>... as well as quite ugly/dangerous, given that we&#39;re leaking the responsibility to do error-prone casting to the client code using these interfaces and/or passing the same object as an argument multiple times to multiple parameters of the same function. So we end up often wanting to design a more diluted interface which consolidates the concerns of <code>IParenting</code> and <code>IPosition</code> in one place, like <code>IGuiElement</code> or something like that which then becomes susceptible to overlapping with the concerns of orthogonal interfaces which will likewise be tempted to have more member functions for the same &#34;self-sufficiency&#34; reason.</p><p><strong>Mixing Responsibilities vs. Casting</strong></p><p>When designing interfaces with a totally distilled, ultra-singular responsibility, the temptation will often be to either accept some downcasting or consolidate interfaces to fulfill multiple responsibilities (and therefore tread on both ISP and SRP).</p><p>By using a COM-style approach (just the <code>QueryInterface</code> part), we play to the downcasting approach but consolidate the casting to one central place in the codebase, and can do something more like this:</p><pre><code>// Returns the absolute position of an entity as the sum
// of its own position and the position of its ancestors.
// `obj` should implement `IPosition` and optionally `IParenting`.
Vec2i abs_position(Object* obj)
{
     // `Object::query_interface` returns nullptr if the interface is
     // not provided by the entity. `Object` is an abstract base class
     // inherited by all entities using this interface query system.
     IPosition* position = obj-&gt;query_interface&lt;IPosition&gt;();
     assert(position &amp;&amp; &#34;obj does not implement IPosition!&#34;);
     const Vec2i xy = position-&gt;xy();

     IParenting* parenting = obj-&gt;query_interface&lt;IParenting&gt;();
     if (parenting &amp;&amp; parenting-&gt;parent()-&gt;query_interface&lt;IPosition&gt;())
     {
         // If the entity implements IParenting and has a parent, 
         // return the sum of the parent position and the entity&#39;s 
         // local position.
         return xy + abs_position(parenting-&gt;parent());
     }
     return xy;
}
</code></pre><p>... of course hopefully with type-safe wrappers and all that you can build centrally to get something safer than raw pointers.</p><p>With this, the temptation to design overlapping interfaces is often mitigated to the absolute minimum. It allows you to design interfaces with very singular responsibilities (sometimes just one member function inside) that you can mix and match all you like without worrying about ISP, and getting the flexibility of pseudo-duck typing at runtime in C++ (though of course with the trade-off of runtime penalties to query objects to see if they support a particular interface). The runtime part can be important in, say, a setting with a software development kit where the functions will not have the compile-time information of plugins in advance that implement these interfaces.</p><p><strong>Templates</strong></p><p>If templates are a possibility (we have the necessary compile-time info in advance which is not lost by the time we get hold of an object, i.e.), then we can simply do this:</p><pre><code>// Returns the absolute position of an entity as the sum
// of its own position and the position of its ancestors.
// `obj` should have `position` and `parent` methods.
template &lt;class Entity&gt;
Vec2i abs_position(Entity&amp; obj)
{
     const Vec2i xy = obj.xy();
     if (obj.parent())
     {
         // If the entity has a parent, return the sum of the parent 
         // position and the entity&#39;s local position.
         return xy + abs_position(obj.parent());
     }
     return xy;
}
</code></pre><p>... of course in such a case, the <code>parent</code> method would have to return the same <code>Entity</code> type, in which case we probably want to avoid interfaces outright (since they&#39;ll often want to lose type information in favor of working with base pointers).</p><p><strong>Entity-Component System</strong></p><p>If you start pursuing the COM-style approach further from a flexibility or performance standpoint, you&#39;ll often end up with an entity-component system similar to what game engines apply in the industry. At that point you&#39;ll be going completely perpendicular to a lot of object-oriented approaches, but ECS might be applicable to GUI design (one place I&#39;ve contemplated using ECS outside of a scene-oriented focus, but considered it too late after settling on a COM-style approach to try there).</p><p>Note that this COM-style solution is completely out there as far as GUI toolkit designs go, and ECS would be even more, so it&#39;s not something which will be backed by a lot of resources. Yet it&#39;ll definitely allow you to mitigate the temptations to design interfaces which have overlapping responsibilities to an absolute minimum, often making it a non-concern.</p><p><strong>Pragmatic Approach</strong></p><p>The alternative, of course, is relax your guard a bit, or design interfaces at a granular level and then start inheriting them to create coarser interfaces that you use, like <code>IPositionPlusParenting</code> which derives from both <code>IPosition</code> and <code>IParenting</code> (hopefully with a better name than that). With pure interfaces, it shouldn&#39;t violate ISP quite as much as those monolithic deep-hierarchical approaches commonly applied (Qt, MFC, etc, where the documentation often feels the need to hide irrelevant members given the excessive level of violating ISP with those kinds of designs), so a pragmatic approach might simply accept some overlap here and there. Yet this kind of COM-style approach avoids the need to create consolidated interfaces for every combination you&#39;ll ever use. The &#34;self-sufficiency&#34; concern is completely eliminated in such cases, and that will often eliminate the ultimate source of temptation to design interfaces which have overlapping responsibilities which want to fight with both SRP and ISP.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../java-object-oriented-class-design/'>Java &#8211; Object-Oriented Class Design</a></li><li class="list-group-item"><a href='../design-violating-the-interface-segregation-principle/'>Design &#8211; Violating the Interface Segregation Principle</a></li><li class="list-group-item"><a href='../php-interface-segregation-principle-type-hinting-multiple-interfaces/'>Php &#8211; Interface Segregation Principle &#8211; type hinting multiple interfaces</a></li><li class="list-group-item"><a href='../c-implementing-the-interface-segregation-principle/'>C# &#8211; Implementing the Interface Segregation Principle</a></li><li class="list-group-item"><a href='../when-should-interface-be-owned-by-client/'>When should interface be owned by client</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>