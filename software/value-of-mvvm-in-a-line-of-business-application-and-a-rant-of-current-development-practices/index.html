<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Value of MVVM in a Line of Business Application (and a Rant of Current Development Practices) &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1077481 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1077481" class="post-1077481 software type-software status-publish hentry category-software tag-mvvm tag-wpf"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Value of MVVM in a Line of Business Application (and a Rant of Current Development Practices)</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">mvvm</span><span class="mr-2 badge badge-info">wpf</span></p><div class="entry-content"><p>After 2 years, I&#39;m still struggling with MVVM as a practical method of producing working software.  In some cases it&#39;s great.  I did a multithreaded application that controlled a small assembly line that would have been a nightmere without MVVM concepts.  An abstraction from the physical assembly line was almost a no brainer.</p><p>However, my career mostly revolves around internal line of business applications &#8211; formalizing and optimizing the operations of a business.  In such apps, there is generally a business teir revolving around CRUD and compound operations.  In LOBs, my view models end up being a very simple collections of one line wrapper functions of the business class methods and in the end only end up complicating the simplest of tasks like showing a message box or opening a window.  Doesn&#39;t anybody else find it odd when people go into long discriptions of &#34;dependency injection&#34; and &#34;messaging providers&#34; for a Window.ShowDialog call that has been around for decades?  How many other questions are there on stack overflow asking for advice for tasks that were extremely simple in winforms?</p><p>Don&#39;t get me wrong &#8211; I get MVVM and how it could be invaluable to large teams doing horizontal development of a shrink-wrapped and marketed software package.  Unit testing the view models could save millions by avoiding a bad RTM bug and dedicated UI developers could give a rich experience.  But when the cost of redeployment is minimal and all the business cares to pay for is simple working software, why should i spend time unit testing a simple &#34;wrapper&#34; vm when my business logic is already unit tested? How much time is the business really going to allow me to spend on cute animations and color schemes?  Is there anything left for a junior developer to do (tracking down a bug in a save functionality used to be looking at &#34;Save_Click&#34;, but now you have to understand the patterns and the project as a whole especially if you&#39;re relying on templating to marry up the VM with the view).</p><p>Admittedly, I really like the databinding of WPF.  To take advantage of it, I set the data context to the window itself, where it has access to the business class as well as any other observable properties.  Yes I break nearly every MVVM &#34;rule&#34; by doing so.  But at least I have simple event driven code that&#39;s easy to read AND I get to take advantage of the new databinding and validation.  The problem is in the designers &#8211; which I don&#39;t use all that much but hope to now that it&#39;s better integrated in 2012 &#8211; the designer shows the hundreds of properties that a window and its base classes have.</p><p>For those that can relate can you point me to resources, books, or even just changes in perspective that made this easier to swallow.  I&#39;ll give MVVM another shot, but the last time I felt pretty stupid for worrying about dependency injection just to show a message box from a VM I had no intention of unit testing.  Even if I did unit test are we really getting more quality by trading run time testing for compile time errors of those dreaded &#34;tightly-coupled&#34; applications?</p><p>I realize one answer is to just stay in winforms.  But as one of the last supporters of WebForms (I have much of the same critique of the trend of web developement), i felt a little like a dinosaur as it is when I descovered there&#39;s no more WebForms left in the Microsoft certification tracks.  Moving forward is the only option, even if I don&#39;t like it.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>My perspective is from years of experience working with Winforms, the &#34;old fashioned way,&#34; with events and code-behind. So I can tell you with absolute certainty that, once you get beyond the simplest of applications, your code quickly becomes a <a href="http://en.wikipedia.org/wiki/Big_ball_of_mud">big ball of mud</a>.  It was inevitable, because that&#39;s the way applications were written back then.</p><p>Webforms is just the same, except that it throws in the additional complication of being a stateful abstraction over a stateless system (the web).  As Rob Conery put it:</p><blockquote><p>WebForms is a lie. It’s abstraction wrapped in deception covered in
 lie sauce presented on a plate full of diversion and sleight of hand.
 Nothing you do with Webforms has anything to do with the web – you let
 it do the work for you.</p></blockquote><p>This, from the guy that wrote a fully functional object-relational mapper using the <code>dynamic</code> keyword in C# and only four hundred lines of code.  When he speaks authoritatively about something, I listen.</p><p>The application I&#39;m currently working on is a Winforms application, with several tabs in the main form.  I can dynamically load forms into each of the tabs.  While I didn&#39;t follow MVVM or MVP (you can, with libraries like <a href="http://winformsmvp.codeplex.com/">this one</a>), I did aggressively push every bit of code I could out to a separate assembly, leaving only that code that is absolutely required to run the form.  There&#39;s still several hundred lines of code in there, not counting the partial class containing the form&#39;s control definitions, properties and event handler assignments, but I should never have to touch it again, unless I need to add something new to the form.</p><p>I have a static method that I can hand a form and a collections of Key/Value pairs, and it will (using Reflection) automatically match up the keys to the fields in the form, and populate the form with the collection&#39;s values.  I can also do the reverse, getting a collection of Key/Value pairs from the form&#39;s fields.  That whole thing is about twenty lines of code, but it pays for itself every time I use it, because I don&#39;t have to write forty custom assignment statements for forty controls on a form.</p><p>I can take that Key/Value list, and serialize it to XML, allowing me to persist it to a file.  I have other forms that I can hand a conventional <a href="http://en.wikipedia.org/wiki/Data_transfer_object">DTO</a>, and map its fields to the form. None of this would be practical in the &#34;big ball of mud&#34; style of Winforms.  It&#39;s almost trivial when adequate decoupling is utilized.</p><p>Does any of this sound familiar?  It should; it&#39;s essentially a poor-man&#39;s form of data binding.</p><blockquote><p>Admittedly, I really like the databinding of WPF. To take advantage of
 it, I set the data context to the window itself, where it has access
 to the business class as well as any other observable properties.</p></blockquote><p>Good for you.  It doesn&#39;t have to be MVVM compliant.  But remember, patterns like MVVM were created to help developers build <em>big systems.</em> If you just need to display a dialog, you may not need all of that plumbing.</p><p>Part of the complexity of systems like WPF is inherent in all programmer libraries that seek to <em>solve a specific problem in a generalized way.</em> To do that, you have to account for every practical way a programmer might use your library.  That adds complexity, but for those who design their libraries well, it also brings to the table a philosophy of doing things in a uniform and consistent way.</p><p>Consider John Resig&#39;s jQuery library: it is the very essence of a coherent design, and it hides a lot of weird details about the <a href="http://en.wikipedia.org/wiki/Document_Object_Model">DOM</a>, and variations in the way browsers handle it.  Is it simpler just to write a few lines of Javascript?  Sometimes.  But the benefit of writing jQuery code in a coherent, uniform API makes it easier for the next person who comes along to understand what you did, and maintain that code if needed.</p><p>My real experience with &#34;big application&#34; models is in using ASP.NET MVC. <em>ASP.NET is to ASP.NET MVC as Winforms is to WPF.</em> When I worked in ASP.NET, I always struggled to bend it to my will.  ASP.NET MVC bends to you.  It is a joy to use; it produces a system structure that is clear and organized, and gives you full control over your application and markup.  You can use Javascript, jQuery and CSS liberally, and ASP.NET MVC stays out of your way.</p><p>My only hurdle was getting used to it, and getting to know it on its own terms.</p><p><strong>Further Reading</strong><br/> <a href="http://wekeroad.com/2009/04/22/i-spose-ill-just-say-it-you-should-learn-mvc">You Should Learn MVC by Rob Conery</a></p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../who-should-control-navigation-in-an-mvvm-application/'>Who should control navigation in an MVVM application</a></li><li class="list-group-item"><a href='../c-how-to-use-a-messagebox-using-the-mvvm-pattern/'>C# &#8211; How to use a MessageBox using the MVVM pattern</a></li><li class="list-group-item"><a href='../mvvm-child-windows-and-data-contexts/'>MVVM &#8211; child windows and data contexts</a></li><li class="list-group-item"><a href='../c-net-mvvm-software-architecture-and-naming-conventions/'>C# .NET MVVM software architecture and naming conventions</a></li><li class="list-group-item"><a href='../c-switch-complex-winforms-app-to-wpf-mvvm/'>C# &#8211; Switch complex WinForms app to WPF MVVM</a></li><li class="list-group-item"><a href='../design-mvvm-best-practices-with-wpf-client-and-wcf-duplex-service/'>Design &#8211; MVVM best practices with WPF client and WCF duplex service</a></li><li class="list-group-item"><a href='../wpf-mvvm-loading-data-on-startup/'>WPF MVVM Loading data on startup</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>