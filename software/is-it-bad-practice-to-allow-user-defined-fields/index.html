<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Is it bad practice to allow user defined fields &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1069170 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1069170" class="post-1069170 software type-software status-publish hentry category-software tag-database-design tag-patterns-and-practices tag-web-applications"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Is it bad practice to allow user defined fields</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">database-design</span><span class="mr-2 badge badge-info">patterns-and-practices</span><span class="mr-2 badge badge-warning">web-applications</span></p><div class="entry-content"><p>Generally speaking, is it considered bad practice to allow for user created fields in a database for a webapp?</p><p>For example, I am making a home inventory webapp for my wife, and she is going to want to define her own fields for different items.  I was planning to allow her to create item categories, and add &#34;features&#34; to those categories.  Features would just be key/value stored as strings.  That way if she had a category called &#34;Audio CDs&#34; for example, she could add features for stuff like &#34;artist&#34;, &#34;tracks&#34;, etc.  But in another category like &#34;furniture&#34;, she could add features for stuff like &#34;material&#34; (wood, plastic, etc).  Then any item could belong to one (or many) categories, adding those features to the item.</p><p>I can see issues where searching by these features requires string comparisons, there&#39;s no validation of data, etc.  Following agile methodology, maybe it would be better to just have her come up with new categories and attributes and I would just have to create new tables as we go.  In my example, it&#39;s a small userbase (2 of us) and the amount of records created would be small, so not too bad.</p><p>Generally speaking though, how do people handle something like this in &#34;real life&#34;?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>When you start getting to &#34;user defined fields&#34; as is often found in bug trackers, customer resource management, and similar business tools is that they are not backed with a table with a bajillion fields (if they are, then thats likely a problem of its own).</p><p>Instead what you find are <a href="http://en.wikipedia.org/wiki/Entity-attribute-value_model">Entity Attribute Value</a> table designs and the associated administration tool to manage the valid attributes.</p><p>Consider the following table:</p><pre>

  +--------------+
  | thing        |
  |--------------|
  | id           |
  | type         |
  | desc         |
  | attr1        |
  | attr2        |
  | attr3        |
  | attr4        |
  | attr5        |
  +--------------+
</pre><p>This is after you&#39;ve added a few attributes.  Instead of <code>attr1</code> pretend it reads <code>artist</code> or <code>tracks</code> or <code>genre</code> or whatever attributes the thing has.  And instead of 5, what if it was 50.  Clearly that is unmanageable.  It also requires an update of the model and redeployment of the application to handle a new field.  Not ideal.</p><p>Now consider the following table structure:</p><pre>

  +--------------+     +---------------+    +-------------+
  | thing        |     | thing_attr    |    | attr        |
  |--------------|     |---------------|    |-------------|
  | id           |&lt;---+|  thing_id (fk)|  +&gt;| id          |
  | type         |     |  attr_id  (fk)|+-+ | name        |
  | desc         |     |  value        |    |             |
  +--------------+     +---------------+    +-------------+
</pre><p>You&#39;ve got your thing with its basic fields.  You have two more tables.  One with the attributes.  Each field is a row in the <code>attr</code> table.  And then there is the <code>thing_attr</code> with a pair of foreign keys relating back to the <code>thing</code> table and the <code>attr</code> table.  And this then has a value field where you store whatever the value of the field for that entity would be.</p><p>And now you&#39;ve got a structure where the attr table can be updated at runtime and new fields can be added (or removed) on the fly without significant impact to the overall application.</p><p>The queries are a little bit more complex and validation becomes more complex too (either funky stored procedures or all client side).  Its a trade off in design.</p><p>Consider also the situation where some day you need to do a migration and you come back to the application to find that there are now a half dozen or so more attributes than the schema you originally distributed.  This makes for ugly migrations and upgrades where the Entity Attribute Value table, when used correctly, can be cleaner.   (Not always, but can be.)</p><hr/><blockquote><p>Are there any downsides to just modifying the schema at runtime? If the user thinks a thing needs a new attribute, just dynamically add a column to the table?</p></blockquote><p>If you are working with the appropriate flavor of nosql database, you could probably do this (note that the appropriate flavor of the nosql for this would probably be a <a href="http://en.wikipedia.org/wiki/NoSQL#Key.E2.80.93value_stores">key-value store</a> which is, well, the EAV table for relational ones described above) without too much trouble. <em>However</em> it comes with all the compromises for nosql which are described elsewhere in great detail.</p><p>If you are instead working on a relational database - you need to have the schema.  Adding the column dynamically means some subset of the following things are true:</p><ul><li>You are doing meta-database programming.  Instead of being able to cleanly map this column to that field with a nice ORM, you are probably doing things like <code>select *</code> and then doing some complex code to find out what the data actually is (see <a href="http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSetMetaData.html">Java&#39;s ResultSetMetaData</a>) and then storing that in a map (or some other datatype - but <em>not</em> nice fields in the code).  This then throws away a fair bit of type and typo safety that you have with the traditional approach.</li><li>You&#39;ve likely abandoned the ORM.  This means you&#39;re writing raw sql for all the code instead of letting the system do the work for you.</li><li>You&#39;ve given up on doing clean upgrades.  What happens when the customer adds a field with one name that your next version also uses?  In the matchmaking site the upgrade that wants to add a <code>hasdate</code> field for storing a timestamp has already been defined as <code>hasdate</code> with a boolean for a successful match... and your upgrade breaks.</li><li>You&#39;re trusting that the customer doesn&#39;t break the system by using some reserved word that breaks your queries too... somewhere.</li><li>You&#39;ve bound yourself to one database brand.  The <a href="http://en.wikipedia.org/wiki/Data_definition_language">DDL</a> of different databases is different. Database types are the easiest example of this. <code>varchar2</code> vs <code>text</code> and the like.  Your code to add the column would work on MySQL but not Postgres or Oracle or SQL Server.</li><li>Do you trust the customer to actually add the data <em>well</em>?  Sure, the EAV is far from ideal but now you&#39;ve got some horrendous obscure table names that you the developer didn&#39;t add, with the wrong type of index (if any), with no constraints added in the code where there need to be and so on.</li><li>You&#39;ve given schema modification privileges to the user running the application. <a href="http://xkcd.com/327/">Little Bobby Drop Tables</a> isn&#39;t possible when you&#39;re restricted to SQL rather than DDL (sure you can do a <code>delete * from students</code> instead, but you can&#39;t really mess up the database in bad ways).  The number of things that can go wrong with schema access either from an accident or malicious activity skyrockets.</li></ul><p>This really boils down to &#34;don&#39;t do it.&#34; If you really want this, go with a known pattern of the EAV table structure or a database that is entirely dedicated to this structure.  Don&#39;t let people create arbitrary fields in a table.  The headaches just aren&#39;t worth it.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/database-design-for-tagging-system/'>Database design for tagging system</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/practical-thesql-schema-advice-for-ecommerce-store-products-attributes/'>Practical thesql schema advice for eCommerce store &#8211; Products &#038; Attributes</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/patterns-for-undo-in-multi-user-applications-on-relational-data/'>Patterns for undo in multi-user applications on relational data</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/database-would-these-two-scenarios-be-good-candidates-for-a-nosql-database/'>Database &#8211; Would these two scenarios be good candidates for a NoSQL database</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>