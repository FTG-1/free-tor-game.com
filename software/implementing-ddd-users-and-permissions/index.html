<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Implementing DDD: users and permissions &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1065975 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1065975" class="post-1065975 software type-software status-publish hentry category-software tag-authorization tag-domain-driven-design tag-implementations tag-permissions"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Implementing DDD: users and permissions</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">authorization</span><span class="mr-2 badge badge-info">domain-driven-design</span><span class="mr-2 badge badge-warning">implementations</span><span class="mr-2 badge badge-primary">permissions</span></p><div class="entry-content"><p>I am working on a small application trying to grasp the principles of domain-driven design. If successful, this might be a pilot for a larger project. I&#39;m trying to follow the book &#34;Implementing Domain-Driven Design&#34; (by Vaughn Vernon) and trying to implement a similar, simple discussion forum. I&#39;ve also checked out the IDDD samples on github. I have some difficulties adopting the Identity and Access to my case. Let me give some background information:</p><ul><li><p>I (hopefully) understand the reasoning behind separating the users and permissions logic: it is a supporting domain, and it&#39;s a different bounded context.</p></li><li><p>In the core domain, there are no users, just Authors, Moderators, etc. These are created by reaching out to the Identity and Access context using a service and then translating the received User objects to and Moderator.</p></li><li><p>Domain operations are called with a related role as a parameter: e.g.:</p><p><code>ModeratePost( ..., moderator);</code></p></li><li><p>The method of the domain object checks if the given Moderator instance is not null (the Moderator instance will be null if the user asked from the Identity and Access context does not have the Moderator role).</p></li><li><p>In one case, it does an additional check before altering a Post:</p><p><code>if (forum.IsModeratedby(moderator))</code></p></li></ul><p>My questions are:</p><ul><li><p>In the latter case aren&#39;t the security concerns blended again into the core domain? Previously the books states &#34;with who can post a subject, or under what conditions that is permitted. A Forum just needs to know that an Author is doing that right now&#34;.</p></li><li><p>The role based implementation in the book is fairly straightforward: when a Moderator is the core domain tries to convert the current userId into a Moderator instance or into an Author when it needs that. The service will respond with the appropriate instance or a null if the user does not have the required role. However, I can&#39;t see how could I adapt this to a more complex security model; our current project I&#39;m piloting for has a rather complex model with groups, ACLs, etc.</p></li></ul><p>Even with rules that are not much very complex, like: &#34;A post should be edited only by its Owner or an Editor&#34;, this approach seems to break down, or at least I don&#39;t see the correct way to implement it.</p><p>By asking the Identity and Access context for an OwnerOrEditor instance doesn&#39;t feel right, and I would end up with more and more security-related classes in the core domain. In addition, I would need to pass not just the userId, but the identifier of the protected resource (the id of the post, forum, etc.) to the security context, which probably should not care about these things (is it correct?)</p><p>By pulling the permissions to the core domain and checking them in the methods of the domain objects or in the services, I&#39;d end up at square one: mixing security concerns with the domain.</p><p>I&#39;ve read somewhere (and I tend to agree with it) that these permission related things should not be a part of the core domain, unless security and permissions are the core domain itself. Does a simple rule like the one given above justify making security a part of the core domain?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>It&#39;s sometimes difficult to distinguish between real access control rules and domain invariants borderlining on access control.</p><p>Especially, rules that depend on data only available far into the course of a particular piece of domain logic might not easily be extractible out of the domain. Usually, Access Control is called before or after a domain operation is performed but not during.</p><p>Vaughn Vernon&#39;s <code>assert (forum.IsModeratedBy(moderator))</code> example probably should have been outside the Domain, but it is not always feasible.</p><blockquote><p>I would need to pass not just the userId, but the identifier of the
 protected resource (the id of the post, forum, etc.) to the security
 context, which probably should not care about these things (is it
 correct?)</p></blockquote><p>If there&#39;s a Security BC and you want it to handle that logic, it doesn&#39;t have to know what a Forum is in detail but :</p><ul><li>It could just have knowledge of concepts like &#34;moderated by&#34; and grant or deny access rights accordingly.</li><li>You could have adapter logic that subscribes to Core Domain events and translates them to simple (resource, authorizedUsers) key value pairs for the Security BC to store and use.</li></ul></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../object-oriented-filesystem-like-permissions-for-c-type-members/'>Object-oriented &#8211; Filesystem like permissions for C++ type-members</a></li><li class="list-group-item"><a href='../vernons-book-implementing-ddd-and-modeling-of-underlying-concepts/'>Vernon&#8217;s book Implementing DDD and modeling of underlying concepts</a></li><li class="list-group-item"><a href='../ddd-cqrs-per-query-and-per-command-authorization/'>DDD CQRS &#8211; per-query and per-command authorization</a></li><li class="list-group-item"><a href='../ddd-referencing-objects-from-other-bounded-contexts/'>DDD Referencing objects from other bounded contexts</a></li><li class="list-group-item"><a href='../how-to-efficiently-pass-permissions-that-control-view-and-access-of-specific-front-end-elements-from-backend-to-the-spa-using-jwt/'>How to efficiently pass permissions that control view and access of specific front-end elements from backend to the SPA using JWT</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>