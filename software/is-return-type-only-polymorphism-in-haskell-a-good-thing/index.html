<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Is return-type-(only)-polymorphism in Haskell a good thing &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070656 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070656" class="post-1070656 software type-software status-publish hentry category-software tag-functional-programming tag-haskell"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Is return-type-(only)-polymorphism in Haskell a good thing</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">functional programming</span><span class="mr-2 badge badge-info">haskell</span></p><div class="entry-content"><p>One thing that I&#39;ve never quite come to terms with in Haskell is how you can have polymorphic constants and functions whose return type cannot be determined by their input type, like</p><pre><code>class Foo a where
    foo::Int -&gt; a
</code></pre><p>Some of the reasons that I do not like this:</p><p><strong>Referential transparency:</strong></p><p>&#34;In Haskell, given the same input, a function will always return the same output&#34;, but is that really true? <code>read &#34;3&#34;</code> return 3 when used in an <code>Int</code> context, but throws an error when used in a, say, <code>(Int,Int)</code> context. Yes, you can argue that <code>read</code> is also taking a type parameter, but the implicitness of the type parameter makes it lose some of its beauty in my opinion.</p><p><strong>Monomorphism restriction:</strong></p><p>One of the most annoying things about Haskell. Correct me if I&#39;m wrong, but the whole reason for the MR is that computation that looks shared might not be because the type parameter is implicit.</p><p><strong>Type defaulting:</strong></p><p>Again one of the most annoying things about Haskell. Happens e.g. if you pass the result of functions polymorphic in their output to functions polymorphic in their input. Again, correct me if I&#39;m wrong, but this would not be necessary without functions whose return type cannot be determined by their input type (and polymorphic constants).</p><p>So my question is (running the risk of being stamped as a &#34;discussion quesion&#34;): <em>Would it be possible to create a Haskell-like language where the type checker disallows these kinds of definitions? If so, what would be the benefits/disadvantages of that restriction?</em></p><p>I can see some immediate problems:</p><p>If, say, <code>2</code> only had the type <code>Integer</code>, <code>2/3</code> wouldn&#39;t type check anymore with the current definition of <code>/</code>. But in this case, I think type classes with functional dependencies could come to the rescue (yes, I know that this is an extension). Furthermore, I think it is a lot more intuitive to have functions that can take different input types, than to have functions that are restricted in their input types, but we just pass polymorphic values to them.</p><p>The typing of values like <code>[]</code> and <code>Nothing</code> seems to me like a tougher nut to crack. I haven&#39;t thought of a good way to handle them.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>I actually think that return type polymorphism is one of the best features of type classes.  After having used it for a while, it is sometimes hard for me to go back to OOP style modeling where I don&#39;t have it.</p><p>Consider the encoding of algebra.  In Haskell we have a type class <code>Monoid</code> (ignoring <code>mconcat</code>)</p><pre><code>class Monoid a where
   mempty :: a
   mappend :: a -&gt; a -&gt; a
</code></pre><p>How could we encode this as an interface in an OO language?  The short answer is we can&#39;t.  That&#39;s because the type of <code>mempty</code> is <code>(Monoid a) =&gt; a</code> aka, return type polymorphism.  Having the ability to model algebra is incredibly useful IMO.*</p><p>You start your post with the complaint about &#34;Referential Transparency.&#34;  This raises an important point: Haskell is a value oriented language.  So expressions like <code>read 3</code> don&#39;t have to be understood as things that compute values, they can also be understood as values.   What this means is that the real issue is not return type polymorphism: it is values with polymorphic type (<code>[]</code> and <code>Nothing</code>).  If the language should have these, then it really has to have polymorphic return types for consistency.</p><p>Should we be able to say <code>[]</code> is of type <code>forall a. [a]</code>?  I think so.  These features are very useful, and they make the language much simpler.</p><p>If Haskell had subtype polymorphism <code>[]</code> could be a subtype for all <code>[a]</code>.  The problem is, that I don&#39;t know of a way of encoding that without having the type of the empty list be polymorphic.  Consider how it would be done in Scala (it is shorter than doing it in the canonical statically typed OOP language, Java)</p><pre><code>abstract class List[A]
case class Nil[A] extends List[A]
case class Cons[A](h: A. t: List[A]) extends List[A]
</code></pre><p>Even here, <code>Nil()</code> is an object of type <code>Nil[A]</code> **</p><p>Another advantage of return type polymorphism is that it makes the Curry-Howard embedding much simpler.</p><p>Consider the following logical theorems:</p><pre><code> t1 = forall P. forall Q. P -&gt; P or Q
 t2 = forall P. forall Q. P -&gt; Q or P
</code></pre><p>We can trivially capture these as theorems in Haskell:</p><pre><code>data Either a b = Left a | Right b
t1 :: a -&gt; Either a b
t1 = Left
t2 :: a -&gt; Either b a
t2 = Right
</code></pre><p>To sum up: I like return type polymorphism, and only think it breaks referential transparency if you have a limited notion of values (although this is less compelling in the ad hoc type class case).  On the other hand, I do find your points about MR and type defaulting compelling.</p><hr/><p>*. In the comments <a href="https://softwareengineering.stackexchange.com/questions/105662/is-return-type-only-polymorphism-in-haskell-a-good-thing/215794#comment191731_105663">ysdx points out</a> this isn&#39;t strictly true: we could re-implement type classes by modeling the algebra as another type.  Like the java:</p><pre><code>abstract class Monoid&lt;M&gt;{
   abstract M empty();
   abstract M append(M m1, M m2);
}
</code></pre><p>You then have to pass objects of this type around with you.  Scala has a notion of implicit parameters which avoids some, but in my experience not all, of the overhead of explicitly managing these things.  Putting your utility methods (factory methods, binary methods, etc) on a separate F-bounded type turns out to be an incredibly nice way of managing things in an OO language that has support for generics.  That said, I&#39;m not sure I would have groked this pattern if I didn&#39;t have experience modeling things with typeclasses, and I&#39;m not sure other people will.</p><p>It also has limitations, out of the box there is no way to get an object that implements the typeclass for an arbitrary type.  You have to either pass the values explicitly, use something like Scala&#39;s implicits, or use some form of dependency injection technology.  Life gets ugly.  On the other hand, it is nice that you can have multiple implementations for the same type.  Something can be a Monoid in multiple ways.  Also, carrying around these structures separately has IMO a more mathematically modern, constructive, feel to it.  So, although I still generally prefer the Haskell way of doing this, I probably overstated my case.</p><p>Typeclasses with return type polymorphism makes this kind of thing easy to handle.  That doesn&#39;t meen it is the best way to do it.</p><p>**. <a href="https://softwareengineering.stackexchange.com/questions/105662/is-return-type-only-polymorphism-in-haskell-a-good-thing/215794#comment191752_105663">Jörg W Mittag points out</a> this isn&#39;t really the canonical way of doing this in Scala.  Instead, we would follow the standard library with something more like:</p><pre><code>abstract class List[+A] ...  
case class Cons[A](head: A, tail: List[A]) extends List[A] ...
case object Nil extends List[Nothing] ...
</code></pre><p>This takes advantage of Scala&#39;s support for bottom types, as well as covariant type paramaters.  So, <code>Nil</code> is of type <code>Nil</code> not <code>Nil[A]</code>.  At this point we are pretty far from Haskell, but it is interesting to note how Haskell represents the bottom type</p><pre><code>undefined :: forall a. a
</code></pre><p>That is, it isn&#39;t the subtype of all types, it is polymorphically(sp) a member of all types.<br/> Yet more return type polymorphism.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../why-does-scala-require-functions-to-have-explicit-return-type/'>Why does Scala require functions to have explicit return type</a></li><li class="list-group-item"><a href='../what-does-the-symbol-do-in-haskell/'>What does the => symbol do in haskell</a></li><li class="list-group-item"><a href='../alternative-to-language-purity/'>Alternative to language purity</a></li><li class="list-group-item"><a href='../is-higher-rank-parametric-polymorphism-useful/'>Is higher-rank parametric polymorphism useful</a></li><li class="list-group-item"><a href='../haskell-idiom-for-trying-several-functions-and-stop-as-soon-as-one-succeeds/'>Haskell idiom for trying several functions and stop as soon as one succeeds</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>