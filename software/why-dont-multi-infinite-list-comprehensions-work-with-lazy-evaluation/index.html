<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Why don&#8217;t &#8220;multi-infinite&#8221; list comprehensions work with lazy evaluation &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087965 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087965" class="post-1087965 software type-software status-publish hentry category-software tag-complexity tag-functional-programming tag-haskell"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Why don&#8217;t &#8220;multi-infinite&#8221; list comprehensions work with lazy evaluation</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">complexity</span><span class="mr-2 badge badge-info">functional programming</span><span class="mr-2 badge badge-warning">haskell</span></p><div class="entry-content"><p>As a simple demonstration of the efficiency of Haskell style, I thoughtlessly ran the following:</p><p><code>take 100 [(a, b, c) | a &lt;- [1..], b &lt;- [1..], c &lt;- [1..], a^2 + b^2 == c^2]</code></p><p>This should be a way of deriving the first 100 Pythagorean triples, with duplicates. In practice however, it never halts, because the algorithm itself defies lazy evaluation.</p><p>To think about it in terms of actual implementation, the following should be something similar to how the list comprehension is actually evaluated, in an imperative style:</p><pre><code>results = []
for (a = 0; a &lt; ∞; a++) {
  for (b = 0; b &lt; ∞; b++) {
    for (c = 0; c &lt; ∞; c++) {
      if (a^2 + b^2 == c^2) {
        results[] = [a, b, c]
      }
    }    
  }
}
</code></pre><p>When written like this, it becomes obvious that the function can never yield results, because infinite time will be spent testing whether <code>1^2 + 1^1 == c^2</code>, as only the innermost <code>for</code> loop will advance, and <code>a</code> and <code>b</code> will remain &#39;1&#39;.</p><p>The common solution in this particular case is to constrain the values of the smallest two variables to that of the largest:</p><p><code>take 100 [(a, b, c) | c &lt;- [1..],</code><strong><code>a &lt;- [1..c], b &lt;- [1..c],</code></strong><code>a^2 + b^2 == c^2]</code></p><p>However, this seems like an obvious oversight for implementors of the language. When you think about it, <em>any</em> list comprehension with more than one infinite source of search space will never halt, for the same reason, except some will yield useful results when (1, 1, x) is useful. There are <a href="https://stackoverflow.com/questions/15510916/how-to-have-multiple-infinite-ranges-in-list-comprehensions">questions</a> <a href="https://stackoverflow.com/questions/26877979/list-comprehension-with-infinity-list">discussing</a> <a href="https://stackoverflow.com/questions/15583975/haskell-infinite-list-of-incrementing-pairs">this</a> <a href="https://stackoverflow.com/questions/26956053/infinite-list-not-being-terminated-after-appropriate-value-is-found">problem</a>, but most discuss specific cases, rather than the problem overall. <strong>Why isn&#39;t fixing this within the language with a different iteration pattern trivial?</strong></p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>It is certainly possible to define an iteration order for <code>x1 &lt;- [1..], x2 &lt;- [1..], ..., xK &lt;- [1..]</code> that will reach any tuple <code>(c1, c2, ..., cK)</code> after some finite amount of steps, and tries each tuple only once. Take any computable bijection between the natural numbers N and the k-tuples of natural numbers, N^k. Such a bijection exists, as the Cartesian product of countable sets is again countable. One example would be repeatedly applying the (inverse of the) <a href="https://en.wikipedia.org/wiki/Pairing_function#Cantor_pairing_function">Cantor pairing function</a>. The precise bijection being used would have to be specified by the Haskell report, because it affects the order in which results are found.</p><p>However, this is of limited utility, because it would only cover the very specific pattern with <code>[1..]</code>. There are countless other ways to produce infinte lists, and not only is it far more involved to define a suitable iteration order for those cases, it is also <em>impossible</em> for the compiler to detect infinite lists in all cases (Rice&#39;s theorem). So you&#39;d have to define some heuristic for when this transformation applies. In the interest of being feasible to describe and implement across multiple interpreters and compilers, this would likely be a very simplistic heuristic.</p><p>So what you are left with is a subtle change to the semantics of a program, with no indication in the program source code, that only happens when some arcane and limited heuristic fires. Thanks, I&#39;ll pass. Just explicitly write the program to do what you want.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../why-is-the-concept-of-lazy-evaluation-useful/'>Why is the concept of lazy evaluation useful</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>