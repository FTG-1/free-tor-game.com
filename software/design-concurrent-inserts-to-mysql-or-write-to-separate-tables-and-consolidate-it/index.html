<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="https://free-tor-game.com/wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Design &#8211; Concurrent inserts to MySQL or write to separate tables and consolidate it &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js?ver=11.2.0' id='highlight-js'></script>     <script>( function( w, d, s, l, i ) {
				w[l] = w[l] || [];
				w[l].push( {'gtm.start': new Date().getTime(), event: 'gtm.js'} );
				var f = d.getElementsByTagName( s )[0],
					j = d.createElement( s ), dl = l != 'dataLayer' ? '&l=' + l : '';
				j.async = true;
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
				f.parentNode.insertBefore( j, f );
			} )( window, document, 'script', 'dataLayer', ' ' );</script>      <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1075359 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="https://free-tor-game.com/3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="https://free-tor-game.com/contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1075359" class="post-1075359 software type-software status-publish hentry category-software tag-apache-storm tag-design tag-mysql"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Design &#8211; Concurrent inserts to MySQL or write to separate tables and consolidate it</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">apache-storm</span><span class="mr-2 badge badge-info">design</span><span class="mr-2 badge badge-warning">MySQL</span></p><div class="entry-content"><p>I&#39;m working on Apache Storm (but anyone who knows MySQL well could help too). Topology is like this:</p><p>Single spout &#8212;-emit&#8212;&gt; Multiple instances of a Bolt</p><p>Each instance of the Bolt inserts a batch of rows to table ABC. The database table is located on a single server. The Bolt instances could be distributed across multiple servers.</p><p><strong>Objective:</strong> To be able to <a href="https://stackoverflow.com/questions/11093744/fastest-way-to-insert-in-parallel-to-a-single-table">speed</a> up and scale the program by increasing the number of Bolt instances (ie: if processing x amount of data and writing to MySQL took 1 hour with 5 Bolts, it should take maybe 35 minutes if I use 10 Bolts).</p><p><strong>Problem:</strong><br /> 1. No matter how many Bolts I use, the processing time will reduce, but <strong>each Bolt will have to wait for the other n-1 Bolts to finish inserting</strong>, before it can insert (not because the program logic makes it wait, but because <a href="https://stackoverflow.com/a/32288484/453673">SQL does not allow a process/bolt to write to SQL while another process/bolt is writing to the same table</a>). This waiting time does not allow the program to scale.<br /> 2. A long wait time will cause <strong>Zookeeper to timeout</strong>.<br /> 3. Before this topology starts, the table ABC already has existing data, and whatever new inserts are done will eventually have to be added to table ABC.</p><p><strong>A solution I thought of:</strong><br /> To let each Bolt write to its own temporary table<br /> <code>ABC_TempBolt1</code><br /> <code>ABC_TempBolt2</code><br /> <code>ABC_TempBolt3</code><br /> <code>ABC_TempBolt4</code><br /> <code>ABC_TempBolt5</code><br /> and when the Spout is finished, use SQL&#39;s <code>INSERT INTO</code> command to take contents of the Temp tables and insert it into ABC.</p><p>Is this the most efficient &amp;&amp; fast &amp;&amp; scalable way to accomplish this or is there a better design || technique?</p><p>ps: If there are other databases (even noSQL DB&#39;s) which can help speed up the application by allowing concurrent inserts, I&#39;m open to the idea.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>If you have the locking mechanism in place on the table in the database, then the concurrent writing in it is not possible, so there is no other way to parallelize the writing. Simply, the database is the bottleneck. The only gain that you get is that the processing done by bolts before the data is written into database is done in parallel.</p><p>Therefore, the approach you used is pretty much optimal. The only way I see that you could speed up the inserts is by using batch inserts and by tweaking the database so that it is optimized for what you are trying to do. Take a look at the following links:</p><p><a href="https://dev.mysql.com/doc/refman/5.5/en/optimizing-innodb-bulk-data-loading.html" rel="nofollow noreferrer">Bulk Data Loading for InnoDB Tables</a></p><p><a href="https://dba.stackexchange.com/questions/46886/insert-speeds-for-large-batches">Insert Speeds for large batches</a></p><p>As far as concurrent inserts, this might help:</p><p><a href="https://dev.mysql.com/doc/refman/5.7/en/concurrent-inserts.html" rel="nofollow noreferrer">MySQL Concurrent Inserts</a></p><p>I believe this would be of interest to you:</p><blockquote><p>If there are multiple INSERT statements, they are queued and performed in sequence</p></blockquote><p>Basically, you cannot insert two records simultaneously. They will always be queued, which means that the locking mechanism is in place implicitly.</p><p>Hope this helps.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='https://free-tor-game.com/software/the-best-collation-for-use-in-mysql-tables/'>The Best Collation for Use in MySQL Tables</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/how-to-separate-sensitive-data-in-databasemysql/'>How to separate sensitive data in database(MySql)</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/php-algorithm-for-tracking-progress-of-controller-method-running-in-background/'>Php &#8211; Algorithm for tracking progress of controller method running in background</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/multi-thread-return-single-sql-result/'>Multi-Thread Return Single SQL Result</a></li><li class="list-group-item"><a href='https://free-tor-game.com/software/c-design-for-sql-connection-and-commands/'>C# Design for SQL connection and commands</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='http://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="https://free-tor-game.com/wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>