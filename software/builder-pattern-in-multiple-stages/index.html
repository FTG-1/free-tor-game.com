<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Builder pattern in multiple stages &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1087220 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1087220" class="post-1087220 software type-software status-publish hentry category-software tag-builder-pattern tag-design-patterns"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Builder pattern in multiple stages</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">builder-pattern</span><span class="mr-2 badge badge-info">design-patterns</span></p><div class="entry-content"><p>I like using the Builder/Director pattern to build complex objects. It works really well. The only restrictions (maybe it is not really a restrictions) I see is that all of the parameters for the construction of an object need be present before calling the builder.</p><p>I have now come to a situation where I need to build a complex object, but one part at a time. More than that, I need to support both scenarios.</p><p><strong>Example of the first scenario</strong> (<em>where I have all parameters needed to build a complex object at once</em>): A user calls an api end point with a build request dto which contains all the parameters I need. I pass request dto to director and I build the object.</p><p><strong>Example of the second scenario</strong> (<em>where the building of an object is broken up into multiple stages</em>): A user calls an api end point and passes in some dto which contains just the parameters to build first part one of the whole object. After some time, the user calls an api end point and passes another dto which contains just the parameters to build part two, and so forth.</p><p>What is the best way to handle this?<br /> Do I create multiple directors which build only those specific parts?</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>There a few options the way I see it:</p><h3>Option 1: Pass the Builder Around</h3><p>There&#39;s no benefit in actually building and returning an object that will need to changed. Just pass the <code>Builder</code> object where ever it needs to go and provide access to its fields so that whatever needs to happen between each build stage can know the current state of the builder. The downsides to this are that you cant &#34;lock in&#34; a part of the <code>Builders</code> state if that is something you need to do. It can technically be done by having a function <code>lockInStage1()</code> or something which changes a flag that stops some setters from being used, but thats a bit messy.</p><h3>Option 2: Provide a ReadOnly implementation</h3><p>This is basically the same thing as Option 1, but without the <code>Builder</code> object. Just have a mutable version of the object and then allow the user to create a immutable version from it.</p><p>For example:</p><pre><code>public class ReadOnlyMyObject {
    private int field1;
    private int field2;

    public ReadOnlyMyObject(MyObject obj) {
        field1 = obj.field1;
        field2 = obj.field2;
    }

    public int getField1() {
        return field1;
    }
}

public class MyObject {
    public int field1;
    public int field2;
    //fields can either be public or accessed through getters and setters

    public ReadOnlyMyObject asReadOnly() {
        return new ReadOnlyMyObject(this);
    }    
}
</code></pre><p>Personally, I prefer this over the builder pattern as it leaves you open to having a mutable object if it is ever needed, and why have a <code>Builder</code> class if the object isn&#39;t being built as one piece. It has the same disadvantage as Option 1 though. You can&#39;t really lock in the state of each stage.</p><h3>Option 3: Builder for each Stage</h3><p>Instead of a single object and <code>Builder</code> counterpart you would simply make an object for each stage and build it individually. The <code>Builder</code> for each stage would then take as a parameter the previous stage.</p><pre><code>public class Stage1 {
    //stage 1 fields

    public class Builder {
        //Builder fields

        public Builder() { }

        //stage 1 builder functions

        public Stage1 build() {
            //build stage 1
        }
    }    
}

public class Stage2 {
    private Stage1 stage1
    //stage 2 fields

    public class Builder {
        private Stage1 stage1;
        //Builder fields

        public Builder(Stage1 stage1) {
            this.stage1 = stage1;
        }

        //stage 2 builder functions

        public Stage1 build() {
            Stage2 stage2 = new Stage2(this.stage1);
            //build stage 2
        }
    }    
}    


public class FinalObject {
    private Stage2 stage2
    //fields

    public class Builder {
        private Stage2 stage2;
        //Builder fields

        public Builder(Stage2 stage2) {
            this.stage2 = stage2;
        }

        //builder functions

        public FinalObject build() {
            FinalObject obj = new FinalObject(this.stage2);
            //build final object
        }
    }    
}
</code></pre><p>I don&#39;t love this, because you can potentially need to create a lot of classes. However there are some real benefits to this method.</p><ol><li><p>Each stage is locked in. Once it is created it can&#39;t be changed.</p></li><li><p>If you need to add stages between 2 existing stages its fairly simple (kind of like how adding an object to a <code>LinkedList</code> has very little overhead. For that reason the stage objects shouldn&#39;t be called <code>Stage</code>, <code>Stage2</code> or any ordinal value as it would force you to rename all of them.</p></li></ol><h3>Summary</h3><p>Overall I would say if the stages need to be locked in go with the Multiple Builders as long as you don&#39;t need to change any data in a previous stage once it is created. It can be done, but its fighting the pattern.</p><p>If the data in each stage can potentially be changed by what happens in later stages go with passing the <code>Builder</code> or providing a ReadOnly version of the object.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../builder-design-patterns-passing-parameters-from-client-to-the-builder/'>Builder design patterns: passing parameters from client to the builder</a></li><li class="list-group-item"><a href='../design-is-stringbuilder-an-application-of-the-builder-design-pattern/'>Design &#8211; Is &#8220;StringBuilder&#8221; an application of the Builder Design Pattern</a></li><li class="list-group-item"><a href='../constructor-with-tons-of-parameters-vs-builder-pattern/'>Constructor with tons of parameters vs builder pattern</a></li><li class="list-group-item"><a href='../java-is-it-strange-for-a-builder-object-to-have-getter-methods/'>Java &#8211; Is it strange for a Builder object to have getter methods</a></li><li class="list-group-item"><a href='../java-how-to-implement-a-step-builder-for-which-the-order-of-setters-doesnt-matter/'>Java: How to implement a step builder for which the order of setters doesn&#8217;t matter</a></li><li class="list-group-item"><a href='../object-oriented-when-should-the-builder-design-pattern-be-used/'>Object-oriented &#8211; When should the builder design pattern be used</a></li><li class="list-group-item"><a href='../what-are-the-advantages-of-builder-pattern-of-gof/'>What are the advantages of Builder Pattern of GoF</a></li><li class="list-group-item"><a href='../is-the-builder-pattern-applicable-in-domain-driven-design/'>Is the builder pattern applicable in domain driven design</a></li><li class="list-group-item"><a href='../java-is-the-builder-pattern-appropriate-to-use-to-update-objects-in-a-service-layer/'>Java &#8211; Is the builder pattern appropriate to use to update Objects in a Service layer</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>