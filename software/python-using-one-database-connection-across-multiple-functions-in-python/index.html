<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Python &#8211; using one database connection across multiple functions in python &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1064791 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1064791" class="post-1064791 software type-software status-publish hentry category-software tag-python"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Python &#8211; using one database connection across multiple functions in python</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">python</span></p><div class="entry-content"><p>whats the best way to go about this in python? I have a number of like so</p><pre><code>def test1()
    .... code .....
def test2()
    .... code .....
def test3()
    .... code .....
</code></pre><p>how could I create one database connection and use it across all the functions? I&#39;m connecting to my database in a test file like so:</p><pre><code>import MySQLdb as mdb
import sys

try:
    con = mdb.connect(&#39;10.243.17.13&#39;, &#39;mark&#39;, &#39;********&#39;, &#39;dex&#39;);

    cur = con.cursor()
    cur.execute(&#34;SELECT VERSION()&#34;)

    ver = cur.fetchone()
    
    print &#34;Database version : %s &#34; % ver

except mdb.Error, e:

    print &#34;Error %d: %s&#34; % (e.args[0],e.args[1])
    sys.exit(1)
</code></pre></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The problem is well known and the keyword you may be searching for is <em>pooling</em>.</p><p>The idea is that opening a connection is a complicated task: is usually requires reaching the server, doing authentication, checking the rights, auditing, etc.</p><p>On the other hand, preserving the same connection through the application by either storing it in a static variable or passing it to every method which may require access to the database is usually ugly and difficult to implement. Not counting the fact that in this case, the connection may remain opened for a long time while being unused, eventually reaching the maximum number of connections allowed by the server.</p><p>Connection pooling consists of preserving the pool of connections under the hood in order to make it possible for the programmer to open the connection and close it as soon as it is not needed any longer. The actual connections are managed transparently, meaning that you don&#39;t have the overheat of a connection opened again and again and you are less at risk of using all available connections.</p><p>Further reading:</p><ul><li><p><a href="https://stackoverflow.com/a/14951329/240613">Opening and closing database connection for each query</a> at Stack Overflow.</p></li><li><p><a href="http://blog.pelicandd.com/article/12/pooling-and-performance-what-benchmarks-and-profiling-may-reveal" rel="noreferrer">Pooling and performance: what benchmarks and profiling may reveal</a>, an article from my blog.</p></li></ul><p>Now, not reusing the connection doesn&#39;t mean you should duplicate database logic in every of your tests. You may put connection and disposal logic in a class with <a href="https://stackoverflow.com/a/1984346/240613">special</a> <code>__enter__</code> and <code>__exit__</code> methods, and then use it as:</p><pre><code>with DatabaseConnection() as db:
    cursor = db.connection.cursor()
    ...
</code></pre><p>Note that since you mention tests in your code sample:</p><ol><li><p>You may be interested in <a href="https://docs.python.org/3/library/unittest.html" rel="noreferrer">using a testing framework</a>. After all, you said that you &#34;just play with Python, learning by doing&#34;, so why not to learn a Python&#39;s testing framework as well?</p></li><li><p>As others noted, unit tests shouldn&#39;t access a database. But access to databases is perfectly fine in integration or system tests.</p></li></ol></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../javascript-multiple-attribution-in-python-js/'>Javascript &#8211; Multiple attribution in Python, JS, &#8230;</a></li><li class="list-group-item"><a href='../python-methods-vs-builtin-functions/'>Python methods vs builtin functions</a></li><li class="list-group-item"><a href='../python-how-to-achieve-inheritance-when-using-just-modules-and-vanilla-functions-in-python/'>Python &#8211; How to achieve inheritance when using just modules and vanilla functions in Python</a></li><li class="list-group-item"><a href='../python-organizing-python-functions-into-a-module-or-class/'>Python &#8211; Organizing Python functions into a module or class</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>