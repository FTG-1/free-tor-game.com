<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>C# &#8211; Do not declare interfaces for immutable objects &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1070119 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1070119" class="post-1070119 software type-software status-publish hentry category-software tag-c tag-immutability"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">C# &#8211; Do not declare interfaces for immutable objects</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">c</span><span class="mr-2 badge badge-info">immutability</span></p><div class="entry-content"><p><strong>Do not declare interfaces for immutable objects</strong></p><p>[EDIT] <em>Where the objects in question represent Data Transfer Objects (DTOs) or Plain Old Data (PODs)</em></p><p>Is that a reasonable guideline?</p><p>Up to now, I&#39;ve often created interfaces for sealed classes that are immutable (data cannot be changed). I&#39;ve tried to be careful myself to not use the interface anywhere where I care about immutability.</p><p>Unfortunately, the interface begins to pervade the code (and it&#39;s not just my code I&#39;m worried about). You wind up being passed an interface, and then wanting to pass it to some code that really wants to assume that the thing being passed to it is immutable.</p><p>Because of this problem, I&#39;m considering never declaring interfaces for immutable objects.</p><p>This might have ramifications with respect to Unit Testing, but other than that, does this seem a reasonable guideline?</p><p>Or is there another pattern I should be using to avoid the &#34;spreading-interface&#34; problem I&#39;m seeing?</p><p>(I&#39;m using these immutable objects for several reasons: Mainly for thread safety since I write a lot of multi-threaded code; but also because it means I can avoid making defensive copies of objects passed to methods. Code becomes a lot simpler in many cases when you know something is immutable &#8211; which you don&#39;t if you&#39;ve been handed an interface. In fact, often you can&#39;t even make a defensive copy of an object referenced via an interface if it doesn&#39;t provide a clone operation or any way of serialising it&#8230;)</p><p>[EDIT]</p><p>To provide a lot more context for my reasons for wanting to make objects immutable, see this blog post from Eric Lippert:</p><p><a href="http://blogs.msdn.com/b/ericlippert/archive/tags/immutability/">http://blogs.msdn.com/b/ericlippert/archive/tags/immutability/</a></p><p>I should also point out that I&#39;m working with some lower-level concepts here, such as items that are being manipulated/passed around in multi-threaded job queues. These are essentially DTOs.</p><p>Also Joshua Bloch <a href="http://books.google.co.uk/books?id=ka2VUBqHiWkC&amp;pg=PA76&amp;lpg=PA76&amp;dq=immutable%20objects%20essential%20java&amp;source=bl&amp;ots=yYIhNmr3O4&amp;sig=dYdJ8LQR4AjR_igZ5NW9s38wx-8&amp;hl=en&amp;sa=X&amp;ei=NWQ3UfT9DcnZPPPEgagO&amp;ved=0CFUQ6AEwBA#v=onepage&amp;q=immutable%20objects%20essential%20java&amp;f=false">recommends the use of immutable objects in his book Effective Java</a>.</p><hr/><p><strong>Follow Up</strong></p><p>Thanks for the feedback, all. I&#39;ve decided to go ahead and use this guideline for DTOs and their ilk. It&#39;s working well so far, but it&#39;s only been a week&#8230; Still, it&#39;s looking good.</p><p>There are some other issues relating to this that I want to ask about; notably something I&#39;m calling &#34;Deep or Shallow Immutability&#34; (nomenclature I stole from Deep and Shallow cloning) &#8211; but that&#39;s a question for another time.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>In my opinion, your rule is a good one (or at least it&#39;s not a bad one), but only because of the situation you are describing.  I wouldn&#39;t say that I agree with it in all situations, so, from the standpoint of my inner pedant, I&#39;d have to say your rule is technically too broad.</p><p>Typically you wouldn&#39;t define immutable objects unless they are essentially being used as data transfer objects (DTO), which means that they contain data properties but very little logic and no dependencies.  If that is the case, as it seems it is here, I&#39;d say you are safe to use the concrete types directly rather than interfaces.</p><p>I&#39;m sure there will be some unit-testing purists who will disagree, but in my opinion, DTO classes can be safely excluded from unit-testing and dependency-injection requirements.  There is no need to use a factory to create a DTO, since it has no dependencies.  If everything creates the DTOs directly as needed, then there&#39;s really no way to inject a different type anyway, so there&#39;s no need for an interface.  And since they contain no logic, there&#39;s nothing to unit-test.  Even if they do contain some logic, as long as they have no dependencies, then it should be trivial to unit-test the logic, if necessary.</p><p>As such, I think that making a rule that all DTO classes shall not implement an interface, while potentially unnecessary, is not going to hurt your software design.  Since you have this requirement that the data needs to be immutable, and you cannot enforce that via an interface, then I would say it&#39;s totally legitimate to establish that rule as a coding standard.</p><p>The larger issue, though, is the need to strictly enforce a clean DTO layer.  As long as your interface-less immutable classes only exist in the DTO layer, and your DTO layer remains free of logic and dependencies, then you will be safe.  If you start mixing your layers, though, and you have interface-less classes that double as business layer classes, then I think you will start to run into much trouble.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../what-are-the-consequences-of-immutable-classes-with-references-to-mutable-classes/'>What are the consequences of immutable classes with references to mutable classes</a></li><li class="list-group-item"><a href='../does-immutability-entirely-eliminate-the-need-for-locks-in-multi-processor-programming/'>Does immutability entirely eliminate the need for locks in multi-processor programming</a></li><li class="list-group-item"><a href='../java-why-doesnt-java-8-include-immutable-collections/'>Java &#8211; Why doesn&#8217;t Java 8 include immutable collections</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>