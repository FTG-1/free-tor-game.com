<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Preferred approach to mock a site to test a scraper &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1081791 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1081791" class="post-1081791 software type-software status-publish hentry category-software tag-acceptance-testing tag-web-scraping"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Preferred approach to mock a site to test a scraper</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">acceptance-testing</span><span class="mr-2 badge badge-info">web scraping</span></p><div class="entry-content"><p>Subj. Atm I&#39;m using Selenium and Python, but the same applies to any other scraping solution.</p><p>I&#39;m wondering:</p><ol><li>which of the options outlined below are optimal/recommended/best practices</li><li>if there are existing solutions/helper libraries, which keywords I should look them up by.</li></ol><p>To stay objective, &#34;optimal/recommended/best practices&#34; means &#34;widely used and/or promoted/endorsed by high-profile projects in the niche.&#34;</p><p>I couldn&#39;t find any Selenium-related or general-purpose material on this topic having spent about a day of net time searching around which probably means I&#39;m lacking some critical piece(s) of information.</p><hr/><p>The basic operations when scraping are:</p><ul><li>searching for element (by CSS selector/XPath and/or by hand for things that those aren&#39;t capable of)</li><li>interacting with an element (input text, click)</li><li>read element data</li></ul><p>And the call chain goes like this:</p><blockquote><p>(Test code -&gt;) User code -&gt; Framework (selenium) -&gt; Browser (web driver) -&gt; Site</p></blockquote><hr/><p>So, there are 3 hops here that I could mock. Each one poses challenges:</p><ul><li>Mock the site: launch a local HTTP server and direct the browser there<ul><li>Have to reimplement the scraped site&#39;s interface, in web technologies</li></ul></li><li>Mock the browser (e.g. populate HtmlUnit (an in-process browser engine) with predefined HTML at appropriate moments)<ul><li>much simpler but still need to emulate state transitions/action reactions somehow</li></ul></li><li>Mock the framework calls<ul><li>The truest to the unit testing philosophy, the least work</li><li>I&#39;m however worried that it&#39;s too restrictive. E.g. I can find the same element by various means. A mock object can only accept a very specific course of action as it lacks the sophistication to e.g. check if some other selector would produce the same result.</li></ul></li></ul><p>There are also two options for what content to provide &#8212; either</p><ul><li>provide the site&#39;s original content that it produced for a test query, compiling it into some sort or self-contained package<ul><li>labor-intensive and error-prone, or</li></ul></li><li>provide the bare minimun to satisfy the tested algorithm<ul><li>much simpler but would fail for other possible algorithms that would succeed with the real site</li></ul></li></ul><p>One last concern is the fact that a site is effectively a state machine. I&#39;m not sure which will be more useful:</p><ul><li>implement the complete state machine, probably as some kind of specification, and set/check its states in the tests<ul><li>very labor-intensive without some kind of library that reduces the work to writing a formal specification; or</li></ul></li><li>simply validate the action sequences<ul><li>which doesn&#39;t seem to actually test the code against anything &#8212; it merely reiterates what the code does</li></ul></li></ul><p>Update to address an expressed concern:</p><p>I&#39;m scraping a 3rd-party site &#8212; which can and will change without notice one day. So, I&#39;m fine with testing against &#34;the site&#39;s interface as it was at the time of writing&#34; &#8212; to quickly check if a code change broke the scraper&#39;s internal logic.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>You can go crazy mocking every detail. That&#39;s probably not feasible given many complicated test cases.</p><p>Where possible, it is better to record a complete real-world test input, redact it to get rid of irrelevant details, and then run it through your complete scraping engine. How to represent the site and how to replay it depends on the fidelity you need for these tests. E.g. this might be very difficult if the site is expected to make Ajax requests to multiple domains.</p><p>For example, you might get away by simply storing the HTML of a page you want to scrape. In extreme cases, you would want to log and replay all HTTP requests the site makes. I.e., the site makes the request and you replay a response you recorded from the live site.</p><p>In all cases, the thing you assert is that your scraper extracted the correct data from the page. How it gets there is going to be secondary.</p><p>The advantage of these high-level testing methods is that</p><ul><li>they are quite realistic,</li><li>and once the test suite is set up, adding another testcase doesn&#39;t require much effort.</li></ul><p>The disadvantage is that these tests are somewhat slow â€“ much faster than doing actual requests to live sites, but still slower than targeted unit tests of your scraper.</p><p>Over time, you can grow a corpus of realistic test cases. If a test case stops being useful (e.g. because the live site changed), you can always throw it out.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../agile-the-difference-between-acceptance-test-driven-planning-and-acceptance-test-driven-development/'>Agile &#8211;  the difference between Acceptance Test-Driven Planning and Acceptance Test-Driven Development</a></li><li class="list-group-item"><a href='../writing-acceptance-test-cases/'>Writing Acceptance test cases</a></li><li class="list-group-item"><a href='../how-would-you-test-google-maps-get-directions-feature/'>How would you test Google Maps &#8220;Get Directions&#8221; feature</a></li><li class="list-group-item"><a href='../isolating-test-data-in-acceptance-tests/'>Isolating test data in acceptance tests</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>