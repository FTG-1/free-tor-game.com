<!doctype html><html lang="en-US"><!--  --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- / -->
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">  <link media="all" href="../../wp-content/cache/autoptimize/4/css/autoptimize_dc56928889f08ceb40a4520f8ece953b.css" rel="stylesheet" /><title>Use case interactions in clean architecture &#8211; free-tor-game.com</title> <script>MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};</script> <link rel='dns-prefetch' href='http://cdn.jsdelivr.net/' /><link rel='dns-prefetch' href='http://cdnjs.cloudflare.com/' /><link rel='dns-prefetch' href='http://stackpath.bootstrapcdn.com/' /><link rel='dns-prefetch' href='http://s.w.org/' /><link rel='stylesheet' id='highlight-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/vs2015.min40df.css?ver=5.6' type='text/css' media='all' /><link rel='stylesheet' id='bootstrap-css'  href='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.mina352.css?ver=4.1.3' type='text/css' media='all' /><link rel='stylesheet' id='icons-css'  href='../../../stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min40df.css?ver=5.6' type='text/css' media='all' /> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.minb8ff.js?ver=1.12.4' id='jquery-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.minc9a3.js?ver=11.2.0' id='highlight-js'></script>            <script>hljs.highlightAll();</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1731162805004860" crossorigin="anonymous"></script></head><body class="software-template-default single single-software postid-1081243 no-sidebar"><div id="page" class="site"> <a class="skip-link screen-reader-text" href="#content">Skip to content</a><header id="topnav" class="sticky-top"><nav class="navbar navbar-expand-md navbar-light bg-light" role="navigation"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-primary" aria-controls="navbar-primary" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="#">free-tor-game.com</a><div id="navbar-primary" class="collapse navbar-collapse"><ul id="menu-primary-top-menu" class="nav navbar-nav"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-192" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children dropdown menu-item-192 nav-item"><a title="Tools" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle nav-link" id="menu-item-dropdown-192">Tools</a><ul class="dropdown-menu" aria-labelledby="menu-item-dropdown-192" role="menu"><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-post menu-item-193 nav-item"><a title="ARFCN-Frequency Converter" href="../../3gpp-arfcn-frequency-converter/" class="dropdown-item">ARFCN-Frequency Converter</a></li></ul></li><li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-2301" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2301 nav-item"><a title="Contact Us" href="../../contact/" class="nav-link">Contact Us</a></li></ul></div></nav></header><div id="content" class="site-content"><div id="primary" class="content-area"><main id="main" class="site-main"><div id="main-container" class="container"><div id="main-row" class="row"><div id="main-col" class="col-12"><article id="post-1081243" class="post-1081243 software type-software status-publish hentry category-software tag-clean-architecture tag-onion-architecture tag-use-case"><div class="row"><div class="col-12 col-md-8"><header class="entry-header"><h1 class="entry-title text-danger">Use case interactions in clean architecture</h1></header><p style='font-size:1.2em'><span class="mr-2 badge badge-success">clean-architecture</span><span class="mr-2 badge badge-info">onion-architecture</span><span class="mr-2 badge badge-warning">use-case</span></p><div class="entry-content"><p>I&#39;m experimenting with Clean Architecture for my turn-based strategy game project. I have useÂ cases that form hierarchies and need to be coordinated with each other. I would like some advice on how to design these interactions.</p><h2>Example</h2><p>My entry point to the game is the <code>TurnUseCase</code>. It gives information about the current turn, the list of actions that are possible in that turn and allows to end the turn. The <em>end of the turn</em> bit is important as it is causing my issues.</p><p>Inside the turn, players can perform various actions. Each has its own use case, for example <code>MoveUseCase</code>, <code>AttackUseCase</code> or <code>DefendUseCase</code>. After some actions, the turn should end.</p><h2>Question</h2><p>How the <code>AttackUseCase</code> should pass information to the <code>TurnUseCase</code> that the turn should now end? Without that information, the <code>TurnUseCase</code> can&#39;t progress the game to another player.</p><ul><li>Should I have the dependency between these use cases? Do I need a Factory to create all these use cases and manage relationships between them?</li><li>Should I use Observer to notify the other use case?</li><li>Should I create some kind of <em>System Use Case</em> that will monitor the Entities and it will trigger the end of the turn when certain conditions are met (ie: number of possible actions is 0)? Could this logic be part of <code>TurnUseCase</code>?</li></ul><p>I would appreciate any suggestions on how to solve this problem.</p><h2>Edit</h2><p>Here are some details as requested by @candied_orange to help with the answer.</p><p><strong>Who should be responsible for use case creation?</strong> It does not seem to be efficient to create use cases from other use cases due to dependencies that the child use case requires (Presenter, Repositories, etc). At the same time, I&#39;m reluctant to move that responsibility up as this is part of the domain (game rules) to know which operation is possible at any given moment in the game. Most of the examples and articles show use case created by Controller and only situations where one use case operate independently of other use cases. From <a href="https://softwareengineering.stackexchange.com/users/9113/doc-brown">Doc Brown&#39;s</a> answer I understand that this kind of problems are not addressed by Clean Architecture rules. Nevertheless I would like to see some hints from people that have used this approach in larger system.</p><p><strong>What should be the use case life cycle?</strong> In my particular problem, I create all the use cases dynamically when the turn starts. That is partly because the game is asymmetric and different players have different use cases to choose from. However, maybe it is needed to have all the use cases active all the time and validate if their usage is possible in any given moment of the game?</p><p><strong>What is the best way to override the use case?</strong> This kind of operation I&#39;ve planned to use for tutorial purposes where I have to interrupt the normal game flow and explain the game rules. I wanted the tutorial to decorate the normal game flow so the normal use cases are not aware of the tutorial. To make this work I would need to have a place where all use cases live so I can override them in runtime. This goes back to question about who should create use cases.</p><p><strong>It there a concept of <em>System</em> use case?</strong> By that, I mean a use case that is triggered by the system rather than a user. This goes back to <a href="https://softwareengineering.stackexchange.com/users/5099/bart-van-ingen-schenau">Bart van Ingen Schenau&#39;s</a> question about user manually triggering the end of the turn. Yes, the user can do it manually when he doesn&#39;t want to move anything. However, in the normal scenario, I would like the turn to end automatically. This is also because I have other situations when child use case have to do something on the parent so I&#39;m interested in solving this problem rather than forcing the user to confirm the end of the turn manually.</p></div>     <div id="comments" class="comments-area"><div class="row"><div class="col-12"><div class="mt-3 border-bottom border-success"><h4 class="text-success"><i class='fa fa-check-circle text-success mr-3'></i><span>Best Answer</span></h4></div><div class='bg-transparent mb-3'><p>The <a href="http://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html" rel="nofollow noreferrer">Clean Architecture</a> does not say anything about implementing interfaces,  dependencies or interactions between different use cases. Use cases are all part of the same ring. So at this part of the system, you are on your own, have to start thinking by yourself and make your own decisions about how you are going to implement things in a meaningful manner.</p><p>Some things you need to start thinking about:</p><ul><li><p>What exactly are the game rules (especially for ending a turn), and how is this information represented in the system? Without clarifying this basic requirement, don&#39;t even start thinking about different solutions.</p></li><li><p>How shall the data flow between the parts look like? Will each action write information about the changes to the game&#39;s state back to a global instance? Like a &#34;game&#34; class? Or a database? Can a third party instance (like the code which will handle the turn) ask that global instance about that information or when a turn ended? Or does such a central instance not exist, and the different components have to communicate directly with each other?</p></li><li><p>How are the use cases implemented? Is each use case is a class on its own in your system? Where are the related objects <code>MoveUseCase</code>, <code>AttackUseCase</code> or <code>DefendUseCase</code> created, and what is their life time? Does the <code>TurnUseCase</code> create them during the turn? Does it call an synchronous method of each those objects to deal with the use case? Then it should be quite simple for a <code>TurnUseCase</code> object to ask any of the other objects for any information after each action. Or do you have an event based system, where each use case communicates with the other ones through asynchronous event channels? Then something like an Observer could be appropriate.</p></li><li><p>Will there be something like a game loop, maybe in conjunction with some kind of event queue (<a href="https://softwareengineering.stackexchange.com/q/382510/9113">see this post</a>)? Where is is placed in your system, and how will it interact with the other components?</p></li><li><p>How decoupled do you need those use cases for unit testing purposes? This depends on the complexity of each, and the tests you intend to write. If each action is not a class, but a simple method in a <code>TurnUseCase</code> class, you probably won&#39;t need any decoupling measures.</p></li></ul><p>As a general rule: start with the most simple design you can think of, and if it turns out to be &#34;too simple&#34; for your requirements, <em>then</em> start refactoring.</p></div></div><div class="col-4"></div></div></div></div><div class="col-12 col-md-4"> <ins class="adsbygoogle"
 style="display:block"
 data-ad-client="ca-pub-1731162805004860"
 data-ad-slot="1340983829"
 data-ad-format="auto"
 data-full-width-responsive="true"></ins>   <div class='mt-3 ml-4 border-bottom border-success'><h6><span>Related Question</span></h6></div><ul class='list-group list-group-flush'><li class="list-group-item"><a href='../use-case-decomposition-for-class-registration-system/'>Use case decomposition for class registration system</a></li><li class="list-group-item"><a href='../how-to-create-a-use-case-diagram-for-board-game-played-on-pc/'>How to create a use case diagram for board game played on PC</a></li><li class="list-group-item"><a href='../how-to-split-up-use-cases-in-clean-architecture-dealing-with-use-case-dependencies/'>How to split up use cases in Clean Architecture? (Dealing with use case dependencies)</a></li><li class="list-group-item"><a href='../architecture-clean-architecture-use-case-spanning-multiple-ui-elements/'>Architecture &#8211; Clean Architecture: Use case spanning multiple UI elements</a></li></ul></div></div><footer class="entry-footer"></footer></article></div></div></div></main></div></div><footer id="colophon" class="site-footer"><div class="site-info"></div></footer></div>    <script type='text/javascript' src='../../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-chtml40df.js?ver=5.6' id='mathjax-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/esm/popper.min43d3.js?ver=1.14.7' id='popper-js'></script> <script type='text/javascript' src='../../../cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min5b31.js?ver=4.3.1' id='bootstrap4-js'></script> <script type='text/javascript' id='itectec-common-js-extra'>var globalObject = {"homeUrl":"https:\/\/free-tor-game.com\/"};</script> <script defer src="../../wp-content/cache/autoptimize/4/js/autoptimize_63b39f43631847816e6b0e70ea726624.js"></script></body></html>